import{D as a,s as r,E as u,F as c,z as h}from"./index-D_zi-PEm.js";const f=a.fragmentForType().project(n=>({_id:r(),name:r().nullish(),nickname:r().nullish(),designation:r().nullish(),introduction:r().nullish(),portraitImage:n.field("portraitImage.asset").field("_ref",r().nullish().transform(d=>u(d,{mode:"cover",width:720,height:1e3}))),portraitAltImage:n.field("portraitAltImage.asset").field("_ref",r().nullish().transform(d=>u(d,{mode:"cover",width:720,height:1e3}))),fullBodyImage:n.field("fullBodyImage.asset").field("_ref",r().nullish().transform(d=>u(d,{mode:"contain",height:1200}))),fullBodyAltImage:n.field("fullBodyAltImage.asset").field("_ref",r().nullish().transform(d=>u(d,{mode:"contain",height:1200}))),riichiImage:n.field("riichiImage.asset").field("_ref",r().nullish().transform(d=>u(d,{mode:"cover",width:800,height:800})))})),s=a.fragmentForType().project(n=>({_id:r(),name:r().nullish(),secondaryName:r().nullish(),thirdName:r().nullish(),preferredName:r().nullish(),squareLogoImage:n.field("squareLogoImage.asset").field("_ref",r().nullish().transform(d=>u(d,{width:1e3,height:1e3}))),color:n.field("color.hex",r().nullish()),introduction:r().nullish()})),m=async(n,d)=>{const o=a.star.filterByType("match").filterRaw(`tournament._ref == "${n}" && !defined(resultUploadedAt)`).order("startAt asc").slice(0,10).project(i=>({_id:r(),name:r().nullish(),nameAlt:r().nullish(),startAt:!0,playerEast:i.field("playerEast").deref().project(f),playerSouth:i.field("playerSouth").deref().project(f),playerWest:i.field("playerWest").deref().project(f),playerNorth:i.field("playerNorth").deref().project(f),playerEastTeam:i.field("playerEastTeam").deref().project(s),playerSouthTeam:i.field("playerSouthTeam").deref().project(s),playerWestTeam:i.field("playerWestTeam").deref().project(s),playerNorthTeam:i.field("playerNorthTeam").deref().project(s),_createdAt:!0,_updatedAt:!0}));return c(o).then(i=>{const l=(e,t)=>({id:(e==null?void 0:e._id)??"",teamId:(t==null?void 0:t._id)??"",color:{primary:(t==null?void 0:t.color)??"#FFFF00",secondary:h((t==null?void 0:t.color)??"#FFFF00")},name:{official:{primary:(e==null?void 0:e.name)??"",secondary:(e==null?void 0:e.designation)??"",third:(e==null?void 0:e.nickname)??""},display:{primary:(e==null?void 0:e.name)??"",secondary:(t==null?void 0:t.preferredName)??"",third:(e==null?void 0:e.nickname)??""}},image:{portrait:e!=null&&e.portraitImage?{default:{url:e==null?void 0:e.portraitImage}}:void 0,portraitAlt:e!=null&&e.portraitAltImage?{default:{url:e==null?void 0:e.portraitAltImage}}:void 0,fullBody:e!=null&&e.fullBodyImage?{default:{url:e==null?void 0:e.fullBodyImage}}:void 0,fullBodyAlt:e!=null&&e.fullBodyAltImage?{default:{url:e==null?void 0:e.fullBodyAltImage}}:void 0,riichi:e!=null&&e.riichiImage?{default:{url:e==null?void 0:e.riichiImage}}:void 0,logo:{default:{url:(t==null?void 0:t.squareLogoImage)??""}}}});return i.map(e=>({schemaVersion:"2",code:e._id,data:{name:{official:{primary:e.name??""}},players:[l(e.playerEast,e.playerEastTeam),l(e.playerSouth,e.playerSouthTeam),l(e.playerWest,e.playerWestTeam),l(e.playerNorth,e.playerNorthTeam)],rulesetRef:"hkleague-4p",startAt:e.startAt},metadata:{createdAt:e._createdAt,updatedAt:e._updatedAt}}))})},A=async n=>{const d=a.star.filterByType("match").filterRaw(`_id == "${n}"`).order("startAt asc").slice(0,1).project(o=>({_id:r(),name:r().nullish(),nameAlt:r().nullish(),playerEast:o.field("playerEast").deref().project(f),playerSouth:o.field("playerSouth").deref().project(f),playerWest:o.field("playerWest").deref().project(f),playerNorth:o.field("playerNorth").deref().project(f),playerEastTeam:o.field("playerEastTeam").deref().project(s),playerSouthTeam:o.field("playerSouthTeam").deref().project(s),playerWestTeam:o.field("playerWestTeam").deref().project(s),playerNorthTeam:o.field("playerNorthTeam").deref().project(s),_createdAt:!0,_updatedAt:!0,tournament:!0}));return c(d).then(o=>{var l;if(o.length===0)throw new Error("找不到賽事");const i=(e,t)=>({id:(e==null?void 0:e._id)??"",teamId:(t==null?void 0:t._id)??"",color:{primary:(t==null?void 0:t.color)??"#FFFF00",secondary:h((t==null?void 0:t.color)??"#FFFF00")},name:{official:{primary:(e==null?void 0:e.name)??"",secondary:(e==null?void 0:e.designation)??"",third:(e==null?void 0:e.nickname)??""},display:{primary:(e==null?void 0:e.name)??"",secondary:(t==null?void 0:t.preferredName)??"",third:(e==null?void 0:e.nickname)??""}},image:{portrait:{default:{url:(e==null?void 0:e.portraitImage)??""}},logo:{default:{url:(t==null?void 0:t.squareLogoImage)??""}}}});return{schemaVersion:"2",code:o[0]._id,data:{tournamentId:(l=o[0].tournament)==null?void 0:l._ref,name:{official:{primary:o[0].name??""},display:o[0].nameAlt?{primary:o[0].nameAlt}:null},players:[i(o[0].playerEast,o[0].playerEastTeam),i(o[0].playerSouth,o[0].playerSouthTeam),i(o[0].playerWest,o[0].playerWestTeam),i(o[0].playerNorth,o[0].playerNorthTeam)],rulesetRef:"hkleague-4p"},metadata:{createdAt:o[0]._createdAt,updatedAt:o[0]._updatedAt}}})};export{m as a,A as b};
