import{u as g,k as p,a as N,r as n,j as e,L as h}from"./index-D_zi-PEm.js";import{C as v}from"./useCurrentTournament-DDGfv-Su.js";import{u as w}from"./index-DAMtnkVo.js";import{u as y}from"./useObsRoom-Bs1khnqn.js";import{i as S,n as f}from"./util-CeAI_f06.js";function I(){return g({queryKey:["v2-tournaments"],queryFn:N,placeholderData:p})}var C=function(r,s,a){if(!S)return[s,f,f];var i=JSON.parse,l=n.useRef(function(c){try{var u=a?a.raw?String:a.serializer:JSON.stringify,o=localStorage.getItem(c);return o!==null?i(o):(s&&localStorage.setItem(c,u(s)),s)}catch{return s}}),x=n.useState(function(){return l.current(r)}),m=x[0],t=x[1];n.useLayoutEffect(function(){return t(l.current(r))},[r]);var d=n.useCallback(function(c){try{var u=typeof c=="function"?c(m):c;if(typeof u>"u")return;var o=void 0;a||(o=JSON.stringify(u)),localStorage.setItem(r,o),t(i(o))}catch{}},[r,t]),j=n.useCallback(function(){try{localStorage.removeItem(r),t(void 0)}catch{}},[r,t]);return[m,d,j]};function E(r){var s;return(s=document.getElementById(r))==null?void 0:s.showModal()}function L(r){var s;return(s=document.getElementById(r))==null?void 0:s.close()}function M(){var a;const{data:r}=y(),{rtMatch:s}=w(((a=r==null?void 0:r.activeMatch)==null?void 0:a.id)??(r==null?void 0:r.matchId));return s?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"border-2 border-error rounded text-center space-y-1 p-1",children:[e.jsx("div",{className:"text-error text-xs font-bold",children:"直播中"}),e.jsx("div",{children:s.name})]})}):e.jsx(e.Fragment,{})}function k({children:r}){var m;const{data:s=[]}=I(),[a,i]=C("v2-current-tournament-id",""),l=n.useMemo(()=>s==null?void 0:s.find(({id:t})=>t===a),[s,a]);n.useEffect(()=>{!a&&s[0]&&i(s[0].id)},[s,a,i]);const x=n.useCallback(t=>{const d=t.currentTarget.getAttribute("data-tournament-id");i(d),L("tournament-selector-dialog")},[i]);return e.jsxs(v.Provider,{value:a,children:[e.jsxs("div",{className:"drawer lg:drawer-open",children:[e.jsx("input",{id:"layout-drawer",type:"checkbox",className:"drawer-toggle"}),e.jsxs("div",{className:"drawer-content",children:[e.jsxs("div",{className:"navbar bg-base-100 w-full border-b-1 border-base-300",children:[e.jsx("div",{children:e.jsx("label",{htmlFor:"layout-drawer",className:"btn btn-ghost rounded-full text-lg drawer-button lg:hidden",children:e.jsx("i",{className:"bi bi-list"})})}),e.jsxs("div",{className:"mx-2 flex-1 px-2 flex gap-x-2 items-center",children:[e.jsxs("div",{className:"flex gap-x-2 items-center",children:[e.jsx("img",{src:(m=l==null?void 0:l.image.logo)==null?void 0:m.default.url,className:"w-8 h-8"}),e.jsx("span",{children:l==null?void 0:l.name})]}),e.jsx("div",{children:s.length>1&&e.jsx("button",{onClick:()=>E("tournament-selector-dialog"),className:"btn btn-xs btn-ghost text-primary",children:"切換"})})]})]}),e.jsx("main",{children:r})]}),e.jsx("div",{className:"drawer-side  border-r-1 bg-base-100 border-base-300",children:e.jsxs("div",{className:"w-60 p-2",children:[e.jsx("label",{htmlFor:"layout-drawer",className:"btn btn-ghost rounded-full text-lg drawer-button lg:hidden",children:e.jsx("i",{className:"bi bi-list"})}),e.jsx("div",{className:"p-4 w-full text-lg text-center",children:"日麻直播系統"}),e.jsx("h5",{className:"text-sm font-bold px-4",children:"聯賽控制"}),e.jsxs("ul",{className:"menu bg-base-100 text-base-content min-h-full p-4 w-full",children:[e.jsx("li",{children:e.jsx(h,{href:"/",children:"賽事"})}),e.jsx("li",{children:e.jsx("a",{children:"隊伍／選手"})}),e.jsx("li",{children:e.jsx("a",{children:"風格"})})]}),e.jsx("div",{className:"divider"}),e.jsx("h5",{className:"text-sm font-bold px-4",children:"OBS 控制"}),e.jsx("div",{className:"px-4 py-2",children:e.jsx(M,{})}),e.jsxs("ul",{className:"menu bg-base-100 text-base-content min-h-full p-4 w-full",children:[e.jsx("li",{children:e.jsx("a",{children:"如何設置 OBS"})}),e.jsx("li",{children:e.jsx(h,{href:"/obs/match-control",children:"分數控制台"})}),e.jsx("li",{children:e.jsx(h,{href:"/obs/scene-control",children:"多合一場景控制台"})})]}),e.jsx("div",{className:"divider"}),e.jsx("h5",{className:"text-sm font-bold px-4",children:"暫存資料庫"}),e.jsx("ul",{className:"menu bg-base-100 text-base-content min-h-full p-4 w-full",children:e.jsx("li",{children:e.jsx(h,{href:"/realtime/matches",children:"已結束賽事"})})})]})})]}),e.jsxs("dialog",{id:"tournament-selector-dialog",className:"modal",children:[e.jsxs("div",{className:"modal-box",children:[e.jsx("h3",{className:"font-bold text-lg",children:"切換聯賽"}),e.jsx("ul",{className:"menu w-full",children:s.map(t=>{var d;return e.jsx("li",{children:e.jsxs("a",{className:"flex gap-x-2",onClick:x,"data-tournament-id":t.id,children:[e.jsx("img",{src:(d=t.image.logo)==null?void 0:d.default.url,className:"w-8 h-8",alt:""}),e.jsx("span",{className:"flex-1",children:t.name})]})},t.id)})})]}),e.jsx("form",{method:"dialog",className:"modal-backdrop",children:e.jsx("button",{children:"close"})})]})]})}export{k as default};
