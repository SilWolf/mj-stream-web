import{r as h,j as a,M as J,g as jo,R as V,n as xe,p as ko,q as Ro,t as Io,v as Eo,w as wo,x as To,y as Oo}from"./index-BMGwXdKL.js";import{u as Po}from"./index-BHEvSQpW.js";import{a as Pr,b as Ar,c as $r,d as Br,e as ye,f as Fr,h as _r,i as Lr,j as Gr,k as Wr,l as Ur,m as Ao,n as Hr,o as Ln,P as $o,p as Q,q as Bo,R as Y,r as Gn,N as W,s as Fo,t as Wn,g as Un}from"./mahjong.helper-s_44wUGK.js";import{M as un}from"./index-BqeRljXq.js";import{M as ut}from"./index-C-lPdgka.js";import{M as zr,a as rt}from"./index-Dc1huFnl.js";import{u as Ie}from"./useToggle-CGqcuEMf.js";import{M as fe}from"./index-U3e3zUo8.js";import{u as dn,C as dt,b as vt,_ as Vr}from"./index.esm-DxQXHv9Q.js";import{i as _o}from"./tiny-invariant-BaFNuDhB.js";import{u as Lo}from"./useObsRoom-DHWZ63WN.js";const Go=[["1m","2m","3m","4m","5m","6m","7m","8m","9m","0m"],["1p","2p","3p","4p","5p","6p","7p","8p","9p","0p"],["1s","2s","3s","4s","5s","6s","7s","8s","9s","0s"],["1z","2z","3z","4z","5z","6z","7z"]],Hn={m:0,p:1,s:2,z:3},Wo=(e,t)=>{const[n,s]=[e[0],e[1]],[o,r]=[t[0],t[1]];return s!==r?Hn[s]-Hn[r]:parseInt(n,10)-parseInt(o,10)};function Uo({onSubmit:e,onRemove:t,canRemove:n,hideRedTiles:s,multiple:o,defaultValue:r}){const[l,c]=h.useState([]),i=h.useCallback(f=>{var m;const p=(m=f.currentTarget)==null?void 0:m.getAttribute("data-key");p&&c(o?g=>{const x=g.indexOf(p);if(x===-1)return[...g,p].sort(Wo);const y=[...g];return y.splice(x,1),y}:[p])},[o]),u=h.useCallback(()=>{l&&e&&(e==null||e(l),c([]))},[e,l]),d=h.useCallback(()=>{n&&(t==null||t(),c([]))},[n,t]);return h.useEffect(()=>{c(r??[])},[r]),a.jsxs("div",{children:[a.jsx("div",{className:`mb-4 grid ${s?"grid-cols-9":"grid-cols-10"} gap-1 lg:gap-x-2 lg:gap-y-4 items-center text-center`,children:Go.map(f=>f.map(p=>(!p.startsWith("0")||!s)&&a.jsx("button",{type:"button",onClick:i,"data-key":p,className:`${l.indexOf(p)!==-1?"bg-blue-400":"bg-black/20"} rounded p-1 lg:p-2`,children:a.jsx(un,{children:p})})))}),a.jsxs("div",{className:"flex gap-x-4",children:[n&&a.jsx("div",{className:"flex-1",children:a.jsx(J,{className:"w-full",type:"button",color:"secondary",onClick:d,children:"移除"})}),a.jsx("div",{className:"flex-1",children:a.jsx(J,{className:"w-full",type:"button",color:"primary",onClick:u,disabled:l.length===0,children:"確定"})})]})]})}const Ho=[["1m","2m","3m","4m","5m","6m","7m","8m","9m","0m"],["1p","2p","3p","4p","5p","6p","7p","8p","9p","0p"],["1s","2s","3s","4s","5s","6s","7s","8s","9s","0s"],["1z","2z","3z","4z","5z","6z","7z"]];function pn({onClick:e,hideJiHai:t}){const n=h.useCallback(s=>{var r;const o=(r=s.currentTarget)==null?void 0:r.getAttribute("data-key");e==null||e(o)},[e]);return a.jsx("div",{children:a.jsx("div",{className:"grid grid-cols-10 gap-x-2 items-center w-[12em] h-[6em] **:data-button:cursor-pointer",children:Ho.map(s=>s.map(o=>{if(!(t&&o[1]==="z"))return a.jsx("button",{type:"button",onClick:n,"data-key":o,"data-button":!0,children:a.jsx(zr,{value:o})},o)}))})})}const zo=e=>["5m","0m","5p","0p","5s","0s"].indexOf(e)===-1?[`${e}-${e}${e}`,`${e}${e}-${e}`,`${e}${e}${e}-`]:e[0]==="0"?[`${e}-5${e[1]}5${e[1]}`,`5${e[1]}${e}-5${e[1]}`,`5${e[1]}5${e[1]}${e}-`]:[`${e}-${e}${e}`,`${e}${e}-${e}`,`${e}${e}${e}-`,`${e}-5${e[1]}0${e[1]}`,`5${e[1]}${e}-0${e[1]}`,`5${e[1]}0${e[1]}${e}-`];function Vo({onClick:e}){const[t,n]=h.useState(null),s=h.useMemo(()=>t?zo(t):null,[t]),o=h.useCallback(r=>{const l=r.currentTarget.getAttribute("data-value");e==null||e(l),n(null)},[e]);return s?a.jsxs("div",{className:"**:data-button:flex **:data-button:justify-center **:data-button:p-1 **:data-button:cursor-pointer **:data-button:hover:bg-base-200",children:[a.jsx("div",{className:"w-[12em] h-[4em] grid grid-cols-3 items-start",children:s.map(r=>a.jsx("button",{onClick:o,"data-value":r,"data-button":!0,children:a.jsx(rt,{value:r})},r))}),a.jsx("div",{children:a.jsx("button",{className:"w-full text-[16px]","data-button":!0,onClick:()=>n(null),children:a.jsx("i",{className:"bi bi-x-circle-fill"})})})]}):a.jsx(pn,{onClick:n})}const Mo=e=>["5m","0m","5p","0p","5s","0s"].indexOf(e)===-1?[`${e}-${e}${e}${e}`,`${e}${e}${e}-${e}`,`${e}${e}${e}${e}-`,`0z${e}${e}0z`]:e[0]==="0"?[`${e}-5${e[1]}5${e[1]}5${e[1]}`,`5${e[1]}5${e[1]}${e}-5${e[1]}`,`5${e[1]}5${e[1]}5${e[1]}${e}-`,`0z5${e[1]}${e}0z`]:[`${e}-5${e[1]}5${e[1]}0${e[1]}`,`5${e[1]}5${e[1]}${e}-0${e[1]}`,`5${e[1]}5${e[1]}0${e[1]}${e}-`,`0z${e}5${e[1]}0z`];function qo({onClick:e}){const[t,n]=h.useState(null),s=h.useMemo(()=>t?Mo(t):null,[t]),o=h.useCallback(r=>{const l=r.currentTarget.getAttribute("data-value");e==null||e(l),n(null)},[e]);return s?a.jsxs("div",{className:"**:data-button:flex **:data-button:justify-center **:data-button:p-1 **:data-button:cursor-pointer **:data-button:hover:bg-base-200",children:[a.jsx("div",{className:"w-[15em] h-[4em] grid grid-cols-3 items-start",children:s.map(r=>a.jsx("button",{onClick:o,"data-value":r,"data-button":!0,children:a.jsx(rt,{value:r})},r))}),a.jsx("div",{children:a.jsx("button",{className:"w-full text-[16px]","data-button":!0,onClick:()=>n(null),children:a.jsx("i",{className:"bi bi-x-circle-fill"})})})]}):a.jsx(pn,{onClick:n})}const Yo=e=>{const t=parseInt(e[0]),n=e[1];if(t===0)return[`${e}-3${n}4${n}`,`${e}-4${n}6${n}`,`${e}-6${n}7${n}`];const s=[];t-2>=1&&t-1<=9&&s.push(`${t-2}${n}${t-1}${n}`),t-1>=1&&t+1<=9&&s.push(`${t-1}${n}${t+1}${n}`),t+1>=1&&t+2<=9&&s.push(`${t+1}${n}${t+2}${n}`);for(const o of s)o.indexOf("5")!==-1&&s.push(o.replace("5","0"));return s.map(o=>`${e}-${o}`)};function Jo({onClick:e}){const[t,n]=h.useState(null),s=h.useMemo(()=>t?Yo(t):null,[t]),o=h.useCallback(r=>{const l=r.currentTarget.getAttribute("data-value");e==null||e(l),n(null)},[e]);return s?a.jsxs("div",{className:"**:data-button:flex **:data-button:justify-center **:data-button:p-1 **:data-button:cursor-pointer **:data-button:hover:bg-base-200",children:[a.jsx("div",{className:"w-[12em] h-[4em] grid grid-cols-3 items-start",children:s.map(r=>a.jsx("button",{onClick:o,"data-value":r,"data-button":!0,children:a.jsx(rt,{value:r})},r))}),a.jsx("div",{children:a.jsx("button",{className:"w-full text-[16px]","data-button":!0,onClick:()=>n(null),children:a.jsx("i",{className:"bi bi-x-circle-fill"})})})]}):a.jsx(pn,{onClick:n,hideJiHai:!0})}function Ko({value:e,onClickReplace:t,onClickDelete:n}){const s=h.useMemo(()=>{const l=[...e.matchAll(/(\d)([mpsz])/g)];return l.length!==3||!(l[0][2]===l[1][2]&&l[0][2]===l[2][2])?null:l[0][1]===l[1][1]&&l[0][1]===l[2][1]?l[0][1]==="5"?e.replace("-",`-0${l[0][2]}=`):e.replace("-",`-${l[0][0]}=`):(l[0][1]==="0"||l[0][1]==="5")&&(l[1][1]==="0"||l[1][1]==="5")&&(l[2][1]==="0"||l[2][1]==="5")?e.replace("-",`-5${l[0][2]}=`):null},[e]),o=h.useCallback(()=>{s&&(t==null||t(e,s))},[s,t,e]),r=h.useCallback(()=>{n==null||n(e)},[n,e]);return a.jsx("div",{className:"**:data-button:flex **:data-button:justify-center **:data-button:p-1 **:data-button:cursor-pointer **:data-button:hover:bg-base-200",children:a.jsxs("div",{className:"w-[12em] flex items-start",children:[s&&a.jsx("button",{className:"flex-1 pt-[.8em]!",onClick:o,"data-button":!0,children:a.jsx(rt,{value:s})}),a.jsx("button",{className:"flex-1",onClick:r,"data-button":!0,children:a.jsx("i",{className:"bi bi-trash-fill text-error"})})]})})}const Xo=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14];function _t({value:e,onClick:t}){const n=h.useMemo(()=>`${jo()}-number-select`,[]),s=h.useCallback(()=>{var c;t==null||t(null),(c=document.getElementById(n))==null||c.hidePopover()},[t,n]),o=h.useCallback(c=>{var u;const i=parseInt(c.currentTarget.getAttribute("data-value"));t==null||t(i),(u=document.getElementById(n))==null||u.hidePopover()},[t,n]),r=h.useCallback(()=>{t==null||t(Math.max(0,(e??0)-1))},[t,e]),l=h.useCallback(()=>{t==null||t(Math.min(99,(e??0)+1))},[t,e]);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex gap-x-1",children:[a.jsx("button",{className:"cursor-pointer px-2 h-10 w-[1.5em] bg-neutral-200 border rounded-l-sm border-neutral-700 text-xl",onClick:r,children:"-"}),a.jsx("button",{className:"cursor-pointer px-2 h-10 w-[2.2em] bg-neutral-200 border border-neutral-700 text-xl",popoverTarget:n,style:{anchorName:`--${n}`},children:e??"?"}),a.jsx("button",{className:"cursor-pointer px-2 h-10 w-[1.5em] bg-neutral-200 border rounded-r-sm border-neutral-700 text-xl",onClick:l,children:"+"})]}),a.jsx("div",{className:"dropdown dropdown-center dropdown-top rounded-box bg-base-100 shadow-sm",popover:"auto",id:n,style:{positionAnchor:`--${n}`},children:a.jsx("div",{className:"card border border-base-300 shadow mb-1",children:a.jsx("div",{className:"card-content p-2",children:a.jsxs("div",{className:"w-[4em] h-[4em] grid grid-cols-4 **:data-button:cursor-pointer **:data-button:text-[0.5em] **:data-button:h-[2em] **:data-button:w-[2em] **:data-button:leading-[2em] **:data-[active=true]:bg-primary **:data-[active=true]:text-primary-content",children:[a.jsx("button",{className:"text-error",onClick:s,"data-button":!0,children:a.jsx("i",{className:"bi bi-trash"})}),Xo.map(c=>a.jsx("button",{"data-value":c,onClick:o,"data-button":!0,"data-active":e===c,children:c},c))]})})})})]})}const Zo=({players:e,currentRound:t,onAction:n})=>{const s=h.useCallback(d=>{const f=d.currentTarget.getAttribute("data-player-index"),p=d.currentTarget.getAttribute("data-action");n(f,p)},[n]),o=h.useCallback(d=>f=>{n(d,"push-reveal",f),document.getElementById(`player${d}-popover-pon-keyboard`).hidePopover(),document.getElementById(`player${d}-popover-chi-keyboard`).hidePopover(),document.getElementById(`player${d}-popover-kanng-keyboard`).hidePopover()},[n]),r=h.useCallback((d,f)=>(p,m)=>{var g;n(d,"replace-reveal",[p,m]),(g=document.getElementById(`player${d}-reveal-${f}-popover-edit-keyboard`))==null||g.hidePopover()},[n]),l=h.useCallback((d,f)=>p=>{var m;n(d,"delete-reveal",p),(m=document.getElementById(`player${d}-reveal-${f}-popover-edit-keyboard`))==null||m.hidePopover()},[n]),c=h.useCallback(d=>f=>{n(d,"waiting-tile-remain",f)},[n]),i=h.useCallback(d=>f=>{n(d,"dora",f)},[n]),u=h.useCallback(d=>f=>{n(d,"red-dora",f)},[n]);return a.jsx("div",{className:"space-y-2",children:["0","1","2","3"].map(d=>{var f,p,m;return a.jsxs("div",{className:"flex gap-2 py-8 border-t border-t-base-300",children:[a.jsxs("div",{className:"shrink-0 flex flex-col gap-1",children:[a.jsx("button",{className:"text-gray-900 text-xs px-1 rounded-sm",style:{backgroundColor:"#ffe100",width:"2rem",height:"2.5rem",top:"0rem",left:"-2.5rem",opacity:t.playerResults[d].isYellowCarded?1:.35},"data-player-index":d,"data-action":"yellow-card",onClick:s,children:"黃牌"}),a.jsx("button",{className:"text-gray-900 text-xs px-1 rounded-sm",style:{backgroundColor:"#ff1900",width:"2rem",height:"2.5rem",top:"2.7rem",left:"-2.5rem",opacity:t.playerResults[d].isRedCarded?1:.35},"data-player-index":d,"data-action":"red-card",onClick:s,children:"紅牌"}),a.jsxs("button",{className:"text-gray-900 text-xs px-1 rounded-sm",style:{border:"1px solid #333",borderColor:t.playerResults[d].isRonDisallowed?"#f00":"#333",color:t.playerResults[d].isRonDisallowed?"#fff":"#000",background:t.playerResults[d].isRonDisallowed?"#f00":"transparent",width:"2rem",height:"2.5rem",top:"2.7rem",left:"-2.5rem",opacity:t.playerResults[d].isRonDisallowed?1:.35},"data-player-index":d,"data-action":"disallow-ron",onClick:s,children:[a.jsx("div",{className:"whitespace-nowrap",children:"和了"}),a.jsx("div",{className:"whitespace-nowrap",children:"禁止"})]})]}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex flex-wrap gap-x-2 items-center",children:[a.jsx("span",{className:"w-32 overflow-hidden",children:e[d].primaryName}),a.jsx("button",{className:"cursor-pointer px-4 h-10 bg-neutral-200 border border-neutral-700 text-xl disabled:opacity-20 disabled:cursor-not-allowed data-[active=true]:bg-red-800 data-[active=true]:text-yellow-300","data-player-index":d,"data-action":"riichi",onClick:s,"data-active":!!t.playerResults[d].isRiichi,disabled:t.playerResults[d].isRevealed,children:"立直"}),a.jsxs("div",{className:"space-x-1 ml-2",children:[!t.playerResults[d].isRiichi&&a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"cursor-pointer px-2 h-10 bg-neutral-200 border rounded-sm border-neutral-700 text-xl",popoverTarget:`player${d}-popover-pon-keyboard`,style:{anchorName:`--player${d}-anchor-pon-keyboard`},children:"碰"}),a.jsx("div",{className:"dropdown dropdown-center dropdown-top rounded-box bg-base-100 shadow-sm",popover:"auto",id:`player${d}-popover-pon-keyboard`,style:{positionAnchor:`--player${d}-anchor-pon-keyboard`},children:a.jsx("div",{className:"card border border-base-300 shadow mb-1",children:a.jsx("div",{className:"card-content p-2 text-[32px]",children:a.jsx(Vo,{onClick:o(d)})})})}),a.jsx("button",{className:"cursor-pointer px-2 h-10 bg-neutral-200 border rounded-sm border-neutral-700 text-xl",popoverTarget:`player${d}-popover-chi-keyboard`,style:{anchorName:`--player${d}-anchor-chi-keyboard`},children:"吃"}),a.jsx("div",{className:"dropdown dropdown-center dropdown-top rounded-box bg-base-100 shadow-sm",popover:"auto",id:`player${d}-popover-chi-keyboard`,style:{positionAnchor:`--player${d}-anchor-chi-keyboard`},children:a.jsx("div",{className:"card border border-base-300 shadow mb-1",children:a.jsx("div",{className:"card-content p-2 text-[32px]",children:a.jsx(Jo,{onClick:o(d)})})})})]}),a.jsx("button",{className:"cursor-pointer px-2 h-10 bg-neutral-200 border rounded-sm border-neutral-700 text-xl",popoverTarget:`player${d}-popover-kanng-keyboard`,style:{anchorName:`--player${d}-anchor-kanng-keyboard`},children:"槓"}),a.jsx("div",{className:"dropdown dropdown-center dropdown-top rounded-box bg-base-100 shadow-sm",popover:"auto",id:`player${d}-popover-kanng-keyboard`,style:{positionAnchor:`--player${d}-anchor-kanng-keyboard`},children:a.jsx("div",{className:"card border border-base-300 shadow mb-1",children:a.jsx("div",{className:"card-content p-2 text-[32px]",children:a.jsx(qo,{onClick:o(d)})})})})]}),a.jsx("div",{className:"flex flex-wrap gap-x-1 text-[24px] **:data-button:cursor-pointer **:data-button:p-1 **:data-button:hover:bg-base-200",children:(f=t.playerResults[d].reveals)==null?void 0:f.map((g,x)=>a.jsxs(V.Fragment,{children:[a.jsx("button",{"data-button":!0,popoverTarget:`player${d}-reveal-${x}-popover-edit-keyboard`,style:{anchorName:`--player${d}-reveal-${x}-anchor-edit-keyboard`},children:a.jsx(rt,{value:g})}),a.jsx("div",{className:"dropdown dropdown-center dropdown-top rounded-box bg-base-100 shadow-sm",popover:"auto",id:`player${d}-reveal-${x}-popover-edit-keyboard`,style:{positionAnchor:`--player${d}-reveal-${x}-anchor-edit-keyboard`},children:a.jsx("div",{className:"card border border-base-300 shadow mb-1",children:a.jsx("div",{className:"card-content p-2 text-[32px]",children:a.jsx(Ko,{value:g,onClickReplace:r(d,x),onClickDelete:l(d,x)})})})})]},x))})]}),a.jsxs("div",{className:"flex items-stretch mt-1",children:[a.jsx("div",{className:"flex items-center justify-center px-2 text-white text-4xl w-32",style:{background:e[d].color},children:t.playerResults[d].afterScore}),a.jsxs("div",{className:"flex-1 flex flex-col justify-around gap-1",children:[a.jsxs("div",{className:"flex items-center gap-x-2",children:[a.jsxs("button",{className:"flex h-12 items-center gap-x-2 bg-base-100 data-[is-furiten=true]:data-[is-waiting]:bg-red-500/50 data-[is-waiting]:bg-green-500/50 px-2 min-w-[200px] cursor-pointer","data-player-index":d,"data-action":"waitingTile","data-is-waiting":t.playerResults[d].waitingTiles&&t.playerResults[d].waitingTiles.length>0,"data-is-furiten":t.playerResults[d].isFuriten,onClick:s,children:[t.playerResults[d].isFuriten?a.jsxs("div",{className:"text-red-700",children:[a.jsx("i",{className:"bi bi-exclamation-diamond"})," 振聽"]}):a.jsx("div",{children:"待牌"}),a.jsx("div",{className:"flex gap-1 text-[28px]",children:(p=t.playerResults[d].waitingTiles)==null?void 0:p.map(g=>a.jsx(zr,{value:g},g))})]}),t.playerResults[d].waitingTiles&&t.playerResults[d].waitingTiles.length>0&&a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"inline-flex items-stretch gap-x-2 border-1 border-primary pr-1",children:[a.jsx("span",{className:"content-center bg-primary text-primary-content px-2",children:"山餘"}),a.jsx("span",{className:"text-[40px]",children:a.jsx(_t,{value:t.playerResults[d].waitingTileRemain,onClick:c(d)})})]})})]}),a.jsxs("div",{className:"flex items-center gap-x-2",children:[a.jsxs("button",{className:"flex-1 flex h-12 items-center gap-x-2cursor-pointer bg-base-100 hover:bg-base-200 px-2 cursor-pointer","data-player-index":d,"data-action":"yaku",onClick:s,children:[a.jsx("div",{children:"役"}),(m=t.playerResults[d].detail.yakus)==null?void 0:m.map(({label:g})=>a.jsx("span",{children:g},g))]}),a.jsx("div",{className:"flex gap-x-1",children:a.jsxs("div",{className:"inline-flex items-stretch gap-x-2 border-4 border-yellow-300 bg-yellow-300 pr-1",children:[a.jsx("span",{className:"content-center px-2",children:"寶牌"}),a.jsx("span",{className:"text-[40px]",children:a.jsx(_t,{value:t.playerResults[d].detail.dora,onClick:i(d)})})]})}),a.jsx("div",{className:"flex gap-x-1",children:a.jsxs("div",{className:"inline-flex items-stretch gap-x-2 border-4 border-red-300 bg-red-300 pr-1",children:[a.jsx("span",{className:"content-center px-2",children:"赤牌"}),a.jsx("span",{className:"text-[40px]",children:a.jsx(_t,{value:t.playerResults[d].detail.redDora,onClick:u(d)})})]})})]})]}),a.jsxs("div",{className:"flex items-center gap-x-1 relative ml-4",children:[a.jsx("div",{className:"flex flex-col gap-1",children:a.jsx("button",{className:"px-1 h-10 w-16 bg-neutral-200 border rounded-sm border-neutral-700 text-xl","data-player-index":d,"data-action":"ron-self",onClick:s,children:"自摸"})}),a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("button",{className:"px-1 h-10 bg-neutral-200 border rounded-sm border-neutral-700 text-xl","data-player-index":d,"data-action":"ron-before",onClick:s,children:["和",e[Pr(d)].nickname||"上家"]}),a.jsxs("button",{className:"px-1 h-10 bg-neutral-200 border rounded-sm border-neutral-700 text-xl","data-player-index":d,"data-action":"ron-after",onClick:s,children:["和",e[Ar(d)].nickname||"下家"]})]}),a.jsx("div",{className:"flex flex-col gap-1",children:a.jsxs("button",{className:"px-1 h-10 bg-neutral-200 border rounded-sm border-neutral-700 text-xl","data-player-index":d,"data-action":"ron-opposite",onClick:s,children:["和",e[$r(d)].nickname||"對家"]})}),t.playerResults[d].isRonDisallowed&&a.jsxs("div",{className:"absolute inset-0 bg-red-500 text-white text-lg opacity-90 flex items-center justify-center",children:[a.jsx("i",{className:"bi bi-ban"})," 和了禁止"]})]})]})]})]})})})};function Mr({onChange:e,onChangeChecked:t,className:n,...s}){const o=h.useCallback(r=>{e==null||e(r),t==null||t(r.currentTarget.checked)},[e,t]);return a.jsx("input",{className:"mt-[0.3rem] mr-2 h-3.5 w-8 appearance-none rounded-[0.4375rem] bg-neutral-300 dark:bg-neutral-600 before:pointer-events-none before:absolute before:h-3.5 before:w-3.5 before:rounded-full before:bg-transparent before:content-[''] after:absolute after:z-2 after:-mt-[0.1875rem] after:h-5 after:w-5 after:rounded-full after:border-none after:bg-neutral-100 dark:after:bg-neutral-400 after:shadow-[0_0px_3px_0_rgb(0_0_0_/_7%),_0_2px_2px_0_rgb(0_0_0_/_4%)] after:transition-[background-color_0.2s,transform_0.2s] after:content-[''] checked:bg-blue-600 dark:checked:bg-blue-600 checked:after:absolute checked:after:z-2 checked:after:-mt-[3px] checked:after:ml-[1.0625rem] checked:after:h-5 checked:after:w-5 checked:after:rounded-full checked:after:border-none checked:after:bg-blue-600 dark:checked:after:bg-blue-600 checked:after:shadow-[0_3px_1px_-2px_rgba(0,0,0,0.2),_0_2px_2px_0_rgba(0,0,0,0.14),_0_1px_5px_0_rgba(0,0,0,0.12)] checked:after:transition-[background-color_0.2s,transform_0.2s] checked:after:content-[''] hover:cursor-pointer focus:before:scale-100 focus:before:opacity-[0.12] focus:before:shadow-[3px_-1px_0px_13px_rgba(0,0,0,0.6)] focus:before:transition-[box-shadow_0.2s,transform_0.2s] focus:after:absolute focus:after:z-1 focus:after:block focus:after:h-5 focus:after:w-5 focus:after:rounded-full focus:after:content-[''] checked:focus:border-blue-600 checked:focus:bg-blue-600 checked:focus:before:ml-[1.0625rem] checked:focus:before:scale-100 checked:focus:before:shadow-[3px_-1px_0px_13px_#3b71ca] checked:focus:before:transition-[box-shadow_0.2s,transform_0.2s]",type:"checkbox",role:"switch",id:"flexSwitchCheckDefault",onChange:o,...s})}function en({han:e,fu:t,yakumanCount:n,yakumanCountMax:s=10,raw:o,isManganRoundUp:r,...l}){const c=h.useMemo(()=>{if(n&&n>0){const i=Math.min(s,n);return i===1?"役滿":i===2?"兩倍役滿":i===3?"三倍役滿":i===4?"四倍役滿":`${i}倍役滿`}return o?typeof t<"u"&&e<=4?`${e}飜${t}符`:`${e}飜`:e>=11?"三倍滿":e>=8?"倍滿":e>=6?"跳滿":e>=5||e>=4&&typeof t<"u"&&(t>=40||r&&t>=30)||e>=3&&typeof t<"u"&&(t>=70||r&&t>=60)?"滿貫":typeof t<"u"?`${e}飜${t}符`:`${e}飜`},[n,o,e,t,r,s]);return a.jsx("div",{...l,children:c})}const pt=({options:e,value:t,onChange:n,disabled:s})=>{const[o,r]=h.useState(0),l=h.useMemo(()=>e[o],[o,e]),c=h.useCallback(()=>{const u=Math.max(0,o-1);r(u),n==null||n(e[u].value)},[o,n,e]),i=h.useCallback(()=>{const u=Math.min(e.length-1,o+1);r(u),n==null||n(e[u].value)},[o,n,e]);return h.useEffect(()=>{if(typeof t<"u"&&t!==l.value){const u=e.findIndex(d=>d.value===t);u!==-1&&r(u)}},[l.value,e,t]),a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"shrink-0",children:a.jsx("button",{className:"w-4 h-4 text-center text-xs disabled:text-transparent",onClick:c,disabled:s||o===0,children:a.jsx("i",{className:"bi bi-dash-circle"})})}),a.jsx("div",{className:"flex-1 text-center text-2xl",children:l.label}),a.jsx("div",{className:"shrink-0",children:a.jsx("button",{className:"w-4 h-4 text-center text-xs disabled:text-transparent",onClick:i,disabled:s||o===e.length-1,children:a.jsx("i",{className:"bi bi-plus-circle"})})})]})},Pe=[{id:"riichi",label:"立直",han:1,hanIfOpened:0,disableFn:({isRevealed:e,raw:t})=>!!e||t["double-riichi"],group:"riichi"},{id:"double-riichi",label:"雙立直",han:2,hanIfOpened:0,disableFn:({isRevealed:e,raw:t})=>!!e||t.riichi,group:"riichi"},{id:"ippatsu",label:"一發",han:1,hanIfOpened:0,disableFn:({raw:e})=>!(e.riichi||e["double-riichi"])||!!e.chankan,group:"riichi"},{id:"menzenchin-tsumohou",label:"門前清自摸和",han:1,hanIfOpened:0,hidden:!0,group:"menzenchin-tsumohou"},{id:"tanyao",label:"斷么九",han:1,hanIfOpened:1,disableFn:({raw:e})=>!!e.chantaiyao||!!e["junchan-taiyao"]||!!e["yakuhai-east"]||!!e["yakuhai-south"]||!!e["yakuhai-west"]||!!e["yakuhai-north"]||!!e["yakuhai-haku"]||!!e["yakuhai-hatsu"]||!!e["yakuhai-chun"]||!!e.honroutou||!!e.honitsu||!!e.ittsu,group:"common"},{id:"pinfu",label:"平和",han:1,hanIfOpened:0,disableFn:({isRevealed:e,raw:t})=>!!e||!!t.chiitoitsu||!!t["yakuhai-east"]||!!t["yakuhai-south"]||!!t["yakuhai-west"]||!!t["yakuhai-north"]||!!t["yakuhai-haku"]||!!t["yakuhai-hatsu"]||!!t["yakuhai-chun"]||!!t.toitoi,group:"common"},{id:"yakuhai-east",label:"東",han:1,hanIfOpened:1,disableFn:({round:e,activePlayerIndex:t,raw:n})=>!ye(t,e)&&!Br(e)||!!n.tanyao||!!n.pinfu||!!n.chiitoitsu||!!n.chinitsu||!!n["junchan-taiyao"]||!!n.ryanpeikou,group:"yakuhai"},{id:"yakuhai-double-east",label:"雙東",han:2,hanIfOpened:2,hidden:!0,group:"yakuhai-special"},{id:"yakuhai-south",label:"南",han:1,hanIfOpened:1,disableFn:({round:e,activePlayerIndex:t,raw:n})=>!_r(t,e)&&!Fr(e)||!!n.tanyao||!!n.pinfu||!!n.chiitoitsu||!!n.chinitsu||!!n["junchan-taiyao"]||!!n.ryanpeikou,group:"yakuhai"},{id:"yakuhai-double-south",label:"雙南",han:2,hanIfOpened:2,hidden:!0,group:"yakuhai-special"},{id:"yakuhai-west",label:"西",han:1,hanIfOpened:1,disableFn:({round:e,activePlayerIndex:t,raw:n})=>!Gr(t,e)&&!Lr(e)||!!n.tanyao||!!n.pinfu||!!n.chiitoitsu||!!n.chinitsu||!!n["junchan-taiyao"]||!!n.ryanpeikou,group:"yakuhai"},{id:"yakuhai-double-west",label:"雙西",han:2,hanIfOpened:2,hidden:!0,group:"yakuhai-special"},{id:"yakuhai-north",label:"北",han:1,hanIfOpened:1,disableFn:({round:e,activePlayerIndex:t,raw:n})=>!Ur(t,e)&&!Wr(e)||!!n.tanyao||!!n.pinfu||!!n.chiitoitsu||!!n.chinitsu||!!n["junchan-taiyao"]||!!n.ryanpeikou,group:"yakuhai"},{id:"yakuhai-double-north",label:"雙北",han:2,hanIfOpened:2,hidden:!0,group:"yakuhai-special"},{id:"yakuhai-haku",label:"白",han:1,hanIfOpened:1,group:"yakuhai",disableFn:({raw:e})=>!!e.tanyao||!!e.pinfu||!!e.chiitoitsu||!!e.chinitsu||!!e["junchan-taiyao"]||!!e.ryanpeikou},{id:"yakuhai-hatsu",label:"發",han:1,hanIfOpened:1,group:"yakuhai",disableFn:({raw:e})=>!!e.tanyao||!!e.pinfu||!!e.chiitoitsu||!!e.chinitsu||!!e["junchan-taiyao"]||!!e.ryanpeikou},{id:"yakuhai-chun",label:"中",han:1,hanIfOpened:1,group:"yakuhai",disableFn:({raw:e})=>!!e.tanyao||!!e.pinfu||!!e.chiitoitsu||!!e.chinitsu||!!e["junchan-taiyao"]||!!e.ryanpeikou},{id:"shousangen",label:"小三元",han:2,hanIfOpened:2,disableFn:({raw:e})=>[e["yakuhai-haku"],e["yakuhai-hatsu"],e["yakuhai-chun"]].filter(t=>!!t).length!==2,group:"yakuhai"},{id:"haitei-raoyue",label:"海底撈月",han:1,hanIfOpened:1,disableFn:({targetPlayerIndex:e,raw:t})=>e!=="-1"||!!t["rinshan-kaihou"],hiddenIfDisabled:!0,group:"luck"},{id:"houtei-raoyui",label:"河底撈魚",han:1,hanIfOpened:1,disableFn:({targetPlayerIndex:e})=>e==="-1",hiddenIfDisabled:!0,group:"luck"},{id:"rinshan-kaihou",label:"嶺上開花",han:1,hanIfOpened:1,disableFn:({targetPlayerIndex:e,raw:t})=>e!=="-1"||!!t.pinfu||!!t.chiitoitsu||!!t.ryanpeikou||!!t["haitei-raoyue"],hiddenIfDisabled:!0,group:"luck"},{id:"chankan",label:"搶槓",han:1,hanIfOpened:1,disableFn:({targetPlayerIndex:e})=>e==="-1",hiddenIfDisabled:!0,group:"luck"},{id:"chiitoitsu",label:"七對子",han:2,hanIfOpened:0,overrideFu:25,disableFn:({isRevealed:e,raw:t})=>!!e||!!t.iipeikou||!!t.ryanpeikou||!!t.pinfu||!!t["sanshku-doujun"]||!!t.ittsu||!!t.chantaiyao||!!t["junchan-taiyao"]||!!t.toitoi||!!t["sanshku-doukou"]||!!t.sanankou||!!t.sankantsu||!!t["rinshan-kaihou"],group:"peikou"},{id:"iipeikou",label:"一盃口",han:1,hanIfOpened:0,disableFn:({isRevealed:e,raw:t})=>!!e||!!t.ryanpeikou||!!t.chiitoitsu||!!t.honroutou||!!t.toitoi||!!t["sanshku-doukou"]||!!t.sanankou||!!t.sankantsu,group:"peikou"},{id:"ryanpeikou",label:"二盃口",han:3,hanIfOpened:0,disableFn:({isRevealed:e,raw:t})=>!!e||!!t.iipeikou||!!t.chiitoitsu||!!t["rinshan-kaihou"]||!!t["sanshku-doujun"]||!!t.ittsu||!!t.honroutou||!!t.toitoi||!!t["sanshku-doukou"]||!!t.sanankou||!!t.sankantsu||!!t["yakuhai-east"]||!!t["yakuhai-south"]||!!t["yakuhai-west"]||!!t["yakuhai-north"]||!!t["yakuhai-haku"]||!!t["yakuhai-hatsu"]||!!t["yakuhai-chun"],group:"peikou"},{id:"sanshku-doujun",label:"三色同順",han:2,hanIfOpened:1,disableFn:({raw:e})=>!!e["sanshku-doukou"]||!!e.sanankou||!!e.chiitoitsu||!!e.ittsu||!!e.sankantsu||!!e.ryanpeikou||!!e.honroutou||!!e.chinitsu||!!e.honitsu||!!e.toitoi,group:"row"},{id:"ittsu",label:"一氣通貫",han:2,hanIfOpened:1,disableFn:({raw:e})=>!!e["sanshku-doukou"]||!!e.sanankou||!!e.chiitoitsu||!!e.tanyao||!!e["sanshku-doujun"]||!!e.sankantsu||!!e.ryanpeikou||!!e.honroutou||!!e.chantaiyao||!!e["junchan-taiyao"]||!!e.toitoi,group:"row"},{id:"honitsu",label:"混一色",han:3,hanIfOpened:2,disableFn:({raw:e})=>!!e.chinitsu||!!e.tanyao||!!e["junchan-taiyao"]||!!e["sanshku-doujun"]||!!e["sanshku-doukou"],group:"itsu"},{id:"chinitsu",label:"清一色",han:6,hanIfOpened:5,disableFn:({raw:e})=>!!e.honitsu||!!e.honroutou||!!e.chantaiyao||!!e["sanshku-doukou"],group:"itsu"},{id:"chantaiyao",label:"混全帶么九",han:2,hanIfOpened:1,disableFn:({raw:e})=>!!e.tanyao||!!e["junchan-taiyao"]||!!e.honroutou||!!e.chiitoitsu||!!e.chinitsu||!!e.ittsu||!!e.toitoi,group:"taiyao"},{id:"junchan-taiyao",label:"純全帶么九",han:3,hanIfOpened:2,disableFn:({raw:e})=>!!e.tanyao||!!e.chantaiyao||!!e.honroutou||!!e.chiitoitsu||!!e.ittsu||!!e.honitsu||!!e.toitoi,group:"taiyao"},{id:"honroutou",label:"混老頭",han:2,hanIfOpened:2,disableFn:({raw:e})=>!!e.tanyao||!!e.chantaiyao||!!e["junchan-taiyao"]||!!e.chinitsu||!!e.iipeikou||!!e.ryanpeikou,group:"taiyao"},{id:"toitoi",label:"對對和",han:2,hanIfOpened:2,disableFn:({raw:e})=>!!e["sanshku-doujun"]||!!e.chiitoitsu||!!e.chantaiyao||!!e["junchan-taiyao"]||!!e.ittsu||!!e.iipeikou||!!e.ryanpeikou,group:"column"},{id:"sanshku-doukou",label:"三色同刻",han:2,hanIfOpened:2,disableFn:({raw:e})=>!!e["sanshku-doujun"]||!!e.chiitoitsu||!!e.ittsu||!!e.chinitsu||!!e.iipeikou||!!e.ryanpeikou||!!e.honitsu,group:"column"},{id:"sanankou",label:"三暗刻",han:2,hanIfOpened:2,disableFn:({raw:e})=>!!e["sanshku-doujun"]||!!e.chiitoitsu||!!e.ittsu||!!e.iipeikou||!!e.ryanpeikou,group:"column"},{id:"sankantsu",label:"三槓子",han:2,hanIfOpened:2,disableFn:({raw:e})=>!!e["sanshku-doujun"]||!!e.chiitoitsu||!!e.ittsu||!!e.iipeikou||!!e.ryanpeikou,group:"column"},{id:"kokushi-musou",label:"國士無雙",han:13,hanIfOpened:0,yakumanCount:1,disableFn:({raw:e,isRevealed:t})=>!!t||!!e.suuankou||!!e["suuankou-dannki"]||!!e.daisangen||!!e.shousuushii||!!e.daisuushii||!!e.tsuuiisou||!!e.chinroutou||!!e.suukantsu||!!e.ryuuiisou||!!e["chuuren-poutou"]||!!e["pure-chuuren-poutou"]||!!e["kokushi-musou-jsuan-men"],group:"kokushi-musou"},{id:"kokushi-musou-jsuan-men",label:"國士無雙十三面",han:13,hanIfOpened:0,yakumanCount:1,disableFn:({raw:e,isRevealed:t})=>!!t||!!e.suuankou||!!e["suuankou-dannki"]||!!e.daisangen||!!e.shousuushii||!!e.daisuushii||!!e.tsuuiisou||!!e.chinroutou||!!e.suukantsu||!!e.ryuuiisou||!!e["chuuren-poutou"]||!!e["pure-chuuren-poutou"]||!!e["kokushi-musou"],group:"kokushi-musou"},{id:"daisangen",label:"大三元",han:13,hanIfOpened:13,yakumanCount:1,disableFn:({raw:e})=>!!e["kokushi-musou"]||!!e.shousuushii||!!e.daisuushii||!!e.chinroutou||!!e.ryuuiisou||!!e["chuuren-poutou"]||!!e["pure-chuuren-poutou"],group:"kan"},{id:"shousuushii",label:"小四喜",han:13,hanIfOpened:13,yakumanCount:1,disableFn:({raw:e})=>!!e["kokushi-musou"]||!!e.daisangen||!!e.daisuushii||!!e.chinroutou||!!e.ryuuiisou||!!e["chuuren-poutou"]||!!e["pure-chuuren-poutou"],group:"kan"},{id:"daisuushii",label:"大四喜",han:26,hanIfOpened:26,yakumanCount:1,disableFn:({raw:e})=>!!e["kokushi-musou"]||!!e.daisangen||!!e.shousuushii||!!e.chinroutou||!!e.ryuuiisou||!!e["chuuren-poutou"]||!!e["pure-chuuren-poutou"],group:"kan"},{id:"chinroutou",label:"清老頭",han:13,hanIfOpened:13,yakumanCount:1,disableFn:({raw:e})=>!!e["kokushi-musou"]||!!e.shousuushii||!!e.daisangen||!!e.daisuushii||!!e.ryuuiisou||!!e["chuuren-poutou"]||!!e["pure-chuuren-poutou"],group:"kan"},{id:"ryuuiisou",label:"綠一色",han:13,hanIfOpened:13,yakumanCount:1,disableFn:({raw:e})=>!!e["kokushi-musou"]||!!e.shousuushii||!!e.daisangen||!!e.daisuushii||!!e.chinroutou||!!e["chuuren-poutou"]||!!e["pure-chuuren-poutou"]||!!e.tsuuiisou,group:"ryuuiisou"},{id:"tsuuiisou",label:"字一色",han:13,hanIfOpened:13,yakumanCount:1,disableFn:({raw:e})=>!!e["kokushi-musou"]||!!e.chinroutou||!!e.ryuuiisou||!!e["chuuren-poutou"]||!!e["pure-chuuren-poutou"],group:"combo"},{id:"suuankou",label:"四暗刻",han:13,hanIfOpened:0,yakumanCount:1,disableFn:({isRevealed:e,raw:t})=>!!e||!!t["kokushi-musou"]||!!t["chuuren-poutou"]||!!t["pure-chuuren-poutou"]||!!t["suuankou-dannki"],group:"combo"},{id:"suuankou-dannki",label:"四暗刻單騎",han:13,hanIfOpened:0,yakumanCount:1,disableFn:({isRevealed:e,raw:t})=>!!e||!!t["kokushi-musou"]||!!t["chuuren-poutou"]||!!t["pure-chuuren-poutou"]||!!t.suuankou,group:"combo"},{id:"suukantsu",label:"四槓子",han:13,hanIfOpened:13,yakumanCount:1,disableFn:({raw:e})=>!!e["kokushi-musou"]||!!e["chuuren-poutou"]||!!e["pure-chuuren-poutou"]||!!e.tenhou||!!e.chiihou||!!e.ronhou,group:"combo"},{id:"chuuren-poutou",label:"九連寶燈",han:13,hanIfOpened:0,yakumanCount:1,disableFn:({isRevealed:e,raw:t})=>!!e||!!t["kokushi-musou"]||!!t.daisangen||!!t.shousuushii||!!t.daisuushii||!!t.chinroutou||!!t.ryuuiisou||!!t.tsuuiisou||!!t.suuankou||!!t["suuankou-dannki"]||!!t.suukantsu||!!t["pure-chuuren-poutou"],group:"chuuren-poutou"},{id:"pure-chuuren-poutou",label:"純正九連寶燈",han:13,hanIfOpened:0,yakumanCount:1,disableFn:({isRevealed:e,raw:t})=>!!e||!!t["kokushi-musou"]||!!t.daisangen||!!t.shousuushii||!!t.daisuushii||!!t.chinroutou||!!t.ryuuiisou||!!t.tsuuiisou||!!t.suuankou||!!t["suuankou-dannki"]||!!t.suukantsu||!!t["chuuren-poutou"],group:"chuuren-poutou"},{id:"tenhou",label:"天和",han:13,hanIfOpened:0,yakumanCount:1,disableFn:({isRevealed:e,round:t,activePlayerIndex:n,targetPlayerIndex:s,raw:o})=>!!e||!ye(n,t)||s!=="-1"||!!o.suukantsu,hiddenIfDisabled:!0,group:"hou"},{id:"chiihou",label:"地和",han:13,hanIfOpened:0,yakumanCount:1,disableFn:({isRevealed:e,round:t,activePlayerIndex:n,targetPlayerIndex:s,raw:o})=>!!e||!!ye(n,t)||s!=="-1"||!!o.suukantsu,hiddenIfDisabled:!0,group:"hou"},{id:"ronhou",label:"人和",han:13,hanIfOpened:0,yakumanCount:1,disableFn:({isRevealed:e,round:t,activePlayerIndex:n,targetPlayerIndex:s,raw:o})=>!!e||!!ye(n,t)||s==="-1"||!!o.suukantsu,hiddenIfDisabled:!0,group:"hou"}],zn=Pe.filter(({yakumanCount:e,hidden:t})=>!e&&!t),Qo=zn.map(e=>e.group).filter((e,t)=>zn.findIndex(({group:n})=>e===n)===t),Vn=Pe.filter(({yakumanCount:e,hidden:t})=>typeof e<"u"&&e>0&&!t),ea=Vn.map(e=>e.group).filter((e,t)=>Vn.findIndex(({group:n})=>e===n)===t),Mn=[{label:"0",value:"0"},{label:"1",value:"1"},{label:"2",value:"2"},{label:"3",value:"3"},{label:"4",value:"4"},{label:"5",value:"5"},{label:"6",value:"6"},{label:"7",value:"7"},{label:"8",value:"8"},{label:"9",value:"9"},{label:"10",value:"10"},{label:"11",value:"11"},{label:"12",value:"12"},{label:"13",value:"13"},{label:"14",value:"14"},{label:"15",value:"15"},{label:"16",value:"16"},{label:"17",value:"17"},{label:"18",value:"18"}],ta=[{label:"0",value:"0"},{label:"1",value:"1"},{label:"2",value:"2"},{label:"3",value:"3"}],na=[{label:"30符",value:"30"},{label:"40符",value:"40"},{label:"50符",value:"50"},{label:"60符",value:"60"},{label:"70符",value:"70"},{label:"80符",value:"80"},{label:"90符",value:"90"},{label:"100符",value:"100"},{label:"110符",value:"110"},{label:"20符",value:"20"},{label:"25符",value:"25"}],qn=({yaku:e,active:t,isRevealed:n,disabled:s,onClick:o,hiddenIfDisabled:r})=>s&&r?a.jsx(a.Fragment,{}):a.jsx("button",{"data-id":e.id,"data-han":n?e.hanIfOpened:e.han,"data-active":t?"1":"0",disabled:s,className:"text-xl text-center px-3 border border-neutral-300 text-neutral-800 cursor-pointer hover:opacity-80 data-[han='0']:cursor-not-allowed disabled:opacity-20 disabled:hover:opacity-20 data-[active='1']:enabled:border-teal-800 data-[active='1']:enabled:text-white data-[active='1']:enabled:bg-teal-800 disabled:cursor-not-allowed",onClick:o,children:e.label},e.id),qr=({round:e,activePlayerIndex:t,targetPlayerIndex:n,onChange:s,value:o})=>{const[r,l]=h.useState({}),[c,i]=Ie(!1),[u,d]=Ie(!1),[f,p]=h.useState("0"),[m,g]=h.useState("0"),[x,y]=h.useState("0"),[D,C]=h.useState("30"),T=h.useCallback(O=>{const k=O.currentTarget.getAttribute("data-id");!k||!Pe.find(({id:v})=>v===k)||l(v=>({...v,[k]:!v[k]}))},[]),j=h.useCallback(()=>{l({}),i(!1),p("0"),g("0"),y("0"),C("30")},[i]),R=h.useMemo(()=>({activePlayerIndex:t,targetPlayerIndex:n,round:e,isRevealed:c,raw:r}),[t,c,e,n,r]),E=h.useMemo(()=>{let O=parseInt(D),k=!1;const B=[],v={...r};n==="-1"&&!c&&(v["menzenchin-tsumohou"]=!0),v["yakuhai-east"]&&Br(e)&&ye(t,e)?(v["yakuhai-east"]=!1,v["yakuhai-double-east"]=!0):v["yakuhai-south"]&&Fr(e)&&_r(t,e)?(v["yakuhai-south"]=!1,v["yakuhai-double-south"]=!0):v["yakuhai-west"]&&Lr(e)&&Gr(t,e)?(v["yakuhai-west"]=!1,v["yakuhai-double-west"]=!0):v["yakuhai-north"]&&Wr(e)&&Ur(t,e)&&(v["yakuhai-north"]=!1,v["yakuhai-double-north"]=!0),v["yakuhai-haku"]&&v["yakuhai-hatsu"]&&v["yakuhai-chun"]&&(v.daisangen=!0);const N=Pe.filter(({id:A,disableFn:I})=>!!v[A]&&!(I!=null&&I(R))),G=N.filter(({yakumanCount:A})=>typeof A<"u"&&A>0);if(G.length>0)for(const A of G)A.yakumanCount&&A.yakumanCount>0&&B.push({id:A.id,label:A.label,han:0,yakumanCount:A.yakumanCount});else if(N.length>0){for(const A of N){const I=c?A.hanIfOpened:A.han;I!==0&&B.push({id:A.id,label:A.label,han:I,yakumanCount:0})}B.findIndex(({id:A})=>A==="chiitoitsu")!==-1?(k=!0,O=25):B.findIndex(({id:A})=>A==="pinfu")!==-1&&(k=!0,O=n==="-1"?20:30),f!=="0"&&B.push({id:`dora-${f}`,label:`寶牌${f}`,han:parseInt(f),yakumanCount:0}),m!=="0"&&B.push({id:`dora-${m}`,label:`赤寶牌${m}`,han:parseInt(m),yakumanCount:0}),x!=="0"&&B.push({id:`dora-${x}`,label:`裡寶牌${x}`,han:parseInt(x),yakumanCount:0})}return{han:B.reduce((A,{han:I})=>A+I,0),fu:O,yakumanCount:B.reduce((A,{yakumanCount:I})=>A+I,0),yakus:B,isFuOverrided:k,raw:r,dora:parseInt(f),redDora:parseInt(m),innerDora:parseInt(x),isRevealed:c,isRiichied:!!r.riichi}},[D,r,n,c,e,f,m,x,R]);return h.useEffect(()=>{s&&s(E)},[E,s]),h.useEffect(()=>{o&&(l(o.raw??{}),p(o.dora.toString()),g(o.redDora.toString()),y("0"),i(o.isRevealed))},[i,o]),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between mb-2",children:[a.jsxs("div",{children:[a.jsx(Mr,{checked:c,onChangeChecked:i})," ","有副露？"]}),a.jsxs("div",{className:"space-x-4",children:[a.jsx("button",{className:"text-sm text-teal-700 underline",onClick:d,children:u?"一般役":"役滿役"}),a.jsx("button",{className:"text-sm text-teal-700 underline",onClick:j,children:"重置"})]})]}),!u&&a.jsxs("div",{children:[a.jsx("div",{className:"flex flex-wrap gap-y-4 gap-x-8",children:Qo.map(O=>a.jsx("div",{className:"flex flex-wrap gap-2",children:Pe.filter(({group:k})=>k===O).map(k=>{var B;return a.jsx(qn,{yaku:k,isRevealed:c,active:r[k.id],disabled:(B=k.disableFn)==null?void 0:B.call(k,R),hiddenIfDisabled:k.hiddenIfDisabled,onClick:T,children:k.label},k.id)})},O))}),a.jsx("table",{className:"w-full mt-2",children:a.jsx("tbody",{children:a.jsxs("tr",{children:[a.jsx("th",{className:"w-20 bg-yellow-400 px-1 border-yellow-100 border-t border-b",children:"寶牌"}),a.jsx("td",{className:"w-36 py-1 px-2 bg-yellow-200 data-[active='1']:text-red-600","data-active":f!=="0"?"1":"0",children:a.jsx(pt,{value:f,onChange:p,options:Mn})}),a.jsx("td",{className:"w-2"}),a.jsx("th",{className:"w-20 bg-red-400 px-1 border-neutral-100 border-t border-b",children:"赤寶牌"}),a.jsx("td",{className:"w-36 py-1 px-2 bg-red-200 data-[active='1']:text-red-600","data-active":m!=="0"?"1":"0",children:a.jsx(pt,{value:m,onChange:g,options:ta})}),a.jsx("td",{className:"w-2"}),a.jsx("th",{className:"w-20 bg-blue-400 px-1 border-neutral-100 border-t border-b",children:"裡寶牌"}),a.jsx("td",{className:"w-36 py-1 px-2 bg-blue-200 data-[active='1']:text-red-600","data-active":x!=="0"?"1":"0",children:a.jsx(pt,{value:x,onChange:y,options:Mn})}),a.jsx("td",{className:"w-2"}),a.jsx("th",{className:"w-20 bg-neutral-400 px-1 border-neutral-100 border-t border-b",children:"符數"}),a.jsx("td",{className:"w-36 py-1 px-2 bg-neutral-200",children:a.jsx(pt,{value:E.isFuOverrided?E.fu.toString():D,onChange:C,options:na,disabled:E.isFuOverrided})})]})})})]}),u&&a.jsx("div",{className:"flex flex-wrap gap-y-4 gap-x-8",children:ea.map(O=>a.jsx("div",{className:"flex flex-wrap gap-2",children:Pe.filter(({group:k})=>k===O).map(k=>{var B;return a.jsx(qn,{yaku:k,isRevealed:c,active:r[k.id],disabled:(B=k.disableFn)==null?void 0:B.call(k,R),hiddenIfDisabled:k.hiddenIfDisabled,onClick:T,children:k.label},k.id)})},O))})]})},ra=({result:e,matchSetting:t})=>{var n;return a.jsx("div",{children:a.jsx("table",{className:"w-full mt-2 bg-teal-100",children:a.jsx("tbody",{children:a.jsxs("tr",{children:[a.jsx("th",{className:"w-16 bg-teal-400 py-2 px-1",children:"結算"}),a.jsx("td",{className:"flex flex-wrap gap-2 p-2 align-middle",children:(n=e.yakus)==null?void 0:n.map(({label:s})=>a.jsx("span",{children:s},s))}),a.jsxs("td",{className:"w-32 bg-teal-400 text-center",children:[a.jsx(en,{han:e.han,fu:e.fu,yakumanCount:e.yakumanCount,isManganRoundUp:t.isManganRoundUp==="1",yakumanCountMax:Ao(t.yakumanMax)}),a.jsx(en,{className:"text-xs text-neutral-600",han:e.han,fu:e.fu,yakumanCount:e.yakumanCount,isManganRoundUp:t.isManganRoundUp==="1",raw:!0})]})]})})})})},sa=({onSubmit:e,defaultValue:t,open:n,onClose:s,...o})=>{const[r,l]=h.useState(),c=h.useCallback(()=>{r&&e(r)},[e,r]);return h.useEffect(()=>{l(t)},[t]),a.jsxs(xe,{open:n,onClose:s,children:[a.jsx(qr,{...o,onChange:l,value:t}),a.jsx("div",{className:"mt-4",children:a.jsx(J,{className:"w-full",onClick:c,children:"儲存"})})]})};function He({className:e,onChange:t,onChangeValue:n,...s}){const o=h.useMemo(()=>`block w-full rounded-md border-0 px-1 py-[9px] text-gray-900 shadow-xs ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6 ${e}`,[e]),r=h.useCallback(l=>{t==null||t(l),n==null||n(l.currentTarget.value)},[t,n]);return a.jsx("select",{className:o,onChange:r,...s})}function oa({score:e,...t}){const n=h.useMemo(()=>e?e.target?e.target:e.all?`${e.all} ALL`:`${e.others},${e.east}`:"(錯誤)",[e]);return a.jsx("div",{...t,children:n})}function Lt({children:e,label:t,action:n,...s}){return a.jsx("div",{...s,children:a.jsxs("label",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("p",{className:"text-sm text-gray-800 font-bold",children:t}),a.jsx("div",{children:n})]}),a.jsx("div",{children:e})]})})}function Yr({rtMatch:e,currentMatchRound:t,initialActivePlayerIndex:n="0",initialTargetPlayerIndex:s="-1",submitNode:o=a.jsxs("span",{children:[a.jsx("i",{className:"bi bi-camera-reels-fill"})," 提交並播出分數變動動畫"]}),onSubmit:r}){const[l,c]=h.useState({han:1,fu:30,yakumanCount:0,dora:0,redDora:0,innerDora:0,yakus:[],raw:{},isRevealed:!1,isRiichied:!1}),i=h.useMemo(()=>Object.keys(e.players).map(N=>({index:N.toString(),name:`${e.players[N].primaryName} (${e.players[N].nickname})`,position:Hr(N,t.roundCount)})),[e.players,t.roundCount]),[u,d]=h.useState(n??"0"),f=h.useMemo(()=>typeof u<"u"?i==null?void 0:i.find(({index:v})=>v===u):void 0,[u,i]),[p,m]=h.useState(s),g=h.useMemo(()=>{const v=Ln(l.han,l.fu,l.yakumanCount,(f==null?void 0:f.position)===$o.East,p!=="-1",{roundUp:e.setting.isManganRoundUp==="1",yakumanMax:e.setting.yakumanMax});return t.extendedRoundCount>0&&(v.win+=t.extendedRoundCount*300,v.target&&(v.target+=t.extendedRoundCount*300),v.all&&(v.all+=t.extendedRoundCount*100),v.east&&(v.east+=t.extendedRoundCount*100),v.others&&(v.others+=t.extendedRoundCount*100)),t.cumulatedThousands>0&&(v.win+=t.cumulatedThousands*1e3),v},[l.han,l.fu,l.yakumanCount,f==null?void 0:f.position,p,e.setting.isManganRoundUp,e.setting.yakumanMax,t.extendedRoundCount,t.cumulatedThousands]),x=h.useMemo(()=>l.isRevealed&&l.yakus&&l.yakus.findIndex(({id:v})=>v==="daisangen")!==-1,[l.isRevealed,l.yakus]),[y,D]=h.useState("-1"),C=h.useMemo(()=>l.isRevealed&&l.yakus&&l.yakus.findIndex(({id:v})=>v==="daisuushii")!==-1,[l.isRevealed,l.yakus]),[T,j]=h.useState("-1"),R=h.useMemo(()=>l.isRevealed&&l.yakus&&l.yakus.findIndex(({id:v})=>v==="suukantsu")!==-1,[l.isRevealed,l.yakus]),[E,O]=h.useState("-1"),k=h.useMemo(()=>{const v=Object.keys(t.playerResults),N={0:{...t.playerResults[0],beforeScore:t.playerResults[0].beforeScore,afterScore:t.playerResults[0].beforeScore,type:0,scoreChanges:[],prevScoreChanges:t.playerResults[0].scoreChanges??[]},1:{...t.playerResults[1],beforeScore:t.playerResults[1].beforeScore,afterScore:t.playerResults[1].beforeScore,type:0,scoreChanges:[],prevScoreChanges:t.playerResults[1].scoreChanges??[]},2:{...t.playerResults[2],beforeScore:t.playerResults[2].beforeScore,afterScore:t.playerResults[2].beforeScore,type:0,scoreChanges:[],prevScoreChanges:t.playerResults[2].scoreChanges??[]},3:{...t.playerResults[3],beforeScore:t.playerResults[3].beforeScore,afterScore:t.playerResults[3].beforeScore,type:0,scoreChanges:[],prevScoreChanges:t.playerResults[3].scoreChanges??[]}};if(u===p)return N;for(let A=0;A<v.length;A+=1){const I=v[A];I===u?(N[I].afterScore+=g.win,N[I].type=Q.Win,N[I].scoreChanges=[g.win]):g.target&&I===p?(N[I].afterScore-=g.target,N[I].type=Q.Lose,N[I].scoreChanges=[-g.target]):g.all?(N[I].afterScore-=g.all,N[I].type=Q.Lose,N[I].scoreChanges=[-g.all]):g.east&&g.others&&(ye(I,t.roundCount)?(N[I].afterScore-=g.east,N[I].type=Q.Lose,N[I].scoreChanges=[-g.east]):(N[I].afterScore-=g.others,N[I].type=Q.Lose,N[I].scoreChanges=[-g.others]))}[{bool:x,triggeredPlayerIndex:y,yakuId:"daisangen"},{bool:C,triggeredPlayerIndex:T,yakuId:"daisuushii"},{bool:R,triggeredPlayerIndex:E,yakuId:"suukantsu"}].forEach(({bool:A,triggeredPlayerIndex:I,yakuId:ne})=>{var Se;if(A&&I!=="-1"&&I!==u&&I!==p){const be=(Se=l.yakus)==null?void 0:Se.find(({id:z})=>ne===z);if(be){const z=Ln(1,30,be.yakumanCount,ye(u,t.roundCount),p!=="-1",{roundUp:e.setting.isManganRoundUp==="1",yakumanMax:e.setting.yakumanMax});if(z.target){const L=Math.round(z.target/2);N[p].afterScore+=L,N[p].scoreChanges[0]+=L,N[p].scoreChanges[0]===0&&N[p].scoreChanges.splice(0,1),N[I].afterScore-=L,typeof N[I].scoreChanges[0]>"u"?N[I].scoreChanges.push(-L):N[I].scoreChanges[0]-=L}else if(z.all)for(let L=0;L<v.length;L+=1){const M=z.all;v[L]!==u&&v[L]!==I&&(N[v[L]].afterScore+=M,N[v[L]].scoreChanges[0]+=M,N[v[L]].scoreChanges[0]===0&&N[v[L]].scoreChanges.splice(0,1),N[I].afterScore-=M,typeof N[I].scoreChanges[0]>"u"?N[I].scoreChanges.push(-M):N[I].scoreChanges[0]-=M)}else if(z.east&&z.others){for(let L=0;L<v.length;L+=1)if(v[L]!==u&&v[L]!==I){const M=ye(v[L],t.roundCount)?z.east:z.others;N[v[L]].afterScore+=M,N[v[L]].scoreChanges[0]+=M,N[v[L]].scoreChanges[0]===0&&N[v[L]].scoreChanges.splice(0,1),N[I].afterScore-=M,typeof N[I].scoreChanges[0]>"u"?N[I].scoreChanges.push(-M):N[I].scoreChanges[0]-=M}}}}},[]);let G=0;for(let A=0;A<v.length;A+=1){const I=v[A];I!==u&&N[I].isRiichi&&(N[I].afterScore-=1e3,N[I].scoreChanges.unshift(-1e3),G+=1e3)}return u&&G>0&&(N[u].afterScore+=G,N[u].scoreChanges.unshift(G)),N[u].detail=l,N},[u,g.all,g.east,g.others,g.target,g.win,t.playerResults,t.roundCount,x,C,R,e.setting.isManganRoundUp,e.setting.yakumanMax,p,l,y,T,E]),B=h.useCallback(()=>{if(!r||!l)return;const v={...t,resultType:Bo(g),playerResults:k,nextRoundCumulatedThousands:0,resultDetail:{winnerPlayerIndex:u,...l,yakus:l.yakus??[]}};r(v)},[u,g,t,r,k,l]);return h.useEffect(()=>{d(n),m(s),c(t.playerResults[n].detail)},[t.playerResults,n,s]),a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{className:"flex gap-x-4 items-center",children:[a.jsx("div",{className:"flex-1",children:a.jsx(He,{value:u,onChangeValue:d,children:i.map(({index:v,name:N})=>a.jsx("option",{value:v,children:N},v))})}),a.jsx("div",{className:"text-xs text-gray-500",children:"和了"}),a.jsx("div",{className:"flex-1",children:a.jsxs(He,{value:p,onChangeValue:m,children:[a.jsx("option",{value:"-1",children:"自摸"}),i.map(({index:v,name:N})=>a.jsx("option",{value:v,children:N},v))]})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h5",{className:"font-bold",children:"役種"}),a.jsxs("div",{children:[a.jsx(qr,{round:t.roundCount,activePlayerIndex:u,targetPlayerIndex:p,onChange:c,value:t.playerResults[u].detail}),a.jsx(ra,{result:l,matchSetting:e.setting}),a.jsx("div",{className:"text-3xl font-bold text-center bg-teal-400 py-2",children:a.jsx(oa,{score:g})})]})]}),(x||C||R)&&a.jsxs("div",{className:"space-y-2 bg-yellow-200 p-4",children:[a.jsx("h5",{className:"font-bold",children:"包牌"}),a.jsxs("p",{children:["當某家打出的牌被鳴牌後，導致役滿確定時（大三元、大四喜、四槓子），便會觸發「包牌」。",a.jsx("br",{}),"- 如自摸，包牌者需支付該役種全部點數",a.jsx("br",{}),"- 如他家放銃，包牌者需支付該役種一半點數"]}),a.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[x&&a.jsx(Lt,{label:"大三元包牌者",children:a.jsxs(He,{value:y,onChangeValue:D,children:[a.jsx("option",{value:"-1",children:"沒有包牌"}),i.map(({index:v,name:N})=>a.jsx("option",{value:v,children:N},v))]})}),C&&a.jsx(Lt,{label:"大四喜包牌者",children:a.jsxs(He,{value:T,onChangeValue:j,children:[a.jsx("option",{value:"-1",children:"沒有包牌"}),i.map(({index:v,name:N})=>a.jsx("option",{value:v,children:N},v))]})}),R&&a.jsx(Lt,{label:"四槓子包牌者",children:a.jsxs(He,{value:E,onChangeValue:O,children:[a.jsx("option",{value:"-1",children:"沒有包牌"}),i.map(({index:v,name:N})=>a.jsx("option",{value:v,children:N},v))]})})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h5",{className:"font-bold",children:"分數變動"}),a.jsxs("table",{className:"data-table w-full text-lg",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"玩家"}),a.jsx("th",{children:"目前分數"}),a.jsx("th",{children:"變動"}),a.jsx("th",{children:"最新分數"})]})}),a.jsx("tbody",{children:Object.keys(e.players).map(v=>a.jsxs("tr",{children:[a.jsx("th",{className:"text-white py-1",style:{background:e.players[v].color},children:e.players[v].primaryName}),a.jsx("td",{className:"px-2 text-center w-32",children:k[v].beforeScore}),a.jsx("td",{className:"text-center w-32",children:a.jsx(fe,{signed:!0,value:k[v].afterScore-k[v].beforeScore,positiveClassName:"text-green-400",negativeClassName:"text-red-400"})}),a.jsx("td",{className:"text-center w-32",children:k[v].afterScore})]},v))})]})]}),a.jsx("div",{className:"space-y-2",children:a.jsx(J,{onClick:B,className:"w-full",disabled:!(l!=null&&l.yakus)||l.yakus.length<=0,children:o})})]})}function Jr({rtMatch:e,currentMatchRound:t,submitNode:n=a.jsxs("span",{children:[a.jsx("i",{className:"bi bi-camera-reels-fill"})," 提交並播出分數變動動畫"]}),onSubmit:s}){const[o,r]=h.useState({0:!1,1:!1,2:!1,3:!1}),l=h.useCallback(u=>{var p,m;const d=(p=u.currentTarget)==null?void 0:p.checked,f=(m=u.currentTarget)==null?void 0:m.getAttribute("data-player-index");typeof d>"u"||!f||r(g=>({...g,[f]:d}))},[]),c=h.useMemo(()=>{const u=Object.keys(t.playerResults),d={0:{...t.playerResults[0],beforeScore:t.playerResults[0].beforeScore,afterScore:t.playerResults[0].beforeScore,type:0,scoreChanges:[],prevScoreChanges:t.playerResults[0].prevScoreChanges??[]},1:{...t.playerResults[1],beforeScore:t.playerResults[1].beforeScore,afterScore:t.playerResults[1].beforeScore,type:0,scoreChanges:[],prevScoreChanges:t.playerResults[1].prevScoreChanges??[]},2:{...t.playerResults[2],beforeScore:t.playerResults[2].beforeScore,afterScore:t.playerResults[2].beforeScore,type:0,scoreChanges:[],prevScoreChanges:t.playerResults[2].prevScoreChanges??[]},3:{...t.playerResults[3],beforeScore:t.playerResults[3].beforeScore,afterScore:t.playerResults[3].beforeScore,type:0,scoreChanges:[],prevScoreChanges:t.playerResults[3].prevScoreChanges??[]}};let f=0,p=0;const m=["0","1","2","3"].filter(g=>o[g]&&!t.playerResults[g].isRonDisallowed).length;m===1?(f=3e3,p=1e3):m===2?(f=1500,p=1500):m===3&&(f=1e3,p=3e3);for(let g=0;g<u.length;g+=1){const x=u[g];d[x].type=o[x]?Q.Win:Q.Lose,f&&p&&(o[x]?t.playerResults[x].isRonDisallowed?(d[x].afterScore-=p,d[x].scoreChanges=[-p]):(d[x].afterScore+=f,d[x].scoreChanges=[f]):(d[x].afterScore-=p,d[x].scoreChanges=[-p])),d[x].isRiichi&&(d[x].afterScore-=1e3,d[x].scoreChanges.unshift(-1e3))}return d},[t.playerResults,o]),i=h.useCallback(()=>{if(!s)return;const u={...t,resultType:Y.Exhausted,playerResults:c,nextRoundCumulatedThousands:t.cumulatedThousands+Object.values(c).filter(({isRiichi:d})=>!!d).length};s(u)},[t,s,c]);return h.useEffect(()=>{var u,d,f,p;r({0:!!t.playerResults[0].waitingTiles&&((u=t.playerResults[0].waitingTiles)==null?void 0:u.length)>0,1:!!t.playerResults[1].waitingTiles&&((d=t.playerResults[1].waitingTiles)==null?void 0:d.length)>0,2:!!t.playerResults[2].waitingTiles&&((f=t.playerResults[2].waitingTiles)==null?void 0:f.length)>0,3:!!t.playerResults[3].waitingTiles&&((p=t.playerResults[3].waitingTiles)==null?void 0:p.length)>0})},[t.playerResults]),a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("h5",{className:"font-bold",children:"分數變動"}),a.jsxs("table",{className:"data-table w-full text-lg",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"玩家"}),a.jsx("th",{className:"bg-yellow-200!",children:"聽牌？"}),a.jsx("th",{className:"w-32",children:"目前分數"}),a.jsx("th",{className:"w-32",children:"變動"}),a.jsx("th",{className:"w-32",children:"最新分數"})]})}),a.jsx("tbody",{children:Object.keys(e.players).map(u=>a.jsxs("tr",{children:[a.jsx("th",{className:"text-white py-1",style:{background:e.players[u].color},children:e.players[u].primaryName}),a.jsxs("td",{className:"text-center bg-yellow-200",style:{backgroundColor:t.playerResults[u].isRonDisallowed?"#F00":""},children:[a.jsx(Mr,{checked:o[u],onChange:l,"data-player-index":u}),t.playerResults[u].isRonDisallowed&&a.jsx("p",{className:"text-white text-sm font-semibold",children:"和了禁止"})]}),a.jsx("td",{className:"text-center",children:c[u].beforeScore}),a.jsx("td",{className:"text-center",children:a.jsx(fe,{signed:!0,value:c[u].afterScore-c[u].beforeScore,positiveClassName:"text-green-400",negativeClassName:"text-red-400"})}),a.jsx("td",{className:"text-center",children:c[u].afterScore})]},u))})]})]}),a.jsx("div",{className:"space-y-2",children:a.jsx(J,{onClick:i,className:"w-full",children:n})})]})}function aa({player:e,onClickEdit:t,...n}){const s=h.useCallback(()=>{t==null||t(e)},[t,e]);return a.jsxs("div",{className:"relative flex-1 flex items-center gap-x-2 rounded-sm p-2 text-white",style:{backgroundColor:e.color??"#115e59"},...n,children:[e.logoUrl&&a.jsx("div",{className:"absolute inset-0 opacity-10 bg-center bg-no-repeat bg-cover",style:{backgroundImage:`url(${e.logoUrl})`}}),a.jsx("div",{className:"relative z-10 shrink-0",children:a.jsx("div",{className:"w-14 h-14 bg-center bg-contain bg-no-repeat rounded-sm",style:{backgroundImage:`url(${e.logoUrl||"/images/portrait-placeholder.jpeg"})`}})}),a.jsxs("div",{className:"flex-1 relative z-10 ",children:[a.jsx("div",{children:e.secondaryName??"(無頭銜)"}),a.jsx("div",{className:"text-2xl",children:e.primaryName??"(無名稱)"})]}),t&&a.jsx("div",{className:"shrink-0",children:a.jsx(J,{variant:"icon",color:"inverted",type:"button",onClick:s,children:a.jsx("i",{className:"bi bi-pencil"})})})]})}const la=ko(["block w-full rounded-md border-0 p-2 text-gray-900 shadow-xs ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600"]);function ft({className:e,...t}){const n=h.useMemo(()=>la({className:e}),[e]);return a.jsx("input",{className:n,...t})}function ia({rtMatch:e,currentMatchRound:t,onSubmit:n}){const{reset:s,handleSubmit:o,control:r}=dn({defaultValues:{player_0:0,player_1:0,player_2:0,player_3:0,cumulatedThousands:0,roundCount:0,extendedRoundCount:0}}),l=h.useMemo(()=>Object.keys(e.players).map(u=>({...e.players[u],index:u.toString(),position:Hr(u,t.roundCount)})),[e.players,t.roundCount]),c=h.useMemo(()=>o(i=>{if(!n)return;const u={...t,resultType:Y.Hotfix,playerResults:{0:{...t.playerResults[0],afterScore:parseInt(i.player_0,10)},1:{...t.playerResults[1],afterScore:parseInt(i.player_1,10)},2:{...t.playerResults[2],afterScore:parseInt(i.player_2,10)},3:{...t.playerResults[3],afterScore:parseInt(i.player_3,10)}},cumulatedThousands:parseInt(i.cumulatedThousands,10),roundCount:parseInt(i.roundCount,10),extendedRoundCount:parseInt(i.extendedRoundCount,10)};n(u)}),[t,o,n]);return h.useEffect(()=>{s({player_0:t.playerResults[0].beforeScore,player_1:t.playerResults[1].beforeScore,player_2:t.playerResults[2].beforeScore,player_3:t.playerResults[3].beforeScore,cumulatedThousands:t.cumulatedThousands,roundCount:t.roundCount,extendedRoundCount:t.extendedRoundCount})},[t.cumulatedThousands,t.extendedRoundCount,t.playerResults,t.roundCount,s]),a.jsxs("div",{className:"space-y-8",children:[a.jsx("div",{className:"space-y-2",children:a.jsxs("table",{className:"data-table w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:"w-1/2",children:"玩家"}),a.jsx("th",{className:"w-1/4",children:"現在分數"}),a.jsx("th",{className:"w-1/4",children:"新的分數"})]})}),a.jsxs("tbody",{children:[l.map(i=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-2 border border-gray-200 align-middle",children:a.jsx(aa,{player:i})}),a.jsx("td",{className:"text-center px-2 border border-gray-200 align-middle",children:t.playerResults[i.index].beforeScore}),a.jsx("td",{className:"px-2 border border-gray-200 align-middle",children:a.jsx(dt,{name:`player_${i.index}`,control:r,rules:{required:!0},render:({field:u})=>a.jsx(ft,{className:"text-center",type:"number",...u})})})]},i.index)),a.jsxs("tr",{children:[a.jsx("td",{className:"px-2 border border-gray-200 align-middle",children:"供托"}),a.jsx("td",{className:"text-center px-2 border border-gray-200 align-middle",children:t.cumulatedThousands}),a.jsx("td",{className:"px-2 border border-gray-200 align-middle",children:a.jsx(dt,{name:"cumulatedThousands",control:r,rules:{required:!0},render:({field:i})=>a.jsx(ft,{className:"text-center",type:"number",...i})})})]}),a.jsxs("tr",{children:[a.jsx("td",{className:"px-2 border border-gray-200 align-middle",children:"局數(東1局=1, 東2局=2, ...)"}),a.jsx("td",{className:"text-center px-2 border border-gray-200 align-middle",children:t.roundCount}),a.jsx("td",{className:"px-2 border border-gray-200 align-middle",children:a.jsx(dt,{name:"roundCount",control:r,rules:{required:!0},render:({field:i})=>a.jsx(ft,{className:"text-center",type:"number",...i})})})]}),a.jsxs("tr",{children:[a.jsx("td",{className:"px-2 border border-gray-200 align-middle",children:"本場數"}),a.jsx("td",{className:"text-center px-2 border border-gray-200 align-middle",children:t.extendedRoundCount}),a.jsx("td",{className:"px-2 border border-gray-200 align-middle",children:a.jsx(dt,{name:"extendedRoundCount",control:r,rules:{required:!0},render:({field:i})=>a.jsx(ft,{className:"text-center",type:"number",...i})})})]})]})]})}),a.jsx("div",{className:"space-y-2",children:a.jsx(J,{onClick:c,className:"w-full",children:"提交並更新直播畫面"})})]})}const ca=({rtMatch:e,rtMatchRound:t,onSubmit:n})=>{const{control:s,register:o,reset:r}=dn(),l=vt({name:"_playerResults",control:s}),c=vt({name:"_resultType",control:s}),i=h.useMemo(()=>!t||!l?null:{...t,playerResults:{0:{...t.playerResults[0],isRiichi:l[0].status==="isRiichied",isRevealed:l[0].status==="isRevealed",detail:{...t.playerResults[0].detail,isRiichied:l[0].status==="isRiichied",isRevealed:l[0].status==="isRevealed"}},1:{...t.playerResults[1],isRiichi:l[1].status==="isRiichied",isRevealed:l[1].status==="isRevealed",detail:{...t.playerResults[1].detail,isRiichied:l[1].status==="isRiichied",isRevealed:l[1].status==="isRevealed"}},2:{...t.playerResults[2],isRiichi:l[2].status==="isRiichied",isRevealed:l[2].status==="isRevealed",detail:{...t.playerResults[2].detail,isRiichied:l[2].status==="isRiichied",isRevealed:l[2].status==="isRevealed"}},3:{...t.playerResults[3],isRiichi:l[3].status==="isRiichied",isRevealed:l[3].status==="isRevealed",detail:{...t.playerResults[3].detail,isRiichied:l[3].status==="isRiichied",isRevealed:l[3].status==="isRevealed"}}}},[t,l]),u=h.useMemo(()=>{var p,m;return i?{rtMatch:e,currentMatchRound:i,initialActivePlayerIndex:i.resultType===Y.Ron||i.resultType===Y.SelfDrawn?((p=Object.entries(i.playerResults).find(([,g])=>g.type===Q.Win))==null?void 0:p[0])??"0":"0",initialTargetPlayerIndex:i.resultType===Y.Ron?((m=Object.entries(i.playerResults).find(([,g])=>g.type===Q.Lose))==null?void 0:m[0])??"-1":"-1"}:null},[e,i]),d=h.useMemo(()=>i?{rtMatch:e,currentMatchRound:i}:null,[e,i]),f=h.useCallback(p=>{n==null||n(p)},[n]);return h.useEffect(()=>{t&&r({_resultType:t.resultType===Y.Ron||t.resultType===Y.SelfDrawn?"ron":"exhausted",_playerResults:{0:{status:t.playerResults[0].isRevealed?"isRevealed":t.playerResults[0].isRiichi?"isRiichied":"none"},1:{status:t.playerResults[1].isRevealed?"isRevealed":t.playerResults[1].isRiichi?"isRiichied":"none"},2:{status:t.playerResults[2].isRevealed?"isRevealed":t.playerResults[2].isRiichi?"isRiichied":"none"},3:{status:t.playerResults[3].isRevealed?"isRevealed":t.playerResults[3].isRiichi?"isRiichied":"none"}}})},[t,t==null?void 0:t.playerResults,t==null?void 0:t.resultType,r]),a.jsxs("div",{className:"space-y-6",children:[a.jsx("h2",{className:"text-xl font-bold",children:"各玩家終局狀態"}),a.jsxs("table",{className:"w-full data-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{}),a.jsx("th",{children:"立直/副露？"})]})}),a.jsx("tbody",{children:["0","1","2","3"].map(p=>a.jsxs("tr",{children:[a.jsx("td",{children:e.players[p].nickname}),a.jsx("td",{children:a.jsxs("select",{...o(`_playerResults.${p}.status`),children:[a.jsx("option",{value:"none",children:"-"}),a.jsx("option",{value:"isRiichied",children:"立直"}),a.jsx("option",{value:"isRevealed",children:"副露"})]})})]},p))})]}),a.jsx("hr",{}),a.jsxs("h2",{className:"text-xl font-bold",children:[a.jsx("span",{children:"對局結果："}),a.jsxs("select",{...o("_resultType"),children:[a.jsx("option",{value:"ron",children:"和了"}),a.jsx("option",{value:"exhausted",children:"流局"})]})]}),c==="ron"&&!!u&&a.jsx(Yr,{...u,submitNode:"提交修改",onSubmit:f}),c==="exhausted"&&!!d&&a.jsx(Jr,{...d,submitNode:"提交修改",onSubmit:f})]})};var fn=Io();const ua=Ro(fn);function te(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var da=typeof Symbol=="function"&&Symbol.observable||"@@observable",Yn=da,Jn=()=>Math.random().toString(36).substring(7).split("").join("."),pa={INIT:`@@redux/INIT${Jn()}`,REPLACE:`@@redux/REPLACE${Jn()}`},Kn=pa;function fa(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function Kr(e,t,n){if(typeof e!="function")throw new Error(te(2));if(typeof t=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(te(0));if(typeof t=="function"&&typeof n>"u"&&(n=t,t=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(te(1));return n(Kr)(e,t)}let s=e,o=t,r=new Map,l=r,c=0,i=!1;function u(){l===r&&(l=new Map,r.forEach((y,D)=>{l.set(D,y)}))}function d(){if(i)throw new Error(te(3));return o}function f(y){if(typeof y!="function")throw new Error(te(4));if(i)throw new Error(te(5));let D=!0;u();const C=c++;return l.set(C,y),function(){if(D){if(i)throw new Error(te(6));D=!1,u(),l.delete(C),r=null}}}function p(y){if(!fa(y))throw new Error(te(7));if(typeof y.type>"u")throw new Error(te(8));if(typeof y.type!="string")throw new Error(te(17));if(i)throw new Error(te(9));try{i=!0,o=s(o,y)}finally{i=!1}return(r=l).forEach(C=>{C()}),y}function m(y){if(typeof y!="function")throw new Error(te(10));s=y,p({type:Kn.REPLACE})}function g(){const y=f;return{subscribe(D){if(typeof D!="object"||D===null)throw new Error(te(11));function C(){const j=D;j.next&&j.next(d())}return C(),{unsubscribe:y(C)}},[Yn](){return this}}}return p({type:Kn.INIT}),{dispatch:p,subscribe:f,getState:d,replaceReducer:m,[Yn]:g}}function Xn(e,t){return function(...n){return t(e.apply(this,n))}}function Zn(e,t){if(typeof e=="function")return Xn(e,t);if(typeof e!="object"||e===null)throw new Error(te(16));const n={};for(const s in e){const o=e[s];typeof o=="function"&&(n[s]=Xn(o,t))}return n}function Xr(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,n)=>(...s)=>t(n(...s)))}function ma(...e){return t=>(n,s)=>{const o=t(n,s);let r=()=>{throw new Error(te(15))};const l={getState:o.getState,dispatch:(i,...u)=>r(i,...u)},c=e.map(i=>i(l));return r=Xr(...c)(o.dispatch),{...o,dispatch:r}}}var Gt={exports:{}},Wt={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qn;function ha(){if(Qn)return Wt;Qn=1;var e=Eo();function t(i,u){return i===u&&(i!==0||1/i===1/u)||i!==i&&u!==u}var n=typeof Object.is=="function"?Object.is:t,s=e.useSyncExternalStore,o=e.useRef,r=e.useEffect,l=e.useMemo,c=e.useDebugValue;return Wt.useSyncExternalStoreWithSelector=function(i,u,d,f,p){var m=o(null);if(m.current===null){var g={hasValue:!1,value:null};m.current=g}else g=m.current;m=l(function(){function y(R){if(!D){if(D=!0,C=R,R=f(R),p!==void 0&&g.hasValue){var E=g.value;if(p(E,R))return T=E}return T=R}if(E=T,n(C,R))return E;var O=f(R);return p!==void 0&&p(E,O)?(C=R,E):(C=R,T=O)}var D=!1,C,T,j=d===void 0?null:d;return[function(){return y(u())},j===null?void 0:function(){return y(j())}]},[u,d,f,p]);var x=s(i,m[0],m[1]);return r(function(){g.hasValue=!0,g.value=x},[x]),c(x),x},Wt}var er;function ga(){return er||(er=1,Gt.exports=ha()),Gt.exports}ga();var ba=h.version.startsWith("19"),xa=Symbol.for(ba?"react.transitional.element":"react.element"),ya=Symbol.for("react.portal"),va=Symbol.for("react.fragment"),Ca=Symbol.for("react.strict_mode"),Na=Symbol.for("react.profiler"),Sa=Symbol.for("react.consumer"),Da=Symbol.for("react.context"),Zr=Symbol.for("react.forward_ref"),ja=Symbol.for("react.suspense"),ka=Symbol.for("react.suspense_list"),mn=Symbol.for("react.memo"),Ra=Symbol.for("react.lazy"),Ia=Zr,Ea=mn;function wa(e){if(typeof e=="object"&&e!==null){const{$$typeof:t}=e;switch(t){case xa:switch(e=e.type,e){case va:case Na:case Ca:case ja:case ka:return e;default:switch(e=e&&e.$$typeof,e){case Da:case Zr:case Ra:case mn:return e;case Sa:return e;default:return t}}case ya:return t}}}function Ta(e){return wa(e)===mn}function Oa(e,t,n,s,{areStatesEqual:o,areOwnPropsEqual:r,areStatePropsEqual:l}){let c=!1,i,u,d,f,p;function m(C,T){return i=C,u=T,d=e(i,u),f=t(s,u),p=n(d,f,u),c=!0,p}function g(){return d=e(i,u),t.dependsOnOwnProps&&(f=t(s,u)),p=n(d,f,u),p}function x(){return e.dependsOnOwnProps&&(d=e(i,u)),t.dependsOnOwnProps&&(f=t(s,u)),p=n(d,f,u),p}function y(){const C=e(i,u),T=!l(C,d);return d=C,T&&(p=n(d,f,u)),p}function D(C,T){const j=!r(T,u),R=!o(C,i,T,u);return i=C,u=T,j&&R?g():j?x():R?y():p}return function(T,j){return c?D(T,j):m(T,j)}}function Pa(e,{initMapStateToProps:t,initMapDispatchToProps:n,initMergeProps:s,...o}){const r=t(e,o),l=n(e,o),c=s(e,o);return Oa(r,l,c,e,o)}function Aa(e,t){const n={};for(const s in e){const o=e[s];typeof o=="function"&&(n[s]=(...r)=>t(o(...r)))}return n}function tn(e){return function(n){const s=e(n);function o(){return s}return o.dependsOnOwnProps=!1,o}}function tr(e){return e.dependsOnOwnProps?!!e.dependsOnOwnProps:e.length!==1}function Qr(e,t){return function(s,{displayName:o}){const r=function(c,i){return r.dependsOnOwnProps?r.mapToProps(c,i):r.mapToProps(c,void 0)};return r.dependsOnOwnProps=!0,r.mapToProps=function(c,i){r.mapToProps=e,r.dependsOnOwnProps=tr(e);let u=r(c,i);return typeof u=="function"&&(r.mapToProps=u,r.dependsOnOwnProps=tr(u),u=r(c,i)),u},r}}function hn(e,t){return(n,s)=>{throw new Error(`Invalid value of type ${typeof e} for ${t} argument when connecting component ${s.wrappedComponentName}.`)}}function $a(e){return e&&typeof e=="object"?tn(t=>Aa(e,t)):e?typeof e=="function"?Qr(e):hn(e,"mapDispatchToProps"):tn(t=>({dispatch:t}))}function Ba(e){return e?typeof e=="function"?Qr(e):hn(e,"mapStateToProps"):tn(()=>({}))}function Fa(e,t,n){return{...n,...e,...t}}function _a(e){return function(n,{displayName:s,areMergedPropsEqual:o}){let r=!1,l;return function(i,u,d){const f=e(i,u,d);return r?o(f,l)||(l=f):(r=!0,l=f),l}}}function La(e){return e?typeof e=="function"?_a(e):hn(e,"mergeProps"):()=>Fa}function Ga(e){e()}function Wa(){let e=null,t=null;return{clear(){e=null,t=null},notify(){Ga(()=>{let n=e;for(;n;)n.callback(),n=n.next})},get(){const n=[];let s=e;for(;s;)n.push(s),s=s.next;return n},subscribe(n){let s=!0;const o=t={callback:n,next:null,prev:t};return o.prev?o.prev.next=o:e=o,function(){!s||e===null||(s=!1,o.next?o.next.prev=o.prev:t=o.prev,o.prev?o.prev.next=o.next:e=o.next)}}}}var nr={notify(){},get:()=>[]};function es(e,t){let n,s=nr,o=0,r=!1;function l(x){d();const y=s.subscribe(x);let D=!1;return()=>{D||(D=!0,y(),f())}}function c(){s.notify()}function i(){g.onStateChange&&g.onStateChange()}function u(){return r}function d(){o++,n||(n=t?t.addNestedSub(i):e.subscribe(i),s=Wa())}function f(){o--,n&&o===0&&(n(),n=void 0,s.clear(),s=nr)}function p(){r||(r=!0,d())}function m(){r&&(r=!1,f())}const g={addNestedSub:l,notifyNestedSubs:c,handleChangeWrapper:i,isSubscribed:u,trySubscribe:p,tryUnsubscribe:m,getListeners:()=>s};return g}var Ua=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Ha=Ua(),za=()=>typeof navigator<"u"&&navigator.product==="ReactNative",Va=za(),Ma=()=>Ha||Va?h.useLayoutEffect:h.useEffect,Ct=Ma();function rr(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function Ut(e,t){if(rr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(let o=0;o<n.length;o++)if(!Object.prototype.hasOwnProperty.call(t,n[o])||!rr(e[n[o]],t[n[o]]))return!1;return!0}var qa={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},Ya={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},Ja={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},ts={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Ka={[Ia]:Ja,[Ea]:ts};function sr(e){return Ta(e)?ts:Ka[e.$$typeof]||qa}var Xa=Object.defineProperty,Za=Object.getOwnPropertyNames,or=Object.getOwnPropertySymbols,Qa=Object.getOwnPropertyDescriptor,el=Object.getPrototypeOf,ar=Object.prototype;function nn(e,t){if(typeof t!="string"){if(ar){const r=el(t);r&&r!==ar&&nn(e,r)}let n=Za(t);or&&(n=n.concat(or(t)));const s=sr(e),o=sr(t);for(let r=0;r<n.length;++r){const l=n[r];if(!Ya[l]&&!(o&&o[l])&&!(s&&s[l])){const c=Qa(t,l);try{Xa(e,l,c)}catch{}}}}return e}var Ht=Symbol.for("react-redux-context"),zt=typeof globalThis<"u"?globalThis:{};function tl(){if(!h.createContext)return{};const e=zt[Ht]??(zt[Ht]=new Map);let t=e.get(h.createContext);return t||(t=h.createContext(null),e.set(h.createContext,t)),t}var ns=tl(),nl=[null,null];function rl(e,t,n){Ct(()=>e(...t),n)}function sl(e,t,n,s,o,r){e.current=s,n.current=!1,o.current&&(o.current=null,r())}function ol(e,t,n,s,o,r,l,c,i,u,d){if(!e)return()=>{};let f=!1,p=null;const m=()=>{if(f||!c.current)return;const x=t.getState();let y,D;try{y=s(x,o.current)}catch(C){D=C,p=C}D||(p=null),y===r.current?l.current||u():(r.current=y,i.current=y,l.current=!0,d())};return n.onStateChange=m,n.trySubscribe(),m(),()=>{if(f=!0,n.tryUnsubscribe(),n.onStateChange=null,p)throw p}}function al(e,t){return e===t}function ll(e,t,n,{pure:s,areStatesEqual:o=al,areOwnPropsEqual:r=Ut,areStatePropsEqual:l=Ut,areMergedPropsEqual:c=Ut,forwardRef:i=!1,context:u=ns}={}){const d=u,f=Ba(e),p=$a(t),m=La(n),g=!!e;return y=>{const D=y.displayName||y.name||"Component",C=`Connect(${D})`,T={shouldHandleStateChanges:g,displayName:C,wrappedComponentName:D,WrappedComponent:y,initMapStateToProps:f,initMapDispatchToProps:p,initMergeProps:m,areStatesEqual:o,areStatePropsEqual:l,areOwnPropsEqual:r,areMergedPropsEqual:c};function j(O){const[k,B,v]=h.useMemo(()=>{const{reactReduxForwardedRef:se,...je}=O;return[O.context,se,je]},[O]),N=h.useMemo(()=>{let se=d;return k!=null&&k.Consumer,se},[k,d]),G=h.useContext(N),A=!!O.store&&!!O.store.getState&&!!O.store.dispatch,I=!!G&&!!G.store,ne=A?O.store:G.store,Se=I?G.getServerState:ne.getState,be=h.useMemo(()=>Pa(ne.dispatch,T),[ne]),[z,L]=h.useMemo(()=>{if(!g)return nl;const se=es(ne,A?void 0:G.subscription),je=se.notifyNestedSubs.bind(se);return[se,je]},[ne,A,G]),M=h.useMemo(()=>A?G:{...G,subscription:z},[A,G,z]),he=h.useRef(void 0),Ge=h.useRef(v),De=h.useRef(void 0),at=h.useRef(!1),re=h.useRef(!1),we=h.useRef(void 0);Ct(()=>(re.current=!0,()=>{re.current=!1}),[]);const lt=h.useMemo(()=>()=>De.current&&v===Ge.current?De.current:be(ne.getState(),v),[ne,v]),Bt=h.useMemo(()=>je=>z?ol(g,ne,z,be,Ge,he,at,re,De,L,je):()=>{},[z]);rl(sl,[Ge,he,at,v,De,L]);let Te;try{Te=h.useSyncExternalStore(Bt,lt,Se?()=>be(Se(),v):lt)}catch(se){throw we.current&&(se.message+=`
The error may be correlated with this previous error:
${we.current.stack}

`),se}Ct(()=>{we.current=void 0,De.current=void 0,he.current=Te});const We=h.useMemo(()=>h.createElement(y,{...Te,ref:B}),[B,y,Te]);return h.useMemo(()=>g?h.createElement(N.Provider,{value:M},We):We,[N,We,M])}const E=h.memo(j);if(E.WrappedComponent=y,E.displayName=j.displayName=C,i){const k=h.forwardRef(function(v,N){return h.createElement(E,{...v,reactReduxForwardedRef:N})});return k.displayName=C,k.WrappedComponent=y,nn(k,y)}return nn(E,y)}}var rs=ll;function il(e){const{children:t,context:n,serverState:s,store:o}=e,r=h.useMemo(()=>{const i=es(o);return{store:o,subscription:i,getServerState:s?()=>s:void 0}},[o,s]),l=h.useMemo(()=>o.getState(),[o]);Ct(()=>{const{subscription:i}=r;return i.onStateChange=i.notifyNestedSubs,i.trySubscribe(),l!==o.getState()&&i.notifyNestedSubs(),()=>{i.tryUnsubscribe(),i.onStateChange=void 0}},[r,l]);const c=n||ns;return h.createElement(c.Provider,{value:r},t)}var cl=il,me=function(t){var n=t.top,s=t.right,o=t.bottom,r=t.left,l=s-r,c=o-n,i={top:n,right:s,bottom:o,left:r,width:l,height:c,x:r,y:n,center:{x:(s+r)/2,y:(o+n)/2}};return i},gn=function(t,n){return{top:t.top-n.top,left:t.left-n.left,bottom:t.bottom+n.bottom,right:t.right+n.right}},lr=function(t,n){return{top:t.top+n.top,left:t.left+n.left,bottom:t.bottom-n.bottom,right:t.right-n.right}},ul=function(t,n){return{top:t.top+n.y,left:t.left+n.x,bottom:t.bottom+n.y,right:t.right+n.x}},Vt={top:0,right:0,bottom:0,left:0},bn=function(t){var n=t.borderBox,s=t.margin,o=s===void 0?Vt:s,r=t.border,l=r===void 0?Vt:r,c=t.padding,i=c===void 0?Vt:c,u=me(gn(n,o)),d=me(lr(n,l)),f=me(lr(d,i));return{marginBox:u,borderBox:me(n),paddingBox:d,contentBox:f,margin:o,border:l,padding:i}},ue=function(t){var n=t.slice(0,-2),s=t.slice(-2);if(s!=="px")return 0;var o=Number(n);return isNaN(o)&&_o(),o},dl=function(){return{x:window.pageXOffset,y:window.pageYOffset}},Nt=function(t,n){var s=t.borderBox,o=t.border,r=t.margin,l=t.padding,c=ul(s,n);return bn({borderBox:c,border:o,margin:r,padding:l})},St=function(t,n){return n===void 0&&(n=dl()),Nt(t,n)},ss=function(t,n){var s={top:ue(n.marginTop),right:ue(n.marginRight),bottom:ue(n.marginBottom),left:ue(n.marginLeft)},o={top:ue(n.paddingTop),right:ue(n.paddingRight),bottom:ue(n.paddingBottom),left:ue(n.paddingLeft)},r={top:ue(n.borderTopWidth),right:ue(n.borderRightWidth),bottom:ue(n.borderBottomWidth),left:ue(n.borderLeftWidth)};return bn({borderBox:t,margin:s,padding:o,border:r})},os=function(t){var n=t.getBoundingClientRect(),s=window.getComputedStyle(t);return ss(n,s)},Ke=function(t){var n=[],s=null,o=function(){for(var l=arguments.length,c=new Array(l),i=0;i<l;i++)c[i]=arguments[i];n=c,!s&&(s=requestAnimationFrame(function(){s=null,t.apply(void 0,n)}))};return o.cancel=function(){s&&(cancelAnimationFrame(s),s=null)},o};function as(e,t){}as.bind(null,"warn");as.bind(null,"error");function ve(){}function pl(e,t){return{...e,...t}}function de(e,t,n){const s=t.map(o=>{const r=pl(n,o.options);return e.addEventListener(o.eventName,o.fn,r),function(){e.removeEventListener(o.eventName,o.fn,r)}});return function(){s.forEach(r=>{r()})}}const fl="Invariant failed";class Dt extends Error{}Dt.prototype.toString=function(){return this.message};function S(e,t){throw new Dt(fl)}class ml extends V.Component{constructor(...t){super(...t),this.callbacks=null,this.unbind=ve,this.onWindowError=n=>{const s=this.getCallbacks();s.isDragging()&&s.tryAbort(),n.error instanceof Dt&&n.preventDefault()},this.getCallbacks=()=>{if(!this.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return this.callbacks},this.setCallbacks=n=>{this.callbacks=n}}componentDidMount(){this.unbind=de(window,[{eventName:"error",fn:this.onWindowError}])}componentDidCatch(t){if(t instanceof Dt){this.setState({});return}throw t}componentWillUnmount(){this.unbind()}render(){return this.props.children(this.setCallbacks)}}const hl=`
  Press space bar to start a drag.
  When dragging you can use the arrow keys to move the item around and escape to cancel.
  Some screen readers may require you to be in focus mode or to use your pass through key
`,jt=e=>e+1,gl=e=>`
  You have lifted an item in position ${jt(e.source.index)}
`,ls=(e,t)=>{const n=e.droppableId===t.droppableId,s=jt(e.index),o=jt(t.index);return n?`
      You have moved the item from position ${s}
      to position ${o}
    `:`
    You have moved the item from position ${s}
    in list ${e.droppableId}
    to list ${t.droppableId}
    in position ${o}
  `},is=(e,t,n)=>t.droppableId===n.droppableId?`
      The item ${e}
      has been combined with ${n.draggableId}`:`
      The item ${e}
      in list ${t.droppableId}
      has been combined with ${n.draggableId}
      in list ${n.droppableId}
    `,bl=e=>{const t=e.destination;if(t)return ls(e.source,t);const n=e.combine;return n?is(e.draggableId,e.source,n):"You are over an area that cannot be dropped on"},ir=e=>`
  The item has returned to its starting position
  of ${jt(e.index)}
`,xl=e=>{if(e.reason==="CANCEL")return`
      Movement cancelled.
      ${ir(e.source)}
    `;const t=e.destination,n=e.combine;return t?`
      You have dropped the item.
      ${ls(e.source,t)}
    `:n?`
      You have dropped the item.
      ${is(e.draggableId,e.source,n)}
    `:`
    The item has been dropped while not over a drop area.
    ${ir(e.source)}
  `},yt={dragHandleUsageInstructions:hl,onDragStart:gl,onDragUpdate:bl,onDragEnd:xl};function yl(e,t){return!!(e===t||Number.isNaN(e)&&Number.isNaN(t))}function cs(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!yl(e[n],t[n]))return!1;return!0}function F(e,t){const n=h.useState(()=>({inputs:t,result:e()}))[0],s=h.useRef(!0),o=h.useRef(n),l=s.current||!!(t&&o.current.inputs&&cs(t,o.current.inputs))?o.current:{inputs:t,result:e()};return h.useEffect(()=>{s.current=!1,o.current=l},[l]),l.result}function w(e,t){return F(()=>e,t)}const X={x:0,y:0},Z=(e,t)=>({x:e.x+t.x,y:e.y+t.y}),oe=(e,t)=>({x:e.x-t.x,y:e.y-t.y}),Ce=(e,t)=>e.x===t.x&&e.y===t.y,Fe=e=>({x:e.x!==0?-e.x:0,y:e.y!==0?-e.y:0}),Ee=(e,t,n=0)=>e==="x"?{x:t,y:n}:{x:n,y:t},Xe=(e,t)=>Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2),cr=(e,t)=>Math.min(...t.map(n=>Xe(e,n))),us=e=>t=>({x:e(t.x),y:e(t.y)});var vl=(e,t)=>{const n=me({top:Math.max(t.top,e.top),right:Math.min(t.right,e.right),bottom:Math.min(t.bottom,e.bottom),left:Math.max(t.left,e.left)});return n.width<=0||n.height<=0?null:n};const st=(e,t)=>({top:e.top+t.y,left:e.left+t.x,bottom:e.bottom+t.y,right:e.right+t.x}),ur=e=>[{x:e.left,y:e.top},{x:e.right,y:e.top},{x:e.left,y:e.bottom},{x:e.right,y:e.bottom}],Cl={top:0,right:0,bottom:0,left:0},Nl=(e,t)=>t?st(e,t.scroll.diff.displacement):e,Sl=(e,t,n)=>n&&n.increasedBy?{...e,[t.end]:e[t.end]+n.increasedBy[t.line]}:e,Dl=(e,t)=>t&&t.shouldClipSubject?vl(t.pageMarginBox,e):me(e);var Ae=({page:e,withPlaceholder:t,axis:n,frame:s})=>{const o=Nl(e.marginBox,s),r=Sl(o,n,t),l=Dl(r,s);return{page:e,withPlaceholder:t,active:l}},xn=(e,t)=>{e.frame||S();const n=e.frame,s=oe(t,n.scroll.initial),o=Fe(s),r={...n,scroll:{initial:n.scroll.initial,current:t,diff:{value:s,displacement:o},max:n.scroll.max}},l=Ae({page:e.subject.page,withPlaceholder:e.subject.withPlaceholder,axis:e.axis,frame:r});return{...e,frame:r,subject:l}};function K(e,t=cs){let n=null;function s(...o){if(n&&n.lastThis===this&&t(o,n.lastArgs))return n.lastResult;const r=e.apply(this,o);return n={lastResult:r,lastArgs:o,lastThis:this},r}return s.clear=function(){n=null},s}const ds=K(e=>e.reduce((t,n)=>(t[n.descriptor.id]=n,t),{})),ps=K(e=>e.reduce((t,n)=>(t[n.descriptor.id]=n,t),{})),Et=K(e=>Object.values(e)),jl=K(e=>Object.values(e));var _e=K((e,t)=>jl(t).filter(s=>e===s.descriptor.droppableId).sort((s,o)=>s.descriptor.index-o.descriptor.index));function yn(e){return e.at&&e.at.type==="REORDER"?e.at.destination:null}function wt(e){return e.at&&e.at.type==="COMBINE"?e.at.combine:null}var Tt=K((e,t)=>t.filter(n=>n.descriptor.id!==e.descriptor.id)),kl=({isMovingForward:e,draggable:t,destination:n,insideDestination:s,previousImpact:o})=>{if(!n.isCombineEnabled||!yn(o))return null;function l(m){const g={type:"COMBINE",combine:{draggableId:m,droppableId:n.descriptor.id}};return{...o,at:g}}const c=o.displaced.all,i=c.length?c[0]:null;if(e)return i?l(i):null;const u=Tt(t,s);if(!i){if(!u.length)return null;const m=u[u.length-1];return l(m.descriptor.id)}const d=u.findIndex(m=>m.descriptor.id===i);d===-1&&S();const f=d-1;if(f<0)return null;const p=u[f];return l(p.descriptor.id)},Le=(e,t)=>e.descriptor.droppableId===t.descriptor.id;const fs={point:X,value:0},Ze={invisible:{},visible:{},all:[]},Rl={displaced:Ze,displacedBy:fs,at:null};var pe=(e,t)=>n=>e<=n&&n<=t,ms=e=>{const t=pe(e.top,e.bottom),n=pe(e.left,e.right);return s=>{if(t(s.top)&&t(s.bottom)&&n(s.left)&&n(s.right))return!0;const r=t(s.top)||t(s.bottom),l=n(s.left)||n(s.right);if(r&&l)return!0;const i=s.top<e.top&&s.bottom>e.bottom,u=s.left<e.left&&s.right>e.right;return i&&u?!0:i&&l||u&&r}},Il=e=>{const t=pe(e.top,e.bottom),n=pe(e.left,e.right);return s=>t(s.top)&&t(s.bottom)&&n(s.left)&&n(s.right)};const vn={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},hs={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"};var El=e=>t=>{const n=pe(t.top,t.bottom),s=pe(t.left,t.right);return o=>e===vn?n(o.top)&&n(o.bottom):s(o.left)&&s(o.right)};const wl=(e,t)=>{const n=t.frame?t.frame.scroll.diff.displacement:X;return st(e,n)},Tl=(e,t,n)=>t.subject.active?n(t.subject.active)(e):!1,Ol=(e,t,n)=>n(t)(e),Cn=({target:e,destination:t,viewport:n,withDroppableDisplacement:s,isVisibleThroughFrameFn:o})=>{const r=s?wl(e,t):e;return Tl(r,t,o)&&Ol(r,n,o)},Pl=e=>Cn({...e,isVisibleThroughFrameFn:ms}),gs=e=>Cn({...e,isVisibleThroughFrameFn:Il}),Al=e=>Cn({...e,isVisibleThroughFrameFn:El(e.destination.axis)}),$l=(e,t,n)=>{if(typeof n=="boolean")return n;if(!t)return!0;const{invisible:s,visible:o}=t;if(s[e])return!1;const r=o[e];return r?r.shouldAnimate:!0};function Bl(e,t){const n=e.page.marginBox,s={top:t.point.y,right:0,bottom:0,left:t.point.x};return me(gn(n,s))}function Qe({afterDragging:e,destination:t,displacedBy:n,viewport:s,forceShouldAnimate:o,last:r}){return e.reduce(function(c,i){const u=Bl(i,n),d=i.descriptor.id;if(c.all.push(d),!Pl({target:u,destination:t,viewport:s,withDroppableDisplacement:!0}))return c.invisible[i.descriptor.id]=!0,c;const p=$l(d,r,o),m={draggableId:d,shouldAnimate:p};return c.visible[d]=m,c},{all:[],visible:{},invisible:{}})}function Fl(e,t){if(!e.length)return 0;const n=e[e.length-1].descriptor.index;return t.inHomeList?n:n+1}function dr({insideDestination:e,inHomeList:t,displacedBy:n,destination:s}){const o=Fl(e,{inHomeList:t});return{displaced:Ze,displacedBy:n,at:{type:"REORDER",destination:{droppableId:s.descriptor.id,index:o}}}}function kt({draggable:e,insideDestination:t,destination:n,viewport:s,displacedBy:o,last:r,index:l,forceShouldAnimate:c}){const i=Le(e,n);if(l==null)return dr({insideDestination:t,inHomeList:i,displacedBy:o,destination:n});const u=t.find(g=>g.descriptor.index===l);if(!u)return dr({insideDestination:t,inHomeList:i,displacedBy:o,destination:n});const d=Tt(e,t),f=t.indexOf(u),p=d.slice(f);return{displaced:Qe({afterDragging:p,destination:n,displacedBy:o,last:r,viewport:s.frame,forceShouldAnimate:c}),displacedBy:o,at:{type:"REORDER",destination:{droppableId:n.descriptor.id,index:l}}}}function Ne(e,t){return!!t.effected[e]}var _l=({isMovingForward:e,destination:t,draggables:n,combine:s,afterCritical:o})=>{if(!t.isCombineEnabled)return null;const r=s.draggableId,c=n[r].descriptor.index;return Ne(r,o)?e?c:c-1:e?c+1:c},Ll=({isMovingForward:e,isInHomeList:t,insideDestination:n,location:s})=>{if(!n.length)return null;const o=s.index,r=e?o+1:o-1,l=n[0].descriptor.index,c=n[n.length-1].descriptor.index,i=t?c:c+1;return r<l||r>i?null:r},Gl=({isMovingForward:e,isInHomeList:t,draggable:n,draggables:s,destination:o,insideDestination:r,previousImpact:l,viewport:c,afterCritical:i})=>{const u=l.at;if(u||S(),u.type==="REORDER"){const f=Ll({isMovingForward:e,isInHomeList:t,location:u.destination,insideDestination:r});return f==null?null:kt({draggable:n,insideDestination:r,destination:o,viewport:c,last:l.displaced,displacedBy:l.displacedBy,index:f})}const d=_l({isMovingForward:e,destination:o,displaced:l.displaced,draggables:s,combine:u.combine,afterCritical:i});return d==null?null:kt({draggable:n,insideDestination:r,destination:o,viewport:c,last:l.displaced,displacedBy:l.displacedBy,index:d})},Wl=({displaced:e,afterCritical:t,combineWith:n,displacedBy:s})=>{const o=!!(e.visible[n]||e.invisible[n]);return Ne(n,t)?o?X:Fe(s.point):o?s.point:X},Ul=({afterCritical:e,impact:t,draggables:n})=>{const s=wt(t);s||S();const o=s.draggableId,r=n[o].page.borderBox.center,l=Wl({displaced:t.displaced,afterCritical:e,combineWith:o,displacedBy:t.displacedBy});return Z(r,l)};const bs=(e,t)=>t.margin[e.start]+t.borderBox[e.size]/2,Hl=(e,t)=>t.margin[e.end]+t.borderBox[e.size]/2,Nn=(e,t,n)=>t[e.crossAxisStart]+n.margin[e.crossAxisStart]+n.borderBox[e.crossAxisSize]/2,pr=({axis:e,moveRelativeTo:t,isMoving:n})=>Ee(e.line,t.marginBox[e.end]+bs(e,n),Nn(e,t.marginBox,n)),fr=({axis:e,moveRelativeTo:t,isMoving:n})=>Ee(e.line,t.marginBox[e.start]-Hl(e,n),Nn(e,t.marginBox,n)),zl=({axis:e,moveInto:t,isMoving:n})=>Ee(e.line,t.contentBox[e.start]+bs(e,n),Nn(e,t.contentBox,n));var Vl=({impact:e,draggable:t,draggables:n,droppable:s,afterCritical:o})=>{const r=_e(s.descriptor.id,n),l=t.page,c=s.axis;if(!r.length)return zl({axis:c,moveInto:s.page,isMoving:l});const{displaced:i,displacedBy:u}=e,d=i.all[0];if(d){const p=n[d];if(Ne(d,o))return fr({axis:c,moveRelativeTo:p.page,isMoving:l});const m=Nt(p.page,u.point);return fr({axis:c,moveRelativeTo:m,isMoving:l})}const f=r[r.length-1];if(f.descriptor.id===t.descriptor.id)return l.borderBox.center;if(Ne(f.descriptor.id,o)){const p=Nt(f.page,Fe(o.displacedBy.point));return pr({axis:c,moveRelativeTo:p,isMoving:l})}return pr({axis:c,moveRelativeTo:f.page,isMoving:l})},rn=(e,t)=>{const n=e.frame;return n?Z(t,n.scroll.diff.displacement):t};const Ml=({impact:e,draggable:t,droppable:n,draggables:s,afterCritical:o})=>{const r=t.page.borderBox.center,l=e.at;return!n||!l?r:l.type==="REORDER"?Vl({impact:e,draggable:t,draggables:s,droppable:n,afterCritical:o}):Ul({impact:e,draggables:s,afterCritical:o})};var Ot=e=>{const t=Ml(e),n=e.droppable;return n?rn(n,t):t},xs=(e,t)=>{const n=oe(t,e.scroll.initial),s=Fe(n);return{frame:me({top:t.y,bottom:t.y+e.frame.height,left:t.x,right:t.x+e.frame.width}),scroll:{initial:e.scroll.initial,max:e.scroll.max,current:t,diff:{value:n,displacement:s}}}};function mr(e,t){return e.map(n=>t[n])}function ql(e,t){for(let n=0;n<t.length;n++){const s=t[n].visible[e];if(s)return s}return null}var Yl=({impact:e,viewport:t,destination:n,draggables:s,maxScrollChange:o})=>{const r=xs(t,Z(t.scroll.current,o)),l=n.frame?xn(n,Z(n.frame.scroll.current,o)):n,c=e.displaced,i=Qe({afterDragging:mr(c.all,s),destination:n,displacedBy:e.displacedBy,viewport:r.frame,last:c,forceShouldAnimate:!1}),u=Qe({afterDragging:mr(c.all,s),destination:l,displacedBy:e.displacedBy,viewport:t.frame,last:c,forceShouldAnimate:!1}),d={},f={},p=[c,i,u];return c.all.forEach(g=>{const x=ql(g,p);if(x){f[g]=x;return}d[g]=!0}),{...e,displaced:{all:c.all,invisible:d,visible:f}}},Jl=(e,t)=>Z(e.scroll.diff.displacement,t),Sn=({pageBorderBoxCenter:e,draggable:t,viewport:n})=>{const s=Jl(n,e),o=oe(s,t.page.borderBox.center);return Z(t.client.borderBox.center,o)},ys=({draggable:e,destination:t,newPageBorderBoxCenter:n,viewport:s,withDroppableDisplacement:o,onlyOnMainAxis:r=!1})=>{const l=oe(n,e.page.borderBox.center),i={target:st(e.page.borderBox,l),destination:t,withDroppableDisplacement:o,viewport:s};return r?Al(i):gs(i)},Kl=({isMovingForward:e,draggable:t,destination:n,draggables:s,previousImpact:o,viewport:r,previousPageBorderBoxCenter:l,previousClientSelection:c,afterCritical:i})=>{if(!n.isEnabled)return null;const u=_e(n.descriptor.id,s),d=Le(t,n),f=kl({isMovingForward:e,draggable:t,destination:n,insideDestination:u,previousImpact:o})||Gl({isMovingForward:e,isInHomeList:d,draggable:t,draggables:s,destination:n,insideDestination:u,previousImpact:o,viewport:r,afterCritical:i});if(!f)return null;const p=Ot({impact:f,draggable:t,droppable:n,draggables:s,afterCritical:i});if(ys({draggable:t,destination:n,newPageBorderBoxCenter:p,viewport:r.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0}))return{clientSelection:Sn({pageBorderBoxCenter:p,draggable:t,viewport:r}),impact:f,scrollJumpRequest:null};const g=oe(p,l),x=Yl({impact:f,viewport:r,destination:n,draggables:s,maxScrollChange:g});return{clientSelection:c,impact:x,scrollJumpRequest:g}};const ee=e=>{const t=e.subject.active;return t||S(),t};var Xl=({isMovingForward:e,pageBorderBoxCenter:t,source:n,droppables:s,viewport:o})=>{const r=n.subject.active;if(!r)return null;const l=n.axis,c=pe(r[l.start],r[l.end]),i=Et(s).filter(d=>d!==n).filter(d=>d.isEnabled).filter(d=>!!d.subject.active).filter(d=>ms(o.frame)(ee(d))).filter(d=>{const f=ee(d);return e?r[l.crossAxisEnd]<f[l.crossAxisEnd]:f[l.crossAxisStart]<r[l.crossAxisStart]}).filter(d=>{const f=ee(d),p=pe(f[l.start],f[l.end]);return c(f[l.start])||c(f[l.end])||p(r[l.start])||p(r[l.end])}).sort((d,f)=>{const p=ee(d)[l.crossAxisStart],m=ee(f)[l.crossAxisStart];return e?p-m:m-p}).filter((d,f,p)=>ee(d)[l.crossAxisStart]===ee(p[0])[l.crossAxisStart]);if(!i.length)return null;if(i.length===1)return i[0];const u=i.filter(d=>pe(ee(d)[l.start],ee(d)[l.end])(t[l.line]));return u.length===1?u[0]:u.length>1?u.sort((d,f)=>ee(d)[l.start]-ee(f)[l.start])[0]:i.sort((d,f)=>{const p=cr(t,ur(ee(d))),m=cr(t,ur(ee(f)));return p!==m?p-m:ee(d)[l.start]-ee(f)[l.start]})[0]};const hr=(e,t)=>{const n=e.page.borderBox.center;return Ne(e.descriptor.id,t)?oe(n,t.displacedBy.point):n},Zl=(e,t)=>{const n=e.page.borderBox;return Ne(e.descriptor.id,t)?st(n,Fe(t.displacedBy.point)):n};var Ql=({pageBorderBoxCenter:e,viewport:t,destination:n,insideDestination:s,afterCritical:o})=>s.filter(l=>gs({target:Zl(l,o),destination:n,viewport:t.frame,withDroppableDisplacement:!0})).sort((l,c)=>{const i=Xe(e,rn(n,hr(l,o))),u=Xe(e,rn(n,hr(c,o)));return i<u?-1:u<i?1:l.descriptor.index-c.descriptor.index})[0]||null,ot=K(function(t,n){const s=n[t.line];return{value:s,point:Ee(t.line,s)}});const ei=(e,t,n)=>{const s=e.axis;if(e.descriptor.mode==="virtual")return Ee(s.line,t[s.line]);const o=e.subject.page.contentBox[s.size],i=_e(e.descriptor.id,n).reduce((u,d)=>u+d.client.marginBox[s.size],0)+t[s.line]-o;return i<=0?null:Ee(s.line,i)},vs=(e,t)=>({...e,scroll:{...e.scroll,max:t}}),Cs=(e,t,n)=>{const s=e.frame;Le(t,e)&&S(),e.subject.withPlaceholder&&S();const o=ot(e.axis,t.displaceBy).point,r=ei(e,o,n),l={placeholderSize:o,increasedBy:r,oldFrameMaxScroll:e.frame?e.frame.scroll.max:null};if(!s){const d=Ae({page:e.subject.page,withPlaceholder:l,axis:e.axis,frame:e.frame});return{...e,subject:d}}const c=r?Z(s.scroll.max,r):s.scroll.max,i=vs(s,c),u=Ae({page:e.subject.page,withPlaceholder:l,axis:e.axis,frame:i});return{...e,subject:u,frame:i}},ti=e=>{const t=e.subject.withPlaceholder;t||S();const n=e.frame;if(!n){const l=Ae({page:e.subject.page,axis:e.axis,frame:null,withPlaceholder:null});return{...e,subject:l}}const s=t.oldFrameMaxScroll;s||S();const o=vs(n,s),r=Ae({page:e.subject.page,axis:e.axis,frame:o,withPlaceholder:null});return{...e,subject:r,frame:o}};var ni=({previousPageBorderBoxCenter:e,moveRelativeTo:t,insideDestination:n,draggable:s,draggables:o,destination:r,viewport:l,afterCritical:c})=>{if(!t){if(n.length)return null;const f={displaced:Ze,displacedBy:fs,at:{type:"REORDER",destination:{droppableId:r.descriptor.id,index:0}}},p=Ot({impact:f,draggable:s,droppable:r,draggables:o,afterCritical:c}),m=Le(s,r)?r:Cs(r,s,o);return ys({draggable:s,destination:m,newPageBorderBoxCenter:p,viewport:l.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0})?f:null}const i=e[r.axis.line]<=t.page.borderBox.center[r.axis.line],u=(()=>{const f=t.descriptor.index;return t.descriptor.id===s.descriptor.id||i?f:f+1})(),d=ot(r.axis,s.displaceBy);return kt({draggable:s,insideDestination:n,destination:r,viewport:l,displacedBy:d,last:Ze,index:u})},ri=({isMovingForward:e,previousPageBorderBoxCenter:t,draggable:n,isOver:s,draggables:o,droppables:r,viewport:l,afterCritical:c})=>{const i=Xl({isMovingForward:e,pageBorderBoxCenter:t,source:s,droppables:r,viewport:l});if(!i)return null;const u=_e(i.descriptor.id,o),d=Ql({pageBorderBoxCenter:t,viewport:l,destination:i,insideDestination:u,afterCritical:c}),f=ni({previousPageBorderBoxCenter:t,destination:i,draggable:n,draggables:o,moveRelativeTo:d,insideDestination:u,viewport:l,afterCritical:c});if(!f)return null;const p=Ot({impact:f,draggable:n,droppable:i,draggables:o,afterCritical:c});return{clientSelection:Sn({pageBorderBoxCenter:p,draggable:n,viewport:l}),impact:f,scrollJumpRequest:null}},ae=e=>{const t=e.at;return t?t.type==="REORDER"?t.destination.droppableId:t.combine.droppableId:null};const si=(e,t)=>{const n=ae(e);return n?t[n]:null};var oi=({state:e,type:t})=>{const n=si(e.impact,e.dimensions.droppables),s=!!n,o=e.dimensions.droppables[e.critical.droppable.id],r=n||o,l=r.axis.direction,c=l==="vertical"&&(t==="MOVE_UP"||t==="MOVE_DOWN")||l==="horizontal"&&(t==="MOVE_LEFT"||t==="MOVE_RIGHT");if(c&&!s)return null;const i=t==="MOVE_DOWN"||t==="MOVE_RIGHT",u=e.dimensions.draggables[e.critical.draggable.id],d=e.current.page.borderBoxCenter,{draggables:f,droppables:p}=e.dimensions;return c?Kl({isMovingForward:i,previousPageBorderBoxCenter:d,draggable:u,destination:r,draggables:f,viewport:e.viewport,previousClientSelection:e.current.client.selection,previousImpact:e.impact,afterCritical:e.afterCritical}):ri({isMovingForward:i,previousPageBorderBoxCenter:d,draggable:u,isOver:r,draggables:f,droppables:p,viewport:e.viewport,afterCritical:e.afterCritical})};function Re(e){return e.phase==="DRAGGING"||e.phase==="COLLECTING"}function Ns(e){const t=pe(e.top,e.bottom),n=pe(e.left,e.right);return function(o){return t(o.y)&&n(o.x)}}function ai(e,t){return e.left<t.right&&e.right>t.left&&e.top<t.bottom&&e.bottom>t.top}function li({pageBorderBox:e,draggable:t,candidates:n}){const s=t.page.borderBox.center,o=n.map(r=>{const l=r.axis,c=Ee(r.axis.line,e.center[l.line],r.page.borderBox.center[l.crossAxisLine]);return{id:r.descriptor.id,distance:Xe(s,c)}}).sort((r,l)=>l.distance-r.distance);return o[0]?o[0].id:null}function ii({pageBorderBox:e,draggable:t,droppables:n}){const s=Et(n).filter(o=>{if(!o.isEnabled)return!1;const r=o.subject.active;if(!r||!ai(e,r))return!1;if(Ns(r)(e.center))return!0;const l=o.axis,c=r.center[l.crossAxisLine],i=e[l.crossAxisStart],u=e[l.crossAxisEnd],d=pe(r[l.crossAxisStart],r[l.crossAxisEnd]),f=d(i),p=d(u);return!f&&!p?!0:f?i<c:u>c});return s.length?s.length===1?s[0].descriptor.id:li({pageBorderBox:e,draggable:t,candidates:s}):null}const Ss=(e,t)=>me(st(e,t));var ci=(e,t)=>{const n=e.frame;return n?Ss(t,n.scroll.diff.value):t};function Ds({displaced:e,id:t}){return!!(e.visible[t]||e.invisible[t])}function ui({draggable:e,closest:t,inHomeList:n}){return t?n&&t.descriptor.index>e.descriptor.index?t.descriptor.index-1:t.descriptor.index:null}var di=({pageBorderBoxWithDroppableScroll:e,draggable:t,destination:n,insideDestination:s,last:o,viewport:r,afterCritical:l})=>{const c=n.axis,i=ot(n.axis,t.displaceBy),u=i.value,d=e[c.start],f=e[c.end],m=Tt(t,s).find(x=>{const y=x.descriptor.id,D=x.page.borderBox.center[c.line],C=Ne(y,l),T=Ds({displaced:o,id:y});return C?T?f<=D:d<D-u:T?f<=D+u:d<D})||null,g=ui({draggable:t,closest:m,inHomeList:Le(t,n)});return kt({draggable:t,insideDestination:s,destination:n,viewport:r,last:o,displacedBy:i,index:g})};const pi=4;var fi=({draggable:e,pageBorderBoxWithDroppableScroll:t,previousImpact:n,destination:s,insideDestination:o,afterCritical:r})=>{if(!s.isCombineEnabled)return null;const l=s.axis,c=ot(s.axis,e.displaceBy),i=c.value,u=t[l.start],d=t[l.end],p=Tt(e,o).find(g=>{const x=g.descriptor.id,y=g.page.borderBox,C=y[l.size]/pi,T=Ne(x,r),j=Ds({displaced:n.displaced,id:x});return T?j?d>y[l.start]+C&&d<y[l.end]-C:u>y[l.start]-i+C&&u<y[l.end]-i-C:j?d>y[l.start]+i+C&&d<y[l.end]+i-C:u>y[l.start]+C&&u<y[l.end]-C});return p?{displacedBy:c,displaced:n.displaced,at:{type:"COMBINE",combine:{draggableId:p.descriptor.id,droppableId:s.descriptor.id}}}:null},js=({pageOffset:e,draggable:t,draggables:n,droppables:s,previousImpact:o,viewport:r,afterCritical:l})=>{const c=Ss(t.page.borderBox,e),i=ii({pageBorderBox:c,draggable:t,droppables:s});if(!i)return Rl;const u=s[i],d=_e(u.descriptor.id,n),f=ci(u,c);return fi({pageBorderBoxWithDroppableScroll:f,draggable:t,previousImpact:o,destination:u,insideDestination:d,afterCritical:l})||di({pageBorderBoxWithDroppableScroll:f,draggable:t,destination:u,insideDestination:d,last:o.displaced,viewport:r,afterCritical:l})},Dn=(e,t)=>({...e,[t.descriptor.id]:t});const mi=({previousImpact:e,impact:t,droppables:n})=>{const s=ae(e),o=ae(t);if(!s||s===o)return n;const r=n[s];if(!r.subject.withPlaceholder)return n;const l=ti(r);return Dn(n,l)};var hi=({draggable:e,draggables:t,droppables:n,previousImpact:s,impact:o})=>{const r=mi({previousImpact:s,impact:o,droppables:n}),l=ae(o);if(!l)return r;const c=n[l];if(Le(e,c)||c.subject.withPlaceholder)return r;const i=Cs(c,e,t);return Dn(r,i)},Ye=({state:e,clientSelection:t,dimensions:n,viewport:s,impact:o,scrollJumpRequest:r})=>{const l=s||e.viewport,c=n||e.dimensions,i=t||e.current.client.selection,u=oe(i,e.initial.client.selection),d={offset:u,selection:i,borderBoxCenter:Z(e.initial.client.borderBoxCenter,u)},f={selection:Z(d.selection,l.scroll.current),borderBoxCenter:Z(d.borderBoxCenter,l.scroll.current),offset:Z(d.offset,l.scroll.diff.value)},p={client:d,page:f};if(e.phase==="COLLECTING")return{...e,dimensions:c,viewport:l,current:p};const m=c.draggables[e.critical.draggable.id],g=o||js({pageOffset:f.offset,draggable:m,draggables:c.draggables,droppables:c.droppables,previousImpact:e.impact,viewport:l,afterCritical:e.afterCritical}),x=hi({draggable:m,impact:g,previousImpact:e.impact,draggables:c.draggables,droppables:c.droppables});return{...e,current:p,dimensions:{draggables:c.draggables,droppables:x},impact:g,viewport:l,scrollJumpRequest:r||null,forceShouldAnimate:r?!1:null}};function gi(e,t){return e.map(n=>t[n])}var ks=({impact:e,viewport:t,draggables:n,destination:s,forceShouldAnimate:o})=>{const r=e.displaced,l=gi(r.all,n),c=Qe({afterDragging:l,destination:s,displacedBy:e.displacedBy,viewport:t.frame,forceShouldAnimate:o,last:r});return{...e,displaced:c}},Rs=({impact:e,draggable:t,droppable:n,draggables:s,viewport:o,afterCritical:r})=>{const l=Ot({impact:e,draggable:t,draggables:s,droppable:n,afterCritical:r});return Sn({pageBorderBoxCenter:l,draggable:t,viewport:o})},Is=({state:e,dimensions:t,viewport:n})=>{e.movementMode!=="SNAP"&&S();const s=e.impact,o=n||e.viewport,r=t||e.dimensions,{draggables:l,droppables:c}=r,i=l[e.critical.draggable.id],u=ae(s);u||S();const d=c[u],f=ks({impact:s,viewport:o,destination:d,draggables:l}),p=Rs({impact:f,draggable:i,droppable:d,draggables:l,viewport:o,afterCritical:e.afterCritical});return Ye({impact:f,clientSelection:p,state:e,dimensions:r,viewport:o})},bi=e=>({index:e.index,droppableId:e.droppableId}),Es=({draggable:e,home:t,draggables:n,viewport:s})=>{const o=ot(t.axis,e.displaceBy),r=_e(t.descriptor.id,n),l=r.indexOf(e);l===-1&&S();const c=r.slice(l+1),i=c.reduce((p,m)=>(p[m.descriptor.id]=!0,p),{}),u={inVirtualList:t.descriptor.mode==="virtual",displacedBy:o,effected:i};return{impact:{displaced:Qe({afterDragging:c,destination:t,displacedBy:o,last:null,viewport:s.frame,forceShouldAnimate:!1}),displacedBy:o,at:{type:"REORDER",destination:bi(e.descriptor)}},afterCritical:u}},xi=(e,t)=>({draggables:e.draggables,droppables:Dn(e.droppables,t)}),yi=({draggable:e,offset:t,initialWindowScroll:n})=>{const s=Nt(e.client,t),o=St(s,n);return{...e,placeholder:{...e.placeholder,client:s},client:s,page:o}},vi=e=>{const t=e.frame;return t||S(),t},Ci=({additions:e,updatedDroppables:t,viewport:n})=>{const s=n.scroll.diff.value;return e.map(o=>{const r=o.descriptor.droppableId,l=t[r],i=vi(l).scroll.diff.value,u=Z(s,i);return yi({draggable:o,offset:u,initialWindowScroll:n.scroll.initial})})},Ni=({state:e,published:t})=>{const n=t.modified.map(D=>{const C=e.dimensions.droppables[D.droppableId];return xn(C,D.scroll)}),s={...e.dimensions.droppables,...ds(n)},o=ps(Ci({additions:t.additions,updatedDroppables:s,viewport:e.viewport})),r={...e.dimensions.draggables,...o};t.removals.forEach(D=>{delete r[D]});const l={droppables:s,draggables:r},c=ae(e.impact),i=c?l.droppables[c]:null,u=l.draggables[e.critical.draggable.id],d=l.droppables[e.critical.droppable.id],{impact:f,afterCritical:p}=Es({draggable:u,home:d,draggables:r,viewport:e.viewport}),m=i&&i.isCombineEnabled?e.impact:f,g=js({pageOffset:e.current.page.offset,draggable:l.draggables[e.critical.draggable.id],draggables:l.draggables,droppables:l.droppables,previousImpact:m,viewport:e.viewport,afterCritical:p}),x={...e,phase:"DRAGGING",impact:g,onLiftImpact:f,dimensions:l,afterCritical:p,forceShouldAnimate:!1};return e.phase==="COLLECTING"?x:{...x,phase:"DROP_PENDING",reason:e.reason,isWaiting:!1}};const sn=e=>e.movementMode==="SNAP",Mt=(e,t,n)=>{const s=xi(e.dimensions,t);return!sn(e)||n?Ye({state:e,dimensions:s}):Is({state:e,dimensions:s})};function qt(e){return e.isDragging&&e.movementMode==="SNAP"?{...e,scrollJumpRequest:null}:e}const gr={phase:"IDLE",completed:null,shouldFlush:!1};var Si=(e=gr,t)=>{if(t.type==="FLUSH")return{...gr,shouldFlush:!0};if(t.type==="INITIAL_PUBLISH"){e.phase!=="IDLE"&&S();const{critical:n,clientSelection:s,viewport:o,dimensions:r,movementMode:l}=t.payload,c=r.draggables[n.draggable.id],i=r.droppables[n.droppable.id],u={selection:s,borderBoxCenter:c.client.borderBox.center,offset:X},d={client:u,page:{selection:Z(u.selection,o.scroll.initial),borderBoxCenter:Z(u.selection,o.scroll.initial),offset:Z(u.selection,o.scroll.diff.value)}},f=Et(r.droppables).every(x=>!x.isFixedOnPage),{impact:p,afterCritical:m}=Es({draggable:c,home:i,draggables:r.draggables,viewport:o});return{phase:"DRAGGING",isDragging:!0,critical:n,movementMode:l,dimensions:r,initial:d,current:d,isWindowScrollAllowed:f,impact:p,afterCritical:m,onLiftImpact:p,viewport:o,scrollJumpRequest:null,forceShouldAnimate:null}}if(t.type==="COLLECTION_STARTING")return e.phase==="COLLECTING"||e.phase==="DROP_PENDING"?e:(e.phase!=="DRAGGING"&&S(),{...e,phase:"COLLECTING"});if(t.type==="PUBLISH_WHILE_DRAGGING")return e.phase==="COLLECTING"||e.phase==="DROP_PENDING"||S(),Ni({state:e,published:t.payload});if(t.type==="MOVE"){if(e.phase==="DROP_PENDING")return e;Re(e)||S();const{client:n}=t.payload;return Ce(n,e.current.client.selection)?e:Ye({state:e,clientSelection:n,impact:sn(e)?e.impact:null})}if(t.type==="UPDATE_DROPPABLE_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="COLLECTING")return qt(e);Re(e)||S();const{id:n,newScroll:s}=t.payload,o=e.dimensions.droppables[n];if(!o)return e;const r=xn(o,s);return Mt(e,r,!1)}if(t.type==="UPDATE_DROPPABLE_IS_ENABLED"){if(e.phase==="DROP_PENDING")return e;Re(e)||S();const{id:n,isEnabled:s}=t.payload,o=e.dimensions.droppables[n];o||S(),o.isEnabled===s&&S();const r={...o,isEnabled:s};return Mt(e,r,!0)}if(t.type==="UPDATE_DROPPABLE_IS_COMBINE_ENABLED"){if(e.phase==="DROP_PENDING")return e;Re(e)||S();const{id:n,isCombineEnabled:s}=t.payload,o=e.dimensions.droppables[n];o||S(),o.isCombineEnabled===s&&S();const r={...o,isCombineEnabled:s};return Mt(e,r,!0)}if(t.type==="MOVE_BY_WINDOW_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="DROP_ANIMATING")return e;Re(e)||S(),e.isWindowScrollAllowed||S();const n=t.payload.newScroll;if(Ce(e.viewport.scroll.current,n))return qt(e);const s=xs(e.viewport,n);return sn(e)?Is({state:e,viewport:s}):Ye({state:e,viewport:s})}if(t.type==="UPDATE_VIEWPORT_MAX_SCROLL"){if(!Re(e))return e;const n=t.payload.maxScroll;if(Ce(n,e.viewport.scroll.max))return e;const s={...e.viewport,scroll:{...e.viewport.scroll,max:n}};return{...e,viewport:s}}if(t.type==="MOVE_UP"||t.type==="MOVE_DOWN"||t.type==="MOVE_LEFT"||t.type==="MOVE_RIGHT"){if(e.phase==="COLLECTING"||e.phase==="DROP_PENDING")return e;e.phase!=="DRAGGING"&&S();const n=oi({state:e,type:t.type});return n?Ye({state:e,impact:n.impact,clientSelection:n.clientSelection,scrollJumpRequest:n.scrollJumpRequest}):e}if(t.type==="DROP_PENDING"){const n=t.payload.reason;return e.phase!=="COLLECTING"&&S(),{...e,phase:"DROP_PENDING",isWaiting:!0,reason:n}}if(t.type==="DROP_ANIMATE"){const{completed:n,dropDuration:s,newHomeClientOffset:o}=t.payload;return e.phase==="DRAGGING"||e.phase==="DROP_PENDING"||S(),{phase:"DROP_ANIMATING",completed:n,dropDuration:s,newHomeClientOffset:o,dimensions:e.dimensions}}if(t.type==="DROP_COMPLETE"){const{completed:n}=t.payload;return{phase:"IDLE",completed:n,shouldFlush:!1}}return e};function _(e,t){return e instanceof Object&&"type"in e&&e.type===t}const Di=e=>({type:"BEFORE_INITIAL_CAPTURE",payload:e}),ji=e=>({type:"LIFT",payload:e}),ki=e=>({type:"INITIAL_PUBLISH",payload:e}),Ri=e=>({type:"PUBLISH_WHILE_DRAGGING",payload:e}),Ii=()=>({type:"COLLECTION_STARTING",payload:null}),Ei=e=>({type:"UPDATE_DROPPABLE_SCROLL",payload:e}),wi=e=>({type:"UPDATE_DROPPABLE_IS_ENABLED",payload:e}),Ti=e=>({type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:e}),ws=e=>({type:"MOVE",payload:e}),Oi=e=>({type:"MOVE_BY_WINDOW_SCROLL",payload:e}),Pi=e=>({type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:e}),Ai=()=>({type:"MOVE_UP",payload:null}),$i=()=>({type:"MOVE_DOWN",payload:null}),Bi=()=>({type:"MOVE_RIGHT",payload:null}),Fi=()=>({type:"MOVE_LEFT",payload:null}),jn=()=>({type:"FLUSH",payload:null}),_i=e=>({type:"DROP_ANIMATE",payload:e}),kn=e=>({type:"DROP_COMPLETE",payload:e}),Ts=e=>({type:"DROP",payload:e}),Li=e=>({type:"DROP_PENDING",payload:e}),Os=()=>({type:"DROP_ANIMATION_FINISHED",payload:null});var Gi=e=>({getState:t,dispatch:n})=>s=>o=>{if(!_(o,"LIFT")){s(o);return}const{id:r,clientSelection:l,movementMode:c}=o.payload,i=t();i.phase==="DROP_ANIMATING"&&n(kn({completed:i.completed})),t().phase!=="IDLE"&&S(),n(jn()),n(Di({draggableId:r,movementMode:c}));const d={draggableId:r,scrollOptions:{shouldPublishImmediately:c==="SNAP"}},{critical:f,dimensions:p,viewport:m}=e.startPublishing(d);n(ki({critical:f,dimensions:p,clientSelection:l,movementMode:c,viewport:m}))},Wi=e=>()=>t=>n=>{_(n,"INITIAL_PUBLISH")&&e.dragging(),_(n,"DROP_ANIMATE")&&e.dropping(n.payload.completed.result.reason),(_(n,"FLUSH")||_(n,"DROP_COMPLETE"))&&e.resting(),t(n)};const Rn={outOfTheWay:"cubic-bezier(0.2, 0, 0, 1)",drop:"cubic-bezier(.2,1,.1,1)"},et={opacity:{drop:0,combining:.7},scale:{drop:.75}},Ps={outOfTheWay:.2,minDropTime:.33,maxDropTime:.55},ke=`${Ps.outOfTheWay}s ${Rn.outOfTheWay}`,Je={fluid:`opacity ${ke}`,snap:`transform ${ke}, opacity ${ke}`,drop:e=>{const t=`${e}s ${Rn.drop}`;return`transform ${t}, opacity ${t}`},outOfTheWay:`transform ${ke}`,placeholder:`height ${ke}, width ${ke}, margin ${ke}`},br=e=>Ce(e,X)?void 0:`translate(${e.x}px, ${e.y}px)`,on={moveTo:br,drop:(e,t)=>{const n=br(e);if(n)return t?`${n} scale(${et.scale.drop})`:n}},{minDropTime:an,maxDropTime:As}=Ps,Ui=As-an,xr=1500,Hi=.6;var zi=({current:e,destination:t,reason:n})=>{const s=Xe(e,t);if(s<=0)return an;if(s>=xr)return As;const o=s/xr,r=an+Ui*o,l=n==="CANCEL"?r*Hi:r;return Number(l.toFixed(2))},Vi=({impact:e,draggable:t,dimensions:n,viewport:s,afterCritical:o})=>{const{draggables:r,droppables:l}=n,c=ae(e),i=c?l[c]:null,u=l[t.descriptor.droppableId],d=Rs({impact:e,draggable:t,draggables:r,afterCritical:o,droppable:i||u,viewport:s});return oe(d,t.client.borderBox.center)},Mi=({draggables:e,reason:t,lastImpact:n,home:s,viewport:o,onLiftImpact:r})=>!n.at||t!=="DROP"?{impact:ks({draggables:e,impact:r,destination:s,viewport:o,forceShouldAnimate:!0}),didDropInsideDroppable:!1}:n.at.type==="REORDER"?{impact:n,didDropInsideDroppable:!0}:{impact:{...n,displaced:Ze},didDropInsideDroppable:!0};const qi=({getState:e,dispatch:t})=>n=>s=>{if(!_(s,"DROP")){n(s);return}const o=e(),r=s.payload.reason;if(o.phase==="COLLECTING"){t(Li({reason:r}));return}if(o.phase==="IDLE")return;o.phase==="DROP_PENDING"&&o.isWaiting&&S(),o.phase==="DRAGGING"||o.phase==="DROP_PENDING"||S();const c=o.critical,i=o.dimensions,u=i.draggables[o.critical.draggable.id],{impact:d,didDropInsideDroppable:f}=Mi({reason:r,lastImpact:o.impact,afterCritical:o.afterCritical,onLiftImpact:o.onLiftImpact,home:o.dimensions.droppables[o.critical.droppable.id],viewport:o.viewport,draggables:o.dimensions.draggables}),p=f?yn(d):null,m=f?wt(d):null,g={index:c.draggable.index,droppableId:c.droppable.id},x={draggableId:u.descriptor.id,type:u.descriptor.type,source:g,reason:r,mode:o.movementMode,destination:p,combine:m},y=Vi({impact:d,draggable:u,dimensions:i,viewport:o.viewport,afterCritical:o.afterCritical}),D={critical:o.critical,afterCritical:o.afterCritical,result:x,impact:d};if(!(!Ce(o.current.client.offset,y)||!!x.combine)){t(kn({completed:D}));return}const T=zi({current:o.current.client.offset,destination:y,reason:r});t(_i({newHomeClientOffset:y,dropDuration:T,completed:D}))};var $s=()=>({x:window.pageXOffset,y:window.pageYOffset});function Yi(e){return{eventName:"scroll",options:{passive:!0,capture:!1},fn:t=>{t.target!==window&&t.target!==window.document||e()}}}function Ji({onWindowScroll:e}){function t(){e($s())}const n=Ke(t),s=Yi(n);let o=ve;function r(){return o!==ve}function l(){r()&&S(),o=de(window,[s])}function c(){r()||S(),n.cancel(),o(),o=ve}return{start:l,stop:c,isActive:r}}const Ki=e=>_(e,"DROP_COMPLETE")||_(e,"DROP_ANIMATE")||_(e,"FLUSH"),Xi=e=>{const t=Ji({onWindowScroll:n=>{e.dispatch(Oi({newScroll:n}))}});return n=>s=>{!t.isActive()&&_(s,"INITIAL_PUBLISH")&&t.start(),t.isActive()&&Ki(s)&&t.stop(),n(s)}};var Zi=e=>{let t=!1,n=!1;const s=setTimeout(()=>{n=!0}),o=r=>{t||n||(t=!0,e(r),clearTimeout(s))};return o.wasCalled=()=>t,o},Qi=()=>{const e=[],t=o=>{const r=e.findIndex(c=>c.timerId===o);r===-1&&S();const[l]=e.splice(r,1);l.callback()};return{add:o=>{const r=setTimeout(()=>t(r)),l={timerId:r,callback:o};e.push(l)},flush:()=>{if(!e.length)return;const o=[...e];e.length=0,o.forEach(r=>{clearTimeout(r.timerId),r.callback()})}}};const ec=(e,t)=>e==null&&t==null?!0:e==null||t==null?!1:e.droppableId===t.droppableId&&e.index===t.index,tc=(e,t)=>e==null&&t==null?!0:e==null||t==null?!1:e.draggableId===t.draggableId&&e.droppableId===t.droppableId,nc=(e,t)=>{if(e===t)return!0;const n=e.draggable.id===t.draggable.id&&e.draggable.droppableId===t.draggable.droppableId&&e.draggable.type===t.draggable.type&&e.draggable.index===t.draggable.index,s=e.droppable.id===t.droppable.id&&e.droppable.type===t.droppable.type;return n&&s},ze=(e,t)=>{t()},mt=(e,t)=>({draggableId:e.draggable.id,type:e.droppable.type,source:{droppableId:e.droppable.id,index:e.draggable.index},mode:t});function Yt(e,t,n,s){if(!e){n(s(t));return}const o=Zi(n);e(t,{announce:o}),o.wasCalled()||n(s(t))}var rc=(e,t)=>{const n=Qi();let s=null;const o=(f,p)=>{s&&S(),ze("onBeforeCapture",()=>{const m=e().onBeforeCapture;m&&m({draggableId:f,mode:p})})},r=(f,p)=>{s&&S(),ze("onBeforeDragStart",()=>{const m=e().onBeforeDragStart;m&&m(mt(f,p))})},l=(f,p)=>{s&&S();const m=mt(f,p);s={mode:p,lastCritical:f,lastLocation:m.source,lastCombine:null},n.add(()=>{ze("onDragStart",()=>Yt(e().onDragStart,m,t,yt.onDragStart))})},c=(f,p)=>{const m=yn(p),g=wt(p);s||S();const x=!nc(f,s.lastCritical);x&&(s.lastCritical=f);const y=!ec(s.lastLocation,m);y&&(s.lastLocation=m);const D=!tc(s.lastCombine,g);if(D&&(s.lastCombine=g),!x&&!y&&!D)return;const C={...mt(f,s.mode),combine:g,destination:m};n.add(()=>{ze("onDragUpdate",()=>Yt(e().onDragUpdate,C,t,yt.onDragUpdate))})},i=()=>{s||S(),n.flush()},u=f=>{s||S(),s=null,ze("onDragEnd",()=>Yt(e().onDragEnd,f,t,yt.onDragEnd))};return{beforeCapture:o,beforeStart:r,start:l,update:c,flush:i,drop:u,abort:()=>{if(!s)return;const f={...mt(s.lastCritical,s.mode),combine:null,destination:null,reason:"CANCEL"};u(f)}}},sc=(e,t)=>{const n=rc(e,t);return s=>o=>r=>{if(_(r,"BEFORE_INITIAL_CAPTURE")){n.beforeCapture(r.payload.draggableId,r.payload.movementMode);return}if(_(r,"INITIAL_PUBLISH")){const c=r.payload.critical;n.beforeStart(c,r.payload.movementMode),o(r),n.start(c,r.payload.movementMode);return}if(_(r,"DROP_COMPLETE")){const c=r.payload.completed.result;n.flush(),o(r),n.drop(c);return}if(o(r),_(r,"FLUSH")){n.abort();return}const l=s.getState();l.phase==="DRAGGING"&&n.update(l.critical,l.impact)}};const oc=e=>t=>n=>{if(!_(n,"DROP_ANIMATION_FINISHED")){t(n);return}const s=e.getState();s.phase!=="DROP_ANIMATING"&&S(),e.dispatch(kn({completed:s.completed}))},ac=e=>{let t=null,n=null;function s(){n&&(cancelAnimationFrame(n),n=null),t&&(t(),t=null)}return o=>r=>{if((_(r,"FLUSH")||_(r,"DROP_COMPLETE")||_(r,"DROP_ANIMATION_FINISHED"))&&s(),o(r),!_(r,"DROP_ANIMATE"))return;const l={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){e.getState().phase==="DROP_ANIMATING"&&e.dispatch(Os())}};n=requestAnimationFrame(()=>{n=null,t=de(window,[l])})}};var lc=e=>()=>t=>n=>{(_(n,"DROP_COMPLETE")||_(n,"FLUSH")||_(n,"DROP_ANIMATE"))&&e.stopPublishing(),t(n)},ic=e=>{let t=!1;return()=>n=>s=>{if(_(s,"INITIAL_PUBLISH")){t=!0,e.tryRecordFocus(s.payload.critical.draggable.id),n(s),e.tryRestoreFocusRecorded();return}if(n(s),!!t){if(_(s,"FLUSH")){t=!1,e.tryRestoreFocusRecorded();return}if(_(s,"DROP_COMPLETE")){t=!1;const o=s.payload.completed.result;o.combine&&e.tryShiftRecord(o.draggableId,o.combine.draggableId),e.tryRestoreFocusRecorded()}}}};const cc=e=>_(e,"DROP_COMPLETE")||_(e,"DROP_ANIMATE")||_(e,"FLUSH");var uc=e=>t=>n=>s=>{if(cc(s)){e.stop(),n(s);return}if(_(s,"INITIAL_PUBLISH")){n(s);const o=t.getState();o.phase!=="DRAGGING"&&S(),e.start(o);return}n(s),e.scroll(t.getState())};const dc=e=>t=>n=>{if(t(n),!_(n,"PUBLISH_WHILE_DRAGGING"))return;const s=e.getState();s.phase==="DROP_PENDING"&&(s.isWaiting||e.dispatch(Ts({reason:s.reason})))},pc=Xr;var fc=({dimensionMarshal:e,focusMarshal:t,styleMarshal:n,getResponders:s,announce:o,autoScroller:r})=>Kr(Si,pc(ma(Wi(n),lc(e),Gi(e),qi,oc,ac,dc,uc(r),Xi,ic(t),sc(s,o))));const Jt=()=>({additions:{},removals:{},modified:{}});function mc({registry:e,callbacks:t}){let n=Jt(),s=null;const o=()=>{s||(t.collectionStarting(),s=requestAnimationFrame(()=>{s=null;const{additions:i,removals:u,modified:d}=n,f=Object.keys(i).map(g=>e.draggable.getById(g).getDimension(X)).sort((g,x)=>g.descriptor.index-x.descriptor.index),p=Object.keys(d).map(g=>{const y=e.droppable.getById(g).callbacks.getScrollWhileDragging();return{droppableId:g,scroll:y}}),m={additions:f,removals:Object.keys(u),modified:p};n=Jt(),t.publish(m)}))};return{add:i=>{const u=i.descriptor.id;n.additions[u]=i,n.modified[i.descriptor.droppableId]=!0,n.removals[u]&&delete n.removals[u],o()},remove:i=>{const u=i.descriptor;n.removals[u.id]=!0,n.modified[u.droppableId]=!0,n.additions[u.id]&&delete n.additions[u.id],o()},stop:()=>{s&&(cancelAnimationFrame(s),s=null,n=Jt())}}}var Bs=({scrollHeight:e,scrollWidth:t,height:n,width:s})=>{const o=oe({x:t,y:e},{x:s,y:n});return{x:Math.max(0,o.x),y:Math.max(0,o.y)}},Fs=()=>{const e=document.documentElement;return e||S(),e},_s=()=>{const e=Fs();return Bs({scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth,width:e.clientWidth,height:e.clientHeight})},hc=()=>{const e=$s(),t=_s(),n=e.y,s=e.x,o=Fs(),r=o.clientWidth,l=o.clientHeight,c=s+r,i=n+l;return{frame:me({top:n,left:s,right:c,bottom:i}),scroll:{initial:e,current:e,max:t,diff:{value:X,displacement:X}}}},gc=({critical:e,scrollOptions:t,registry:n})=>{const s=hc(),o=s.scroll.current,r=e.droppable,l=n.droppable.getAllByType(r.type).map(d=>d.callbacks.getDimensionAndWatchScroll(o,t)),c=n.draggable.getAllByType(e.draggable.type).map(d=>d.getDimension(o));return{dimensions:{draggables:ps(c),droppables:ds(l)},critical:e,viewport:s}};function yr(e,t,n){return!(n.descriptor.id===t.id||n.descriptor.type!==t.type||e.droppable.getById(n.descriptor.droppableId).descriptor.mode!=="virtual")}var bc=(e,t)=>{let n=null;const s=mc({callbacks:{publish:t.publishWhileDragging,collectionStarting:t.collectionStarting},registry:e}),o=(p,m)=>{e.droppable.exists(p)||S(),n&&t.updateDroppableIsEnabled({id:p,isEnabled:m})},r=(p,m)=>{n&&(e.droppable.exists(p)||S(),t.updateDroppableIsCombineEnabled({id:p,isCombineEnabled:m}))},l=(p,m)=>{n&&(e.droppable.exists(p)||S(),t.updateDroppableScroll({id:p,newScroll:m}))},c=(p,m)=>{n&&e.droppable.getById(p).callbacks.scroll(m)},i=()=>{if(!n)return;s.stop();const p=n.critical.droppable;e.droppable.getAllByType(p.type).forEach(m=>m.callbacks.dragStopped()),n.unsubscribe(),n=null},u=p=>{n||S();const m=n.critical.draggable;p.type==="ADDITION"&&yr(e,m,p.value)&&s.add(p.value),p.type==="REMOVAL"&&yr(e,m,p.value)&&s.remove(p.value)};return{updateDroppableIsEnabled:o,updateDroppableIsCombineEnabled:r,scrollDroppable:c,updateDroppableScroll:l,startPublishing:p=>{n&&S();const m=e.draggable.getById(p.draggableId),g=e.droppable.getById(m.descriptor.droppableId),x={draggable:m.descriptor,droppable:g.descriptor},y=e.subscribe(u);return n={critical:x,unsubscribe:y},gc({critical:x,registry:e,scrollOptions:p.scrollOptions})},stopPublishing:i}},Ls=(e,t)=>e.phase==="IDLE"?!0:e.phase!=="DROP_ANIMATING"||e.completed.result.draggableId===t?!1:e.completed.result.reason==="DROP",xc=e=>{window.scrollBy(e.x,e.y)};const yc=K(e=>Et(e).filter(t=>!(!t.isEnabled||!t.frame))),vc=(e,t)=>yc(t).find(s=>(s.frame||S(),Ns(s.frame.pageMarginBox)(e)))||null;var Cc=({center:e,destination:t,droppables:n})=>{if(t){const o=n[t];return o.frame?o:null}return vc(e,n)};const tt={startFromPercentage:.25,maxScrollAtPercentage:.05,maxPixelScroll:28,ease:e=>e**2,durationDampening:{stopDampeningAt:1200,accelerateAt:360},disabled:!1};var Nc=(e,t,n=()=>tt)=>{const s=n(),o=e[t.size]*s.startFromPercentage,r=e[t.size]*s.maxScrollAtPercentage;return{startScrollingFrom:o,maxScrollValueAt:r}},Gs=({startOfRange:e,endOfRange:t,current:n})=>{const s=t-e;return s===0?0:(n-e)/s},In=1,Sc=(e,t,n=()=>tt)=>{const s=n();if(e>t.startScrollingFrom)return 0;if(e<=t.maxScrollValueAt)return s.maxPixelScroll;if(e===t.startScrollingFrom)return In;const r=1-Gs({startOfRange:t.maxScrollValueAt,endOfRange:t.startScrollingFrom,current:e}),l=s.maxPixelScroll*s.ease(r);return Math.ceil(l)},Dc=(e,t,n)=>{const s=n(),o=s.durationDampening.accelerateAt,r=s.durationDampening.stopDampeningAt,l=t,c=r,u=Date.now()-l;if(u>=r)return e;if(u<o)return In;const d=Gs({startOfRange:o,endOfRange:c,current:u}),f=e*s.ease(d);return Math.ceil(f)},vr=({distanceToEdge:e,thresholds:t,dragStartTime:n,shouldUseTimeDampening:s,getAutoScrollerOptions:o})=>{const r=Sc(e,t,o);return r===0?0:s?Math.max(Dc(r,n,o),In):r},Cr=({container:e,distanceToEdges:t,dragStartTime:n,axis:s,shouldUseTimeDampening:o,getAutoScrollerOptions:r})=>{const l=Nc(e,s,r);return t[s.end]<t[s.start]?vr({distanceToEdge:t[s.end],thresholds:l,dragStartTime:n,shouldUseTimeDampening:o,getAutoScrollerOptions:r}):-1*vr({distanceToEdge:t[s.start],thresholds:l,dragStartTime:n,shouldUseTimeDampening:o,getAutoScrollerOptions:r})},jc=({container:e,subject:t,proposedScroll:n})=>{const s=t.height>e.height,o=t.width>e.width;return!o&&!s?n:o&&s?null:{x:o?0:n.x,y:s?0:n.y}};const kc=us(e=>e===0?0:e);var Ws=({dragStartTime:e,container:t,subject:n,center:s,shouldUseTimeDampening:o,getAutoScrollerOptions:r})=>{const l={top:s.y-t.top,right:t.right-s.x,bottom:t.bottom-s.y,left:s.x-t.left},c=Cr({container:t,distanceToEdges:l,dragStartTime:e,axis:vn,shouldUseTimeDampening:o,getAutoScrollerOptions:r}),i=Cr({container:t,distanceToEdges:l,dragStartTime:e,axis:hs,shouldUseTimeDampening:o,getAutoScrollerOptions:r}),u=kc({x:i,y:c});if(Ce(u,X))return null;const d=jc({container:t,subject:n,proposedScroll:u});return d?Ce(d,X)?null:d:null};const Rc=us(e=>e===0?0:e>0?1:-1),En=(()=>{const e=(t,n)=>t<0?t:t>n?t-n:0;return({current:t,max:n,change:s})=>{const o=Z(t,s),r={x:e(o.x,n.x),y:e(o.y,n.y)};return Ce(r,X)?null:r}})(),Us=({max:e,current:t,change:n})=>{const s={x:Math.max(t.x,e.x),y:Math.max(t.y,e.y)},o=Rc(n),r=En({max:s,current:t,change:o});return!r||o.x!==0&&r.x===0||o.y!==0&&r.y===0},wn=(e,t)=>Us({current:e.scroll.current,max:e.scroll.max,change:t}),Ic=(e,t)=>{if(!wn(e,t))return null;const n=e.scroll.max,s=e.scroll.current;return En({current:s,max:n,change:t})},Tn=(e,t)=>{const n=e.frame;return n?Us({current:n.scroll.current,max:n.scroll.max,change:t}):!1},Ec=(e,t)=>{const n=e.frame;return!n||!Tn(e,t)?null:En({current:n.scroll.current,max:n.scroll.max,change:t})};var wc=({viewport:e,subject:t,center:n,dragStartTime:s,shouldUseTimeDampening:o,getAutoScrollerOptions:r})=>{const l=Ws({dragStartTime:s,container:e.frame,subject:t,center:n,shouldUseTimeDampening:o,getAutoScrollerOptions:r});return l&&wn(e,l)?l:null},Tc=({droppable:e,subject:t,center:n,dragStartTime:s,shouldUseTimeDampening:o,getAutoScrollerOptions:r})=>{const l=e.frame;if(!l)return null;const c=Ws({dragStartTime:s,container:l.pageMarginBox,subject:t,center:n,shouldUseTimeDampening:o,getAutoScrollerOptions:r});return c&&Tn(e,c)?c:null},Nr=({state:e,dragStartTime:t,shouldUseTimeDampening:n,scrollWindow:s,scrollDroppable:o,getAutoScrollerOptions:r})=>{const l=e.current.page.borderBoxCenter,i=e.dimensions.draggables[e.critical.draggable.id].page.marginBox;if(e.isWindowScrollAllowed){const f=e.viewport,p=wc({dragStartTime:t,viewport:f,subject:i,center:l,shouldUseTimeDampening:n,getAutoScrollerOptions:r});if(p){s(p);return}}const u=Cc({center:l,destination:ae(e.impact),droppables:e.dimensions.droppables});if(!u)return;const d=Tc({dragStartTime:t,droppable:u,subject:i,center:l,shouldUseTimeDampening:n,getAutoScrollerOptions:r});d&&o(u.descriptor.id,d)},Oc=({scrollWindow:e,scrollDroppable:t,getAutoScrollerOptions:n=()=>tt})=>{const s=Ke(e),o=Ke(t);let r=null;const l=u=>{r||S();const{shouldUseTimeDampening:d,dragStartTime:f}=r;Nr({state:u,scrollWindow:s,scrollDroppable:o,dragStartTime:f,shouldUseTimeDampening:d,getAutoScrollerOptions:n})};return{start:u=>{r&&S();const d=Date.now();let f=!1;const p=()=>{f=!0};Nr({state:u,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:p,scrollDroppable:p,getAutoScrollerOptions:n}),r={dragStartTime:d,shouldUseTimeDampening:f},f&&l(u)},stop:()=>{r&&(s.cancel(),o.cancel(),r=null)},scroll:l}},Pc=({move:e,scrollDroppable:t,scrollWindow:n})=>{const s=(c,i)=>{const u=Z(c.current.client.selection,i);e({client:u})},o=(c,i)=>{if(!Tn(c,i))return i;const u=Ec(c,i);if(!u)return t(c.descriptor.id,i),null;const d=oe(i,u);return t(c.descriptor.id,d),oe(i,d)},r=(c,i,u)=>{if(!c||!wn(i,u))return u;const d=Ic(i,u);if(!d)return n(u),null;const f=oe(u,d);return n(f),oe(u,f)};return c=>{const i=c.scrollJumpRequest;if(!i)return;const u=ae(c.impact);u||S();const d=o(c.dimensions.droppables[u],i);if(!d)return;const f=c.viewport,p=r(c.isWindowScrollAllowed,f,d);p&&s(c,p)}},Ac=({scrollDroppable:e,scrollWindow:t,move:n,getAutoScrollerOptions:s})=>{const o=Oc({scrollWindow:t,scrollDroppable:e,getAutoScrollerOptions:s}),r=Pc({move:n,scrollWindow:t,scrollDroppable:e});return{scroll:i=>{if(!(s().disabled||i.phase!=="DRAGGING")){if(i.movementMode==="FLUID"){o.scroll(i);return}i.scrollJumpRequest&&r(i)}},start:o.start,stop:o.stop}};const $e="data-rfd",Be=(()=>{const e=`${$e}-drag-handle`;return{base:e,draggableId:`${e}-draggable-id`,contextId:`${e}-context-id`}})(),ln=(()=>{const e=`${$e}-draggable`;return{base:e,contextId:`${e}-context-id`,id:`${e}-id`}})(),$c=(()=>{const e=`${$e}-droppable`;return{base:e,contextId:`${e}-context-id`,id:`${e}-id`}})(),Sr={contextId:`${$e}-scroll-container-context-id`},Bc=e=>t=>`[${t}="${e}"]`,Ve=(e,t)=>e.map(n=>{const s=n.styles[t];return s?`${n.selector} { ${s} }`:""}).join(" "),Fc="pointer-events: none;";var _c=e=>{const t=Bc(e),n=(()=>{const c=`
      cursor: -webkit-grab;
      cursor: grab;
    `;return{selector:t(Be.contextId),styles:{always:`
          -webkit-touch-callout: none;
          -webkit-tap-highlight-color: rgba(0,0,0,0);
          touch-action: manipulation;
        `,resting:c,dragging:Fc,dropAnimating:c}}})(),s=(()=>{const c=`
      transition: ${Je.outOfTheWay};
    `;return{selector:t(ln.contextId),styles:{dragging:c,dropAnimating:c,userCancel:c}}})(),o={selector:t($c.contextId),styles:{always:"overflow-anchor: none;"}},l=[s,n,o,{selector:"body",styles:{dragging:`
        cursor: grabbing;
        cursor: -webkit-grabbing;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        overflow-anchor: none;
      `}}];return{always:Ve(l,"always"),resting:Ve(l,"resting"),dragging:Ve(l,"dragging"),dropAnimating:Ve(l,"dropAnimating"),userCancel:Ve(l,"userCancel")}};const le=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?h.useLayoutEffect:h.useEffect,Kt=()=>{const e=document.querySelector("head");return e||S(),e},Dr=e=>{const t=document.createElement("style");return e&&t.setAttribute("nonce",e),t.type="text/css",t};function Lc(e,t){const n=F(()=>_c(e),[e]),s=h.useRef(null),o=h.useRef(null),r=w(K(f=>{const p=o.current;p||S(),p.textContent=f}),[]),l=w(f=>{const p=s.current;p||S(),p.textContent=f},[]);le(()=>{!s.current&&!o.current||S();const f=Dr(t),p=Dr(t);return s.current=f,o.current=p,f.setAttribute(`${$e}-always`,e),p.setAttribute(`${$e}-dynamic`,e),Kt().appendChild(f),Kt().appendChild(p),l(n.always),r(n.resting),()=>{const m=g=>{const x=g.current;x||S(),Kt().removeChild(x),g.current=null};m(s),m(o)}},[t,l,r,n.always,n.resting,e]);const c=w(()=>r(n.dragging),[r,n.dragging]),i=w(f=>{if(f==="DROP"){r(n.dropAnimating);return}r(n.userCancel)},[r,n.dropAnimating,n.userCancel]),u=w(()=>{o.current&&r(n.resting)},[r,n.resting]);return F(()=>({dragging:c,dropping:i,resting:u}),[c,i,u])}function Hs(e,t){return Array.from(e.querySelectorAll(t))}var zs=e=>e&&e.ownerDocument&&e.ownerDocument.defaultView?e.ownerDocument.defaultView:window;function Pt(e){return e instanceof zs(e).HTMLElement}function Gc(e,t){const n=`[${Be.contextId}="${e}"]`,s=Hs(document,n);if(!s.length)return null;const o=s.find(r=>r.getAttribute(Be.draggableId)===t);return!o||!Pt(o)?null:o}function Wc(e){const t=h.useRef({}),n=h.useRef(null),s=h.useRef(null),o=h.useRef(!1),r=w(function(p,m){const g={id:p,focus:m};return t.current[p]=g,function(){const y=t.current;y[p]!==g&&delete y[p]}},[]),l=w(function(p){const m=Gc(e,p);m&&m!==document.activeElement&&m.focus()},[e]),c=w(function(p,m){n.current===p&&(n.current=m)},[]),i=w(function(){s.current||o.current&&(s.current=requestAnimationFrame(()=>{s.current=null;const p=n.current;p&&l(p)}))},[l]),u=w(function(p){n.current=null;const m=document.activeElement;m&&m.getAttribute(Be.draggableId)===p&&(n.current=p)},[]);return le(()=>(o.current=!0,function(){o.current=!1;const p=s.current;p&&cancelAnimationFrame(p)}),[]),F(()=>({register:r,tryRecordFocus:u,tryRestoreFocusRecorded:i,tryShiftRecord:c}),[r,u,i,c])}function Uc(){const e={draggables:{},droppables:{}},t=[];function n(f){return t.push(f),function(){const m=t.indexOf(f);m!==-1&&t.splice(m,1)}}function s(f){t.length&&t.forEach(p=>p(f))}function o(f){return e.draggables[f]||null}function r(f){const p=o(f);return p||S(),p}const l={register:f=>{e.draggables[f.descriptor.id]=f,s({type:"ADDITION",value:f})},update:(f,p)=>{const m=e.draggables[p.descriptor.id];m&&m.uniqueId===f.uniqueId&&(delete e.draggables[p.descriptor.id],e.draggables[f.descriptor.id]=f)},unregister:f=>{const p=f.descriptor.id,m=o(p);m&&f.uniqueId===m.uniqueId&&(delete e.draggables[p],e.droppables[f.descriptor.droppableId]&&s({type:"REMOVAL",value:f}))},getById:r,findById:o,exists:f=>!!o(f),getAllByType:f=>Object.values(e.draggables).filter(p=>p.descriptor.type===f)};function c(f){return e.droppables[f]||null}function i(f){const p=c(f);return p||S(),p}const u={register:f=>{e.droppables[f.descriptor.id]=f},unregister:f=>{const p=c(f.descriptor.id);p&&f.uniqueId===p.uniqueId&&delete e.droppables[f.descriptor.id]},getById:i,findById:c,exists:f=>!!c(f),getAllByType:f=>Object.values(e.droppables).filter(p=>p.descriptor.type===f)};function d(){e.draggables={},e.droppables={},t.length=0}return{draggable:l,droppable:u,subscribe:n,clean:d}}function Hc(){const e=F(Uc,[]);return h.useEffect(()=>function(){e.clean()},[e]),e}var On=V.createContext(null),Rt=()=>{const e=document.body;return e||S(),e};const zc={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"},Vc=e=>`rfd-announcement-${e}`;function Mc(e){const t=F(()=>Vc(e),[e]),n=h.useRef(null);return h.useEffect(function(){const r=document.createElement("div");return n.current=r,r.id=t,r.setAttribute("aria-live","assertive"),r.setAttribute("aria-atomic","true"),Vr(r.style,zc),Rt().appendChild(r),function(){setTimeout(function(){const i=Rt();i.contains(r)&&i.removeChild(r),r===n.current&&(n.current=null)})}},[t]),w(o=>{const r=n.current;if(r){r.textContent=o;return}},[])}const qc={separator:"::"};function Pn(e,t=qc){const n=V.useId();return F(()=>`${e}${t.separator}${n}`,[t.separator,e,n])}function Yc({contextId:e,uniqueId:t}){return`rfd-hidden-text-${e}-${t}`}function Jc({contextId:e,text:t}){const n=Pn("hidden-text",{separator:"-"}),s=F(()=>Yc({contextId:e,uniqueId:n}),[n,e]);return h.useEffect(function(){const r=document.createElement("div");return r.id=s,r.textContent=t,r.style.display="none",Rt().appendChild(r),function(){const c=Rt();c.contains(r)&&c.removeChild(r)}},[s,t]),s}var At=V.createContext(null);function Vs(e){const t=h.useRef(e);return h.useEffect(()=>{t.current=e}),t}function Kc(){let e=null;function t(){return!!e}function n(l){return l===e}function s(l){e&&S();const c={abandon:l};return e=c,c}function o(){e||S(),e=null}function r(){e&&(e.abandon(),o())}return{isClaimed:t,isActive:n,claim:s,release:o,tryAbandon:r}}function nt(e){return e.phase==="IDLE"||e.phase==="DROP_ANIMATING"?!1:e.isDragging}const Xc=9,Zc=13,An=27,Ms=32,Qc=33,eu=34,tu=35,nu=36,ru=37,su=38,ou=39,au=40,lu={[Zc]:!0,[Xc]:!0};var qs=e=>{lu[e.keyCode]&&e.preventDefault()};const $t=(()=>{const e="visibilitychange";return typeof document>"u"?e:[e,`ms${e}`,`webkit${e}`,`moz${e}`,`o${e}`].find(s=>`on${s}`in document)||e})(),Ys=0,jr=5;function iu(e,t){return Math.abs(t.x-e.x)>=jr||Math.abs(t.y-e.y)>=jr}const kr={type:"IDLE"};function cu({cancel:e,completed:t,getPhase:n,setPhase:s}){return[{eventName:"mousemove",fn:o=>{const{button:r,clientX:l,clientY:c}=o;if(r!==Ys)return;const i={x:l,y:c},u=n();if(u.type==="DRAGGING"){o.preventDefault(),u.actions.move(i);return}u.type!=="PENDING"&&S();const d=u.point;if(!iu(d,i))return;o.preventDefault();const f=u.actions.fluidLift(i);s({type:"DRAGGING",actions:f})}},{eventName:"mouseup",fn:o=>{const r=n();if(r.type!=="DRAGGING"){e();return}o.preventDefault(),r.actions.drop({shouldBlockNextClick:!0}),t()}},{eventName:"mousedown",fn:o=>{n().type==="DRAGGING"&&o.preventDefault(),e()}},{eventName:"keydown",fn:o=>{if(n().type==="PENDING"){e();return}if(o.keyCode===An){o.preventDefault(),e();return}qs(o)}},{eventName:"resize",fn:e},{eventName:"scroll",options:{passive:!0,capture:!1},fn:()=>{n().type==="PENDING"&&e()}},{eventName:"webkitmouseforcedown",fn:o=>{const r=n();if(r.type==="IDLE"&&S(),r.actions.shouldRespectForcePress()){e();return}o.preventDefault()}},{eventName:$t,fn:e}]}function uu(e){const t=h.useRef(kr),n=h.useRef(ve),s=F(()=>({eventName:"mousedown",fn:function(f){if(f.defaultPrevented||f.button!==Ys||f.ctrlKey||f.metaKey||f.shiftKey||f.altKey)return;const p=e.findClosestDraggableId(f);if(!p)return;const m=e.tryGetLock(p,l,{sourceEvent:f});if(!m)return;f.preventDefault();const g={x:f.clientX,y:f.clientY};n.current(),u(m,g)}}),[e]),o=F(()=>({eventName:"webkitmouseforcewillbegin",fn:d=>{if(d.defaultPrevented)return;const f=e.findClosestDraggableId(d);if(!f)return;const p=e.findOptionsForDraggable(f);p&&(p.shouldRespectForcePress||e.canGetLock(f)&&d.preventDefault())}}),[e]),r=w(function(){const f={passive:!1,capture:!0};n.current=de(window,[o,s],f)},[o,s]),l=w(()=>{t.current.type!=="IDLE"&&(t.current=kr,n.current(),r())},[r]),c=w(()=>{const d=t.current;l(),d.type==="DRAGGING"&&d.actions.cancel({shouldBlockNextClick:!0}),d.type==="PENDING"&&d.actions.abort()},[l]),i=w(function(){const f={capture:!0,passive:!1},p=cu({cancel:c,completed:l,getPhase:()=>t.current,setPhase:m=>{t.current=m}});n.current=de(window,p,f)},[c,l]),u=w(function(f,p){t.current.type!=="IDLE"&&S(),t.current={type:"PENDING",point:p,actions:f},i()},[i]);le(function(){return r(),function(){n.current()}},[r])}function du(){}const pu={[eu]:!0,[Qc]:!0,[nu]:!0,[tu]:!0};function fu(e,t){function n(){t(),e.cancel()}function s(){t(),e.drop()}return[{eventName:"keydown",fn:o=>{if(o.keyCode===An){o.preventDefault(),n();return}if(o.keyCode===Ms){o.preventDefault(),s();return}if(o.keyCode===au){o.preventDefault(),e.moveDown();return}if(o.keyCode===su){o.preventDefault(),e.moveUp();return}if(o.keyCode===ou){o.preventDefault(),e.moveRight();return}if(o.keyCode===ru){o.preventDefault(),e.moveLeft();return}if(pu[o.keyCode]){o.preventDefault();return}qs(o)}},{eventName:"mousedown",fn:n},{eventName:"mouseup",fn:n},{eventName:"click",fn:n},{eventName:"touchstart",fn:n},{eventName:"resize",fn:n},{eventName:"wheel",fn:n,options:{passive:!0}},{eventName:$t,fn:n}]}function mu(e){const t=h.useRef(du),n=F(()=>({eventName:"keydown",fn:function(r){if(r.defaultPrevented||r.keyCode!==Ms)return;const l=e.findClosestDraggableId(r);if(!l)return;const c=e.tryGetLock(l,d,{sourceEvent:r});if(!c)return;r.preventDefault();let i=!0;const u=c.snapLift();t.current();function d(){i||S(),i=!1,t.current(),s()}t.current=de(window,fu(u,d),{capture:!0,passive:!1})}}),[e]),s=w(function(){const r={passive:!1,capture:!0};t.current=de(window,[n],r)},[n]);le(function(){return s(),function(){t.current()}},[s])}const Xt={type:"IDLE"},hu=120,gu=.15;function bu({cancel:e,getPhase:t}){return[{eventName:"orientationchange",fn:e},{eventName:"resize",fn:e},{eventName:"contextmenu",fn:n=>{n.preventDefault()}},{eventName:"keydown",fn:n=>{if(t().type!=="DRAGGING"){e();return}n.keyCode===An&&n.preventDefault(),e()}},{eventName:$t,fn:e}]}function xu({cancel:e,completed:t,getPhase:n}){return[{eventName:"touchmove",options:{capture:!1},fn:s=>{const o=n();if(o.type!=="DRAGGING"){e();return}o.hasMoved=!0;const{clientX:r,clientY:l}=s.touches[0],c={x:r,y:l};s.preventDefault(),o.actions.move(c)}},{eventName:"touchend",fn:s=>{const o=n();if(o.type!=="DRAGGING"){e();return}s.preventDefault(),o.actions.drop({shouldBlockNextClick:!0}),t()}},{eventName:"touchcancel",fn:s=>{if(n().type!=="DRAGGING"){e();return}s.preventDefault(),e()}},{eventName:"touchforcechange",fn:s=>{const o=n();o.type==="IDLE"&&S();const r=s.touches[0];if(!r||!(r.force>=gu))return;const c=o.actions.shouldRespectForcePress();if(o.type==="PENDING"){c&&e();return}if(c){if(o.hasMoved){s.preventDefault();return}e();return}s.preventDefault()}},{eventName:$t,fn:e}]}function yu(e){const t=h.useRef(Xt),n=h.useRef(ve),s=w(function(){return t.current},[]),o=w(function(m){t.current=m},[]),r=F(()=>({eventName:"touchstart",fn:function(m){if(m.defaultPrevented)return;const g=e.findClosestDraggableId(m);if(!g)return;const x=e.tryGetLock(g,c,{sourceEvent:m});if(!x)return;const y=m.touches[0],{clientX:D,clientY:C}=y,T={x:D,y:C};n.current(),f(x,T)}}),[e]),l=w(function(){const m={capture:!0,passive:!1};n.current=de(window,[r],m)},[r]),c=w(()=>{const p=t.current;p.type!=="IDLE"&&(p.type==="PENDING"&&clearTimeout(p.longPressTimerId),o(Xt),n.current(),l())},[l,o]),i=w(()=>{const p=t.current;c(),p.type==="DRAGGING"&&p.actions.cancel({shouldBlockNextClick:!0}),p.type==="PENDING"&&p.actions.abort()},[c]),u=w(function(){const m={capture:!0,passive:!1},g={cancel:i,completed:c,getPhase:s},x=de(window,xu(g),m),y=de(window,bu(g),m);n.current=function(){x(),y()}},[i,s,c]),d=w(function(){const m=s();m.type!=="PENDING"&&S();const g=m.actions.fluidLift(m.point);o({type:"DRAGGING",actions:g,hasMoved:!1})},[s,o]),f=w(function(m,g){s().type!=="IDLE"&&S();const x=setTimeout(d,hu);o({type:"PENDING",point:g,actions:m,longPressTimerId:x}),u()},[u,s,o,d]);le(function(){return l(),function(){n.current();const g=s();g.type==="PENDING"&&(clearTimeout(g.longPressTimerId),o(Xt))}},[s,l,o]),le(function(){return de(window,[{eventName:"touchmove",fn:()=>{},options:{capture:!1,passive:!1}}])},[])}const vu=["input","button","textarea","select","option","optgroup","video","audio"];function Js(e,t){if(t==null)return!1;if(vu.includes(t.tagName.toLowerCase()))return!0;const s=t.getAttribute("contenteditable");return s==="true"||s===""?!0:t===e?!1:Js(e,t.parentElement)}function Cu(e,t){const n=t.target;return Pt(n)?Js(e,n):!1}var Nu=e=>me(e.getBoundingClientRect()).center;function Su(e){return e instanceof zs(e).Element}const Du=(()=>{const e="matches";return typeof document>"u"?e:[e,"msMatchesSelector","webkitMatchesSelector"].find(s=>s in Element.prototype)||e})();function Ks(e,t){return e==null?null:e[Du](t)?e:Ks(e.parentElement,t)}function ju(e,t){return e.closest?e.closest(t):Ks(e,t)}function ku(e){return`[${Be.contextId}="${e}"]`}function Ru(e,t){const n=t.target;if(!Su(n))return null;const s=ku(e),o=ju(n,s);return!o||!Pt(o)?null:o}function Iu(e,t){const n=Ru(e,t);return n?n.getAttribute(Be.draggableId):null}function Eu(e,t){const n=`[${ln.contextId}="${e}"]`,o=Hs(document,n).find(r=>r.getAttribute(ln.id)===t);return!o||!Pt(o)?null:o}function wu(e){e.preventDefault()}function ht({expected:e,phase:t,isLockActive:n,shouldWarn:s}){return!(!n()||e!==t)}function Xs({lockAPI:e,store:t,registry:n,draggableId:s}){if(e.isClaimed())return!1;const o=n.draggable.findById(s);return!(!o||!o.options.isEnabled||!Ls(t.getState(),s))}function Tu({lockAPI:e,contextId:t,store:n,registry:s,draggableId:o,forceSensorStop:r,sourceEvent:l}){if(!Xs({lockAPI:e,store:n,registry:s,draggableId:o}))return null;const i=s.draggable.getById(o),u=Eu(t,i.descriptor.id);if(!u||l&&!i.options.canDragInteractiveElements&&Cu(u,l))return null;const d=e.claim(r||ve);let f="PRE_DRAG";function p(){return i.options.shouldRespectForcePress}function m(){return e.isActive(d)}function g(R,E){ht({expected:R,phase:f,isLockActive:m,shouldWarn:!0})&&n.dispatch(E())}const x=g.bind(null,"DRAGGING");function y(R){function E(){e.release(),f="COMPLETED"}f!=="PRE_DRAG"&&(E(),S()),n.dispatch(ji(R.liftActionArgs)),f="DRAGGING";function O(k,B={shouldBlockNextClick:!1}){if(R.cleanup(),B.shouldBlockNextClick){const v=de(window,[{eventName:"click",fn:wu,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(v)}E(),n.dispatch(Ts({reason:k}))}return{isActive:()=>ht({expected:"DRAGGING",phase:f,isLockActive:m,shouldWarn:!1}),shouldRespectForcePress:p,drop:k=>O("DROP",k),cancel:k=>O("CANCEL",k),...R.actions}}function D(R){const E=Ke(k=>{x(()=>ws({client:k}))});return{...y({liftActionArgs:{id:o,clientSelection:R,movementMode:"FLUID"},cleanup:()=>E.cancel(),actions:{move:E}}),move:E}}function C(){const R={moveUp:()=>x(Ai),moveRight:()=>x(Bi),moveDown:()=>x($i),moveLeft:()=>x(Fi)};return y({liftActionArgs:{id:o,clientSelection:Nu(u),movementMode:"SNAP"},cleanup:ve,actions:R})}function T(){ht({expected:"PRE_DRAG",phase:f,isLockActive:m,shouldWarn:!0})&&e.release()}return{isActive:()=>ht({expected:"PRE_DRAG",phase:f,isLockActive:m,shouldWarn:!1}),shouldRespectForcePress:p,fluidLift:D,snapLift:C,abort:T}}const Ou=[uu,mu,yu];function Pu({contextId:e,store:t,registry:n,customSensors:s,enableDefaultSensors:o}){const r=[...o?Ou:[],...s||[]],l=h.useState(()=>Kc())[0],c=w(function(y,D){nt(y)&&!nt(D)&&l.tryAbandon()},[l]);le(function(){let y=t.getState();return t.subscribe(()=>{const C=t.getState();c(y,C),y=C})},[l,t,c]),le(()=>l.tryAbandon,[l.tryAbandon]);const i=w(x=>Xs({lockAPI:l,registry:n,store:t,draggableId:x}),[l,n,t]),u=w((x,y,D)=>Tu({lockAPI:l,registry:n,contextId:e,store:t,draggableId:x,forceSensorStop:y||null,sourceEvent:D&&D.sourceEvent?D.sourceEvent:null}),[e,l,n,t]),d=w(x=>Iu(e,x),[e]),f=w(x=>{const y=n.draggable.findById(x);return y?y.options:null},[n.draggable]),p=w(function(){l.isClaimed()&&(l.tryAbandon(),t.getState().phase!=="IDLE"&&t.dispatch(jn()))},[l,t]),m=w(()=>l.isClaimed(),[l]),g=F(()=>({canGetLock:i,tryGetLock:u,findClosestDraggableId:d,findOptionsForDraggable:f,tryReleaseLock:p,isLockClaimed:m}),[i,u,d,f,p,m]);for(let x=0;x<r.length;x++)r[x](g)}const Au=e=>({onBeforeCapture:t=>{const n=()=>{e.onBeforeCapture&&e.onBeforeCapture(t)};fn.flushSync(n)},onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragEnd:e.onDragEnd,onDragUpdate:e.onDragUpdate}),$u=e=>({...tt,...e.autoScrollerOptions,durationDampening:{...tt.durationDampening,...e.autoScrollerOptions}});function Me(e){return e.current||S(),e.current}function Bu(e){const{contextId:t,setCallbacks:n,sensors:s,nonce:o,dragHandleUsageInstructions:r}=e,l=h.useRef(null),c=Vs(e),i=w(()=>Au(c.current),[c]),u=w(()=>$u(c.current),[c]),d=Mc(t),f=Jc({contextId:t,text:r}),p=Lc(t,o),m=w(v=>{Me(l).dispatch(v)},[]),g=F(()=>Zn({publishWhileDragging:Ri,updateDroppableScroll:Ei,updateDroppableIsEnabled:wi,updateDroppableIsCombineEnabled:Ti,collectionStarting:Ii},m),[m]),x=Hc(),y=F(()=>bc(x,g),[x,g]),D=F(()=>Ac({scrollWindow:xc,scrollDroppable:y.scrollDroppable,getAutoScrollerOptions:u,...Zn({move:ws},m)}),[y.scrollDroppable,m,u]),C=Wc(t),T=F(()=>fc({announce:d,autoScroller:D,dimensionMarshal:y,focusMarshal:C,getResponders:i,styleMarshal:p}),[d,D,y,C,i,p]);l.current=T;const j=w(()=>{const v=Me(l);v.getState().phase!=="IDLE"&&v.dispatch(jn())},[]),R=w(()=>{const v=Me(l).getState();return v.phase==="DROP_ANIMATING"?!0:v.phase==="IDLE"?!1:v.isDragging},[]),E=F(()=>({isDragging:R,tryAbort:j}),[R,j]);n(E);const O=w(v=>Ls(Me(l).getState(),v),[]),k=w(()=>Re(Me(l).getState()),[]),B=F(()=>({marshal:y,focus:C,contextId:t,canLift:O,isMovementAllowed:k,dragHandleUsageInstructionsId:f,registry:x}),[t,y,f,C,O,k,x]);return Pu({contextId:t,store:T,registry:x,customSensors:s||null,enableDefaultSensors:e.enableDefaultSensors!==!1}),h.useEffect(()=>j,[j]),V.createElement(At.Provider,{value:B},V.createElement(cl,{context:On,store:T},e.children))}function Fu(){return V.useId()}function _u(e){const t=Fu(),n=e.dragHandleUsageInstructions||yt.dragHandleUsageInstructions;return V.createElement(ml,null,s=>V.createElement(Bu,{nonce:e.nonce,contextId:t,setCallbacks:s,dragHandleUsageInstructions:n,enableDefaultSensors:e.enableDefaultSensors,sensors:e.sensors,onBeforeCapture:e.onBeforeCapture,onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragUpdate:e.onDragUpdate,onDragEnd:e.onDragEnd,autoScrollerOptions:e.autoScrollerOptions},e.children))}const Rr={dragging:5e3,dropAnimating:4500},Lu=(e,t)=>t?Je.drop(t.duration):e?Je.snap:Je.fluid,Gu=(e,t)=>{if(e)return t?et.opacity.drop:et.opacity.combining},Wu=e=>e.forceShouldAnimate!=null?e.forceShouldAnimate:e.mode==="SNAP";function Uu(e){const n=e.dimension.client,{offset:s,combineWith:o,dropping:r}=e,l=!!o,c=Wu(e),i=!!r,u=i?on.drop(s,l):on.moveTo(s);return{position:"fixed",top:n.marginBox.top,left:n.marginBox.left,boxSizing:"border-box",width:n.borderBox.width,height:n.borderBox.height,transition:Lu(c,r),transform:u,opacity:Gu(l,i),zIndex:i?Rr.dropAnimating:Rr.dragging,pointerEvents:"none"}}function Hu(e){return{transform:on.moveTo(e.offset),transition:e.shouldAnimateDisplacement?void 0:"none"}}function zu(e){return e.type==="DRAGGING"?Uu(e):Hu(e)}function Vu(e,t,n=X){const s=window.getComputedStyle(t),o=t.getBoundingClientRect(),r=ss(o,s),l=St(r,n),c={client:r,tagName:t.tagName.toLowerCase(),display:s.display},i={x:r.marginBox.width,y:r.marginBox.height};return{descriptor:e,placeholder:c,displaceBy:i,client:r,page:l}}function Mu(e){const t=Pn("draggable"),{descriptor:n,registry:s,getDraggableRef:o,canDragInteractiveElements:r,shouldRespectForcePress:l,isEnabled:c}=e,i=F(()=>({canDragInteractiveElements:r,shouldRespectForcePress:l,isEnabled:c}),[r,c,l]),u=w(m=>{const g=o();return g||S(),Vu(n,g,m)},[n,o]),d=F(()=>({uniqueId:t,descriptor:n,options:i,getDimension:u}),[n,u,i,t]),f=h.useRef(d),p=h.useRef(!0);le(()=>(s.draggable.register(f.current),()=>s.draggable.unregister(f.current)),[s.draggable]),le(()=>{if(p.current){p.current=!1;return}const m=f.current;f.current=d,s.draggable.update(d,m)},[d,s.draggable])}var $n=V.createContext(null);function It(e){const t=h.useContext(e);return t||S(),t}function qu(e){e.preventDefault()}const Yu=e=>{const t=h.useRef(null),n=w((E=null)=>{t.current=E},[]),s=w(()=>t.current,[]),{contextId:o,dragHandleUsageInstructionsId:r,registry:l}=It(At),{type:c,droppableId:i}=It($n),u=F(()=>({id:e.draggableId,index:e.index,type:c,droppableId:i}),[e.draggableId,e.index,c,i]),{children:d,draggableId:f,isEnabled:p,shouldRespectForcePress:m,canDragInteractiveElements:g,isClone:x,mapped:y,dropAnimationFinished:D}=e;if(!x){const E=F(()=>({descriptor:u,registry:l,getDraggableRef:s,canDragInteractiveElements:g,shouldRespectForcePress:m,isEnabled:p}),[u,l,s,g,m,p]);Mu(E)}const C=F(()=>p?{tabIndex:0,role:"button","aria-describedby":r,"data-rfd-drag-handle-draggable-id":f,"data-rfd-drag-handle-context-id":o,draggable:!1,onDragStart:qu}:null,[o,r,f,p]),T=w(E=>{y.type==="DRAGGING"&&y.dropping&&E.propertyName==="transform"&&fn.flushSync(D)},[D,y]),j=F(()=>{const E=zu(y),O=y.type==="DRAGGING"&&y.dropping?T:void 0;return{innerRef:n,draggableProps:{"data-rfd-draggable-context-id":o,"data-rfd-draggable-id":f,style:E,onTransitionEnd:O},dragHandleProps:C}},[o,C,f,y,T,n]),R=F(()=>({draggableId:u.id,type:u.type,source:{index:u.index,droppableId:u.droppableId}}),[u.droppableId,u.id,u.index,u.type]);return V.createElement(V.Fragment,null,d(j,y.snapshot,R))};var Zs=(e,t)=>e===t,Qs=e=>{const{combine:t,destination:n}=e;return n?n.droppableId:t?t.droppableId:null};const Ju=e=>e.combine?e.combine.draggableId:null,Ku=e=>e.at&&e.at.type==="COMBINE"?e.at.combine.draggableId:null;function Xu(){const e=K((o,r)=>({x:o,y:r})),t=K((o,r,l=null,c=null,i=null)=>({isDragging:!0,isClone:r,isDropAnimating:!!i,dropAnimation:i,mode:o,draggingOver:l,combineWith:c,combineTargetFor:null})),n=K((o,r,l,c,i=null,u=null,d=null)=>({mapped:{type:"DRAGGING",dropping:null,draggingOver:i,combineWith:u,mode:r,offset:o,dimension:l,forceShouldAnimate:d,snapshot:t(r,c,i,u,null)}}));return(o,r)=>{if(nt(o)){if(o.critical.draggable.id!==r.draggableId)return null;const l=o.current.client.offset,c=o.dimensions.draggables[r.draggableId],i=ae(o.impact),u=Ku(o.impact),d=o.forceShouldAnimate;return n(e(l.x,l.y),o.movementMode,c,r.isClone,i,u,d)}if(o.phase==="DROP_ANIMATING"){const l=o.completed;if(l.result.draggableId!==r.draggableId)return null;const c=r.isClone,i=o.dimensions.draggables[r.draggableId],u=l.result,d=u.mode,f=Qs(u),p=Ju(u),g={duration:o.dropDuration,curve:Rn.drop,moveTo:o.newHomeClientOffset,opacity:p?et.opacity.drop:null,scale:p?et.scale.drop:null};return{mapped:{type:"DRAGGING",offset:o.newHomeClientOffset,dimension:i,dropping:g,draggingOver:f,combineWith:p,mode:d,forceShouldAnimate:null,snapshot:t(d,c,f,p,g)}}}return null}}function eo(e=null){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:e,combineWith:null}}const Zu={mapped:{type:"SECONDARY",offset:X,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:eo(null)}};function Qu(){const e=K((l,c)=>({x:l,y:c})),t=K(eo),n=K((l,c=null,i)=>({mapped:{type:"SECONDARY",offset:l,combineTargetFor:c,shouldAnimateDisplacement:i,snapshot:t(c)}})),s=l=>l?n(X,l,!0):null,o=(l,c,i,u)=>{const d=i.displaced.visible[l],f=!!(u.inVirtualList&&u.effected[l]),p=wt(i),m=p&&p.draggableId===l?c:null;if(!d){if(!f)return s(m);if(i.displaced.invisible[l])return null;const y=Fe(u.displacedBy.point),D=e(y.x,y.y);return n(D,m,!0)}if(f)return s(m);const g=i.displacedBy.point,x=e(g.x,g.y);return n(x,m,d.shouldAnimate)};return(l,c)=>{if(nt(l))return l.critical.draggable.id===c.draggableId?null:o(c.draggableId,l.critical.draggable.id,l.impact,l.afterCritical);if(l.phase==="DROP_ANIMATING"){const i=l.completed;return i.result.draggableId===c.draggableId?null:o(c.draggableId,i.result.draggableId,i.impact,i.afterCritical)}return null}}const ed=()=>{const e=Xu(),t=Qu();return(s,o)=>e(s,o)||t(s,o)||Zu},td={dropAnimationFinished:Os},nd=rs(ed,td,null,{context:On,areStatePropsEqual:Zs})(Yu);function to(e){return It($n).isUsingCloneFor===e.draggableId&&!e.isClone?null:V.createElement(nd,e)}function rd(e){const t=typeof e.isDragDisabled=="boolean"?!e.isDragDisabled:!0,n=!!e.disableInteractiveElementBlocking,s=!!e.shouldRespectForcePress;return V.createElement(to,Vr({},e,{isClone:!1,isEnabled:t,canDragInteractiveElements:n,shouldRespectForcePress:s}))}const no=e=>t=>e===t,sd=no("scroll"),od=no("auto"),Ir=(e,t)=>t(e.overflowX)||t(e.overflowY),ad=e=>{const t=window.getComputedStyle(e),n={overflowX:t.overflowX,overflowY:t.overflowY};return Ir(n,sd)||Ir(n,od)},ld=()=>!1,ro=e=>e==null?null:e===document.body?ld()?e:null:e===document.documentElement?null:ad(e)?e:ro(e.parentElement);var cn=e=>({x:e.scrollLeft,y:e.scrollTop});const so=e=>e?window.getComputedStyle(e).position==="fixed"?!0:so(e.parentElement):!1;var id=e=>{const t=ro(e),n=so(e);return{closestScrollable:t,isFixedOnPage:n}},cd=({descriptor:e,isEnabled:t,isCombineEnabled:n,isFixedOnPage:s,direction:o,client:r,page:l,closest:c})=>{const i=(()=>{if(!c)return null;const{scrollSize:p,client:m}=c,g=Bs({scrollHeight:p.scrollHeight,scrollWidth:p.scrollWidth,height:m.paddingBox.height,width:m.paddingBox.width});return{pageMarginBox:c.page.marginBox,frameClient:m,scrollSize:p,shouldClipSubject:c.shouldClipSubject,scroll:{initial:c.scroll,current:c.scroll,max:g,diff:{value:X,displacement:X}}}})(),u=o==="vertical"?vn:hs,d=Ae({page:l,withPlaceholder:null,axis:u,frame:i});return{descriptor:e,isCombineEnabled:n,isFixedOnPage:s,axis:u,isEnabled:t,client:r,page:l,frame:i,subject:d}};const ud=(e,t)=>{const n=os(e);if(!t||e!==t)return n;const s=n.paddingBox.top-t.scrollTop,o=n.paddingBox.left-t.scrollLeft,r=s+t.scrollHeight,l=o+t.scrollWidth,i=gn({top:s,right:l,bottom:r,left:o},n.border);return bn({borderBox:i,margin:n.margin,border:n.border,padding:n.padding})};var dd=({ref:e,descriptor:t,env:n,windowScroll:s,direction:o,isDropDisabled:r,isCombineEnabled:l,shouldClipSubject:c})=>{const i=n.closestScrollable,u=ud(e,i),d=St(u,s),f=(()=>{if(!i)return null;const m=os(i),g={scrollHeight:i.scrollHeight,scrollWidth:i.scrollWidth};return{client:m,page:St(m,s),scroll:cn(i),scrollSize:g,shouldClipSubject:c}})();return cd({descriptor:t,isEnabled:!r,isCombineEnabled:l,isFixedOnPage:n.isFixedOnPage,direction:o,client:u,page:d,closest:f})};const pd={passive:!1},fd={passive:!0};var Er=e=>e.shouldPublishImmediately?pd:fd;const gt=e=>e&&e.env.closestScrollable||null;function md(e){const t=h.useRef(null),n=It(At),s=Pn("droppable"),{registry:o,marshal:r}=n,l=Vs(e),c=F(()=>({id:e.droppableId,type:e.type,mode:e.mode}),[e.droppableId,e.mode,e.type]),i=h.useRef(c),u=F(()=>K((j,R)=>{t.current||S();const E={x:j,y:R};r.updateDroppableScroll(c.id,E)}),[c.id,r]),d=w(()=>{const j=t.current;return!j||!j.env.closestScrollable?X:cn(j.env.closestScrollable)},[]),f=w(()=>{const j=d();u(j.x,j.y)},[d,u]),p=F(()=>Ke(f),[f]),m=w(()=>{const j=t.current,R=gt(j);if(j&&R||S(),j.scrollOptions.shouldPublishImmediately){f();return}p()},[p,f]),g=w((j,R)=>{t.current&&S();const E=l.current,O=E.getDroppableRef();O||S();const k=id(O),B={ref:O,descriptor:c,env:k,scrollOptions:R};t.current=B;const v=dd({ref:O,descriptor:c,env:k,windowScroll:j,direction:E.direction,isDropDisabled:E.isDropDisabled,isCombineEnabled:E.isCombineEnabled,shouldClipSubject:!E.ignoreContainerClipping}),N=k.closestScrollable;return N&&(N.setAttribute(Sr.contextId,n.contextId),N.addEventListener("scroll",m,Er(B.scrollOptions))),v},[n.contextId,c,m,l]),x=w(()=>{const j=t.current,R=gt(j);return j&&R||S(),cn(R)},[]),y=w(()=>{const j=t.current;j||S();const R=gt(j);t.current=null,R&&(p.cancel(),R.removeAttribute(Sr.contextId),R.removeEventListener("scroll",m,Er(j.scrollOptions)))},[m,p]),D=w(j=>{const R=t.current;R||S();const E=gt(R);E||S(),E.scrollTop+=j.y,E.scrollLeft+=j.x},[]),C=F(()=>({getDimensionAndWatchScroll:g,getScrollWhileDragging:x,dragStopped:y,scroll:D}),[y,g,x,D]),T=F(()=>({uniqueId:s,descriptor:c,callbacks:C}),[C,c,s]);le(()=>(i.current=T.descriptor,o.droppable.register(T),()=>{t.current&&y(),o.droppable.unregister(T)}),[C,c,y,T,r,o.droppable]),le(()=>{t.current&&r.updateDroppableIsEnabled(i.current.id,!e.isDropDisabled)},[e.isDropDisabled,r]),le(()=>{t.current&&r.updateDroppableIsCombineEnabled(i.current.id,e.isCombineEnabled)},[e.isCombineEnabled,r])}function Zt(){}const wr={width:0,height:0,margin:Cl},hd=({isAnimatingOpenOnMount:e,placeholder:t,animate:n})=>e||n==="close"?wr:{height:t.client.borderBox.height,width:t.client.borderBox.width,margin:t.client.margin},gd=({isAnimatingOpenOnMount:e,placeholder:t,animate:n})=>{const s=hd({isAnimatingOpenOnMount:e,placeholder:t,animate:n});return{display:t.display,boxSizing:"border-box",width:s.width,height:s.height,marginTop:s.margin.top,marginRight:s.margin.right,marginBottom:s.margin.bottom,marginLeft:s.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:n!=="none"?Je.placeholder:null}},bd=e=>{const t=h.useRef(null),n=w(()=>{t.current&&(clearTimeout(t.current),t.current=null)},[]),{animate:s,onTransitionEnd:o,onClose:r,contextId:l}=e,[c,i]=h.useState(e.animate==="open");h.useEffect(()=>c?s!=="open"?(n(),i(!1),Zt):t.current?Zt:(t.current=setTimeout(()=>{t.current=null,i(!1)}),n):Zt,[s,c,n]);const u=w(f=>{f.propertyName==="height"&&(o(),s==="close"&&r())},[s,r,o]),d=gd({isAnimatingOpenOnMount:c,animate:e.animate,placeholder:e.placeholder});return V.createElement(e.placeholder.tagName,{style:d,"data-rfd-placeholder-context-id":l,onTransitionEnd:u,ref:e.innerRef})};var xd=V.memo(bd);class yd extends V.PureComponent{constructor(...t){super(...t),this.state={isVisible:!!this.props.on,data:this.props.on,animate:this.props.shouldAnimate&&this.props.on?"open":"none"},this.onClose=()=>{this.state.animate==="close"&&this.setState({isVisible:!1})}}static getDerivedStateFromProps(t,n){return t.shouldAnimate?t.on?{isVisible:!0,data:t.on,animate:"open"}:n.isVisible?{isVisible:!0,data:n.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:!!t.on,data:t.on,animate:"none"}}render(){if(!this.state.isVisible)return null;const t={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(t)}}const vd=e=>{const t=h.useContext(At);t||S();const{contextId:n,isMovementAllowed:s}=t,o=h.useRef(null),r=h.useRef(null),{children:l,droppableId:c,type:i,mode:u,direction:d,ignoreContainerClipping:f,isDropDisabled:p,isCombineEnabled:m,snapshot:g,useClone:x,updateViewportMaxScroll:y,getContainerForClone:D}=e,C=w(()=>o.current,[]),T=w((N=null)=>{o.current=N},[]);w(()=>r.current,[]);const j=w((N=null)=>{r.current=N},[]),R=w(()=>{s()&&y({maxScroll:_s()})},[s,y]);md({droppableId:c,type:i,mode:u,direction:d,isDropDisabled:p,isCombineEnabled:m,ignoreContainerClipping:f,getDroppableRef:C});const E=F(()=>V.createElement(yd,{on:e.placeholder,shouldAnimate:e.shouldAnimatePlaceholder},({onClose:N,data:G,animate:A})=>V.createElement(xd,{placeholder:G,onClose:N,innerRef:j,animate:A,contextId:n,onTransitionEnd:R})),[n,R,e.placeholder,e.shouldAnimatePlaceholder,j]),O=F(()=>({innerRef:T,placeholder:E,droppableProps:{"data-rfd-droppable-id":c,"data-rfd-droppable-context-id":n}}),[n,c,E,T]),k=x?x.dragging.draggableId:null,B=F(()=>({droppableId:c,type:i,isUsingCloneFor:k}),[c,k,i]);function v(){if(!x)return null;const{dragging:N,render:G}=x,A=V.createElement(to,{draggableId:N.draggableId,index:N.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},(I,ne)=>G(I,ne,N));return ua.createPortal(A,D())}return V.createElement($n.Provider,{value:B},l(O,g),v())};function Cd(){return document.body||S(),document.body}const Tr={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:Cd},oo=e=>{let t={...e},n;for(n in Tr)e[n]===void 0&&(t={...t,[n]:Tr[n]});return t},Qt=(e,t)=>e===t.droppable.type,Or=(e,t)=>t.draggables[e.draggable.id],Nd=()=>{const e={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},t={...e,shouldAnimatePlaceholder:!1},n=K(r=>({draggableId:r.id,type:r.type,source:{index:r.index,droppableId:r.droppableId}})),s=K((r,l,c,i,u,d)=>{const f=u.descriptor.id;if(u.descriptor.droppableId===r){const g=d?{render:d,dragging:n(u.descriptor)}:null,x={isDraggingOver:c,draggingOverWith:c?f:null,draggingFromThisWith:f,isUsingPlaceholder:!0};return{placeholder:u.placeholder,shouldAnimatePlaceholder:!1,snapshot:x,useClone:g}}if(!l)return t;if(!i)return e;const m={isDraggingOver:c,draggingOverWith:f,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:u.placeholder,shouldAnimatePlaceholder:!0,snapshot:m,useClone:null}});return(r,l)=>{const c=oo(l),i=c.droppableId,u=c.type,d=!c.isDropDisabled,f=c.renderClone;if(nt(r)){const p=r.critical;if(!Qt(u,p))return t;const m=Or(p,r.dimensions),g=ae(r.impact)===i;return s(i,d,g,g,m,f)}if(r.phase==="DROP_ANIMATING"){const p=r.completed;if(!Qt(u,p.critical))return t;const m=Or(p.critical,r.dimensions);return s(i,d,Qs(p.result)===i,ae(p.impact)===i,m,f)}if(r.phase==="IDLE"&&r.completed&&!r.shouldFlush){const p=r.completed;if(!Qt(u,p.critical))return t;const m=ae(p.impact)===i,g=!!(p.impact.at&&p.impact.at.type==="COMBINE"),x=p.critical.droppable.id===i;return m?g?e:t:x?e:t}return t}},Sd={updateViewportMaxScroll:Pi},Dd=rs(Nd,Sd,(e,t,n)=>({...oo(n),...e,...t}),{context:On,areStatePropsEqual:Zs})(vd),jd=["0","1","2","3"],kd=({defaultPlayers:e,onSubmit:t})=>{const{register:n,reset:s,control:o,getValues:r,setValue:l}=dn({defaultValues:e}),c=vt({control:o,name:["0.propicUrl","0.logoUrl","1.propicUrl","1.logoUrl","2.propicUrl","2.logoUrl","3.propicUrl","3.logoUrl"]}),i=vt({control:o,name:["0.color","1.color","2.color","3.color"]}),u=h.useCallback(m=>{if(!m.destination)return;const g=["0","1","2","3"],[x]=g.splice(m.source.index,1);g.splice(m.destination.index,0,x),s({0:r(g[0]),1:r(g[1]),2:r(g[2]),3:r(g[3])})},[r,s]),d=h.useCallback(m=>{const g=m.currentTarget.getAttribute("data-index"),x=m.currentTarget.getAttribute("data-type"),y=r(`${g}.${x}`),D=prompt("新的圖片網址",y??"");D!==null&&l(`${g}.${x}`,D)},[r,l]),f=h.useCallback(()=>{s()},[s]),p=h.useCallback(()=>{t==null||t(r())},[r,t]);return h.useEffect(()=>{s({0:{...e[0]},1:{...e[1]},2:{...e[2]},3:{...e[3]}})},[e,s]),a.jsxs("div",{children:[a.jsxs("div",{className:"flex",children:[a.jsx("div",{className:"w-8"}),a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"flex font-semibold gap-2 text-center",children:[a.jsx("div",{className:"flex-1"}),a.jsx("div",{className:"flex-2",children:"圖片"}),a.jsx("div",{className:"flex-2",children:"隊伍"}),a.jsx("div",{className:"flex-5",children:"隊伍名稱／稱號"}),a.jsx("div",{className:"flex-5",children:"名稱"}),a.jsx("div",{className:"flex-3",children:"暱稱"}),a.jsx("div",{className:"flex-3",children:"顏色"})]})})]}),a.jsxs("div",{className:"flex",children:[a.jsxs("div",{className:"w-8 flex flex-col justify-around font-semibold",children:[a.jsx("div",{children:"東"}),a.jsx("div",{children:"南"}),a.jsx("div",{children:"西"}),a.jsx("div",{children:"北"})]}),a.jsx("div",{className:"flex-1",children:a.jsx(_u,{onDragEnd:u,children:a.jsx(Dd,{droppableId:"droppable",children:m=>a.jsxs("div",{...m.droppableProps,ref:m.innerRef,children:[jd.map((g,x)=>a.jsx(rd,{draggableId:g,index:x,children:y=>a.jsx("div",{ref:y.innerRef,...y.draggableProps,children:a.jsxs("div",{className:"flex gap-2 py-1 items-center",children:[a.jsx("div",{className:"flex-1",children:a.jsx("div",{className:"text-2xl",...y.dragHandleProps,children:a.jsx("i",{className:"bi bi-grip-vertical"})})}),a.jsx("div",{className:"flex-2 border border-neutral-400",children:a.jsx("img",{className:"aspect-18/25 w-full cursor-pointer",src:c[2*x],onClick:d,"data-type":"propicUrl","data-index":x,alt:""})}),a.jsx("div",{className:"flex-2 border border-neutral-400",children:a.jsx("img",{className:"aspect-square w-full cursor-pointer",src:c[2*x+1],onClick:d,"data-type":"teamPicUrl","data-index":x,alt:""})}),a.jsx("div",{className:"flex-5",children:a.jsx("input",{className:"w-full",...n(`${g}.secondaryName`)})}),a.jsx("div",{className:"flex-5",children:a.jsx("input",{className:"w-full",...n(`${g}.primaryName`)})}),a.jsx("div",{className:"flex-3",children:a.jsx("input",{className:"w-full",...n(`${g}.nickname`)})}),a.jsx("div",{className:"flex-3",children:a.jsx("input",{className:"w-full text-white",...n(`${g}.color`),style:{background:i[x]}})})]})})},g)),m.placeholder]})})})})]}),a.jsxs("div",{className:"flex mt-8",children:[a.jsx(J,{className:"flex-1",variant:"text",color:"secondary",onClick:f,children:"重置"}),a.jsx(J,{className:"flex-1",onClick:p,children:"儲存"})]})]})},ao=[["1m","2m","3m","4m","5m","6m","7m","8m","9m"],["1p","2p","3p","4p","5p","6p","7p","8p","9p"],["1s","2s","3s","4s","5s","6s","7s","8s","9s"],["1z","2z","3z","4z","5z","6z","7z"]],qe=()=>wo(ao.flat(2),0);function Rd({onSubmit:e,onRemove:t,canRemove:n,defaultValue:s}){const[o,r]=h.useState(qe()),l=h.useRef(""),c=h.useMemo(()=>Object.entries(o).filter(([,p])=>typeof p=="number"&&p!==0).map(([p,m])=>p+(m===2?"#":"")),[o]),i=h.useCallback(p=>{var g;const m=(g=p.currentTarget)==null?void 0:g.getAttribute("data-key");if(typeof o[m]<"u"){let x=0;l.current===m?x=(o[m]+1)%3:x=o[m]!==0?0:1,r(y=>(y[m]=x,{...y})),l.current=m}},[o]),u=h.useCallback(()=>{c.length>0&&e&&(e==null||e(c,!0),r(qe()))},[e,c]),d=h.useCallback(()=>{c.length>0&&e&&(e==null||e(c,!1),r(qe()))},[e,c]),f=h.useCallback(()=>{n&&(t==null||t(),r(qe()))},[n,t]);return h.useEffect(()=>{if(s){const p=qe();for(const m of s){const g=m[0]+m[1];p[g]=m[2]==="#"?2:1}r(p)}},[s]),a.jsxs("div",{children:[n&&a.jsx("div",{className:"mb-4",children:a.jsx("button",{className:"btn btn-sm btn-outline",type:"button",onClick:f,children:"移除全部聽牌"})}),a.jsx("div",{className:"mb-4 grid grid-cols-9 gap-1 lg:gap-x-2 lg:gap-y-4 items-center text-center",children:ao.map(p=>p.map(m=>a.jsx("button",{type:"button",onClick:i,"data-key":m,"data-status":o[m],className:"cursor-pointer opacity-100 data-[status=0]:opacity-50 data-[status=1]:bg-green-500 data-[status=2]:bg-gray-500",children:a.jsx("div",{className:"opacity-60",children:a.jsx(un,{children:m})})})))}),a.jsxs("div",{className:"flex gap-x-4",children:[a.jsx("div",{className:"flex-2",children:a.jsxs("button",{className:"btn btn-warning w-full",type:"button",onClick:u,disabled:c.length===0,children:[a.jsx("i",{className:"bi bi-exclamation-diamond"})," 振聽聽牌"]})}),a.jsx("div",{className:"flex-3",children:a.jsx("button",{className:"btn btn-primary w-full",type:"button",onClick:d,disabled:c.length===0,children:"確定"})})]})]})}function bt({value:e}){return a.jsx(fe,{value:e,positiveClassName:"text-green-600",negativeClassName:"text-red-600",signed:!0,hideZero:!0})}const xt=({rtMatch:e,rtMatchRound:t,playerIndex:n})=>{var s;return a.jsxs("div",{className:"text-xs",children:[a.jsxs("p",{children:[t.playerResults[n].isRiichi&&a.jsx("span",{children:"立"}),t.resultType===Y.Ron&&t.playerResults[n].type===Q.Lose&&a.jsx("span",{children:"統"}),t.resultType===Y.Ron&&t.playerResults[n].type===Q.Win&&a.jsx("span",{children:"和"}),t.resultType===Y.SelfDrawn&&t.playerResults[n].type===Q.Win&&a.jsx("span",{children:"摸"}),t.resultType===Y.Exhausted&&t.playerResults[n].type===Q.Win&&a.jsx("span",{children:"聽"})]}),t.playerResults[n].isRonDisallowed&&a.jsx("p",{className:"text-red-500 font-semibold",children:"和了禁止"}),(t.resultType===Y.Ron||t.resultType===Y.SelfDrawn)&&t.playerResults[n].type===Q.Win&&a.jsxs("div",{className:"bg-base-200 rounded-sm py-1 px-2 mx-auto inline-block",children:[a.jsx("p",{className:"font-bold",children:a.jsx(en,{className:"text-xs text-base-content",han:t.playerResults[n].detail.han,fu:t.playerResults[n].detail.fu,yakumanCount:t.playerResults[n].detail.yakumanCount,isManganRoundUp:e.setting.isManganRoundUp==="1"})}),a.jsx("p",{children:(s=t.playerResults[n].detail.yakus)==null?void 0:s.map(({label:o})=>o).join(" ")})]})]})};function Id({params:{matchId:e}}){const{data:t,set:n}=To("obs/1"),{rtMatch:s,rtMatchRounds:o,rtMatchCurrentRound:r,rtMatchCurrentRoundDoras:l,updateMatchRoundById:c,updateCurrentMatchRound:i,pushMatchRound:u,setCurrentRoundDoras:d,setMatchName:f,setMatchPlayers:p,setMatchPointDisplay:m,setMatchHideHeaderDisplay:g,setMatchHidePlayersDisplay:x,setMatchActiveResultDetail:y,setMatchRoundHasBroadcastedToTrue:D}=Po(e),C=h.useMemo(()=>Object.entries(o??{}).map(([b,P])=>({id:b,...P}))??[],[o]),T=h.useMemo(()=>C.filter(({resultDetail:b,hasBroadcasted:P})=>!!b&&!P),[C]),[j,R]=h.useState(void 0),[E,O]=Ie(!1),[k,B]=h.useState({initialActivePlayerIndex:"0",initialTargetPlayerIndex:"-1"}),v=Oo(),[N,G]=Ie(!1),[A,I]=Ie(!1),ne=h.useCallback(()=>{I(!0)},[I]),Se=h.useCallback(b=>{p(b),I(!1)},[p,I]),[be,z]=Ie(!1),[L,M]=Ie(!1),[he,Ge]=h.useState({id:null,rtMatchRound:null}),De=h.useCallback(b=>{const P=b.currentTarget.getAttribute("data-matchRoundId");if(!P)return;const $=o==null?void 0:o[P];$&&(Ge({id:P,rtMatchRound:$}),M(!0))},[o,M]),at=h.useCallback(b=>{if(!C||!he.id)return;const P=C.findIndex(({id:q})=>q===he.id);if(P===-1)return;c(he.id,b);let $=b;for(let q=P+1;q<C.length;q++){const{id:U,...H}=C[q],ge={...H,playerResults:{0:{...H.playerResults[0],beforeScore:$.playerResults[0].afterScore,afterScore:$.playerResults[0].afterScore+(H.playerResults[0].afterScore-H.playerResults[0].beforeScore)},1:{...H.playerResults[1],beforeScore:$.playerResults[1].afterScore,afterScore:$.playerResults[1].afterScore+(H.playerResults[1].afterScore-H.playerResults[1].beforeScore)},2:{...H.playerResults[2],beforeScore:$.playerResults[2].afterScore,afterScore:$.playerResults[2].afterScore+(H.playerResults[2].afterScore-H.playerResults[2].beforeScore)},3:{...H.playerResults[3],beforeScore:$.playerResults[3].afterScore,afterScore:$.playerResults[3].afterScore+(H.playerResults[3].afterScore-H.playerResults[3].beforeScore)}}};c(U,ge),$=ge}M(!1),setTimeout(()=>{alert("「下次小心d喇屌 :)」")},0)},[he.id,C,M,c]),[,re]=h.useState(null),we=h.useCallback(b=>{var $;const P=parseInt(($=b.currentTarget)==null?void 0:$.getAttribute("data-index"),10);typeof P<"u"&&!Number.isNaN(P)&&R(P)},[]),lt=h.useCallback(b=>{if(typeof j<"u"){const P=b[0];if(!P)return;const $=[...l];j===-1?$.push(P):$[j]=P,d($),R(void 0)}},[j,l,d]),Bt=h.useCallback(()=>{if(typeof j<"u"){const b=[...l];j>-1&&(b.splice(j,1),d(b),R(void 0))}},[j,l,d]),Te=h.useCallback(()=>{R(void 0)},[]),We=h.useCallback(()=>{G(!0)},[G]),Bn=h.useCallback(()=>{z(!0)},[z]),se=h.useCallback((b,P,$)=>{if(!s||!r)return;const q=s.players[b],U=r.playerResults[b];switch(P){case"reveal":return i({playerResults:{...r.playerResults,[b]:{...r.playerResults[b],isRevealed:!r.playerResults[b].isRevealed,detail:{...r.playerResults[b].detail,isRevealed:!r.playerResults[b].isRevealed}}}});case"riichi":return v.showConfirmDialog({title:U.isRiichi?"取消立直？":"確定要立直嗎？",content:U.isRiichi?`你是否想取消 ${q.primaryName} 的立直？`:`一旦點擊確定，就會播出立直動畫，請確定立直的是 ${q.primaryName}！`,onClickOk:async()=>{i({playerResults:{...r==null?void 0:r.playerResults,[b]:{...r==null?void 0:r.playerResults[b],isRiichi:!(r!=null&&r.playerResults[b].isRiichi),detail:{...r.playerResults[b].detail,isRiichied:!r.playerResults[b].isRiichi,raw:{...r.playerResults[b].detail.raw,riichi:!r.playerResults[b].isRiichi}}}}}),U.isRiichi||(re("立直動畫"),setTimeout(()=>{re(null)},2e3))}});case"ron-self":i({playerResults:{...r==null?void 0:r.playerResults,[b]:{...r==null?void 0:r.playerResults[b],detail:{...r.playerResults[b].detail,raw:{...r.playerResults[b].detail.raw,"menzenchin-tsumohou":!(r!=null&&r.playerResults[b].detail.isRevealed)}}}}}),B({initialActivePlayerIndex:b,initialTargetPlayerIndex:"-1"}),O();return;case"ron-before":i({playerResults:{...r==null?void 0:r.playerResults,[b]:{...r==null?void 0:r.playerResults[b],detail:{...r.playerResults[b].detail,raw:{...r.playerResults[b].detail.raw,"menzenchin-tsumohou":!1}}}}}),B({initialActivePlayerIndex:b,initialTargetPlayerIndex:Pr(b)}),O();return;case"ron-after":i({playerResults:{...r==null?void 0:r.playerResults,[b]:{...r==null?void 0:r.playerResults[b],detail:{...r.playerResults[b].detail,raw:{...r.playerResults[b].detail.raw,"menzenchin-tsumohou":!1}}}}}),B({initialActivePlayerIndex:b,initialTargetPlayerIndex:Ar(b)}),O();return;case"ron-opposite":i({playerResults:{...r==null?void 0:r.playerResults,[b]:{...r==null?void 0:r.playerResults[b],detail:{...r.playerResults[b].detail,raw:{...r.playerResults[b].detail.raw,"menzenchin-tsumohou":!1}}}}}),B({initialActivePlayerIndex:b,initialTargetPlayerIndex:$r(b)}),O();return;case"dora":return i({playerResults:{...r.playerResults,[b]:{...r.playerResults[b],detail:{...r.playerResults[b].detail,dora:$??0}}}});case"red-dora":return i({playerResults:{...r.playerResults,[b]:{...r.playerResults[b],detail:{...r.playerResults[b].detail,redDora:$??0}}}});case"waitingTile":return it({index:b,tiles:(r==null?void 0:r.playerResults[b].waitingTiles)??[]});case"yaku":return Ft({index:b});case"yellow-card":return v.showConfirmDialog({title:U.isYellowCarded?"取消黃牌？":"確定要給予這名玩家黃牌嗎？",content:U.isYellowCarded?`你是否想取消 ${q.primaryName} 的黃牌？`:`一旦點擊確定，就會播出黃牌動畫，請確定要黃牌的是 ${q.primaryName}！`,onClickOk:async()=>{i({playerResults:{...r==null?void 0:r.playerResults,[b]:{...r==null?void 0:r.playerResults[b],isYellowCarded:!(r!=null&&r.playerResults[b].isYellowCarded)}}})}});case"red-card":return v.showConfirmDialog({title:U.isRedCarded?"取消紅牌？":"確定要給予這名玩家紅牌嗎？",content:U.isRedCarded?`你是否想取消 ${q.primaryName} 的紅牌？`:`一旦點擊確定，就會播出紅牌動畫，請確定要紅牌的是 ${q.primaryName}！`,onClickOk:async()=>{i({playerResults:{...r==null?void 0:r.playerResults,[b]:{...r==null?void 0:r.playerResults[b],isRedCarded:!(r!=null&&r.playerResults[b].isRedCarded)}}})}});case"disallow-ron":return v.showConfirmDialog({title:U.isRedCarded?"取消和了禁止？":"確定要給予這名玩家和了禁止嗎？",content:U.isRedCarded?`你是否想取消 ${q.primaryName} 的和了禁止？`:`一旦點擊確定，就會播出紅牌動畫，請確定要和了禁止的是 ${q.primaryName}！`,onClickOk:async()=>{i({playerResults:{...r==null?void 0:r.playerResults,[b]:{...r==null?void 0:r.playerResults[b],isRonDisallowed:!(r!=null&&r.playerResults[b].isRonDisallowed)}}})}});case"push-reveal":{const ge=[...r.playerResults[b].reveals||[],$].some(Oe=>Oe.indexOf("0z")===-1);return i({playerResults:{...r.playerResults,[b]:{...r.playerResults[b],reveals:[...r.playerResults[b].reveals||[],$],isRevealed:ge,detail:{...r.playerResults[b].detail,isRevealed:ge}}}})}case"replace-reveal":{const H=r.playerResults[b].reveals||[],[ge,Oe]=$,Ue=H.indexOf(ge);if(Ue!==-1){H[Ue]=Oe;const ct=H.some(Do=>Do.indexOf("0z")===-1);return i({playerResults:{...r.playerResults,[b]:{...r.playerResults[b],reveals:H,isRevealed:ct,detail:{...r.playerResults[b].detail,isRevealed:ct}}}})}return}case"delete-reveal":{const H=r.playerResults[b].reveals||[],ge=$,Oe=H.indexOf(ge);if(Oe!==-1){H.splice(Oe,1);const Ue=H.some(ct=>ct.indexOf("0z")===-1);return i({playerResults:{...r.playerResults,[b]:{...r.playerResults[b],reveals:H,isRevealed:Ue,detail:{...r.playerResults[b].detail,isRevealed:Ue}}}})}return}case"waiting-tile-remain":return i({playerResults:{...r.playerResults,[b]:{...r.playerResults[b],waitingTileRemain:$}}})}},[v,s,r,O,i]),je=h.useCallback(b=>{try{const P=Gn(b.roundCount),$=b.playerResults[P].type===Q.Win,q=!$&&b.roundCount>=8;q&&alert("對局結束。"),i({...b,nextRoundType:q?W.End:$?W.Extended:W.NextRound}),O(!1),re("分數變動中…"),setTimeout(()=>{re(null)},4e3)}catch(P){console.error(P)}},[O,i]),lo=h.useCallback(b=>{try{const P=Gn(b.roundCount),$=b.playerResults[P].type!==Q.Win,q=$&&b.roundCount>=8;if(q)if(b.nextRoundCumulatedThousands>0){const U=Fo([b.playerResults[0].afterScore,b.playerResults[1].afterScore,b.playerResults[2].afterScore,b.playerResults[3].afterScore],b.nextRoundCumulatedThousands*1e3);U[0]!==0&&(b.playerResults[0].scoreChanges.unshift(U[0]),b.playerResults[0].afterScore+=U[0]),U[1]!==0&&(b.playerResults[1].scoreChanges.unshift(U[1]),b.playerResults[1].afterScore+=U[1]),U[2]!==0&&(b.playerResults[2].scoreChanges.unshift(U[2]),b.playerResults[2].afterScore+=U[2]),U[3]!==0&&(b.playerResults[3].scoreChanges.unshift(U[3]),b.playerResults[3].afterScore+=U[3]),alert(`對局結束。終局時剩餘的 ${b.nextRoundCumulatedThousands*1e3} 供託已派給首位。`)}else alert("對局結束。");i({...b,nextRoundType:q?W.End:$?W.NextRoundAndExtended:W.Extended}),G(!1),re("分數變動中…"),setTimeout(()=>{re(null)},4e3)}catch(P){console.error(P)}},[G,i]),io=h.useCallback(b=>{try{i({playerResults:b.playerResults,resultType:Y.Hotfix});const P={matchId:e,code:Un(e,b.roundCount,b.extendedRoundCount),roundCount:b.roundCount,extendedRoundCount:b.extendedRoundCount,cumulatedThousands:b.cumulatedThousands,nextRoundCumulatedThousands:0,resultType:Y.Unknown,nextRoundType:W.Unknown,playerResults:Wn(b.playerResults),doras:(r==null?void 0:r.doras)??[]};u(P),re("分數變動中…"),setTimeout(()=>{re(null)},4e3),z(!1)}catch(P){console.error(P)}},[r==null?void 0:r.doras,e,u,z,i]),Fn=h.useCallback(()=>{if(!r)return;const b=r.nextRoundType===W.NextRound||r.nextRoundType===W.NextRoundAndExtended?r.roundCount+1:r.roundCount,P=r.nextRoundType===W.Extended||r.nextRoundType===W.NextRoundAndExtended?r.extendedRoundCount+1:0,$={matchId:e,code:Un(e,b,P),roundCount:b,extendedRoundCount:P,cumulatedThousands:r.nextRoundCumulatedThousands,nextRoundCumulatedThousands:0,resultType:Y.Unknown,nextRoundType:W.Unknown,playerResults:Wn(r.playerResults),doras:{}};u($).then(()=>{R(-1)})},[r,e,u]),co=h.useCallback(()=>{n({matchId:e})},[e,n]),[ie,it]=h.useState(null),uo=h.useCallback(()=>{it(null)},[]),po=h.useCallback((b,P)=>{ie&&(i({playerResults:{...r==null?void 0:r.playerResults,[ie.index]:{...r==null?void 0:r.playerResults[ie.index],waitingTiles:b,isFuriten:P}}}),it(null))},[ie,r==null?void 0:r.playerResults,i]),fo=h.useCallback(()=>{ie&&(i({playerResults:{...r==null?void 0:r.playerResults,[ie.index]:{...r==null?void 0:r.playerResults[ie.index],waitingTiles:[]}}}),it(null))},[ie,r==null?void 0:r.playerResults,i]),[ce,Ft]=h.useState(null),mo=h.useCallback(()=>{Ft(null)},[]),ho=h.useCallback(b=>{!r||!ce||(i({playerResults:{...r.playerResults,[ce.index]:{...r.playerResults[ce.index],detail:{...r.playerResults[ce.index].detail,...b}}}}),Ft(null))},[ce,r,i]),go=h.useCallback(b=>{if(b.preventDefault(),!s)return;const P=prompt("對局名稱",s.name);P&&f(P)},[s,f]),_n=h.useCallback(b=>{if(!o)return;const P=b.currentTarget.getAttribute("data-rtMatch-round-id");if(!P)return;const $=o[P].resultDetail;$&&(y($),D(P),re("播放和牌中…"),setTimeout(()=>{y(null),re(null)},1e4))},[o,y,D]),bo=h.useCallback(()=>{y(null)},[y]),xo=h.useCallback(()=>{m(!0)},[m]),yo=h.useCallback(()=>{m(!1)},[m]),vo=h.useCallback(()=>{g(!0)},[g]),Co=h.useCallback(()=>{g(!1)},[g]),No=h.useCallback(()=>{x(!0)},[x]),So=h.useCallback(()=>{x(!1)},[x]);return!s||!r?a.jsx("div",{children:"對局讀取失敗。"}):a.jsxs("div",{children:[a.jsxs("div",{className:"container mx-auto my-8 px-8 space-y-24 pb-48",children:[a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-row items-center gap-x-4 text-white",children:[a.jsxs("div",{className:"p-2 pl-4 pr-10 flex items-center gap-x-8 transition-[width] text-[4rem]",style:{background:"linear-gradient(280deg, transparent, transparent 22px, #00000080 23px, #00000080 100%)"},children:[a.jsxs("div",{className:"text-[0.5em] relative",children:[a.jsx("div",{className:"text-[0.5em]",children:a.jsxs("button",{type:"button",onClick:go,children:[s.name," ",a.jsx("i",{className:"bi bi-pencil"})]})}),a.jsxs("div",{className:"flex gap-x-8 items-center",children:[a.jsx("div",{children:a.jsx(ut,{roundCount:r.roundCount,max:8})}),a.jsxs("div",{className:"flex flex-col justify-around",children:[a.jsxs("div",{className:"flex-1 flex flex-row items-center gap-x-3",children:[a.jsx("div",{className:"flex-1",children:a.jsx("img",{src:"/mj-stream-web/images/score-hundred.png",alt:"hundred",className:"h-2"})}),a.jsx("div",{className:"text-[0.4em] pb-1.5 leading-none",children:r.extendedRoundCount??0})]}),a.jsxs("div",{className:"flex-1 flex flex-row items-center gap-x-3",children:[a.jsx("div",{className:"flex-1",children:a.jsx("img",{src:"/mj-stream-web/images/score-thousand.png",alt:"thousand",className:"h-2"})}),a.jsx("div",{className:"text-[0.4em] pb-1.5 leading-none",children:r.cumulatedThousands??0})]})]})]}),s.hideHeader&&a.jsx("div",{className:"absolute inset-0 opacity-100 bg-red-800 text-center",children:"隱藏中"})]}),a.jsxs("div",{className:"flex items-center gap-x-2",children:[l.map((b,P)=>a.jsx("button",{"data-index":P,onClick:we,className:"hover:opacity-80",children:a.jsx(un,{className:"w-12! animate-[fadeInFromLeft_0.5s_ease-in-out]",children:b},b)})),a.jsx(J,{type:"button",color:l.length===0?"danger":"secondary",className:`${l.length===0&&"animate-bounce"}`,"data-index":"-1",onClick:we,children:"+懸賞"})]})]}),a.jsx("div",{className:"flex-1"}),a.jsx("div",{className:"shrink-0",children:(t==null?void 0:t.matchId)!==e&&a.jsx(J,{color:"success",type:"button",className:"animate-pulse",onClick:co,children:"開始OBS"})})]}),a.jsx("div",{className:"flex justify-end gap-x-8 ",children:a.jsxs("div",{className:"text-right space-x-4",children:[s.activeResultDetail&&a.jsxs(J,{color:"secondary",type:"button",onClick:bo,children:["結束播放中的和牌詳情",a.jsx("br",{}),a.jsx("span",{className:"text-xs",children:"(或最多10秒後自動結束)"})]}),r.nextRoundType!==W.Unknown&&r.nextRoundType!==W.End&&a.jsxs(J,{color:"success",type:"button",className:"animate-pulse",onClick:Fn,children:["進入",a.jsx(ut,{roundCount:r.nextRoundType===W.NextRound||r.nextRoundType===W.NextRoundAndExtended?r.roundCount+1:r.roundCount,extendedRoundCount:r.nextRoundType===W.Extended||r.nextRoundType===W.NextRoundAndExtended?r.extendedRoundCount+1:0})]}),a.jsx(J,{color:"secondary",type:"button",onClick:We,children:"流局"})]})}),a.jsx(Zo,{players:s.players,currentRound:r,onAction:se}),a.jsx("div",{children:a.jsxs(J,{size:"small",color:"secondary",onClick:ne,children:[a.jsx("i",{className:"bi bi-people"})," 修改玩家"]})})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("h4",{className:"text-3xl",children:[a.jsx("i",{className:"bi bi-bar-chart-steps"})," 紀錄"," ",a.jsx("span",{className:"text-sm",children:"( 立=立直, 和=和牌, 統=出統, 摸=自摸, 聽=聽牌 )"})]}),a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-gray-400 [&>th]:p-2",children:[a.jsx("th",{className:"whitespace-nowrap px-16",children:"局數"}),a.jsx("th",{children:s.players[0].nickname}),a.jsx("th",{children:s.players[1].nickname}),a.jsx("th",{children:s.players[2].nickname}),a.jsx("th",{children:s.players[3].nickname}),a.jsx("th",{className:"text-right",children:"操作"})]})}),a.jsxs("tbody",{children:[C[0]&&a.jsxs("tr",{className:"even:bg-gray-200 [&>td]:p-2",children:[a.jsx("td",{className:"text-center"}),a.jsx("td",{className:"text-center",children:a.jsx(fe,{value:C[0].playerResults[0].beforeScore})}),a.jsx("td",{className:"text-center",children:a.jsx(fe,{value:C[0].playerResults[1].beforeScore})}),a.jsx("td",{className:"text-center",children:a.jsx(fe,{value:C[0].playerResults[2].beforeScore})}),a.jsx("td",{className:"text-center",children:a.jsx(fe,{value:C[0].playerResults[3].beforeScore})}),a.jsx("td",{})]}),C.map(b=>b.resultType===Y.Hotfix?a.jsxs("tr",{className:"even:bg-gray-200 [&>td]:p-2",children:[a.jsx("td",{className:"text-center whitespace-nowrap px-16",children:"手動調整"}),a.jsx("td",{className:"text-center",children:b.playerResults[0].afterScore}),a.jsx("td",{className:"text-center",children:b.playerResults[1].afterScore}),a.jsx("td",{className:"text-center",children:b.playerResults[2].afterScore}),a.jsx("td",{className:"text-center",children:b.playerResults[3].afterScore}),a.jsx("td",{})]},b.id):a.jsxs("tr",{className:"even:bg-gray-200 [&>td]:p-2",children:[a.jsx("td",{className:"text-center whitespace-nowrap",children:a.jsx(ut,{roundCount:b.roundCount,extendedRoundCount:b.extendedRoundCount,max:8,className:"px-4"})}),a.jsxs("td",{className:"text-center",children:[a.jsx(bt,{value:b.playerResults[0].afterScore-b.playerResults[0].beforeScore}),a.jsx(xt,{rtMatch:s,rtMatchRound:b,playerIndex:"0"})]}),a.jsxs("td",{className:"text-center",children:[a.jsx(bt,{value:b.playerResults[1].afterScore-b.playerResults[1].beforeScore}),a.jsx(xt,{rtMatch:s,rtMatchRound:b,playerIndex:"1"})]}),a.jsxs("td",{className:"text-center",children:[a.jsx(bt,{value:b.playerResults[2].afterScore-b.playerResults[2].beforeScore}),a.jsx(xt,{rtMatch:s,rtMatchRound:b,playerIndex:"2"})]}),a.jsxs("td",{className:"text-center",children:[a.jsx(bt,{value:b.playerResults[3].afterScore-b.playerResults[3].beforeScore}),a.jsx(xt,{rtMatch:s,rtMatchRound:b,playerIndex:"3"})]}),a.jsxs("td",{className:"text-right space-x-2",children:[(b.resultType===Y.Ron||b.resultType===Y.SelfDrawn)&&a.jsxs(J,{color:b.hasBroadcasted?"secondary":"success",type:"button",variant:"text",className:b.hasBroadcasted?"opacity-50":"",onClick:_n,"data-rtMatch-round-id":b.id,children:[a.jsx("i",{className:"bi bi-camera-reels"})," ",b.hasBroadcasted?"已播放過":"播放和牌詳情"]}),b.resultType!==Y.Unknown&&a.jsxs(J,{variant:"text",color:"danger","data-matchRoundId":b.id,onClick:De,children:[a.jsx("i",{className:"bi bi-pencil"})," 修改"]})]})]},b.id)),C[C.length-1]&&a.jsxs("tr",{className:"even:bg-gray-200 [&>td]:p-2",children:[a.jsx("td",{className:"text-center whitespace-nowrap px-16",children:a.jsxs(J,{onClick:Bn,size:"small",color:"secondary",children:[a.jsx("i",{className:"bi bi-pencil"})," 手動調整分數"]})}),a.jsx("td",{className:"text-center font-bold text-lg",children:a.jsx(fe,{value:C[C.length-1].playerResults[0].afterScore})}),a.jsx("td",{className:"text-center font-bold text-lg",children:a.jsx(fe,{value:C[C.length-1].playerResults[1].afterScore})}),a.jsx("td",{className:"text-center font-bold text-lg",children:a.jsx(fe,{value:C[C.length-1].playerResults[2].afterScore})}),a.jsx("td",{className:"text-center font-bold text-lg",children:a.jsx(fe,{value:C[C.length-1].playerResults[3].afterScore})}),a.jsx("td",{})]})]})]})]})]}),a.jsx(xe,{open:typeof j<"u",title:"選擇懸賞",onClose:Te,children:a.jsx(Uo,{hideRedTiles:!0,onSubmit:lt,onRemove:Bt,canRemove:typeof j<"u"&&j>0,defaultValue:typeof j<"u"?[l[j]]:void 0})}),a.jsx(xe,{open:!!ie,title:"選擇待牌",onClose:uo,children:a.jsx(Rd,{onSubmit:po,onRemove:fo,defaultValue:ie==null?void 0:ie.tiles,canRemove:!0})}),a.jsx(sa,{round:r.roundCount,activePlayerIndex:(ce==null?void 0:ce.index)??"0",targetPlayerIndex:"-1",open:!!ce,onClose:mo,onSubmit:ho,defaultValue:r.playerResults[(ce==null?void 0:ce.index)??"0"].detail}),a.jsx(xe,{title:"和了",open:E,onClose:()=>O(!1),children:a.jsx(Yr,{rtMatch:s,currentMatchRound:r,onSubmit:je,...k})}),a.jsx(xe,{title:"流局",open:N,onClose:()=>G(!1),children:a.jsx(Jr,{rtMatch:s,currentMatchRound:r,onSubmit:lo,...k})}),a.jsx(xe,{title:"修改玩家",open:A,onClose:()=>I(!1),children:a.jsx(kd,{defaultPlayers:s.players,onSubmit:Se})}),a.jsx(xe,{title:"手動調整分數",open:be,onClose:()=>z(!1),children:a.jsx(ia,{rtMatch:s,currentMatchRound:r,onSubmit:io,...k})}),a.jsx(xe,{title:"修改局數",open:L,onClose:()=>M(!1),children:a.jsx(ca,{rtMatch:s,rtMatchRound:he.rtMatchRound,onSubmit:at})}),a.jsxs("div",{className:"fixed bottom-0 left-0 right-0 pl-6 pr-6 pb-6 z-50 flex justify-between items-end bg-linear-to-b from-transparent to-[#00000080]",children:[a.jsx("div",{className:"text-left"}),a.jsxs("div",{children:[a.jsxs("div",{className:"text-right mb-4",children:[r.nextRoundType!==W.Unknown&&r.nextRoundType!==W.End&&a.jsxs("button",{className:"text-6xl p-4 text-green-800 bg-green-400 border-4 border-green-600 rounded-lg",onClick:Fn,children:["進入",a.jsx(ut,{roundCount:r.nextRoundType===W.NextRound||r.nextRoundType===W.NextRoundAndExtended?r.roundCount+1:r.roundCount,extendedRoundCount:r.nextRoundType===W.Extended||r.nextRoundType===W.NextRoundAndExtended?r.extendedRoundCount+1:0})," ",a.jsx("i",{className:"bi bi-play-fill"})]}),r.nextRoundType===W.End&&a.jsx("a",{href:`/panel/realtime/matches/${s.code}/detail`,target:"_blank",children:a.jsxs("button",{className:"text-6xl p-4 text-yellow-800 bg-yellow-400 border-4 border-yellow-600 rounded-lg",children:["上傳成績",a.jsx("i",{className:"bi bi-cloud-upload"})]})})]}),a.jsxs("div",{className:"flex gap-x-6 items-end justify-end",children:[!s.hideHeader&&a.jsxs("button",{onClick:vo,className:"relative rounded-full py-2 px-4 shadow-sm shadow-neutral-700 text-center bg-neutral-200 border border-neutral-300 leading-6 text-neutral-600",children:[a.jsx("i",{className:"bi bi-eye"})," 標題：顯示中"]}),s.hideHeader&&a.jsxs("button",{onClick:Co,className:"relative rounded-full py-2 px-4 shadow-sm shadow-neutral-700 text-center bg-red-600 border border-red-500 leading-6 text-white",children:[a.jsx("i",{className:"bi bi-eye-slash"})," 標題：隱藏中"]}),!s.hidePlayers&&a.jsxs("button",{onClick:No,className:"relative rounded-full py-2 px-4 shadow-sm shadow-neutral-700 text-center bg-neutral-200 border border-neutral-300 leading-6 text-neutral-600",children:[a.jsx("i",{className:"bi bi-people-fill"})," 玩家：顯示中"]}),s.hidePlayers&&a.jsxs("button",{onClick:So,className:"relative rounded-full py-2 px-4 shadow-sm shadow-neutral-700 text-center bg-red-600 border border-red-500 leading-6 text-white",children:[a.jsx("i",{className:"bi bi-people"})," 玩家：隱藏中"]}),!s.showPoints&&a.jsxs("button",{onClick:xo,className:"relative rounded-full py-2 px-4 shadow-sm shadow-neutral-700 text-center bg-neutral-200 border border-neutral-300 leading-6 text-neutral-600",children:[a.jsx("i",{className:"bi bi-list-ol"})," 切換播放馬點＆名次"]}),s.showPoints&&a.jsxs("button",{onClick:yo,className:"relative rounded-full py-2 px-4 shadow-sm shadow-neutral-700 text-center bg-green-300 border border-green-300 leading-6 text-green-800",children:[a.jsx("i",{className:"bi bi-list-ol"})," 切換播放馬點＆名次"]}),T.map(b=>a.jsx("button",{onClick:_n,"data-rtMatch-round-id":b.id,className:"relative rounded-full py-2 px-4 shadow-sm shadow-neutral-700 text-center bg-red-200 border border-red-300 leading-6 text-red-800 animate-bounce",children:a.jsxs("p",{children:[a.jsx("i",{className:"bi bi-trophy"})," ",b.roundCount,".",b.extendedRoundCount," 和牌動畫：待播放"]})}))]})]})]}),a.jsx("div",{className:"text-right text-base-300",children:s.code})]})}function Gd(){var n;const{data:e}=Lo(),t=h.useMemo(()=>{var s;return{matchId:((s=e==null?void 0:e.activeMatch)==null?void 0:s.id)??(e==null?void 0:e.matchId)}},[(n=e==null?void 0:e.activeMatch)==null?void 0:n.id,e==null?void 0:e.matchId]);return!t||!t.matchId?a.jsx(a.Fragment,{children:"讀取中…"}):a.jsx(Id,{params:t})}export{Gd as default};
