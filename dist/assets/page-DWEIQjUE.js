import{T as q,a as B,r as p,U as F,j as e,Q as y,e as G,d as k,V as N,W as X}from"./index-0LaFy2cp.js";const Y={"match-introduction":"_match-introduction_d92b1_239"},Z=({slide:r,status:a,subslide:m})=>r.type==="teams"?e.jsxs("div",{className:"text-[#78012c] absolute px-24 inset-0 flex flex-col justify-center items-stretch",style:{opacity:a>=0&&a<1?1:0},children:[e.jsx("div",{className:"flex-1"}),e.jsx("div",{className:"flex-3 grid grid-cols-4 items-center",children:["playerEast","playerSouth","playerWest","playerNorth"].map((l,c)=>e.jsxs("div",{className:y("relative h-full overflow-hidden",{"mi-teams-in":a===0,"mi-teams-out":a>0}),style:{animationDelay:a===0?c*.25+"s":"0s",filter:r.teamAndPlayers[l].result.ranking!=="1"?"grayscale(1)":"grayscale(0)"},children:[e.jsx("div",{className:"absolute inset-0 -z-10",style:{background:`linear-gradient(to bottom, transparent, ${r.teamAndPlayers[l].player.color})`,opacity:.5}}),e.jsx("div",{className:"absolute inset-0 -z-10",style:{background:`url(${r.teamAndPlayers[l].player.largeLogoUrl+"?w=800&h=800&auto=format"})`,backgroundRepeat:"no-repeat",backgroundPosition:"center center",opacity:.05}}),e.jsxs("div",{className:y("absolute inset-0",{"mi-teams-team-out":a>=0&&m>0}),children:[e.jsx("img",{src:r.teamAndPlayers[l].player.propicUrl,className:"aspect-[18/25] w-full",alt:""}),e.jsx("h3",{className:"text-[1.5em] font-semibold text-center",children:r.teamAndPlayers[l].player.primaryName}),e.jsxs("h3",{className:"text-[1.5em] font-semibold text-center flex justify-between px-[.5em]",children:[e.jsx("span",{children:G(r.teamAndPlayers[l].result.ranking)}),e.jsx("span",{children:k(r.teamAndPlayers[l].result.point)})]})]})]},l))})]}):r.type==="players"?e.jsxs("div",{className:"absolute px-24 pb-24 inset-0 flex flex-col justify-center items-stretch",style:{opacity:a>=0&&a<1?1:0},children:[e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"flex-3 flex flex-col items-stretch",children:[e.jsxs("div",{className:y("flex gap-x-[1em] pl-[1em] mb-[.5em] items-end",{"mi-teams-in":a===0,"mi-teams-out":a>0}),children:[e.jsxs("div",{className:"flex-5 space-x-[1.5em] text-[1.1em]",children:[e.jsxs("span",{children:[e.jsx("span",{className:"text-[1.5em]",children:r.roundCount})," 總局數"]}),e.jsxs("span",{className:"opacity-80",children:["（"," ",e.jsx("span",{className:"text-[1.5em]",children:r.exhaustedRoundCount})," ","流局數 ）"]})]}),e.jsx("div",{className:"flex-1 text-right text-[.9em] font-semibold",children:"分數"}),e.jsx("div",{className:"flex-1 text-right text-[.9em] font-semibold",children:"立直次數"}),e.jsx("div",{className:"flex-1 text-right text-[.9em] font-semibold",children:"和了次數"}),e.jsx("div",{className:"flex-1 text-right text-[.9em] font-semibold",children:"放銃次數"})]}),r.teamAndPlayers.map(({player:l,result:c},n)=>e.jsxs("div",{className:y("text-[#78012c] relative overflow-hidden flex-1",{"mi-teams-in":a===0,"mi-teams-out":a>0}),style:{animationDelay:a===0?n*.25+"s":"0s"},children:[e.jsx("div",{className:"absolute inset-0 -z-10",style:{background:`linear-gradient(to left, transparent, ${l.color})`,opacity:.5}}),e.jsx("div",{className:"absolute inset-0 -z-10",style:{background:`url(${l.largeLogoUrl+"?w=800&h=800&auto=format"})`,backgroundRepeat:"no-repeat",backgroundPosition:"center center",opacity:.05}}),e.jsxs("div",{className:y("absolute inset-0 flex gap-x-[1em] items-center pl-[1em]",{"mi-teams-team-out":a>=0&&m>0}),children:[e.jsx("div",{className:"text-left flex-5",children:e.jsx("h3",{className:"text-[1.5em] font-semibold",children:l.primaryName})}),e.jsxs("div",{className:"flex-1 text-right",children:[e.jsx("p",{className:"text-[1.5em] leading-[1em]",children:N(c.score)}),e.jsx("p",{children:k(c.point)})]}),e.jsxs("div",{className:"flex-1 text-right",children:[e.jsx("span",{className:"text-[1.5em]",children:N(c.riichiCount)}),"回"]}),e.jsxs("div",{className:"flex-1 text-right",children:[e.jsx("span",{className:"text-[1.5em]",children:N(c.ronCount)}),"回"]}),e.jsxs("div",{className:"flex-1 text-right",children:[e.jsx("span",{className:"text-[1.5em]",children:N(c.chuckCount)}),"回"]})]})]},n))]})]}):r.type==="chart"?e.jsxs("div",{className:"text-[#78012c] absolute py-16 px-24 inset-0 flex flex-col justify-center items-stretch",style:{opacity:a>=0&&a<1?1:0},children:[e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"flex-3 flex items-stretch gap-x-[1em]",children:[e.jsx("div",{className:y("flex-3",{"mi-chart-chart-in":a===0,"mi-chart-chart-out":a>0}),children:e.jsx(X,{rounds:r.rounds,players:r.players})}),e.jsx("div",{className:"flex-1 flex flex-col pb-[1em]",children:[0,1,2,3].map(l=>e.jsxs("div",{className:y("relative overflow-hidden flex-1 pl-[.5em] flex flex-col justify-center",{"mi-chart-player-in":a===0,"mi-chart-player-out":a>0}),style:{background:`linear-gradient(to left, transparent, ${r.teamAndPlayers[l].player.color}C0)`,animationDelay:a===0?l*.25+"s":"0s"},children:[e.jsx("img",{src:r.teamAndPlayers[l].player.logoUrl+"?w=320&h=320",alt:r.teamAndPlayers[l].player.primaryName,className:"absolute left-0 opacity-10 -z-10"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:e.jsx("p",{className:"text-[1.5em] leading-[1em]",children:r.teamAndPlayers[l].player.primaryName})}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[1.5em] leading-[1em]",children:r.teamAndPlayers[l].result.score}),e.jsx("p",{className:"text-[.75em]",children:k(r.teamAndPlayers[l].result.point)})]})]})]},l))})]})]}):e.jsx(e.Fragment,{}),ee=({params:{matchId:r},forwardFlag:a,resetFlag:m,disableClick:l})=>{const{data:c}=q(r),{rtMatch:n,rtMatchRounds:d}=B(r),j=p.useMemo(()=>{var W,A,R,M,w,_,I,T,U,$,z,D,L,H;if(!n||!d)return[{type:"empty",_id:"empty",subslide:0}];const t=F(Object.values(d)),o=[{type:"empty",_id:"empty",subslide:0},{type:"teams",_id:"teams",teamAndPlayers:{playerEast:{player:n.players[0],result:{point:t.result.playerEast.point,ranking:t.result.playerEast.ranking}},playerSouth:{player:n.players[1],result:{point:t.result.playerSouth.point,ranking:t.result.playerSouth.ranking}},playerWest:{player:n.players[2],result:{point:t.result.playerWest.point,ranking:t.result.playerWest.ranking}},playerNorth:{player:n.players[3],result:{point:t.result.playerNorth.point,ranking:t.result.playerNorth.ranking}}},subslide:1}],i={playerEast:{score:((W=t.result.playerEast)==null?void 0:W.score)??25e3,point:((A=t.result.playerEast)==null?void 0:A.point)??0,ranking:((R=t.result.playerEast)==null?void 0:R.ranking)??"1",ronCount:0,riichiCount:0,chuckCount:0,scores:[25e3]},playerSouth:{score:((M=t.result.playerSouth)==null?void 0:M.score)??25e3,point:((w=t.result.playerSouth)==null?void 0:w.point)??0,ranking:((_=t.result.playerSouth)==null?void 0:_.ranking)??"1",ronCount:0,riichiCount:0,chuckCount:0,scores:[25e3]},playerWest:{score:((I=t.result.playerWest)==null?void 0:I.score)??25e3,point:((T=t.result.playerWest)==null?void 0:T.point)??0,ranking:((U=t.result.playerWest)==null?void 0:U.ranking)??"1",ronCount:0,riichiCount:0,chuckCount:0,scores:[25e3]},playerNorth:{score:(($=t.result.playerNorth)==null?void 0:$.score)??25e3,point:((z=t.result.playerNorth)==null?void 0:z.point)??0,ranking:((D=t.result.playerNorth)==null?void 0:D.ranking)??"1",ronCount:0,riichiCount:0,chuckCount:0,scores:[25e3]}};for(const s of t.rounds)i.playerEast.scores.push(s.playerEast.afterScore),i.playerSouth.scores.push(s.playerSouth.afterScore),i.playerWest.scores.push(s.playerWest.afterScore),i.playerNorth.scores.push(s.playerNorth.afterScore),s.playerEast.status==="isRiichied"&&(i.playerEast.riichiCount+=1),s.playerSouth.status==="isRiichied"&&(i.playerSouth.riichiCount+=1),s.playerWest.status==="isRiichied"&&(i.playerWest.riichiCount+=1),s.playerNorth.status==="isRiichied"&&(i.playerNorth.riichiCount+=1),(s.type==="ron"||s.type==="tsumo")&&(s.playerEast.type==="win"&&(i.playerEast.ronCount+=1),s.playerSouth.type==="win"&&(i.playerSouth.ronCount+=1),s.playerWest.type==="win"&&(i.playerWest.ronCount+=1),s.playerNorth.type==="win"&&(i.playerNorth.ronCount+=1)),s.type==="ron"&&(s.playerEast.type==="lose"&&(i.playerEast.chuckCount+=1),s.playerSouth.type==="lose"&&(i.playerSouth.chuckCount+=1),s.playerWest.type==="lose"&&(i.playerWest.chuckCount+=1),s.playerNorth.type==="lose"&&(i.playerNorth.chuckCount+=1));const P=[{player:n.players[0],result:i.playerEast},{player:n.players[1],result:i.playerSouth},{player:n.players[2],result:i.playerWest},{player:n.players[3],result:i.playerNorth}].sort((s,S)=>S.result.score-s.result.score);o.push({type:"players",_id:"players",teamAndPlayers:P,roundCount:((L=t.rounds)==null?void 0:L.filter(s=>s.type!=="hotfix").length)??0,exhaustedRoundCount:((H=t.rounds)==null?void 0:H.filter(s=>s.type==="exhausted").length)??0,subslide:1});const V=t.rounds.findIndex(s=>s.code.startsWith("5."));return o.push({type:"chart",_id:"chart",rounds:[{name:"東",playerEast:25e3,playerSouth:25e3,playerWest:25e3,playerNorth:25e3},...t.rounds.map((s,S)=>({name:S===V?"南":"",playerEast:s.playerEast.afterScore,playerSouth:s.playerSouth.afterScore,playerWest:s.playerWest.afterScore,playerNorth:s.playerNorth.afterScore}))],players:{playerEast:{name:n.players[0].primaryName,color:n.players[0].color},playerSouth:{name:n.players[1].primaryName,color:n.players[1].color},playerWest:{name:n.players[2].primaryName,color:n.players[2].color},playerNorth:{name:n.players[3].primaryName,color:n.players[3].color}},teamAndPlayers:P,subslide:1}),o},[n,d]),[g,h]=p.useState(0),[v,x]=p.useState(0),[C,f]=p.useState(!1),[b,J]=p.useState(a??0),[E,O]=p.useState(m??0),u=p.useCallback(()=>{if(C)return;const t=j[g];if(!t){h(1);return}t.type==="empty"?h(o=>o+1):v>=t.subslide-1?(h(o=>o+.5),f(!0),setTimeout(()=>{h(o=>Math.ceil(o)),x(0),f(!1)},1200)):(x(o=>o+.5),f(!0),setTimeout(()=>{x(o=>Math.ceil(o)),f(!1)},1200))},[C,g,j,v]),Q=p.useCallback(()=>{l||u()},[l,u]);return p.useEffect(()=>{typeof a<"u"&&a!==b&&(u(),J(a))},[a,u,b]),p.useEffect(()=>{typeof m<"u"&&m!==E&&(h(0),x(0),O(m))},[a,u,b,E,m]),!n||!d||!c?e.jsx(e.Fragment,{}):e.jsxs("div",{className:`${Y["match-introduction"]} absolute inset-0 text-[#ec276e] text-[36px]`,style:{background:"linear-gradient(to bottom, rgb(255, 217, 227), rgb(255, 192, 203)"},onClick:Q,children:[e.jsx("div",{className:"absolute py-16 px-24 inset-0",children:e.jsxs("div",{className:"flex items-end gap-x-[0.25em] mi-title-in",children:[e.jsx("div",{children:e.jsx("img",{src:c.tournament.logoUrl+"?w=280&h=280&auto=format",alt:c.tournament.name,style:{width:"3.5em",height:"3.5em",marginTop:"0.15em"}})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-[1.25em] leading-[1em]",children:c.tournament.name}),e.jsx("h1",{className:"text-[2em] leading-[1.2em] font-semibold",children:c.name})]}),e.jsx("div",{children:e.jsx("h1",{className:"text-[2em] leading-[1.2em] font-semibold",children:"對局結果"})})]})}),j.map((t,o)=>e.jsx(Z,{slide:t,status:g-o,subslide:v},t._id))]})};export{ee as default};
