function H2(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var jv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function iT(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function q2(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var sT={exports:{}},wd={},oT={exports:{}},ge={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bu=Symbol.for("react.element"),K2=Symbol.for("react.portal"),Q2=Symbol.for("react.fragment"),Y2=Symbol.for("react.strict_mode"),X2=Symbol.for("react.profiler"),J2=Symbol.for("react.provider"),Z2=Symbol.for("react.context"),eD=Symbol.for("react.forward_ref"),tD=Symbol.for("react.suspense"),nD=Symbol.for("react.memo"),rD=Symbol.for("react.lazy"),Kw=Symbol.iterator;function iD(t){return t===null||typeof t!="object"?null:(t=Kw&&t[Kw]||t["@@iterator"],typeof t=="function"?t:null)}var aT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},lT=Object.assign,uT={};function Da(t,e,n){this.props=t,this.context=e,this.refs=uT,this.updater=n||aT}Da.prototype.isReactComponent={};Da.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Da.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function cT(){}cT.prototype=Da.prototype;function $v(t,e,n){this.props=t,this.context=e,this.refs=uT,this.updater=n||aT}var Fv=$v.prototype=new cT;Fv.constructor=$v;lT(Fv,Da.prototype);Fv.isPureReactComponent=!0;var Qw=Array.isArray,hT=Object.prototype.hasOwnProperty,Mv={current:null},fT={key:!0,ref:!0,__self:!0,__source:!0};function dT(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)hT.call(e,r)&&!fT.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Bu,type:t,key:s,ref:o,props:i,_owner:Mv.current}}function sD(t,e){return{$$typeof:Bu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Vv(t){return typeof t=="object"&&t!==null&&t.$$typeof===Bu}function oD(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Yw=/\/+/g;function Up(t,e){return typeof t=="object"&&t!==null&&t.key!=null?oD(""+t.key):e.toString(36)}function dh(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Bu:case K2:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Up(o,0):r,Qw(i)?(n="",t!=null&&(n=t.replace(Yw,"$&/")+"/"),dh(i,e,n,"",function(u){return u})):i!=null&&(Vv(i)&&(i=sD(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Yw,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Qw(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+Up(s,a);o+=dh(s,e,n,l,i)}else if(l=iD(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+Up(s,a++),o+=dh(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Dc(t,e,n){if(t==null)return t;var r=[],i=0;return dh(t,r,"","",function(s){return e.call(n,s,i++)}),r}function aD(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var tn={current:null},ph={transition:null},lD={ReactCurrentDispatcher:tn,ReactCurrentBatchConfig:ph,ReactCurrentOwner:Mv};ge.Children={map:Dc,forEach:function(t,e,n){Dc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Dc(t,function(){e++}),e},toArray:function(t){return Dc(t,function(e){return e})||[]},only:function(t){if(!Vv(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ge.Component=Da;ge.Fragment=Q2;ge.Profiler=X2;ge.PureComponent=$v;ge.StrictMode=Y2;ge.Suspense=tD;ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lD;ge.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=lT({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Mv.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)hT.call(e,l)&&!fT.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Bu,type:t.type,key:i,ref:s,props:r,_owner:o}};ge.createContext=function(t){return t={$$typeof:Z2,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:J2,_context:t},t.Consumer=t};ge.createElement=dT;ge.createFactory=function(t){var e=dT.bind(null,t);return e.type=t,e};ge.createRef=function(){return{current:null}};ge.forwardRef=function(t){return{$$typeof:eD,render:t}};ge.isValidElement=Vv;ge.lazy=function(t){return{$$typeof:rD,_payload:{_status:-1,_result:t},_init:aD}};ge.memo=function(t,e){return{$$typeof:nD,type:t,compare:e===void 0?null:e}};ge.startTransition=function(t){var e=ph.transition;ph.transition={};try{t()}finally{ph.transition=e}};ge.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};ge.useCallback=function(t,e){return tn.current.useCallback(t,e)};ge.useContext=function(t){return tn.current.useContext(t)};ge.useDebugValue=function(){};ge.useDeferredValue=function(t){return tn.current.useDeferredValue(t)};ge.useEffect=function(t,e){return tn.current.useEffect(t,e)};ge.useId=function(){return tn.current.useId()};ge.useImperativeHandle=function(t,e,n){return tn.current.useImperativeHandle(t,e,n)};ge.useInsertionEffect=function(t,e){return tn.current.useInsertionEffect(t,e)};ge.useLayoutEffect=function(t,e){return tn.current.useLayoutEffect(t,e)};ge.useMemo=function(t,e){return tn.current.useMemo(t,e)};ge.useReducer=function(t,e,n){return tn.current.useReducer(t,e,n)};ge.useRef=function(t){return tn.current.useRef(t)};ge.useState=function(t){return tn.current.useState(t)};ge.useSyncExternalStore=function(t,e,n){return tn.current.useSyncExternalStore(t,e,n)};ge.useTransition=function(){return tn.current.useTransition()};ge.version="18.2.0";oT.exports=ge;var w=oT.exports;const le=iT(w),uD=H2({__proto__:null,default:le},[w]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cD=w,hD=Symbol.for("react.element"),fD=Symbol.for("react.fragment"),dD=Object.prototype.hasOwnProperty,pD=cD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,yD={key:!0,ref:!0,__self:!0,__source:!0};function pT(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)dD.call(e,r)&&!yD.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:hD,type:t,key:s,ref:o,props:i,_owner:pD.current}}wd.Fragment=fD;wd.jsx=pT;wd.jsxs=pT;sT.exports=wd;var c=sT.exports,Ag={},yT={exports:{}},_n={},gT={exports:{}},mT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(F,X){var te=F.length;F.push(X);e:for(;0<te;){var be=te-1>>>1,me=F[be];if(0<i(me,X))F[be]=X,F[te]=me,te=be;else break e}}function n(F){return F.length===0?null:F[0]}function r(F){if(F.length===0)return null;var X=F[0],te=F.pop();if(te!==X){F[0]=te;e:for(var be=0,me=F.length,En=me>>>1;be<En;){var Fn=2*(be+1)-1,Yr=F[Fn],Mn=Fn+1,rr=F[Mn];if(0>i(Yr,te))Mn<me&&0>i(rr,Yr)?(F[be]=rr,F[Mn]=te,be=Mn):(F[be]=Yr,F[Fn]=te,be=Fn);else if(Mn<me&&0>i(rr,te))F[be]=rr,F[Mn]=te,be=Mn;else break e}}return X}function i(F,X){var te=F.sortIndex-X.sortIndex;return te!==0?te:F.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],h=1,f=null,d=3,p=!1,g=!1,v=!1,E=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(F){for(var X=n(u);X!==null;){if(X.callback===null)r(u);else if(X.startTime<=F)r(u),X.sortIndex=X.expirationTime,e(l,X);else break;X=n(u)}}function S(F){if(v=!1,_(F),!g)if(n(l)!==null)g=!0,Ze(A);else{var X=n(u);X!==null&&$t(S,X.startTime-F)}}function A(F,X){g=!1,v&&(v=!1,m(b),b=-1),p=!0;var te=d;try{for(_(X),f=n(l);f!==null&&(!(f.expirationTime>X)||F&&!se());){var be=f.callback;if(typeof be=="function"){f.callback=null,d=f.priorityLevel;var me=be(f.expirationTime<=X);X=t.unstable_now(),typeof me=="function"?f.callback=me:f===n(l)&&r(l),_(X)}else r(l);f=n(l)}if(f!==null)var En=!0;else{var Fn=n(u);Fn!==null&&$t(S,Fn.startTime-X),En=!1}return En}finally{f=null,d=te,p=!1}}var T=!1,I=null,b=-1,H=5,M=-1;function se(){return!(t.unstable_now()-M<H)}function Z(){if(I!==null){var F=t.unstable_now();M=F;var X=!0;try{X=I(!0,F)}finally{X?U():(T=!1,I=null)}}else T=!1}var U;if(typeof y=="function")U=function(){y(Z)};else if(typeof MessageChannel<"u"){var ce=new MessageChannel,tt=ce.port2;ce.port1.onmessage=Z,U=function(){tt.postMessage(null)}}else U=function(){E(Z,0)};function Ze(F){I=F,T||(T=!0,U())}function $t(F,X){b=E(function(){F(t.unstable_now())},X)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(F){F.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,Ze(A))},t.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):H=0<F?Math.floor(1e3/F):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(F){switch(d){case 1:case 2:case 3:var X=3;break;default:X=d}var te=d;d=X;try{return F()}finally{d=te}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(F,X){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var te=d;d=F;try{return X()}finally{d=te}},t.unstable_scheduleCallback=function(F,X,te){var be=t.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?be+te:be):te=be,F){case 1:var me=-1;break;case 2:me=250;break;case 5:me=1073741823;break;case 4:me=1e4;break;default:me=5e3}return me=te+me,F={id:h++,callback:X,priorityLevel:F,startTime:te,expirationTime:me,sortIndex:-1},te>be?(F.sortIndex=te,e(u,F),n(l)===null&&F===n(u)&&(v?(m(b),b=-1):v=!0,$t(S,te-be))):(F.sortIndex=me,e(l,F),g||p||(g=!0,Ze(A))),F},t.unstable_shouldYield=se,t.unstable_wrapCallback=function(F){var X=d;return function(){var te=d;d=X;try{return F.apply(this,arguments)}finally{d=te}}}})(mT);gT.exports=mT;var gD=gT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vT=w,mn=gD;function N(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _T=new Set,Zl={};function Ms(t,e){ta(t,e),ta(t+"Capture",e)}function ta(t,e){for(Zl[t]=e,t=0;t<e.length;t++)_T.add(e[t])}var Mr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Tg=Object.prototype.hasOwnProperty,mD=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Xw={},Jw={};function vD(t){return Tg.call(Jw,t)?!0:Tg.call(Xw,t)?!1:mD.test(t)?Jw[t]=!0:(Xw[t]=!0,!1)}function _D(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function wD(t,e,n,r){if(e===null||typeof e>"u"||_D(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function nn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Dt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Dt[t]=new nn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Dt[e]=new nn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Dt[t]=new nn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Dt[t]=new nn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Dt[t]=new nn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Dt[t]=new nn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Dt[t]=new nn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Dt[t]=new nn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Dt[t]=new nn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Lv=/[\-:]([a-z])/g;function Uv(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Lv,Uv);Dt[e]=new nn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Lv,Uv);Dt[e]=new nn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Lv,Uv);Dt[e]=new nn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Dt[t]=new nn(t,1,!1,t.toLowerCase(),null,!1,!1)});Dt.xlinkHref=new nn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Dt[t]=new nn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Bv(t,e,n,r){var i=Dt.hasOwnProperty(e)?Dt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(wD(e,n,i,r)&&(n=null),r||i===null?vD(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var qr=vT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Oc=Symbol.for("react.element"),mo=Symbol.for("react.portal"),vo=Symbol.for("react.fragment"),zv=Symbol.for("react.strict_mode"),Ig=Symbol.for("react.profiler"),wT=Symbol.for("react.provider"),ET=Symbol.for("react.context"),Wv=Symbol.for("react.forward_ref"),Cg=Symbol.for("react.suspense"),bg=Symbol.for("react.suspense_list"),Gv=Symbol.for("react.memo"),Jr=Symbol.for("react.lazy"),xT=Symbol.for("react.offscreen"),Zw=Symbol.iterator;function Qa(t){return t===null||typeof t!="object"?null:(t=Zw&&t[Zw]||t["@@iterator"],typeof t=="function"?t:null)}var Ge=Object.assign,Bp;function ml(t){if(Bp===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Bp=e&&e[1]||""}return`
`+Bp+t}var zp=!1;function Wp(t,e){if(!t||zp)return"";zp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{zp=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ml(t):""}function ED(t){switch(t.tag){case 5:return ml(t.type);case 16:return ml("Lazy");case 13:return ml("Suspense");case 19:return ml("SuspenseList");case 0:case 2:case 15:return t=Wp(t.type,!1),t;case 11:return t=Wp(t.type.render,!1),t;case 1:return t=Wp(t.type,!0),t;default:return""}}function Pg(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case vo:return"Fragment";case mo:return"Portal";case Ig:return"Profiler";case zv:return"StrictMode";case Cg:return"Suspense";case bg:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case ET:return(t.displayName||"Context")+".Consumer";case wT:return(t._context.displayName||"Context")+".Provider";case Wv:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Gv:return e=t.displayName||null,e!==null?e:Pg(t.type)||"Memo";case Jr:e=t._payload,t=t._init;try{return Pg(t(e))}catch{}}return null}function xD(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Pg(e);case 8:return e===zv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ri(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function ST(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function SD(t){var e=ST(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function jc(t){t._valueTracker||(t._valueTracker=SD(t))}function AT(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=ST(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Bh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Rg(t,e){var n=e.checked;return Ge({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function e1(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ri(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function TT(t,e){e=e.checked,e!=null&&Bv(t,"checked",e,!1)}function kg(t,e){TT(t,e);var n=Ri(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ng(t,e.type,n):e.hasOwnProperty("defaultValue")&&Ng(t,e.type,Ri(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function t1(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Ng(t,e,n){(e!=="number"||Bh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var vl=Array.isArray;function $o(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ri(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Dg(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(N(91));return Ge({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function n1(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(N(92));if(vl(n)){if(1<n.length)throw Error(N(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ri(n)}}function IT(t,e){var n=Ri(e.value),r=Ri(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function r1(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function CT(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Og(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?CT(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var $c,bT=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for($c=$c||document.createElement("div"),$c.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=$c.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function eu(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Pl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},AD=["Webkit","ms","Moz","O"];Object.keys(Pl).forEach(function(t){AD.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Pl[e]=Pl[t]})});function PT(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Pl.hasOwnProperty(t)&&Pl[t]?(""+e).trim():e+"px"}function RT(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=PT(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var TD=Ge({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function jg(t,e){if(e){if(TD[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(N(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(N(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(N(61))}if(e.style!=null&&typeof e.style!="object")throw Error(N(62))}}function $g(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Fg=null;function Hv(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Mg=null,Fo=null,Mo=null;function i1(t){if(t=Gu(t)){if(typeof Mg!="function")throw Error(N(280));var e=t.stateNode;e&&(e=Td(e),Mg(t.stateNode,t.type,e))}}function kT(t){Fo?Mo?Mo.push(t):Mo=[t]:Fo=t}function NT(){if(Fo){var t=Fo,e=Mo;if(Mo=Fo=null,i1(t),e)for(t=0;t<e.length;t++)i1(e[t])}}function DT(t,e){return t(e)}function OT(){}var Gp=!1;function jT(t,e,n){if(Gp)return t(e,n);Gp=!0;try{return DT(t,e,n)}finally{Gp=!1,(Fo!==null||Mo!==null)&&(OT(),NT())}}function tu(t,e){var n=t.stateNode;if(n===null)return null;var r=Td(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(N(231,e,typeof n));return n}var Vg=!1;if(Mr)try{var Ya={};Object.defineProperty(Ya,"passive",{get:function(){Vg=!0}}),window.addEventListener("test",Ya,Ya),window.removeEventListener("test",Ya,Ya)}catch{Vg=!1}function ID(t,e,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(h){this.onError(h)}}var Rl=!1,zh=null,Wh=!1,Lg=null,CD={onError:function(t){Rl=!0,zh=t}};function bD(t,e,n,r,i,s,o,a,l){Rl=!1,zh=null,ID.apply(CD,arguments)}function PD(t,e,n,r,i,s,o,a,l){if(bD.apply(this,arguments),Rl){if(Rl){var u=zh;Rl=!1,zh=null}else throw Error(N(198));Wh||(Wh=!0,Lg=u)}}function Vs(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function $T(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function s1(t){if(Vs(t)!==t)throw Error(N(188))}function RD(t){var e=t.alternate;if(!e){if(e=Vs(t),e===null)throw Error(N(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return s1(i),t;if(s===r)return s1(i),e;s=s.sibling}throw Error(N(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(N(189))}}if(n.alternate!==r)throw Error(N(190))}if(n.tag!==3)throw Error(N(188));return n.stateNode.current===n?t:e}function FT(t){return t=RD(t),t!==null?MT(t):null}function MT(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=MT(t);if(e!==null)return e;t=t.sibling}return null}var VT=mn.unstable_scheduleCallback,o1=mn.unstable_cancelCallback,kD=mn.unstable_shouldYield,ND=mn.unstable_requestPaint,et=mn.unstable_now,DD=mn.unstable_getCurrentPriorityLevel,qv=mn.unstable_ImmediatePriority,LT=mn.unstable_UserBlockingPriority,Gh=mn.unstable_NormalPriority,OD=mn.unstable_LowPriority,UT=mn.unstable_IdlePriority,Ed=null,yr=null;function jD(t){if(yr&&typeof yr.onCommitFiberRoot=="function")try{yr.onCommitFiberRoot(Ed,t,void 0,(t.current.flags&128)===128)}catch{}}var Qn=Math.clz32?Math.clz32:MD,$D=Math.log,FD=Math.LN2;function MD(t){return t>>>=0,t===0?32:31-($D(t)/FD|0)|0}var Fc=64,Mc=4194304;function _l(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Hh(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=_l(a):(s&=o,s!==0&&(r=_l(s)))}else o=n&~i,o!==0?r=_l(o):s!==0&&(r=_l(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Qn(e),i=1<<n,r|=t[n],e&=~i;return r}function VD(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function LD(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Qn(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=VD(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Ug(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function BT(){var t=Fc;return Fc<<=1,!(Fc&4194240)&&(Fc=64),t}function Hp(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function zu(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Qn(e),t[e]=n}function UD(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Qn(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function Kv(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Qn(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Te=0;function zT(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var WT,Qv,GT,HT,qT,Bg=!1,Vc=[],yi=null,gi=null,mi=null,nu=new Map,ru=new Map,ri=[],BD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function a1(t,e){switch(t){case"focusin":case"focusout":yi=null;break;case"dragenter":case"dragleave":gi=null;break;case"mouseover":case"mouseout":mi=null;break;case"pointerover":case"pointerout":nu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ru.delete(e.pointerId)}}function Xa(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Gu(e),e!==null&&Qv(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function zD(t,e,n,r,i){switch(e){case"focusin":return yi=Xa(yi,t,e,n,r,i),!0;case"dragenter":return gi=Xa(gi,t,e,n,r,i),!0;case"mouseover":return mi=Xa(mi,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return nu.set(s,Xa(nu.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,ru.set(s,Xa(ru.get(s)||null,t,e,n,r,i)),!0}return!1}function KT(t){var e=Ji(t.target);if(e!==null){var n=Vs(e);if(n!==null){if(e=n.tag,e===13){if(e=$T(n),e!==null){t.blockedOn=e,qT(t.priority,function(){GT(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function yh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=zg(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Fg=r,n.target.dispatchEvent(r),Fg=null}else return e=Gu(n),e!==null&&Qv(e),t.blockedOn=n,!1;e.shift()}return!0}function l1(t,e,n){yh(t)&&n.delete(e)}function WD(){Bg=!1,yi!==null&&yh(yi)&&(yi=null),gi!==null&&yh(gi)&&(gi=null),mi!==null&&yh(mi)&&(mi=null),nu.forEach(l1),ru.forEach(l1)}function Ja(t,e){t.blockedOn===e&&(t.blockedOn=null,Bg||(Bg=!0,mn.unstable_scheduleCallback(mn.unstable_NormalPriority,WD)))}function iu(t){function e(i){return Ja(i,t)}if(0<Vc.length){Ja(Vc[0],t);for(var n=1;n<Vc.length;n++){var r=Vc[n];r.blockedOn===t&&(r.blockedOn=null)}}for(yi!==null&&Ja(yi,t),gi!==null&&Ja(gi,t),mi!==null&&Ja(mi,t),nu.forEach(e),ru.forEach(e),n=0;n<ri.length;n++)r=ri[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<ri.length&&(n=ri[0],n.blockedOn===null);)KT(n),n.blockedOn===null&&ri.shift()}var Vo=qr.ReactCurrentBatchConfig,qh=!0;function GD(t,e,n,r){var i=Te,s=Vo.transition;Vo.transition=null;try{Te=1,Yv(t,e,n,r)}finally{Te=i,Vo.transition=s}}function HD(t,e,n,r){var i=Te,s=Vo.transition;Vo.transition=null;try{Te=4,Yv(t,e,n,r)}finally{Te=i,Vo.transition=s}}function Yv(t,e,n,r){if(qh){var i=zg(t,e,n,r);if(i===null)ny(t,e,r,Kh,n),a1(t,r);else if(zD(i,t,e,n,r))r.stopPropagation();else if(a1(t,r),e&4&&-1<BD.indexOf(t)){for(;i!==null;){var s=Gu(i);if(s!==null&&WT(s),s=zg(t,e,n,r),s===null&&ny(t,e,r,Kh,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else ny(t,e,r,null,n)}}var Kh=null;function zg(t,e,n,r){if(Kh=null,t=Hv(r),t=Ji(t),t!==null)if(e=Vs(t),e===null)t=null;else if(n=e.tag,n===13){if(t=$T(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Kh=t,null}function QT(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(DD()){case qv:return 1;case LT:return 4;case Gh:case OD:return 16;case UT:return 536870912;default:return 16}default:return 16}}var oi=null,Xv=null,gh=null;function YT(){if(gh)return gh;var t,e=Xv,n=e.length,r,i="value"in oi?oi.value:oi.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return gh=i.slice(t,1<r?1-r:void 0)}function mh(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Lc(){return!0}function u1(){return!1}function wn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Lc:u1,this.isPropagationStopped=u1,this}return Ge(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Lc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Lc)},persist:function(){},isPersistent:Lc}),e}var Oa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jv=wn(Oa),Wu=Ge({},Oa,{view:0,detail:0}),qD=wn(Wu),qp,Kp,Za,xd=Ge({},Wu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zv,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Za&&(Za&&t.type==="mousemove"?(qp=t.screenX-Za.screenX,Kp=t.screenY-Za.screenY):Kp=qp=0,Za=t),qp)},movementY:function(t){return"movementY"in t?t.movementY:Kp}}),c1=wn(xd),KD=Ge({},xd,{dataTransfer:0}),QD=wn(KD),YD=Ge({},Wu,{relatedTarget:0}),Qp=wn(YD),XD=Ge({},Oa,{animationName:0,elapsedTime:0,pseudoElement:0}),JD=wn(XD),ZD=Ge({},Oa,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),eO=wn(ZD),tO=Ge({},Oa,{data:0}),h1=wn(tO),nO={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},rO={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},iO={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function sO(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=iO[t])?!!e[t]:!1}function Zv(){return sO}var oO=Ge({},Wu,{key:function(t){if(t.key){var e=nO[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=mh(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?rO[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zv,charCode:function(t){return t.type==="keypress"?mh(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?mh(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),aO=wn(oO),lO=Ge({},xd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),f1=wn(lO),uO=Ge({},Wu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zv}),cO=wn(uO),hO=Ge({},Oa,{propertyName:0,elapsedTime:0,pseudoElement:0}),fO=wn(hO),dO=Ge({},xd,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),pO=wn(dO),yO=[9,13,27,32],e_=Mr&&"CompositionEvent"in window,kl=null;Mr&&"documentMode"in document&&(kl=document.documentMode);var gO=Mr&&"TextEvent"in window&&!kl,XT=Mr&&(!e_||kl&&8<kl&&11>=kl),d1=String.fromCharCode(32),p1=!1;function JT(t,e){switch(t){case"keyup":return yO.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ZT(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var _o=!1;function mO(t,e){switch(t){case"compositionend":return ZT(e);case"keypress":return e.which!==32?null:(p1=!0,d1);case"textInput":return t=e.data,t===d1&&p1?null:t;default:return null}}function vO(t,e){if(_o)return t==="compositionend"||!e_&&JT(t,e)?(t=YT(),gh=Xv=oi=null,_o=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return XT&&e.locale!=="ko"?null:e.data;default:return null}}var _O={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function y1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!_O[t.type]:e==="textarea"}function eI(t,e,n,r){kT(r),e=Qh(e,"onChange"),0<e.length&&(n=new Jv("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Nl=null,su=null;function wO(t){hI(t,0)}function Sd(t){var e=xo(t);if(AT(e))return t}function EO(t,e){if(t==="change")return e}var tI=!1;if(Mr){var Yp;if(Mr){var Xp="oninput"in document;if(!Xp){var g1=document.createElement("div");g1.setAttribute("oninput","return;"),Xp=typeof g1.oninput=="function"}Yp=Xp}else Yp=!1;tI=Yp&&(!document.documentMode||9<document.documentMode)}function m1(){Nl&&(Nl.detachEvent("onpropertychange",nI),su=Nl=null)}function nI(t){if(t.propertyName==="value"&&Sd(su)){var e=[];eI(e,su,t,Hv(t)),jT(wO,e)}}function xO(t,e,n){t==="focusin"?(m1(),Nl=e,su=n,Nl.attachEvent("onpropertychange",nI)):t==="focusout"&&m1()}function SO(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Sd(su)}function AO(t,e){if(t==="click")return Sd(e)}function TO(t,e){if(t==="input"||t==="change")return Sd(e)}function IO(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var er=typeof Object.is=="function"?Object.is:IO;function ou(t,e){if(er(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Tg.call(e,i)||!er(t[i],e[i]))return!1}return!0}function v1(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function _1(t,e){var n=v1(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=v1(n)}}function rI(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?rI(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function iI(){for(var t=window,e=Bh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Bh(t.document)}return e}function t_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function CO(t){var e=iI(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&rI(n.ownerDocument.documentElement,n)){if(r!==null&&t_(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=_1(n,s);var o=_1(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var bO=Mr&&"documentMode"in document&&11>=document.documentMode,wo=null,Wg=null,Dl=null,Gg=!1;function w1(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Gg||wo==null||wo!==Bh(r)||(r=wo,"selectionStart"in r&&t_(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Dl&&ou(Dl,r)||(Dl=r,r=Qh(Wg,"onSelect"),0<r.length&&(e=new Jv("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=wo)))}function Uc(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Eo={animationend:Uc("Animation","AnimationEnd"),animationiteration:Uc("Animation","AnimationIteration"),animationstart:Uc("Animation","AnimationStart"),transitionend:Uc("Transition","TransitionEnd")},Jp={},sI={};Mr&&(sI=document.createElement("div").style,"AnimationEvent"in window||(delete Eo.animationend.animation,delete Eo.animationiteration.animation,delete Eo.animationstart.animation),"TransitionEvent"in window||delete Eo.transitionend.transition);function Ad(t){if(Jp[t])return Jp[t];if(!Eo[t])return t;var e=Eo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in sI)return Jp[t]=e[n];return t}var oI=Ad("animationend"),aI=Ad("animationiteration"),lI=Ad("animationstart"),uI=Ad("transitionend"),cI=new Map,E1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Vi(t,e){cI.set(t,e),Ms(e,[t])}for(var Zp=0;Zp<E1.length;Zp++){var ey=E1[Zp],PO=ey.toLowerCase(),RO=ey[0].toUpperCase()+ey.slice(1);Vi(PO,"on"+RO)}Vi(oI,"onAnimationEnd");Vi(aI,"onAnimationIteration");Vi(lI,"onAnimationStart");Vi("dblclick","onDoubleClick");Vi("focusin","onFocus");Vi("focusout","onBlur");Vi(uI,"onTransitionEnd");ta("onMouseEnter",["mouseout","mouseover"]);ta("onMouseLeave",["mouseout","mouseover"]);ta("onPointerEnter",["pointerout","pointerover"]);ta("onPointerLeave",["pointerout","pointerover"]);Ms("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ms("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ms("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ms("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ms("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ms("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kO=new Set("cancel close invalid load scroll toggle".split(" ").concat(wl));function x1(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,PD(r,e,void 0,t),t.currentTarget=null}function hI(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;x1(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;x1(i,a,u),s=l}}}if(Wh)throw t=Lg,Wh=!1,Lg=null,t}function je(t,e){var n=e[Yg];n===void 0&&(n=e[Yg]=new Set);var r=t+"__bubble";n.has(r)||(fI(e,t,2,!1),n.add(r))}function ty(t,e,n){var r=0;e&&(r|=4),fI(n,t,r,e)}var Bc="_reactListening"+Math.random().toString(36).slice(2);function au(t){if(!t[Bc]){t[Bc]=!0,_T.forEach(function(n){n!=="selectionchange"&&(kO.has(n)||ty(n,!1,t),ty(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Bc]||(e[Bc]=!0,ty("selectionchange",!1,e))}}function fI(t,e,n,r){switch(QT(e)){case 1:var i=GD;break;case 4:i=HD;break;default:i=Yv}n=i.bind(null,e,n,t),i=void 0,!Vg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function ny(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Ji(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}jT(function(){var u=s,h=Hv(n),f=[];e:{var d=cI.get(t);if(d!==void 0){var p=Jv,g=t;switch(t){case"keypress":if(mh(n)===0)break e;case"keydown":case"keyup":p=aO;break;case"focusin":g="focus",p=Qp;break;case"focusout":g="blur",p=Qp;break;case"beforeblur":case"afterblur":p=Qp;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=c1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=QD;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=cO;break;case oI:case aI:case lI:p=JD;break;case uI:p=fO;break;case"scroll":p=qD;break;case"wheel":p=pO;break;case"copy":case"cut":case"paste":p=eO;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=f1}var v=(e&4)!==0,E=!v&&t==="scroll",m=v?d!==null?d+"Capture":null:d;v=[];for(var y=u,_;y!==null;){_=y;var S=_.stateNode;if(_.tag===5&&S!==null&&(_=S,m!==null&&(S=tu(y,m),S!=null&&v.push(lu(y,S,_)))),E)break;y=y.return}0<v.length&&(d=new p(d,g,null,n,h),f.push({event:d,listeners:v}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",d&&n!==Fg&&(g=n.relatedTarget||n.fromElement)&&(Ji(g)||g[Vr]))break e;if((p||d)&&(d=h.window===h?h:(d=h.ownerDocument)?d.defaultView||d.parentWindow:window,p?(g=n.relatedTarget||n.toElement,p=u,g=g?Ji(g):null,g!==null&&(E=Vs(g),g!==E||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=u),p!==g)){if(v=c1,S="onMouseLeave",m="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(v=f1,S="onPointerLeave",m="onPointerEnter",y="pointer"),E=p==null?d:xo(p),_=g==null?d:xo(g),d=new v(S,y+"leave",p,n,h),d.target=E,d.relatedTarget=_,S=null,Ji(h)===u&&(v=new v(m,y+"enter",g,n,h),v.target=_,v.relatedTarget=E,S=v),E=S,p&&g)t:{for(v=p,m=g,y=0,_=v;_;_=Ks(_))y++;for(_=0,S=m;S;S=Ks(S))_++;for(;0<y-_;)v=Ks(v),y--;for(;0<_-y;)m=Ks(m),_--;for(;y--;){if(v===m||m!==null&&v===m.alternate)break t;v=Ks(v),m=Ks(m)}v=null}else v=null;p!==null&&S1(f,d,p,v,!1),g!==null&&E!==null&&S1(f,E,g,v,!0)}}e:{if(d=u?xo(u):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var A=EO;else if(y1(d))if(tI)A=TO;else{A=SO;var T=xO}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(A=AO);if(A&&(A=A(t,u))){eI(f,A,n,h);break e}T&&T(t,d,u),t==="focusout"&&(T=d._wrapperState)&&T.controlled&&d.type==="number"&&Ng(d,"number",d.value)}switch(T=u?xo(u):window,t){case"focusin":(y1(T)||T.contentEditable==="true")&&(wo=T,Wg=u,Dl=null);break;case"focusout":Dl=Wg=wo=null;break;case"mousedown":Gg=!0;break;case"contextmenu":case"mouseup":case"dragend":Gg=!1,w1(f,n,h);break;case"selectionchange":if(bO)break;case"keydown":case"keyup":w1(f,n,h)}var I;if(e_)e:{switch(t){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else _o?JT(t,n)&&(b="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(b="onCompositionStart");b&&(XT&&n.locale!=="ko"&&(_o||b!=="onCompositionStart"?b==="onCompositionEnd"&&_o&&(I=YT()):(oi=h,Xv="value"in oi?oi.value:oi.textContent,_o=!0)),T=Qh(u,b),0<T.length&&(b=new h1(b,t,null,n,h),f.push({event:b,listeners:T}),I?b.data=I:(I=ZT(n),I!==null&&(b.data=I)))),(I=gO?mO(t,n):vO(t,n))&&(u=Qh(u,"onBeforeInput"),0<u.length&&(h=new h1("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:u}),h.data=I))}hI(f,e)})}function lu(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Qh(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=tu(t,n),s!=null&&r.unshift(lu(t,s,i)),s=tu(t,e),s!=null&&r.push(lu(t,s,i))),t=t.return}return r}function Ks(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function S1(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=tu(n,s),l!=null&&o.unshift(lu(n,l,a))):i||(l=tu(n,s),l!=null&&o.push(lu(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var NO=/\r\n?/g,DO=/\u0000|\uFFFD/g;function A1(t){return(typeof t=="string"?t:""+t).replace(NO,`
`).replace(DO,"")}function zc(t,e,n){if(e=A1(e),A1(t)!==e&&n)throw Error(N(425))}function Yh(){}var Hg=null,qg=null;function Kg(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Qg=typeof setTimeout=="function"?setTimeout:void 0,OO=typeof clearTimeout=="function"?clearTimeout:void 0,T1=typeof Promise=="function"?Promise:void 0,jO=typeof queueMicrotask=="function"?queueMicrotask:typeof T1<"u"?function(t){return T1.resolve(null).then(t).catch($O)}:Qg;function $O(t){setTimeout(function(){throw t})}function ry(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),iu(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);iu(e)}function vi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function I1(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ja=Math.random().toString(36).slice(2),ar="__reactFiber$"+ja,uu="__reactProps$"+ja,Vr="__reactContainer$"+ja,Yg="__reactEvents$"+ja,FO="__reactListeners$"+ja,MO="__reactHandles$"+ja;function Ji(t){var e=t[ar];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Vr]||n[ar]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=I1(t);t!==null;){if(n=t[ar])return n;t=I1(t)}return e}t=n,n=t.parentNode}return null}function Gu(t){return t=t[ar]||t[Vr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function xo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(N(33))}function Td(t){return t[uu]||null}var Xg=[],So=-1;function Li(t){return{current:t}}function Fe(t){0>So||(t.current=Xg[So],Xg[So]=null,So--)}function Oe(t,e){So++,Xg[So]=t.current,t.current=e}var ki={},Gt=Li(ki),ln=Li(!1),Ss=ki;function na(t,e){var n=t.type.contextTypes;if(!n)return ki;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function un(t){return t=t.childContextTypes,t!=null}function Xh(){Fe(ln),Fe(Gt)}function C1(t,e,n){if(Gt.current!==ki)throw Error(N(168));Oe(Gt,e),Oe(ln,n)}function dI(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(N(108,xD(t)||"Unknown",i));return Ge({},n,r)}function Jh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ki,Ss=Gt.current,Oe(Gt,t),Oe(ln,ln.current),!0}function b1(t,e,n){var r=t.stateNode;if(!r)throw Error(N(169));n?(t=dI(t,e,Ss),r.__reactInternalMemoizedMergedChildContext=t,Fe(ln),Fe(Gt),Oe(Gt,t)):Fe(ln),Oe(ln,n)}var Pr=null,Id=!1,iy=!1;function pI(t){Pr===null?Pr=[t]:Pr.push(t)}function VO(t){Id=!0,pI(t)}function Ui(){if(!iy&&Pr!==null){iy=!0;var t=0,e=Te;try{var n=Pr;for(Te=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Pr=null,Id=!1}catch(i){throw Pr!==null&&(Pr=Pr.slice(t+1)),VT(qv,Ui),i}finally{Te=e,iy=!1}}return null}var Ao=[],To=0,Zh=null,ef=0,Tn=[],In=0,As=null,Rr=1,kr="";function qi(t,e){Ao[To++]=ef,Ao[To++]=Zh,Zh=t,ef=e}function yI(t,e,n){Tn[In++]=Rr,Tn[In++]=kr,Tn[In++]=As,As=t;var r=Rr;t=kr;var i=32-Qn(r)-1;r&=~(1<<i),n+=1;var s=32-Qn(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Rr=1<<32-Qn(e)+i|n<<i|r,kr=s+t}else Rr=1<<s|n<<i|r,kr=t}function n_(t){t.return!==null&&(qi(t,1),yI(t,1,0))}function r_(t){for(;t===Zh;)Zh=Ao[--To],Ao[To]=null,ef=Ao[--To],Ao[To]=null;for(;t===As;)As=Tn[--In],Tn[In]=null,kr=Tn[--In],Tn[In]=null,Rr=Tn[--In],Tn[In]=null}var gn=null,pn=null,Le=!1,Wn=null;function gI(t,e){var n=Rn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function P1(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,gn=t,pn=vi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,gn=t,pn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=As!==null?{id:Rr,overflow:kr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Rn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,gn=t,pn=null,!0):!1;default:return!1}}function Jg(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Zg(t){if(Le){var e=pn;if(e){var n=e;if(!P1(t,e)){if(Jg(t))throw Error(N(418));e=vi(n.nextSibling);var r=gn;e&&P1(t,e)?gI(r,n):(t.flags=t.flags&-4097|2,Le=!1,gn=t)}}else{if(Jg(t))throw Error(N(418));t.flags=t.flags&-4097|2,Le=!1,gn=t}}}function R1(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;gn=t}function Wc(t){if(t!==gn)return!1;if(!Le)return R1(t),Le=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Kg(t.type,t.memoizedProps)),e&&(e=pn)){if(Jg(t))throw mI(),Error(N(418));for(;e;)gI(t,e),e=vi(e.nextSibling)}if(R1(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(N(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){pn=vi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}pn=null}}else pn=gn?vi(t.stateNode.nextSibling):null;return!0}function mI(){for(var t=pn;t;)t=vi(t.nextSibling)}function ra(){pn=gn=null,Le=!1}function i_(t){Wn===null?Wn=[t]:Wn.push(t)}var LO=qr.ReactCurrentBatchConfig;function Un(t,e){if(t&&t.defaultProps){e=Ge({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var tf=Li(null),nf=null,Io=null,s_=null;function o_(){s_=Io=nf=null}function a_(t){var e=tf.current;Fe(tf),t._currentValue=e}function em(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Lo(t,e){nf=t,s_=Io=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(an=!0),t.firstContext=null)}function On(t){var e=t._currentValue;if(s_!==t)if(t={context:t,memoizedValue:e,next:null},Io===null){if(nf===null)throw Error(N(308));Io=t,nf.dependencies={lanes:0,firstContext:t}}else Io=Io.next=t;return e}var Zi=null;function l_(t){Zi===null?Zi=[t]:Zi.push(t)}function vI(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,l_(e)):(n.next=i.next,i.next=n),e.interleaved=n,Lr(t,r)}function Lr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Zr=!1;function u_(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _I(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Or(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function _i(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,xe&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Lr(t,n)}return i=r.interleaved,i===null?(e.next=e,l_(r)):(e.next=i.next,i.next=e),r.interleaved=e,Lr(t,n)}function vh(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Kv(t,n)}}function k1(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function rf(t,e,n,r){var i=t.updateQueue;Zr=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=u:a.next=u,h.lastBaseUpdate=l))}if(s!==null){var f=i.baseState;o=0,h=u=l=null,a=s;do{var d=a.lane,p=a.eventTime;if((r&d)===d){h!==null&&(h=h.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var g=t,v=a;switch(d=e,p=n,v.tag){case 1:if(g=v.payload,typeof g=="function"){f=g.call(p,f,d);break e}f=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=v.payload,d=typeof g=="function"?g.call(p,f,d):g,d==null)break e;f=Ge({},f,d);break e;case 2:Zr=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,d=i.effects,d===null?i.effects=[a]:d.push(a))}else p={eventTime:p,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(u=h=p,l=f):h=h.next=p,o|=d;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;d=a,a=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(1);if(h===null&&(l=f),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Is|=o,t.lanes=o,t.memoizedState=f}}function N1(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(N(191,i));i.call(r)}}}var wI=new vT.Component().refs;function tm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ge({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Cd={isMounted:function(t){return(t=t._reactInternals)?Vs(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Zt(),i=Ei(t),s=Or(r,i);s.payload=e,n!=null&&(s.callback=n),e=_i(t,s,i),e!==null&&(Yn(e,t,i,r),vh(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Zt(),i=Ei(t),s=Or(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=_i(t,s,i),e!==null&&(Yn(e,t,i,r),vh(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Zt(),r=Ei(t),i=Or(n,r);i.tag=2,e!=null&&(i.callback=e),e=_i(t,i,r),e!==null&&(Yn(e,t,r,n),vh(e,t,r))}};function D1(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!ou(n,r)||!ou(i,s):!0}function EI(t,e,n){var r=!1,i=ki,s=e.contextType;return typeof s=="object"&&s!==null?s=On(s):(i=un(e)?Ss:Gt.current,r=e.contextTypes,s=(r=r!=null)?na(t,i):ki),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Cd,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function O1(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Cd.enqueueReplaceState(e,e.state,null)}function nm(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=wI,u_(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=On(s):(s=un(e)?Ss:Gt.current,i.context=na(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(tm(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Cd.enqueueReplaceState(i,i.state,null),rf(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function el(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(N(309));var r=n.stateNode}if(!r)throw Error(N(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;a===wI&&(a=i.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(N(284));if(!n._owner)throw Error(N(290,t))}return t}function Gc(t,e){throw t=Object.prototype.toString.call(e),Error(N(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function j1(t){var e=t._init;return e(t._payload)}function xI(t){function e(m,y){if(t){var _=m.deletions;_===null?(m.deletions=[y],m.flags|=16):_.push(y)}}function n(m,y){if(!t)return null;for(;y!==null;)e(m,y),y=y.sibling;return null}function r(m,y){for(m=new Map;y!==null;)y.key!==null?m.set(y.key,y):m.set(y.index,y),y=y.sibling;return m}function i(m,y){return m=xi(m,y),m.index=0,m.sibling=null,m}function s(m,y,_){return m.index=_,t?(_=m.alternate,_!==null?(_=_.index,_<y?(m.flags|=2,y):_):(m.flags|=2,y)):(m.flags|=1048576,y)}function o(m){return t&&m.alternate===null&&(m.flags|=2),m}function a(m,y,_,S){return y===null||y.tag!==6?(y=hy(_,m.mode,S),y.return=m,y):(y=i(y,_),y.return=m,y)}function l(m,y,_,S){var A=_.type;return A===vo?h(m,y,_.props.children,S,_.key):y!==null&&(y.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Jr&&j1(A)===y.type)?(S=i(y,_.props),S.ref=el(m,y,_),S.return=m,S):(S=Ah(_.type,_.key,_.props,null,m.mode,S),S.ref=el(m,y,_),S.return=m,S)}function u(m,y,_,S){return y===null||y.tag!==4||y.stateNode.containerInfo!==_.containerInfo||y.stateNode.implementation!==_.implementation?(y=fy(_,m.mode,S),y.return=m,y):(y=i(y,_.children||[]),y.return=m,y)}function h(m,y,_,S,A){return y===null||y.tag!==7?(y=ls(_,m.mode,S,A),y.return=m,y):(y=i(y,_),y.return=m,y)}function f(m,y,_){if(typeof y=="string"&&y!==""||typeof y=="number")return y=hy(""+y,m.mode,_),y.return=m,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Oc:return _=Ah(y.type,y.key,y.props,null,m.mode,_),_.ref=el(m,null,y),_.return=m,_;case mo:return y=fy(y,m.mode,_),y.return=m,y;case Jr:var S=y._init;return f(m,S(y._payload),_)}if(vl(y)||Qa(y))return y=ls(y,m.mode,_,null),y.return=m,y;Gc(m,y)}return null}function d(m,y,_,S){var A=y!==null?y.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return A!==null?null:a(m,y,""+_,S);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Oc:return _.key===A?l(m,y,_,S):null;case mo:return _.key===A?u(m,y,_,S):null;case Jr:return A=_._init,d(m,y,A(_._payload),S)}if(vl(_)||Qa(_))return A!==null?null:h(m,y,_,S,null);Gc(m,_)}return null}function p(m,y,_,S,A){if(typeof S=="string"&&S!==""||typeof S=="number")return m=m.get(_)||null,a(y,m,""+S,A);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Oc:return m=m.get(S.key===null?_:S.key)||null,l(y,m,S,A);case mo:return m=m.get(S.key===null?_:S.key)||null,u(y,m,S,A);case Jr:var T=S._init;return p(m,y,_,T(S._payload),A)}if(vl(S)||Qa(S))return m=m.get(_)||null,h(y,m,S,A,null);Gc(y,S)}return null}function g(m,y,_,S){for(var A=null,T=null,I=y,b=y=0,H=null;I!==null&&b<_.length;b++){I.index>b?(H=I,I=null):H=I.sibling;var M=d(m,I,_[b],S);if(M===null){I===null&&(I=H);break}t&&I&&M.alternate===null&&e(m,I),y=s(M,y,b),T===null?A=M:T.sibling=M,T=M,I=H}if(b===_.length)return n(m,I),Le&&qi(m,b),A;if(I===null){for(;b<_.length;b++)I=f(m,_[b],S),I!==null&&(y=s(I,y,b),T===null?A=I:T.sibling=I,T=I);return Le&&qi(m,b),A}for(I=r(m,I);b<_.length;b++)H=p(I,m,b,_[b],S),H!==null&&(t&&H.alternate!==null&&I.delete(H.key===null?b:H.key),y=s(H,y,b),T===null?A=H:T.sibling=H,T=H);return t&&I.forEach(function(se){return e(m,se)}),Le&&qi(m,b),A}function v(m,y,_,S){var A=Qa(_);if(typeof A!="function")throw Error(N(150));if(_=A.call(_),_==null)throw Error(N(151));for(var T=A=null,I=y,b=y=0,H=null,M=_.next();I!==null&&!M.done;b++,M=_.next()){I.index>b?(H=I,I=null):H=I.sibling;var se=d(m,I,M.value,S);if(se===null){I===null&&(I=H);break}t&&I&&se.alternate===null&&e(m,I),y=s(se,y,b),T===null?A=se:T.sibling=se,T=se,I=H}if(M.done)return n(m,I),Le&&qi(m,b),A;if(I===null){for(;!M.done;b++,M=_.next())M=f(m,M.value,S),M!==null&&(y=s(M,y,b),T===null?A=M:T.sibling=M,T=M);return Le&&qi(m,b),A}for(I=r(m,I);!M.done;b++,M=_.next())M=p(I,m,b,M.value,S),M!==null&&(t&&M.alternate!==null&&I.delete(M.key===null?b:M.key),y=s(M,y,b),T===null?A=M:T.sibling=M,T=M);return t&&I.forEach(function(Z){return e(m,Z)}),Le&&qi(m,b),A}function E(m,y,_,S){if(typeof _=="object"&&_!==null&&_.type===vo&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case Oc:e:{for(var A=_.key,T=y;T!==null;){if(T.key===A){if(A=_.type,A===vo){if(T.tag===7){n(m,T.sibling),y=i(T,_.props.children),y.return=m,m=y;break e}}else if(T.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Jr&&j1(A)===T.type){n(m,T.sibling),y=i(T,_.props),y.ref=el(m,T,_),y.return=m,m=y;break e}n(m,T);break}else e(m,T);T=T.sibling}_.type===vo?(y=ls(_.props.children,m.mode,S,_.key),y.return=m,m=y):(S=Ah(_.type,_.key,_.props,null,m.mode,S),S.ref=el(m,y,_),S.return=m,m=S)}return o(m);case mo:e:{for(T=_.key;y!==null;){if(y.key===T)if(y.tag===4&&y.stateNode.containerInfo===_.containerInfo&&y.stateNode.implementation===_.implementation){n(m,y.sibling),y=i(y,_.children||[]),y.return=m,m=y;break e}else{n(m,y);break}else e(m,y);y=y.sibling}y=fy(_,m.mode,S),y.return=m,m=y}return o(m);case Jr:return T=_._init,E(m,y,T(_._payload),S)}if(vl(_))return g(m,y,_,S);if(Qa(_))return v(m,y,_,S);Gc(m,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,y!==null&&y.tag===6?(n(m,y.sibling),y=i(y,_),y.return=m,m=y):(n(m,y),y=hy(_,m.mode,S),y.return=m,m=y),o(m)):n(m,y)}return E}var ia=xI(!0),SI=xI(!1),Hu={},gr=Li(Hu),cu=Li(Hu),hu=Li(Hu);function es(t){if(t===Hu)throw Error(N(174));return t}function c_(t,e){switch(Oe(hu,e),Oe(cu,t),Oe(gr,Hu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Og(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Og(e,t)}Fe(gr),Oe(gr,e)}function sa(){Fe(gr),Fe(cu),Fe(hu)}function AI(t){es(hu.current);var e=es(gr.current),n=Og(e,t.type);e!==n&&(Oe(cu,t),Oe(gr,n))}function h_(t){cu.current===t&&(Fe(gr),Fe(cu))}var Be=Li(0);function sf(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var sy=[];function f_(){for(var t=0;t<sy.length;t++)sy[t]._workInProgressVersionPrimary=null;sy.length=0}var _h=qr.ReactCurrentDispatcher,oy=qr.ReactCurrentBatchConfig,Ts=0,We=null,at=null,wt=null,of=!1,Ol=!1,fu=0,UO=0;function Ft(){throw Error(N(321))}function d_(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!er(t[n],e[n]))return!1;return!0}function p_(t,e,n,r,i,s){if(Ts=s,We=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,_h.current=t===null||t.memoizedState===null?GO:HO,t=n(r,i),Ol){s=0;do{if(Ol=!1,fu=0,25<=s)throw Error(N(301));s+=1,wt=at=null,e.updateQueue=null,_h.current=qO,t=n(r,i)}while(Ol)}if(_h.current=af,e=at!==null&&at.next!==null,Ts=0,wt=at=We=null,of=!1,e)throw Error(N(300));return t}function y_(){var t=fu!==0;return fu=0,t}function sr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wt===null?We.memoizedState=wt=t:wt=wt.next=t,wt}function jn(){if(at===null){var t=We.alternate;t=t!==null?t.memoizedState:null}else t=at.next;var e=wt===null?We.memoizedState:wt.next;if(e!==null)wt=e,at=t;else{if(t===null)throw Error(N(310));at=t,t={memoizedState:at.memoizedState,baseState:at.baseState,baseQueue:at.baseQueue,queue:at.queue,next:null},wt===null?We.memoizedState=wt=t:wt=wt.next=t}return wt}function du(t,e){return typeof e=="function"?e(t):e}function ay(t){var e=jn(),n=e.queue;if(n===null)throw Error(N(311));n.lastRenderedReducer=t;var r=at,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var h=u.lane;if((Ts&h)===h)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var f={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=f,o=r):l=l.next=f,We.lanes|=h,Is|=h}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,er(r,e.memoizedState)||(an=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,We.lanes|=s,Is|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ly(t){var e=jn(),n=e.queue;if(n===null)throw Error(N(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);er(s,e.memoizedState)||(an=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function TI(){}function II(t,e){var n=We,r=jn(),i=e(),s=!er(r.memoizedState,i);if(s&&(r.memoizedState=i,an=!0),r=r.queue,g_(PI.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||wt!==null&&wt.memoizedState.tag&1){if(n.flags|=2048,pu(9,bI.bind(null,n,r,i,e),void 0,null),Et===null)throw Error(N(349));Ts&30||CI(n,e,i)}return i}function CI(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=We.updateQueue,e===null?(e={lastEffect:null,stores:null},We.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function bI(t,e,n,r){e.value=n,e.getSnapshot=r,RI(e)&&kI(t)}function PI(t,e,n){return n(function(){RI(e)&&kI(t)})}function RI(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!er(t,n)}catch{return!0}}function kI(t){var e=Lr(t,1);e!==null&&Yn(e,t,1,-1)}function $1(t){var e=sr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:du,lastRenderedState:t},e.queue=t,t=t.dispatch=WO.bind(null,We,t),[e.memoizedState,t]}function pu(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=We.updateQueue,e===null?(e={lastEffect:null,stores:null},We.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function NI(){return jn().memoizedState}function wh(t,e,n,r){var i=sr();We.flags|=t,i.memoizedState=pu(1|e,n,void 0,r===void 0?null:r)}function bd(t,e,n,r){var i=jn();r=r===void 0?null:r;var s=void 0;if(at!==null){var o=at.memoizedState;if(s=o.destroy,r!==null&&d_(r,o.deps)){i.memoizedState=pu(e,n,s,r);return}}We.flags|=t,i.memoizedState=pu(1|e,n,s,r)}function F1(t,e){return wh(8390656,8,t,e)}function g_(t,e){return bd(2048,8,t,e)}function DI(t,e){return bd(4,2,t,e)}function OI(t,e){return bd(4,4,t,e)}function jI(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function $I(t,e,n){return n=n!=null?n.concat([t]):null,bd(4,4,jI.bind(null,e,t),n)}function m_(){}function FI(t,e){var n=jn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&d_(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function MI(t,e){var n=jn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&d_(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function VI(t,e,n){return Ts&21?(er(n,e)||(n=BT(),We.lanes|=n,Is|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,an=!0),t.memoizedState=n)}function BO(t,e){var n=Te;Te=n!==0&&4>n?n:4,t(!0);var r=oy.transition;oy.transition={};try{t(!1),e()}finally{Te=n,oy.transition=r}}function LI(){return jn().memoizedState}function zO(t,e,n){var r=Ei(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},UI(t))BI(e,n);else if(n=vI(t,e,n,r),n!==null){var i=Zt();Yn(n,t,r,i),zI(n,e,r)}}function WO(t,e,n){var r=Ei(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(UI(t))BI(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,er(a,o)){var l=e.interleaved;l===null?(i.next=i,l_(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=vI(t,e,i,r),n!==null&&(i=Zt(),Yn(n,t,r,i),zI(n,e,r))}}function UI(t){var e=t.alternate;return t===We||e!==null&&e===We}function BI(t,e){Ol=of=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function zI(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Kv(t,n)}}var af={readContext:On,useCallback:Ft,useContext:Ft,useEffect:Ft,useImperativeHandle:Ft,useInsertionEffect:Ft,useLayoutEffect:Ft,useMemo:Ft,useReducer:Ft,useRef:Ft,useState:Ft,useDebugValue:Ft,useDeferredValue:Ft,useTransition:Ft,useMutableSource:Ft,useSyncExternalStore:Ft,useId:Ft,unstable_isNewReconciler:!1},GO={readContext:On,useCallback:function(t,e){return sr().memoizedState=[t,e===void 0?null:e],t},useContext:On,useEffect:F1,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,wh(4194308,4,jI.bind(null,e,t),n)},useLayoutEffect:function(t,e){return wh(4194308,4,t,e)},useInsertionEffect:function(t,e){return wh(4,2,t,e)},useMemo:function(t,e){var n=sr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=sr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=zO.bind(null,We,t),[r.memoizedState,t]},useRef:function(t){var e=sr();return t={current:t},e.memoizedState=t},useState:$1,useDebugValue:m_,useDeferredValue:function(t){return sr().memoizedState=t},useTransition:function(){var t=$1(!1),e=t[0];return t=BO.bind(null,t[1]),sr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=We,i=sr();if(Le){if(n===void 0)throw Error(N(407));n=n()}else{if(n=e(),Et===null)throw Error(N(349));Ts&30||CI(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,F1(PI.bind(null,r,s,t),[t]),r.flags|=2048,pu(9,bI.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=sr(),e=Et.identifierPrefix;if(Le){var n=kr,r=Rr;n=(r&~(1<<32-Qn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=fu++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=UO++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},HO={readContext:On,useCallback:FI,useContext:On,useEffect:g_,useImperativeHandle:$I,useInsertionEffect:DI,useLayoutEffect:OI,useMemo:MI,useReducer:ay,useRef:NI,useState:function(){return ay(du)},useDebugValue:m_,useDeferredValue:function(t){var e=jn();return VI(e,at.memoizedState,t)},useTransition:function(){var t=ay(du)[0],e=jn().memoizedState;return[t,e]},useMutableSource:TI,useSyncExternalStore:II,useId:LI,unstable_isNewReconciler:!1},qO={readContext:On,useCallback:FI,useContext:On,useEffect:g_,useImperativeHandle:$I,useInsertionEffect:DI,useLayoutEffect:OI,useMemo:MI,useReducer:ly,useRef:NI,useState:function(){return ly(du)},useDebugValue:m_,useDeferredValue:function(t){var e=jn();return at===null?e.memoizedState=t:VI(e,at.memoizedState,t)},useTransition:function(){var t=ly(du)[0],e=jn().memoizedState;return[t,e]},useMutableSource:TI,useSyncExternalStore:II,useId:LI,unstable_isNewReconciler:!1};function oa(t,e){try{var n="",r=e;do n+=ED(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function uy(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function rm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var KO=typeof WeakMap=="function"?WeakMap:Map;function WI(t,e,n){n=Or(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){uf||(uf=!0,dm=r),rm(t,e)},n}function GI(t,e,n){n=Or(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){rm(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){rm(t,e),typeof r!="function"&&(wi===null?wi=new Set([this]):wi.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function M1(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new KO;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=lj.bind(null,t,e,n),e.then(t,t))}function V1(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function L1(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Or(-1,1),e.tag=2,_i(n,e,1))),n.lanes|=1),t)}var QO=qr.ReactCurrentOwner,an=!1;function Qt(t,e,n,r){e.child=t===null?SI(e,null,n,r):ia(e,t.child,n,r)}function U1(t,e,n,r,i){n=n.render;var s=e.ref;return Lo(e,i),r=p_(t,e,n,r,s,i),n=y_(),t!==null&&!an?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ur(t,e,i)):(Le&&n&&n_(e),e.flags|=1,Qt(t,e,r,i),e.child)}function B1(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!T_(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,HI(t,e,s,r,i)):(t=Ah(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:ou,n(o,r)&&t.ref===e.ref)return Ur(t,e,i)}return e.flags|=1,t=xi(s,r),t.ref=e.ref,t.return=e,e.child=t}function HI(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(ou(s,r)&&t.ref===e.ref)if(an=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(an=!0);else return e.lanes=t.lanes,Ur(t,e,i)}return im(t,e,n,r,i)}function qI(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Oe(bo,hn),hn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Oe(bo,hn),hn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Oe(bo,hn),hn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Oe(bo,hn),hn|=r;return Qt(t,e,i,n),e.child}function KI(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function im(t,e,n,r,i){var s=un(n)?Ss:Gt.current;return s=na(e,s),Lo(e,i),n=p_(t,e,n,r,s,i),r=y_(),t!==null&&!an?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ur(t,e,i)):(Le&&r&&n_(e),e.flags|=1,Qt(t,e,n,i),e.child)}function z1(t,e,n,r,i){if(un(n)){var s=!0;Jh(e)}else s=!1;if(Lo(e,i),e.stateNode===null)Eh(t,e),EI(e,n,r),nm(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=On(u):(u=un(n)?Ss:Gt.current,u=na(e,u));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&O1(e,o,r,u),Zr=!1;var d=e.memoizedState;o.state=d,rf(e,r,o,i),l=e.memoizedState,a!==r||d!==l||ln.current||Zr?(typeof h=="function"&&(tm(e,n,h,r),l=e.memoizedState),(a=Zr||D1(e,n,a,r,d,l,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,_I(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Un(e.type,a),o.props=u,f=e.pendingProps,d=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=On(l):(l=un(n)?Ss:Gt.current,l=na(e,l));var p=n.getDerivedStateFromProps;(h=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||d!==l)&&O1(e,o,r,l),Zr=!1,d=e.memoizedState,o.state=d,rf(e,r,o,i);var g=e.memoizedState;a!==f||d!==g||ln.current||Zr?(typeof p=="function"&&(tm(e,n,p,r),g=e.memoizedState),(u=Zr||D1(e,n,u,r,d,g,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,g,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,g,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=g),o.props=r,o.state=g,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),r=!1)}return sm(t,e,n,r,s,i)}function sm(t,e,n,r,i,s){KI(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&b1(e,n,!1),Ur(t,e,s);r=e.stateNode,QO.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=ia(e,t.child,null,s),e.child=ia(e,null,a,s)):Qt(t,e,a,s),e.memoizedState=r.state,i&&b1(e,n,!0),e.child}function QI(t){var e=t.stateNode;e.pendingContext?C1(t,e.pendingContext,e.pendingContext!==e.context):e.context&&C1(t,e.context,!1),c_(t,e.containerInfo)}function W1(t,e,n,r,i){return ra(),i_(i),e.flags|=256,Qt(t,e,n,r),e.child}var om={dehydrated:null,treeContext:null,retryLane:0};function am(t){return{baseLanes:t,cachePool:null,transitions:null}}function YI(t,e,n){var r=e.pendingProps,i=Be.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Oe(Be,i&1),t===null)return Zg(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=kd(o,r,0,null),t=ls(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=am(n),e.memoizedState=om,t):v_(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return YO(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=xi(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=xi(a,s):(s=ls(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?am(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=om,r}return s=t.child,t=s.sibling,r=xi(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function v_(t,e){return e=kd({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Hc(t,e,n,r){return r!==null&&i_(r),ia(e,t.child,null,n),t=v_(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function YO(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=uy(Error(N(422))),Hc(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=kd({mode:"visible",children:r.children},i,0,null),s=ls(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&ia(e,t.child,null,o),e.child.memoizedState=am(o),e.memoizedState=om,s);if(!(e.mode&1))return Hc(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(N(419)),r=uy(s,r,void 0),Hc(t,e,o,r)}if(a=(o&t.childLanes)!==0,an||a){if(r=Et,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Lr(t,i),Yn(r,t,i,-1))}return A_(),r=uy(Error(N(421))),Hc(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=uj.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,pn=vi(i.nextSibling),gn=e,Le=!0,Wn=null,t!==null&&(Tn[In++]=Rr,Tn[In++]=kr,Tn[In++]=As,Rr=t.id,kr=t.overflow,As=e),e=v_(e,r.children),e.flags|=4096,e)}function G1(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),em(t.return,e,n)}function cy(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function XI(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Qt(t,e,r.children,n),r=Be.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&G1(t,n,e);else if(t.tag===19)G1(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Oe(Be,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&sf(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),cy(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&sf(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}cy(e,!0,n,null,s);break;case"together":cy(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Eh(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ur(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Is|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(N(153));if(e.child!==null){for(t=e.child,n=xi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=xi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function XO(t,e,n){switch(e.tag){case 3:QI(e),ra();break;case 5:AI(e);break;case 1:un(e.type)&&Jh(e);break;case 4:c_(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Oe(tf,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Oe(Be,Be.current&1),e.flags|=128,null):n&e.child.childLanes?YI(t,e,n):(Oe(Be,Be.current&1),t=Ur(t,e,n),t!==null?t.sibling:null);Oe(Be,Be.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return XI(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Oe(Be,Be.current),r)break;return null;case 22:case 23:return e.lanes=0,qI(t,e,n)}return Ur(t,e,n)}var JI,lm,ZI,eC;JI=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};lm=function(){};ZI=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,es(gr.current);var s=null;switch(n){case"input":i=Rg(t,i),r=Rg(t,r),s=[];break;case"select":i=Ge({},i,{value:void 0}),r=Ge({},r,{value:void 0}),s=[];break;case"textarea":i=Dg(t,i),r=Dg(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Yh)}jg(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Zl.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Zl.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&je("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};eC=function(t,e,n,r){n!==r&&(e.flags|=4)};function tl(t,e){if(!Le)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Mt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function JO(t,e,n){var r=e.pendingProps;switch(r_(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Mt(e),null;case 1:return un(e.type)&&Xh(),Mt(e),null;case 3:return r=e.stateNode,sa(),Fe(ln),Fe(Gt),f_(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Wc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Wn!==null&&(gm(Wn),Wn=null))),lm(t,e),Mt(e),null;case 5:h_(e);var i=es(hu.current);if(n=e.type,t!==null&&e.stateNode!=null)ZI(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(N(166));return Mt(e),null}if(t=es(gr.current),Wc(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[ar]=e,r[uu]=s,t=(e.mode&1)!==0,n){case"dialog":je("cancel",r),je("close",r);break;case"iframe":case"object":case"embed":je("load",r);break;case"video":case"audio":for(i=0;i<wl.length;i++)je(wl[i],r);break;case"source":je("error",r);break;case"img":case"image":case"link":je("error",r),je("load",r);break;case"details":je("toggle",r);break;case"input":e1(r,s),je("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},je("invalid",r);break;case"textarea":n1(r,s),je("invalid",r)}jg(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&zc(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&zc(r.textContent,a,t),i=["children",""+a]):Zl.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&je("scroll",r)}switch(n){case"input":jc(r),t1(r,s,!0);break;case"textarea":jc(r),r1(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Yh)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=CT(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[ar]=e,t[uu]=r,JI(t,e,!1,!1),e.stateNode=t;e:{switch(o=$g(n,r),n){case"dialog":je("cancel",t),je("close",t),i=r;break;case"iframe":case"object":case"embed":je("load",t),i=r;break;case"video":case"audio":for(i=0;i<wl.length;i++)je(wl[i],t);i=r;break;case"source":je("error",t),i=r;break;case"img":case"image":case"link":je("error",t),je("load",t),i=r;break;case"details":je("toggle",t),i=r;break;case"input":e1(t,r),i=Rg(t,r),je("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Ge({},r,{value:void 0}),je("invalid",t);break;case"textarea":n1(t,r),i=Dg(t,r),je("invalid",t);break;default:i=r}jg(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?RT(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&bT(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&eu(t,l):typeof l=="number"&&eu(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Zl.hasOwnProperty(s)?l!=null&&s==="onScroll"&&je("scroll",t):l!=null&&Bv(t,s,l,o))}switch(n){case"input":jc(t),t1(t,r,!1);break;case"textarea":jc(t),r1(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ri(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?$o(t,!!r.multiple,s,!1):r.defaultValue!=null&&$o(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Yh)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Mt(e),null;case 6:if(t&&e.stateNode!=null)eC(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(N(166));if(n=es(hu.current),es(gr.current),Wc(e)){if(r=e.stateNode,n=e.memoizedProps,r[ar]=e,(s=r.nodeValue!==n)&&(t=gn,t!==null))switch(t.tag){case 3:zc(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&zc(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[ar]=e,e.stateNode=r}return Mt(e),null;case 13:if(Fe(Be),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Le&&pn!==null&&e.mode&1&&!(e.flags&128))mI(),ra(),e.flags|=98560,s=!1;else if(s=Wc(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(N(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(N(317));s[ar]=e}else ra(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Mt(e),s=!1}else Wn!==null&&(gm(Wn),Wn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Be.current&1?ht===0&&(ht=3):A_())),e.updateQueue!==null&&(e.flags|=4),Mt(e),null);case 4:return sa(),lm(t,e),t===null&&au(e.stateNode.containerInfo),Mt(e),null;case 10:return a_(e.type._context),Mt(e),null;case 17:return un(e.type)&&Xh(),Mt(e),null;case 19:if(Fe(Be),s=e.memoizedState,s===null)return Mt(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)tl(s,!1);else{if(ht!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=sf(t),o!==null){for(e.flags|=128,tl(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Oe(Be,Be.current&1|2),e.child}t=t.sibling}s.tail!==null&&et()>aa&&(e.flags|=128,r=!0,tl(s,!1),e.lanes=4194304)}else{if(!r)if(t=sf(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),tl(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Le)return Mt(e),null}else 2*et()-s.renderingStartTime>aa&&n!==1073741824&&(e.flags|=128,r=!0,tl(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=et(),e.sibling=null,n=Be.current,Oe(Be,r?n&1|2:n&1),e):(Mt(e),null);case 22:case 23:return S_(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?hn&1073741824&&(Mt(e),e.subtreeFlags&6&&(e.flags|=8192)):Mt(e),null;case 24:return null;case 25:return null}throw Error(N(156,e.tag))}function ZO(t,e){switch(r_(e),e.tag){case 1:return un(e.type)&&Xh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return sa(),Fe(ln),Fe(Gt),f_(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return h_(e),null;case 13:if(Fe(Be),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(N(340));ra()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Fe(Be),null;case 4:return sa(),null;case 10:return a_(e.type._context),null;case 22:case 23:return S_(),null;case 24:return null;default:return null}}var qc=!1,Ut=!1,ej=typeof WeakSet=="function"?WeakSet:Set,B=null;function Co(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){qe(t,e,r)}else n.current=null}function um(t,e,n){try{n()}catch(r){qe(t,e,r)}}var H1=!1;function tj(t,e){if(Hg=qh,t=iI(),t_(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,h=0,f=t,d=null;t:for(;;){for(var p;f!==n||i!==0&&f.nodeType!==3||(a=o+i),f!==s||r!==0&&f.nodeType!==3||(l=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(p=f.firstChild)!==null;)d=f,f=p;for(;;){if(f===t)break t;if(d===n&&++u===i&&(a=o),d===s&&++h===r&&(l=o),(p=f.nextSibling)!==null)break;f=d,d=f.parentNode}f=p}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(qg={focusedElem:t,selectionRange:n},qh=!1,B=e;B!==null;)if(e=B,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,B=t;else for(;B!==null;){e=B;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var v=g.memoizedProps,E=g.memoizedState,m=e.stateNode,y=m.getSnapshotBeforeUpdate(e.elementType===e.type?v:Un(e.type,v),E);m.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var _=e.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(N(163))}}catch(S){qe(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,B=t;break}B=e.return}return g=H1,H1=!1,g}function jl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&um(e,n,s)}i=i.next}while(i!==r)}}function Pd(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function cm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function tC(t){var e=t.alternate;e!==null&&(t.alternate=null,tC(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ar],delete e[uu],delete e[Yg],delete e[FO],delete e[MO])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function nC(t){return t.tag===5||t.tag===3||t.tag===4}function q1(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||nC(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function hm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Yh));else if(r!==4&&(t=t.child,t!==null))for(hm(t,e,n),t=t.sibling;t!==null;)hm(t,e,n),t=t.sibling}function fm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(fm(t,e,n),t=t.sibling;t!==null;)fm(t,e,n),t=t.sibling}var Tt=null,zn=!1;function Xr(t,e,n){for(n=n.child;n!==null;)rC(t,e,n),n=n.sibling}function rC(t,e,n){if(yr&&typeof yr.onCommitFiberUnmount=="function")try{yr.onCommitFiberUnmount(Ed,n)}catch{}switch(n.tag){case 5:Ut||Co(n,e);case 6:var r=Tt,i=zn;Tt=null,Xr(t,e,n),Tt=r,zn=i,Tt!==null&&(zn?(t=Tt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Tt.removeChild(n.stateNode));break;case 18:Tt!==null&&(zn?(t=Tt,n=n.stateNode,t.nodeType===8?ry(t.parentNode,n):t.nodeType===1&&ry(t,n),iu(t)):ry(Tt,n.stateNode));break;case 4:r=Tt,i=zn,Tt=n.stateNode.containerInfo,zn=!0,Xr(t,e,n),Tt=r,zn=i;break;case 0:case 11:case 14:case 15:if(!Ut&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&um(n,e,o),i=i.next}while(i!==r)}Xr(t,e,n);break;case 1:if(!Ut&&(Co(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){qe(n,e,a)}Xr(t,e,n);break;case 21:Xr(t,e,n);break;case 22:n.mode&1?(Ut=(r=Ut)||n.memoizedState!==null,Xr(t,e,n),Ut=r):Xr(t,e,n);break;default:Xr(t,e,n)}}function K1(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new ej),e.forEach(function(r){var i=cj.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Vn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Tt=a.stateNode,zn=!1;break e;case 3:Tt=a.stateNode.containerInfo,zn=!0;break e;case 4:Tt=a.stateNode.containerInfo,zn=!0;break e}a=a.return}if(Tt===null)throw Error(N(160));rC(s,o,i),Tt=null,zn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){qe(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)iC(e,t),e=e.sibling}function iC(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Vn(e,t),ir(t),r&4){try{jl(3,t,t.return),Pd(3,t)}catch(v){qe(t,t.return,v)}try{jl(5,t,t.return)}catch(v){qe(t,t.return,v)}}break;case 1:Vn(e,t),ir(t),r&512&&n!==null&&Co(n,n.return);break;case 5:if(Vn(e,t),ir(t),r&512&&n!==null&&Co(n,n.return),t.flags&32){var i=t.stateNode;try{eu(i,"")}catch(v){qe(t,t.return,v)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&TT(i,s),$g(a,o);var u=$g(a,s);for(o=0;o<l.length;o+=2){var h=l[o],f=l[o+1];h==="style"?RT(i,f):h==="dangerouslySetInnerHTML"?bT(i,f):h==="children"?eu(i,f):Bv(i,h,f,u)}switch(a){case"input":kg(i,s);break;case"textarea":IT(i,s);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?$o(i,!!s.multiple,p,!1):d!==!!s.multiple&&(s.defaultValue!=null?$o(i,!!s.multiple,s.defaultValue,!0):$o(i,!!s.multiple,s.multiple?[]:"",!1))}i[uu]=s}catch(v){qe(t,t.return,v)}}break;case 6:if(Vn(e,t),ir(t),r&4){if(t.stateNode===null)throw Error(N(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(v){qe(t,t.return,v)}}break;case 3:if(Vn(e,t),ir(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{iu(e.containerInfo)}catch(v){qe(t,t.return,v)}break;case 4:Vn(e,t),ir(t);break;case 13:Vn(e,t),ir(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(E_=et())),r&4&&K1(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(Ut=(u=Ut)||h,Vn(e,t),Ut=u):Vn(e,t),ir(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!h&&t.mode&1)for(B=t,h=t.child;h!==null;){for(f=B=h;B!==null;){switch(d=B,p=d.child,d.tag){case 0:case 11:case 14:case 15:jl(4,d,d.return);break;case 1:Co(d,d.return);var g=d.stateNode;if(typeof g.componentWillUnmount=="function"){r=d,n=d.return;try{e=r,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(v){qe(r,n,v)}}break;case 5:Co(d,d.return);break;case 22:if(d.memoizedState!==null){Y1(f);continue}}p!==null?(p.return=d,B=p):Y1(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{i=f.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=PT("display",o))}catch(v){qe(t,t.return,v)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(v){qe(t,t.return,v)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Vn(e,t),ir(t),r&4&&K1(t);break;case 21:break;default:Vn(e,t),ir(t)}}function ir(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(nC(n)){var r=n;break e}n=n.return}throw Error(N(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(eu(i,""),r.flags&=-33);var s=q1(t);fm(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=q1(t);hm(t,a,o);break;default:throw Error(N(161))}}catch(l){qe(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function nj(t,e,n){B=t,sC(t)}function sC(t,e,n){for(var r=(t.mode&1)!==0;B!==null;){var i=B,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||qc;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Ut;a=qc;var u=Ut;if(qc=o,(Ut=l)&&!u)for(B=i;B!==null;)o=B,l=o.child,o.tag===22&&o.memoizedState!==null?X1(i):l!==null?(l.return=o,B=l):X1(i);for(;s!==null;)B=s,sC(s),s=s.sibling;B=i,qc=a,Ut=u}Q1(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,B=s):Q1(t)}}function Q1(t){for(;B!==null;){var e=B;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ut||Pd(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ut)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Un(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&N1(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}N1(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&iu(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(N(163))}Ut||e.flags&512&&cm(e)}catch(d){qe(e,e.return,d)}}if(e===t){B=null;break}if(n=e.sibling,n!==null){n.return=e.return,B=n;break}B=e.return}}function Y1(t){for(;B!==null;){var e=B;if(e===t){B=null;break}var n=e.sibling;if(n!==null){n.return=e.return,B=n;break}B=e.return}}function X1(t){for(;B!==null;){var e=B;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Pd(4,e)}catch(l){qe(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){qe(e,i,l)}}var s=e.return;try{cm(e)}catch(l){qe(e,s,l)}break;case 5:var o=e.return;try{cm(e)}catch(l){qe(e,o,l)}}}catch(l){qe(e,e.return,l)}if(e===t){B=null;break}var a=e.sibling;if(a!==null){a.return=e.return,B=a;break}B=e.return}}var rj=Math.ceil,lf=qr.ReactCurrentDispatcher,__=qr.ReactCurrentOwner,Nn=qr.ReactCurrentBatchConfig,xe=0,Et=null,st=null,Rt=0,hn=0,bo=Li(0),ht=0,yu=null,Is=0,Rd=0,w_=0,$l=null,rn=null,E_=0,aa=1/0,br=null,uf=!1,dm=null,wi=null,Kc=!1,ai=null,cf=0,Fl=0,pm=null,xh=-1,Sh=0;function Zt(){return xe&6?et():xh!==-1?xh:xh=et()}function Ei(t){return t.mode&1?xe&2&&Rt!==0?Rt&-Rt:LO.transition!==null?(Sh===0&&(Sh=BT()),Sh):(t=Te,t!==0||(t=window.event,t=t===void 0?16:QT(t.type)),t):1}function Yn(t,e,n,r){if(50<Fl)throw Fl=0,pm=null,Error(N(185));zu(t,n,r),(!(xe&2)||t!==Et)&&(t===Et&&(!(xe&2)&&(Rd|=n),ht===4&&ii(t,Rt)),cn(t,r),n===1&&xe===0&&!(e.mode&1)&&(aa=et()+500,Id&&Ui()))}function cn(t,e){var n=t.callbackNode;LD(t,e);var r=Hh(t,t===Et?Rt:0);if(r===0)n!==null&&o1(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&o1(n),e===1)t.tag===0?VO(J1.bind(null,t)):pI(J1.bind(null,t)),jO(function(){!(xe&6)&&Ui()}),n=null;else{switch(zT(r)){case 1:n=qv;break;case 4:n=LT;break;case 16:n=Gh;break;case 536870912:n=UT;break;default:n=Gh}n=dC(n,oC.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function oC(t,e){if(xh=-1,Sh=0,xe&6)throw Error(N(327));var n=t.callbackNode;if(Uo()&&t.callbackNode!==n)return null;var r=Hh(t,t===Et?Rt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=hf(t,r);else{e=r;var i=xe;xe|=2;var s=lC();(Et!==t||Rt!==e)&&(br=null,aa=et()+500,as(t,e));do try{oj();break}catch(a){aC(t,a)}while(1);o_(),lf.current=s,xe=i,st!==null?e=0:(Et=null,Rt=0,e=ht)}if(e!==0){if(e===2&&(i=Ug(t),i!==0&&(r=i,e=ym(t,i))),e===1)throw n=yu,as(t,0),ii(t,r),cn(t,et()),n;if(e===6)ii(t,r);else{if(i=t.current.alternate,!(r&30)&&!ij(i)&&(e=hf(t,r),e===2&&(s=Ug(t),s!==0&&(r=s,e=ym(t,s))),e===1))throw n=yu,as(t,0),ii(t,r),cn(t,et()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(N(345));case 2:Ki(t,rn,br);break;case 3:if(ii(t,r),(r&130023424)===r&&(e=E_+500-et(),10<e)){if(Hh(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Zt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Qg(Ki.bind(null,t,rn,br),e);break}Ki(t,rn,br);break;case 4:if(ii(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Qn(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=et()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*rj(r/1960))-r,10<r){t.timeoutHandle=Qg(Ki.bind(null,t,rn,br),r);break}Ki(t,rn,br);break;case 5:Ki(t,rn,br);break;default:throw Error(N(329))}}}return cn(t,et()),t.callbackNode===n?oC.bind(null,t):null}function ym(t,e){var n=$l;return t.current.memoizedState.isDehydrated&&(as(t,e).flags|=256),t=hf(t,e),t!==2&&(e=rn,rn=n,e!==null&&gm(e)),t}function gm(t){rn===null?rn=t:rn.push.apply(rn,t)}function ij(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!er(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ii(t,e){for(e&=~w_,e&=~Rd,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Qn(e),r=1<<n;t[n]=-1,e&=~r}}function J1(t){if(xe&6)throw Error(N(327));Uo();var e=Hh(t,0);if(!(e&1))return cn(t,et()),null;var n=hf(t,e);if(t.tag!==0&&n===2){var r=Ug(t);r!==0&&(e=r,n=ym(t,r))}if(n===1)throw n=yu,as(t,0),ii(t,e),cn(t,et()),n;if(n===6)throw Error(N(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ki(t,rn,br),cn(t,et()),null}function x_(t,e){var n=xe;xe|=1;try{return t(e)}finally{xe=n,xe===0&&(aa=et()+500,Id&&Ui())}}function Cs(t){ai!==null&&ai.tag===0&&!(xe&6)&&Uo();var e=xe;xe|=1;var n=Nn.transition,r=Te;try{if(Nn.transition=null,Te=1,t)return t()}finally{Te=r,Nn.transition=n,xe=e,!(xe&6)&&Ui()}}function S_(){hn=bo.current,Fe(bo)}function as(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,OO(n)),st!==null)for(n=st.return;n!==null;){var r=n;switch(r_(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Xh();break;case 3:sa(),Fe(ln),Fe(Gt),f_();break;case 5:h_(r);break;case 4:sa();break;case 13:Fe(Be);break;case 19:Fe(Be);break;case 10:a_(r.type._context);break;case 22:case 23:S_()}n=n.return}if(Et=t,st=t=xi(t.current,null),Rt=hn=e,ht=0,yu=null,w_=Rd=Is=0,rn=$l=null,Zi!==null){for(e=0;e<Zi.length;e++)if(n=Zi[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Zi=null}return t}function aC(t,e){do{var n=st;try{if(o_(),_h.current=af,of){for(var r=We.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}of=!1}if(Ts=0,wt=at=We=null,Ol=!1,fu=0,__.current=null,n===null||n.return===null){ht=1,yu=e,st=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Rt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,h=a,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var d=h.alternate;d?(h.updateQueue=d.updateQueue,h.memoizedState=d.memoizedState,h.lanes=d.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=V1(o);if(p!==null){p.flags&=-257,L1(p,o,a,s,e),p.mode&1&&M1(s,u,e),e=p,l=u;var g=e.updateQueue;if(g===null){var v=new Set;v.add(l),e.updateQueue=v}else g.add(l);break e}else{if(!(e&1)){M1(s,u,e),A_();break e}l=Error(N(426))}}else if(Le&&a.mode&1){var E=V1(o);if(E!==null){!(E.flags&65536)&&(E.flags|=256),L1(E,o,a,s,e),i_(oa(l,a));break e}}s=l=oa(l,a),ht!==4&&(ht=2),$l===null?$l=[s]:$l.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var m=WI(s,l,e);k1(s,m);break e;case 1:a=l;var y=s.type,_=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(wi===null||!wi.has(_)))){s.flags|=65536,e&=-e,s.lanes|=e;var S=GI(s,a,e);k1(s,S);break e}}s=s.return}while(s!==null)}cC(n)}catch(A){e=A,st===n&&n!==null&&(st=n=n.return);continue}break}while(1)}function lC(){var t=lf.current;return lf.current=af,t===null?af:t}function A_(){(ht===0||ht===3||ht===2)&&(ht=4),Et===null||!(Is&268435455)&&!(Rd&268435455)||ii(Et,Rt)}function hf(t,e){var n=xe;xe|=2;var r=lC();(Et!==t||Rt!==e)&&(br=null,as(t,e));do try{sj();break}catch(i){aC(t,i)}while(1);if(o_(),xe=n,lf.current=r,st!==null)throw Error(N(261));return Et=null,Rt=0,ht}function sj(){for(;st!==null;)uC(st)}function oj(){for(;st!==null&&!kD();)uC(st)}function uC(t){var e=fC(t.alternate,t,hn);t.memoizedProps=t.pendingProps,e===null?cC(t):st=e,__.current=null}function cC(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=ZO(n,e),n!==null){n.flags&=32767,st=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ht=6,st=null;return}}else if(n=JO(n,e,hn),n!==null){st=n;return}if(e=e.sibling,e!==null){st=e;return}st=e=t}while(e!==null);ht===0&&(ht=5)}function Ki(t,e,n){var r=Te,i=Nn.transition;try{Nn.transition=null,Te=1,aj(t,e,n,r)}finally{Nn.transition=i,Te=r}return null}function aj(t,e,n,r){do Uo();while(ai!==null);if(xe&6)throw Error(N(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(N(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(UD(t,s),t===Et&&(st=Et=null,Rt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Kc||(Kc=!0,dC(Gh,function(){return Uo(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Nn.transition,Nn.transition=null;var o=Te;Te=1;var a=xe;xe|=4,__.current=null,tj(t,n),iC(n,t),CO(qg),qh=!!Hg,qg=Hg=null,t.current=n,nj(n),ND(),xe=a,Te=o,Nn.transition=s}else t.current=n;if(Kc&&(Kc=!1,ai=t,cf=i),s=t.pendingLanes,s===0&&(wi=null),jD(n.stateNode),cn(t,et()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(uf)throw uf=!1,t=dm,dm=null,t;return cf&1&&t.tag!==0&&Uo(),s=t.pendingLanes,s&1?t===pm?Fl++:(Fl=0,pm=t):Fl=0,Ui(),null}function Uo(){if(ai!==null){var t=zT(cf),e=Nn.transition,n=Te;try{if(Nn.transition=null,Te=16>t?16:t,ai===null)var r=!1;else{if(t=ai,ai=null,cf=0,xe&6)throw Error(N(331));var i=xe;for(xe|=4,B=t.current;B!==null;){var s=B,o=s.child;if(B.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(B=u;B!==null;){var h=B;switch(h.tag){case 0:case 11:case 15:jl(8,h,s)}var f=h.child;if(f!==null)f.return=h,B=f;else for(;B!==null;){h=B;var d=h.sibling,p=h.return;if(tC(h),h===u){B=null;break}if(d!==null){d.return=p,B=d;break}B=p}}}var g=s.alternate;if(g!==null){var v=g.child;if(v!==null){g.child=null;do{var E=v.sibling;v.sibling=null,v=E}while(v!==null)}}B=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,B=o;else e:for(;B!==null;){if(s=B,s.flags&2048)switch(s.tag){case 0:case 11:case 15:jl(9,s,s.return)}var m=s.sibling;if(m!==null){m.return=s.return,B=m;break e}B=s.return}}var y=t.current;for(B=y;B!==null;){o=B;var _=o.child;if(o.subtreeFlags&2064&&_!==null)_.return=o,B=_;else e:for(o=y;B!==null;){if(a=B,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Pd(9,a)}}catch(A){qe(a,a.return,A)}if(a===o){B=null;break e}var S=a.sibling;if(S!==null){S.return=a.return,B=S;break e}B=a.return}}if(xe=i,Ui(),yr&&typeof yr.onPostCommitFiberRoot=="function")try{yr.onPostCommitFiberRoot(Ed,t)}catch{}r=!0}return r}finally{Te=n,Nn.transition=e}}return!1}function Z1(t,e,n){e=oa(n,e),e=WI(t,e,1),t=_i(t,e,1),e=Zt(),t!==null&&(zu(t,1,e),cn(t,e))}function qe(t,e,n){if(t.tag===3)Z1(t,t,n);else for(;e!==null;){if(e.tag===3){Z1(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(wi===null||!wi.has(r))){t=oa(n,t),t=GI(e,t,1),e=_i(e,t,1),t=Zt(),e!==null&&(zu(e,1,t),cn(e,t));break}}e=e.return}}function lj(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Zt(),t.pingedLanes|=t.suspendedLanes&n,Et===t&&(Rt&n)===n&&(ht===4||ht===3&&(Rt&130023424)===Rt&&500>et()-E_?as(t,0):w_|=n),cn(t,e)}function hC(t,e){e===0&&(t.mode&1?(e=Mc,Mc<<=1,!(Mc&130023424)&&(Mc=4194304)):e=1);var n=Zt();t=Lr(t,e),t!==null&&(zu(t,e,n),cn(t,n))}function uj(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),hC(t,n)}function cj(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(N(314))}r!==null&&r.delete(e),hC(t,n)}var fC;fC=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||ln.current)an=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return an=!1,XO(t,e,n);an=!!(t.flags&131072)}else an=!1,Le&&e.flags&1048576&&yI(e,ef,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Eh(t,e),t=e.pendingProps;var i=na(e,Gt.current);Lo(e,n),i=p_(null,e,r,t,i,n);var s=y_();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,un(r)?(s=!0,Jh(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,u_(e),i.updater=Cd,e.stateNode=i,i._reactInternals=e,nm(e,r,t,n),e=sm(null,e,r,!0,s,n)):(e.tag=0,Le&&s&&n_(e),Qt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Eh(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=fj(r),t=Un(r,t),i){case 0:e=im(null,e,r,t,n);break e;case 1:e=z1(null,e,r,t,n);break e;case 11:e=U1(null,e,r,t,n);break e;case 14:e=B1(null,e,r,Un(r.type,t),n);break e}throw Error(N(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Un(r,i),im(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Un(r,i),z1(t,e,r,i,n);case 3:e:{if(QI(e),t===null)throw Error(N(387));r=e.pendingProps,s=e.memoizedState,i=s.element,_I(t,e),rf(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=oa(Error(N(423)),e),e=W1(t,e,r,n,i);break e}else if(r!==i){i=oa(Error(N(424)),e),e=W1(t,e,r,n,i);break e}else for(pn=vi(e.stateNode.containerInfo.firstChild),gn=e,Le=!0,Wn=null,n=SI(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ra(),r===i){e=Ur(t,e,n);break e}Qt(t,e,r,n)}e=e.child}return e;case 5:return AI(e),t===null&&Zg(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Kg(r,i)?o=null:s!==null&&Kg(r,s)&&(e.flags|=32),KI(t,e),Qt(t,e,o,n),e.child;case 6:return t===null&&Zg(e),null;case 13:return YI(t,e,n);case 4:return c_(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ia(e,null,r,n):Qt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Un(r,i),U1(t,e,r,i,n);case 7:return Qt(t,e,e.pendingProps,n),e.child;case 8:return Qt(t,e,e.pendingProps.children,n),e.child;case 12:return Qt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Oe(tf,r._currentValue),r._currentValue=o,s!==null)if(er(s.value,o)){if(s.children===i.children&&!ln.current){e=Ur(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=Or(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?l.next=l:(l.next=h.next,h.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),em(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(N(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),em(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Qt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Lo(e,n),i=On(i),r=r(i),e.flags|=1,Qt(t,e,r,n),e.child;case 14:return r=e.type,i=Un(r,e.pendingProps),i=Un(r.type,i),B1(t,e,r,i,n);case 15:return HI(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Un(r,i),Eh(t,e),e.tag=1,un(r)?(t=!0,Jh(e)):t=!1,Lo(e,n),EI(e,r,i),nm(e,r,i,n),sm(null,e,r,!0,t,n);case 19:return XI(t,e,n);case 22:return qI(t,e,n)}throw Error(N(156,e.tag))};function dC(t,e){return VT(t,e)}function hj(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rn(t,e,n,r){return new hj(t,e,n,r)}function T_(t){return t=t.prototype,!(!t||!t.isReactComponent)}function fj(t){if(typeof t=="function")return T_(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Wv)return 11;if(t===Gv)return 14}return 2}function xi(t,e){var n=t.alternate;return n===null?(n=Rn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ah(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")T_(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case vo:return ls(n.children,i,s,e);case zv:o=8,i|=8;break;case Ig:return t=Rn(12,n,e,i|2),t.elementType=Ig,t.lanes=s,t;case Cg:return t=Rn(13,n,e,i),t.elementType=Cg,t.lanes=s,t;case bg:return t=Rn(19,n,e,i),t.elementType=bg,t.lanes=s,t;case xT:return kd(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case wT:o=10;break e;case ET:o=9;break e;case Wv:o=11;break e;case Gv:o=14;break e;case Jr:o=16,r=null;break e}throw Error(N(130,t==null?t:typeof t,""))}return e=Rn(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function ls(t,e,n,r){return t=Rn(7,t,r,e),t.lanes=n,t}function kd(t,e,n,r){return t=Rn(22,t,r,e),t.elementType=xT,t.lanes=n,t.stateNode={isHidden:!1},t}function hy(t,e,n){return t=Rn(6,t,null,e),t.lanes=n,t}function fy(t,e,n){return e=Rn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function dj(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Hp(0),this.expirationTimes=Hp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Hp(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function I_(t,e,n,r,i,s,o,a,l){return t=new dj(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Rn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},u_(s),t}function pj(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:mo,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function pC(t){if(!t)return ki;t=t._reactInternals;e:{if(Vs(t)!==t||t.tag!==1)throw Error(N(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(un(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(N(171))}if(t.tag===1){var n=t.type;if(un(n))return dI(t,n,e)}return e}function yC(t,e,n,r,i,s,o,a,l){return t=I_(n,r,!0,t,i,s,o,a,l),t.context=pC(null),n=t.current,r=Zt(),i=Ei(n),s=Or(r,i),s.callback=e??null,_i(n,s,i),t.current.lanes=i,zu(t,i,r),cn(t,r),t}function Nd(t,e,n,r){var i=e.current,s=Zt(),o=Ei(i);return n=pC(n),e.context===null?e.context=n:e.pendingContext=n,e=Or(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=_i(i,e,o),t!==null&&(Yn(t,i,o,s),vh(t,i,o)),o}function ff(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function eE(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function C_(t,e){eE(t,e),(t=t.alternate)&&eE(t,e)}function yj(){return null}var gC=typeof reportError=="function"?reportError:function(t){console.error(t)};function b_(t){this._internalRoot=t}Dd.prototype.render=b_.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(N(409));Nd(t,e,null,null)};Dd.prototype.unmount=b_.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Cs(function(){Nd(null,t,null,null)}),e[Vr]=null}};function Dd(t){this._internalRoot=t}Dd.prototype.unstable_scheduleHydration=function(t){if(t){var e=HT();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ri.length&&e!==0&&e<ri[n].priority;n++);ri.splice(n,0,t),n===0&&KT(t)}};function P_(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Od(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function tE(){}function gj(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=ff(o);s.call(u)}}var o=yC(e,r,t,0,null,!1,!1,"",tE);return t._reactRootContainer=o,t[Vr]=o.current,au(t.nodeType===8?t.parentNode:t),Cs(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=ff(l);a.call(u)}}var l=I_(t,0,!1,null,null,!1,!1,"",tE);return t._reactRootContainer=l,t[Vr]=l.current,au(t.nodeType===8?t.parentNode:t),Cs(function(){Nd(e,l,n,r)}),l}function jd(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=ff(o);a.call(l)}}Nd(e,o,t,i)}else o=gj(n,e,t,i,r);return ff(o)}WT=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=_l(e.pendingLanes);n!==0&&(Kv(e,n|1),cn(e,et()),!(xe&6)&&(aa=et()+500,Ui()))}break;case 13:Cs(function(){var r=Lr(t,1);if(r!==null){var i=Zt();Yn(r,t,1,i)}}),C_(t,1)}};Qv=function(t){if(t.tag===13){var e=Lr(t,134217728);if(e!==null){var n=Zt();Yn(e,t,134217728,n)}C_(t,134217728)}};GT=function(t){if(t.tag===13){var e=Ei(t),n=Lr(t,e);if(n!==null){var r=Zt();Yn(n,t,e,r)}C_(t,e)}};HT=function(){return Te};qT=function(t,e){var n=Te;try{return Te=t,e()}finally{Te=n}};Mg=function(t,e,n){switch(e){case"input":if(kg(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Td(r);if(!i)throw Error(N(90));AT(r),kg(r,i)}}}break;case"textarea":IT(t,n);break;case"select":e=n.value,e!=null&&$o(t,!!n.multiple,e,!1)}};DT=x_;OT=Cs;var mj={usingClientEntryPoint:!1,Events:[Gu,xo,Td,kT,NT,x_]},nl={findFiberByHostInstance:Ji,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},vj={bundleType:nl.bundleType,version:nl.version,rendererPackageName:nl.rendererPackageName,rendererConfig:nl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:qr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=FT(t),t===null?null:t.stateNode},findFiberByHostInstance:nl.findFiberByHostInstance||yj,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qc.isDisabled&&Qc.supportsFiber)try{Ed=Qc.inject(vj),yr=Qc}catch{}}_n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mj;_n.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!P_(e))throw Error(N(200));return pj(t,e,null,n)};_n.createRoot=function(t,e){if(!P_(t))throw Error(N(299));var n=!1,r="",i=gC;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=I_(t,1,!1,null,null,n,!1,r,i),t[Vr]=e.current,au(t.nodeType===8?t.parentNode:t),new b_(e)};_n.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(N(188)):(t=Object.keys(t).join(","),Error(N(268,t)));return t=FT(e),t=t===null?null:t.stateNode,t};_n.flushSync=function(t){return Cs(t)};_n.hydrate=function(t,e,n){if(!Od(e))throw Error(N(200));return jd(null,t,e,!0,n)};_n.hydrateRoot=function(t,e,n){if(!P_(t))throw Error(N(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=gC;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=yC(e,null,t,1,n??null,i,!1,s,o),t[Vr]=e.current,au(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Dd(e)};_n.render=function(t,e,n){if(!Od(e))throw Error(N(200));return jd(null,t,e,!1,n)};_n.unmountComponentAtNode=function(t){if(!Od(t))throw Error(N(40));return t._reactRootContainer?(Cs(function(){jd(null,null,t,!1,function(){t._reactRootContainer=null,t[Vr]=null})}),!0):!1};_n.unstable_batchedUpdates=x_;_n.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Od(n))throw Error(N(200));if(t==null||t._reactInternals===void 0)throw Error(N(38));return jd(t,e,n,!1,r)};_n.version="18.2.0-next-9e3b772b8-20220608";function mC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(mC)}catch(t){console.error(t)}}mC(),yT.exports=_n;var _j=yT.exports,nE=_j;Ag.createRoot=nE.createRoot,Ag.hydrateRoot=nE.hydrateRoot;var vC={exports:{}},_C={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var la=w;function wj(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ej=typeof Object.is=="function"?Object.is:wj,xj=la.useState,Sj=la.useEffect,Aj=la.useLayoutEffect,Tj=la.useDebugValue;function Ij(t,e){var n=e(),r=xj({inst:{value:n,getSnapshot:e}}),i=r[0].inst,s=r[1];return Aj(function(){i.value=n,i.getSnapshot=e,dy(i)&&s({inst:i})},[t,n,e]),Sj(function(){return dy(i)&&s({inst:i}),t(function(){dy(i)&&s({inst:i})})},[t]),Tj(n),n}function dy(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ej(t,n)}catch{return!0}}function Cj(t,e){return e()}var bj=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Cj:Ij;_C.useSyncExternalStore=la.useSyncExternalStore!==void 0?la.useSyncExternalStore:bj;vC.exports=_C;var Pj=vC.exports;const{useEffect:Rj,useLayoutEffect:kj,useRef:Nj,useInsertionEffect:Dj}=uD,Oj=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",jj=Oj?kj:Rj,$j=Dj||jj,wC=t=>{const e=Nj([t,(...n)=>e[0](...n)]).current;return $j(()=>{e[0]=t}),e[1]},Fj=(t="",e=location.pathname)=>e.toLowerCase().indexOf(t.toLowerCase())?"~"+e:e.slice(t.length)||"/",Mj=(t,e="")=>t[0]==="~"?t.slice(1):e+t,Vj="popstate",R_="pushState",k_="replaceState",Lj="hashchange",rE=[Vj,R_,k_,Lj],Uj=t=>{for(const e of rE)addEventListener(e,t);return()=>{for(const e of rE)removeEventListener(e,t)}},Bj=(t,e)=>Pj.useSyncExternalStore(Uj,t,e),iE=()=>location.pathname,zj=({ssrPath:t}={})=>Bj(iE,t?()=>t:iE),Wj=(t,{replace:e=!1}={})=>history[e?k_:R_](null,"",t),Gj=(t={})=>[Fj(t.base,zj(t)),wC((e,n)=>Wj(Mj(e,t.base),n))];if(typeof history<"u")for(const t of[R_,k_]){const e=history[t];history[t]=function(){const n=e.apply(this,arguments),r=new Event(t);return r.arguments=arguments,dispatchEvent(r),n}}function Hj(t=Kj){let e={};const n=r=>e[r]||(e[r]=t(r));return(r,i)=>{const{regexp:s,keys:o}=n(r||""),a=s.exec(i);return a?[!0,o.reduce((u,h,f)=>(u[h.name]=a[f+1],u),{})]:[!1,null]}}const sE=t=>t.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"),qj=(t,e,n)=>{let r=t?"((?:[^\\/]+?)(?:\\/(?:[^\\/]+?))*)":"([^\\/]+?)";return e&&n&&(r="(?:\\/"+r+")"),r+(e?"?":"")},Kj=t=>{const e=/:([A-Za-z0-9_]+)([?+*]?)/g;let n=null,r=0,i=[],s="";for(;(n=e.exec(t))!==null;){const[o,a,l]=n,u=l==="+"||l==="*",h=l==="?"||l==="*",f=h&&t[n.index-1]==="/"?1:0,d=t.substring(r,n.index-f);i.push({name:a}),r=e.lastIndex,s+=sE(d)+qj(u,h,f)}return s+=sE(t.substring(r)),{keys:i,regexp:new RegExp("^"+s+"(?:\\/)?$","i")}},Qj={hook:Gj,matcher:Hj(),base:""},Yj=w.createContext(Qj),$d=()=>w.useContext(Yj),Fd=t=>t.hook(t),Xj=()=>Fd($d()),Jj=t=>{const e=$d(),[n]=Fd(e);return e.matcher(t,n)},Zj=w.createContext({params:{}}),oE=(t,e)=>w.createElement(Zj.Provider,{value:{params:t},children:e}),Sn=({path:t,match:e,component:n,children:r})=>{const i=Jj(t),[s,o]=e||i;return s?n?oE(o,w.createElement(n,{params:o})):oE(o,typeof r=="function"?r(o):r):null};w.forwardRef((t,e)=>{const n=$d(),[,r]=Fd(n),{to:i,href:s=i,children:o,onClick:a}=t,l=wC(f=>{f.ctrlKey||f.metaKey||f.altKey||f.shiftKey||f.button!==0||(a&&a(f),f.defaultPrevented||(f.preventDefault(),r(i||s,t)))}),u={href:s[0]==="~"?s.slice(1):n.base+s,onClick:l,to:null,ref:e},h=w.isValidElement(o)?o:w.createElement("a",t);return w.cloneElement(h,u)});const mm=t=>Array.isArray(t)?[].concat(...t.map(e=>e&&e.type===w.Fragment?mm(e.props.children):mm(e))):[t],e$=({children:t,location:e})=>{const n=$d(),r=n.matcher,[i]=Fd(n);for(const s of mm(t)){let o=0;if(w.isValidElement(s)&&(o=s.props.path?r(s.props.path,e||i):[!0,{}])[0])return w.cloneElement(s,{match:o})}return null};const t$="modulepreload",n$=function(t){return"/"+t},aE={},r$=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=n$(s),s in aE)return;aE[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let h=i.length-1;h>=0;h--){const f=i[h];if(f.href===s&&(!o||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":t$,o||(u.as="script",u.crossOrigin=""),u.href=s,document.head.appendChild(u),o)return new Promise((h,f)=>{u.addEventListener("load",h),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})},i$=t=>{t&&t instanceof Function&&r$(()=>import("./web-vitals-9f4c2f45.js"),[]).then(({getCLS:e,getFID:n,getFCP:r,getLCP:i,getTTFB:s})=>{e(t),n(t),r(t),i(t),s(t)})};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EC={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D=function(t,e){if(!t)throw $a(e)},$a=function(t){return new Error("Firebase Database ("+EC.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xC=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},s$=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},N_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,h=s>>2,f=(s&3)<<4|a>>4;let d=(a&15)<<2|u>>6,p=u&63;l||(p=64,o||(d=64)),r.push(n[h],n[f],n[d],n[p])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(xC(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):s$(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const f=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||u==null||f==null)throw new o$;const d=s<<2|a>>4;if(r.push(d),u!==64){const p=a<<4&240|u>>2;if(r.push(p),f!==64){const g=u<<6&192|f;r.push(g)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class o$ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const SC=function(t){const e=xC(t);return N_.encodeByteArray(e,!0)},df=function(t){return SC(t).replace(/\./g,"")},vm=function(t){try{return N_.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a$(t){return AC(void 0,t)}function AC(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!l$(n)||(t[n]=AC(t[n],e[n]));return t}function l$(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u$(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c$=()=>u$().__FIREBASE_DEFAULTS__,h$=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},f$=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&vm(t[1]);return e&&JSON.parse(e)},D_=()=>{try{return c$()||h$()||f$()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},d$=t=>{var e,n;return(n=(e=D_())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},O_=t=>{const e=d$(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},TC=()=>{var t;return(t=D_())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qu{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j_(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[df(JSON.stringify(n)),df(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p$(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function IC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p$())}function y$(){var t;const e=(t=D_())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function g$(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function CC(){return EC.NODE_ADMIN===!0}function m$(){try{return typeof indexedDB=="object"}catch{return!1}}function v$(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _$="FirebaseError";class Ls extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=_$,Object.setPrototypeOf(this,Ls.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,bC.prototype.create)}}class bC{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?w$(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Ls(i,a,r)}}function w$(t,e){return t.replace(E$,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const E$=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gu(t){return JSON.parse(t)}function ut(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PC=function(t){let e={},n={},r={},i="";try{const s=t.split(".");e=gu(vm(s[0])||""),n=gu(vm(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:i}},x$=function(t){const e=PC(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},S$=function(t){const e=PC(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function ua(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function lE(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function pf(t,e,n){const r={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}function _m(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(uE(s)&&uE(o)){if(!_m(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function uE(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A$(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T${constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const r=this.W_;if(typeof e=="string")for(let f=0;f<16;f++)r[f]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let f=0;f<16;f++)r[f]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let f=16;f<80;f++){const d=r[f-3]^r[f-8]^r[f-14]^r[f-16];r[f]=(d<<1|d>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],u,h;for(let f=0;f<80;f++){f<40?f<20?(u=a^s&(o^a),h=1518500249):(u=s^o^a,h=1859775393):f<60?(u=s&o|a&(s|o),h=2400959708):(u=s^o^a,h=3395469782);const d=(i<<5|i>>>27)+u+l+h+r[f]&4294967295;l=a,a=o,o=(s<<30|s>>>2)&4294967295,s=i,i=d}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const r=n-this.blockSize;let i=0;const s=this.buf_;let o=this.inbuf_;for(;i<n;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<n;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<n;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}}function Ku(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I$=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);if(i>=55296&&i<=56319){const s=i-55296;r++,D(r<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},Md=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ot(t){return t&&t._delegate?t._delegate:t}class bs{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C${constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new qu;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(P$(e))try{this.getOrInitializeService({instanceIdentifier:Qi})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Qi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Qi){return this.instances.has(e)}getOptions(e=Qi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:b$(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Qi){return this.component?this.component.multipleInstances?e:Qi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function b$(t){return t===Qi?void 0:t}function P$(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R${constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new C$(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ee;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ee||(Ee={}));const k$={debug:Ee.DEBUG,verbose:Ee.VERBOSE,info:Ee.INFO,warn:Ee.WARN,error:Ee.ERROR,silent:Ee.SILENT},N$=Ee.INFO,D$={[Ee.DEBUG]:"log",[Ee.VERBOSE]:"log",[Ee.INFO]:"info",[Ee.WARN]:"warn",[Ee.ERROR]:"error"},O$=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=D$[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class $_{constructor(e){this.name=e,this._logLevel=N$,this._logHandler=O$,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ee))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?k$[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ee.DEBUG,...e),this._logHandler(this,Ee.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ee.VERBOSE,...e),this._logHandler(this,Ee.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ee.INFO,...e),this._logHandler(this,Ee.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ee.WARN,...e),this._logHandler(this,Ee.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ee.ERROR,...e),this._logHandler(this,Ee.ERROR,...e)}}const j$=(t,e)=>e.some(n=>t instanceof n);let cE,hE;function $$(){return cE||(cE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function F$(){return hE||(hE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const RC=new WeakMap,wm=new WeakMap,kC=new WeakMap,py=new WeakMap,F_=new WeakMap;function M$(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Si(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&RC.set(n,t)}).catch(()=>{}),F_.set(e,t),e}function V$(t){if(wm.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});wm.set(t,e)}let Em={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return wm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||kC.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Si(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function L$(t){Em=t(Em)}function U$(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(yy(this),e,...n);return kC.set(r,e.sort?e.sort():[e]),Si(r)}:F$().includes(t)?function(...e){return t.apply(yy(this),e),Si(RC.get(this))}:function(...e){return Si(t.apply(yy(this),e))}}function B$(t){return typeof t=="function"?U$(t):(t instanceof IDBTransaction&&V$(t),j$(t,$$())?new Proxy(t,Em):t)}function Si(t){if(t instanceof IDBRequest)return M$(t);if(py.has(t))return py.get(t);const e=B$(t);return e!==t&&(py.set(t,e),F_.set(e,t)),e}const yy=t=>F_.get(t);function z$(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=Si(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Si(o.result),l.oldVersion,l.newVersion,Si(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const W$=["get","getKey","getAll","getAllKeys","count"],G$=["put","add","delete","clear"],gy=new Map;function fE(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(gy.get(e))return gy.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=G$.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||W$.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),i&&l.done]))[0]};return gy.set(e,s),s}L$(t=>({...t,get:(e,n,r)=>fE(e,n)||t.get(e,n,r),has:(e,n)=>!!fE(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H${constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(q$(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function q$(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const xm="@firebase/app",dE="0.9.22";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ps=new $_("@firebase/app"),K$="@firebase/app-compat",Q$="@firebase/analytics-compat",Y$="@firebase/analytics",X$="@firebase/app-check-compat",J$="@firebase/app-check",Z$="@firebase/auth",eF="@firebase/auth-compat",tF="@firebase/database",nF="@firebase/database-compat",rF="@firebase/functions",iF="@firebase/functions-compat",sF="@firebase/installations",oF="@firebase/installations-compat",aF="@firebase/messaging",lF="@firebase/messaging-compat",uF="@firebase/performance",cF="@firebase/performance-compat",hF="@firebase/remote-config",fF="@firebase/remote-config-compat",dF="@firebase/storage",pF="@firebase/storage-compat",yF="@firebase/firestore",gF="@firebase/firestore-compat",mF="firebase",vF="10.5.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sm="[DEFAULT]",_F={[xm]:"fire-core",[K$]:"fire-core-compat",[Y$]:"fire-analytics",[Q$]:"fire-analytics-compat",[J$]:"fire-app-check",[X$]:"fire-app-check-compat",[Z$]:"fire-auth",[eF]:"fire-auth-compat",[tF]:"fire-rtdb",[nF]:"fire-rtdb-compat",[rF]:"fire-fn",[iF]:"fire-fn-compat",[sF]:"fire-iid",[oF]:"fire-iid-compat",[aF]:"fire-fcm",[lF]:"fire-fcm-compat",[uF]:"fire-perf",[cF]:"fire-perf-compat",[hF]:"fire-rc",[fF]:"fire-rc-compat",[dF]:"fire-gcs",[pF]:"fire-gcs-compat",[yF]:"fire-fst",[gF]:"fire-fst-compat","fire-js":"fire-js",[mF]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yf=new Map,Am=new Map;function wF(t,e){try{t.container.addComponent(e)}catch(n){Ps.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ca(t){const e=t.name;if(Am.has(e))return Ps.debug(`There were multiple attempts to register component ${e}.`),!1;Am.set(e,t);for(const n of yf.values())wF(n,t);return!0}function M_(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EF={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Ai=new bC("app","Firebase",EF);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xF{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new bs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ai.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V_=vF;function NC(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Sm,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Ai.create("bad-app-name",{appName:String(i)});if(n||(n=TC()),!n)throw Ai.create("no-options");const s=yf.get(i);if(s){if(_m(n,s.options)&&_m(r,s.config))return s;throw Ai.create("duplicate-app",{appName:i})}const o=new R$(i);for(const l of Am.values())o.addComponent(l);const a=new xF(n,r,o);return yf.set(i,a),a}function L_(t=Sm){const e=yf.get(t);if(!e&&t===Sm&&TC())return NC();if(!e)throw Ai.create("no-app",{appName:t});return e}function mr(t,e,n){var r;let i=(r=_F[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ps.warn(a.join(" "));return}ca(new bs(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SF="firebase-heartbeat-database",AF=1,mu="firebase-heartbeat-store";let my=null;function DC(){return my||(my=z$(SF,AF,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(mu)}}}).catch(t=>{throw Ai.create("idb-open",{originalErrorMessage:t.message})})),my}async function TF(t){try{return await(await DC()).transaction(mu).objectStore(mu).get(OC(t))}catch(e){if(e instanceof Ls)Ps.warn(e.message);else{const n=Ai.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ps.warn(n.message)}}}async function pE(t,e){try{const r=(await DC()).transaction(mu,"readwrite");await r.objectStore(mu).put(e,OC(t)),await r.done}catch(n){if(n instanceof Ls)Ps.warn(n.message);else{const r=Ai.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Ps.warn(r.message)}}}function OC(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IF=1024,CF=30*24*60*60*1e3;class bF{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new RF(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=yE();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(i=>{const s=new Date(i.date).valueOf();return Date.now()-s<=CF}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=yE(),{heartbeatsToSend:n,unsentEntries:r}=PF(this._heartbeatsCache.heartbeats),i=df(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function yE(){return new Date().toISOString().substring(0,10)}function PF(t,e=IF){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),gE(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),gE(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class RF{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return m$()?v$().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await TF(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return pE(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return pE(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function gE(t){return df(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kF(t){ca(new bs("platform-logger",e=>new H$(e),"PRIVATE")),ca(new bs("heartbeat",e=>new bF(e),"PRIVATE")),mr(xm,dE,t),mr(xm,dE,"esm2017"),mr("fire-js","")}kF("");const mE="@firebase/database",vE="1.0.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jC="";function NF(t){jC=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DF{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),ut(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:gu(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OF{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return Sr(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $C=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new DF(e)}}catch{}return new OF},ts=$C("localStorage"),Tm=$C("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bo=new $_("@firebase/database"),jF=function(){let t=1;return function(){return t++}}(),FC=function(t){const e=I$(t),n=new T$;n.update(e);const r=n.digest();return N_.encodeByteArray(r)},Qu=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Qu.apply(null,r):typeof r=="object"?e+=ut(r):e+=r,e+=" "}return e};let us=null,_E=!0;const $F=function(t,e){D(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(Bo.logLevel=Ee.VERBOSE,us=Bo.log.bind(Bo),e&&Tm.set("logging_enabled",!0)):typeof t=="function"?us=t:(us=null,Tm.remove("logging_enabled"))},Ct=function(...t){if(_E===!0&&(_E=!1,us===null&&Tm.get("logging_enabled")===!0&&$F(!0)),us){const e=Qu.apply(null,t);us(e)}},Yu=function(t){return function(...e){Ct(t,...e)}},Im=function(...t){const e="FIREBASE INTERNAL ERROR: "+Qu(...t);Bo.error(e)},Br=function(...t){const e=`FIREBASE FATAL ERROR: ${Qu(...t)}`;throw Bo.error(e),new Error(e)},en=function(...t){const e="FIREBASE WARNING: "+Qu(...t);Bo.warn(e)},FF=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&en("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},U_=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},MF=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Rs="[MIN_NAME]",Ni="[MAX_NAME]",Us=function(t,e){if(t===e)return 0;if(t===Rs||e===Ni)return-1;if(e===Rs||t===Ni)return 1;{const n=wE(t),r=wE(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},VF=function(t,e){return t===e?0:t<e?-1:1},rl=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+ut(e))},B_=function(t){if(typeof t!="object"||t===null)return ut(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=ut(e[r]),n+=":",n+=B_(t[e[r]]);return n+="}",n},MC=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function jt(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const VC=function(t){D(!U_(t),"Invalid JSON number");const e=11,n=52,r=(1<<e-1)-1;let i,s,o,a,l;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));const u=[];for(l=n;l;l-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)u.push(s%2?1:0),s=Math.floor(s/2);u.push(i?1:0),u.reverse();const h=u.join("");let f="";for(l=0;l<64;l+=8){let d=parseInt(h.substr(l,8),2).toString(16);d.length===1&&(d="0"+d),f=f+d}return f.toLowerCase()},LF=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},UF=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function BF(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}const zF=new RegExp("^-?(0*)\\d{1,10}$"),WF=-2147483648,GF=2147483647,wE=function(t){if(zF.test(t)){const e=Number(t);if(e>=WF&&e<=GF)return e}return null},Fa=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw en("Exception was thrown by user callback.",n),e},Math.floor(0))}},HF=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Ml=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qF{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){en(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KF{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Ct("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',en(e)}}class zo{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}zo.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z_="5",LC="v",UC="s",BC="r",zC="f",WC=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,GC="ls",HC="p",Cm="ac",qC="websocket",KC="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QC{constructor(e,n,r,i,s=!1,o="",a=!1,l=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=ts.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&ts.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function QF(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function YC(t,e,n){D(typeof e=="string","typeof type must == string"),D(typeof n=="object","typeof params must == object");let r;if(e===qC)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===KC)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);QF(t)&&(n.ns=t.namespace);const i=[];return jt(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YF{constructor(){this.counters_={}}incrementCounter(e,n=1){Sr(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return a$(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vy={},_y={};function W_(t){const e=t.toString();return vy[e]||(vy[e]=new YF),vy[e]}function XF(t,e){const n=t.toString();return _y[n]||(_y[n]=e()),_y[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JF{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Fa(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EE="start",ZF="close",eM="pLPCommand",tM="pRTLPCB",XC="id",JC="pw",ZC="ser",nM="cb",rM="seg",iM="ts",sM="d",oM="dframe",eb=1870,tb=30,aM=eb-tb,lM=25e3,uM=3e4;class Po{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Yu(e),this.stats_=W_(n),this.urlFn=l=>(this.appCheckToken&&(l[Cm]=this.appCheckToken),YC(n,KC,l))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new JF(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(uM)),MF(()=>{if(this.isClosed_)return;this.scriptTagHolder=new G_((...s)=>{const[o,a,l,u,h]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===EE)this.id=a,this.password=l;else if(o===ZF)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{const[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const r={};r[EE]="t",r[ZC]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[nM]=this.scriptTagHolder.uniqueCallbackIdentifier),r[LC]=z_,this.transportSessionId&&(r[UC]=this.transportSessionId),this.lastSessionId&&(r[GC]=this.lastSessionId),this.applicationId&&(r[HC]=this.applicationId),this.appCheckToken&&(r[Cm]=this.appCheckToken),typeof location<"u"&&location.hostname&&WC.test(location.hostname)&&(r[BC]=zC);const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Po.forceAllow_=!0}static forceDisallow(){Po.forceDisallow_=!0}static isAvailable(){return Po.forceAllow_?!0:!Po.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!LF()&&!UF()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=ut(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=SC(n),i=MC(r,aM);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const r={};r[oM]="t",r[XC]=e,r[JC]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=ut(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class G_{constructor(e,n,r,i){this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=jF(),window[eM+this.uniqueCallbackIdentifier]=e,window[tM+this.uniqueCallbackIdentifier]=n,this.myIFrame=G_.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Ct("frame writing exception"),a.stack&&Ct(a.stack),Ct(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Ct("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[XC]=this.myID,e[JC]=this.myPW,e[ZC]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+tb+r.length<=eb;){const o=this.pendingSegs.shift();r=r+"&"+rM+i+"="+o.seg+"&"+iM+i+"="+o.ts+"&"+sM+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(lM)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{Ct("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cM=16384,hM=45e3;let gf=null;typeof MozWebSocket<"u"?gf=MozWebSocket:typeof WebSocket<"u"&&(gf=WebSocket);class Gn{constructor(e,n,r,i,s,o,a){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Yu(this.connId),this.stats_=W_(n),this.connURL=Gn.connectionURL_(n,o,a,i,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,r,i,s){const o={};return o[LC]=z_,typeof location<"u"&&location.hostname&&WC.test(location.hostname)&&(o[BC]=zC),n&&(o[UC]=n),r&&(o[GC]=r),i&&(o[Cm]=i),s&&(o[HC]=s),YC(e,qC,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,ts.set("previous_websocket_failure",!0);try{let r;CC(),this.mySock=new gf(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){Gn.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&gf!==null&&!Gn.forceDisallow_}static previouslyFailed(){return ts.isInMemoryStorage||ts.get("previous_websocket_failure")===!0}markConnectionHealthy(){ts.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const r=gu(n);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(D(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const n=ut(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=MC(n,cM);r.length>1&&this.sendString_(String(r.length));for(let i=0;i<r.length;i++)this.sendString_(r[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(hM))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Gn.responsesRequiredToBeHealthy=2;Gn.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Po,Gn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const n=Gn&&Gn.isAvailable();let r=n&&!Gn.previouslyFailed();if(e.webSocketOnly&&(n||en("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[Gn];else{const i=this.transports_=[];for(const s of vu.ALL_TRANSPORTS)s&&s.isAvailable()&&i.push(s);vu.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}vu.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fM=6e4,dM=5e3,pM=10*1024,yM=100*1024,wy="t",xE="d",gM="s",SE="r",mM="e",AE="o",TE="a",IE="n",CE="p",vM="h";class _M{constructor(e,n,r,i,s,o,a,l,u,h){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=u,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Yu("c:"+this.id+":"),this.transportManager_=new vu(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Ml(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>yM?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>pM?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(wy in e){const n=e[wy];n===TE?this.upgradeIfSecondaryHealthy_():n===SE?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===AE&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=rl("t",e),r=rl("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:CE,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:TE,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:IE,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=rl("t",e),r=rl("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=rl(wy,e);if(xE in e){const r=e[xE];if(n===vM){const i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===IE){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===gM?this.onConnectionShutdown_(r):n===SE?this.onReset_(r):n===mM?Im("Server Error: "+r):n===AE?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Im("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),z_!==r&&en("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Ml(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(fM))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Ml(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(dM))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:CE,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(ts.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nb{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rb{constructor(e){this.allowedEvents_=e,this.listeners_={},D(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){D(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf extends rb{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!IC()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new mf}getInitialEvent(e){return D(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bE=32,PE=768;class Ie{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function Se(){return new Ie("")}function oe(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Di(t){return t.pieces_.length-t.pieceNum_}function Ne(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Ie(t.pieces_,e)}function H_(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function wM(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function _u(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function ib(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Ie(e,0)}function Qe(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof Ie)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new Ie(n,0)}function ae(t){return t.pieceNum_>=t.pieces_.length}function Xt(t,e){const n=oe(t),r=oe(e);if(n===null)return e;if(n===r)return Xt(Ne(t),Ne(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function EM(t,e){const n=_u(t,0),r=_u(e,0);for(let i=0;i<n.length&&i<r.length;i++){const s=Us(n[i],r[i]);if(s!==0)return s}return n.length===r.length?0:n.length<r.length?-1:1}function q_(t,e){if(Di(t)!==Di(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function kn(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(Di(t)>Di(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class xM{constructor(e,n){this.errorPrefix_=n,this.parts_=_u(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Md(this.parts_[r]);sb(this)}}function SM(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Md(e),sb(t)}function AM(t){const e=t.parts_.pop();t.byteLength_-=Md(e),t.parts_.length>0&&(t.byteLength_-=1)}function sb(t){if(t.byteLength_>PE)throw new Error(t.errorPrefix_+"has a key path longer than "+PE+" bytes ("+t.byteLength_+").");if(t.parts_.length>bE)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+bE+") or object contains a cycle "+Yi(t))}function Yi(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_ extends rb{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new K_}getInitialEvent(e){return D(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const il=1e3,TM=60*5*1e3,RE=30*1e3,IM=1.3,CM=3e4,bM="server_kill",kE=3;class jr extends nb{constructor(e,n,r,i,s,o,a,l){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=i,this.onServerInfoUpdate_=s,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=jr.nextPersistentConnectionId_++,this.log_=Yu("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=il,this.maxReconnectDelay_=TM,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!CC())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");K_.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&mf.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,r){const i=++this.requestNumber_,s={r:i,a:e,b:n};this.log_(ut(s)),D(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),r&&(this.requestCBHash_[i]=r)}get(e){this.initConnection_();const n=new qu,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),n.promise}listen(e,n,r,i){this.initConnection_();const s=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+s),this.listens.has(o)||this.listens.set(o,new Map),D(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),D(!this.listens.get(o).has(s),"listen() called twice for same path/queryId.");const a={onComplete:i,hashFn:n,query:e,tag:r};this.listens.get(o).set(s,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(e){const n=e.query,r=n._path.toString(),i=n._queryIdentifier;this.log_("Listen on "+r+" for "+i);const s={p:r},o="q";e.tag&&(s.q=n._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest(o,s,a=>{const l=a.d,u=a.s;jr.warnOnListenWarnings_(l,n),(this.listens.get(r)&&this.listens.get(r).get(i))===e&&(this.log_("listen response",a),u!=="ok"&&this.removeListen_(r,i),e.onComplete&&e.onComplete(u,l))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&Sr(e,"w")){const r=ua(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const i='".indexOn": "'+n._queryParams.getIndex().toString()+'"',s=n._path.toString();en(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||S$(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=RE)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=x$(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,i=>{const s=i.s,o=i.d||"error";this.authToken_===e&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,r=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(e,n){const r=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+i),D(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,i)&&this.connected_&&this.sendUnlisten_(r,i,e._queryObject,n)}sendUnlisten_(e,n,r,i){this.log_("Unlisten on "+e+" for "+n);const s={p:e},o="n";i&&(s.q=r,s.t=i),this.sendRequest(o,s)}onDisconnectPut(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:r})}onDisconnectMerge(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:r})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,r,i){const s={p:n,d:r};this.log_("onDisconnect "+e,s),this.sendRequest(e,s,o=>{i&&setTimeout(()=>{i(o.s,o.d)},Math.floor(0))})}put(e,n,r,i){this.putInternal("p",e,n,r,i)}merge(e,n,r,i){this.putInternal("m",e,n,r,i)}putInternal(e,n,r,i,s){this.initConnection_();const o={p:n,d:r};s!==void 0&&(o.h=s),this.outstandingPuts_.push({action:e,request:o,onComplete:i}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,s=>{this.log_(n+" response",s),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(s.s,s.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){const s=r.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+ut(e));const n=e.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):Im("Unrecognized action received from server: "+ut(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){D(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=il,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=il,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>CM&&(this.reconnectDelay_=il),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*IM)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+jr.nextConnectionId_++,s=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,r())},u=function(f){D(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(f)};this.realtime_={close:l,sendRequest:u};const h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[f,d]=await Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);o?Ct("getToken() completed but was canceled"):(Ct("getToken() completed. Creating connection."),this.authToken_=f&&f.accessToken,this.appCheckToken_=d&&d.token,a=new _M(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,p=>{en(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(bM)},s))}catch(f){this.log_("Failed to get token: "+f),o||(this.repoInfo_.nodeAdmin&&en(f),l())}}}interrupt(e){Ct("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Ct("Resuming connection for reason: "+e),delete this.interruptReasons_[e],lE(this.interruptReasons_)&&(this.reconnectDelay_=il,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let r;n?r=n.map(s=>B_(s)).join("$"):r="default";const i=this.removeListen_(e,r);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,n){const r=new Ie(e).toString();let i;if(this.listens.has(r)){const s=this.listens.get(r);i=s.get(n),s.delete(n),s.size===0&&this.listens.delete(r)}else i=void 0;return i}onAuthRevoked_(e,n){Ct("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=kE&&(this.reconnectDelay_=RE,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){Ct("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=kE&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+jC.replace(/\./g,"-")]=1,IC()?e["framework.cordova"]=1:g$()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=mf.getInstance().currentlyOnline();return lE(this.interruptReasons_)&&e}}jr.nextPersistentConnectionId_=0;jr.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ue{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new ue(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vd{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new ue(Rs,e),i=new ue(Rs,n);return this.compare(r,i)!==0}minPost(){return ue.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yc;class ob extends Vd{static get __EMPTY_NODE(){return Yc}static set __EMPTY_NODE(e){Yc=e}compare(e,n){return Us(e.name,n.name)}isDefinedOn(e){throw $a("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return ue.MIN}maxPost(){return new ue(Ni,Yc)}makePost(e,n){return D(typeof e=="string","KeyIndex indexValue must always be a string."),new ue(e,Yc)}toString(){return".key"}}const cs=new ob;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xc=class{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},fn=class El{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??El.RED,this.left=i??cr.EMPTY_NODE,this.right=s??cr.EMPTY_NODE}copy(e,n,r,i,s){return new El(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return s<0?i=i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i=i.copy(null,n,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return cr.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let r,i;if(r=this,n(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(e,r.key)===0){if(r.right.isEmpty())return cr.EMPTY_NODE;i=r.right.min_(),r=r.copy(i.key,i.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,El.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,El.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}};fn.RED=!0;fn.BLACK=!1;class PM{copy(e,n,r,i,s){return this}insert(e,n,r){return new fn(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}let cr=class Th{constructor(e,n=Th.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new Th(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,fn.BLACK,null,null))}remove(e){return new Th(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,fn.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Xc(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Xc(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Xc(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Xc(this.root_,null,this.comparator_,!0,e)}};cr.EMPTY_NODE=new PM;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RM(t,e){return Us(t.name,e.name)}function Q_(t,e){return Us(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bm;function kM(t){bm=t}const ab=function(t){return typeof t=="number"?"number:"+VC(t):"string:"+t},lb=function(t){if(t.isLeafNode()){const e=t.val();D(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Sr(e,".sv"),"Priority must be a string or number.")}else D(t===bm||t.isEmpty(),"priority of unexpected type.");D(t===bm||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let NE;class vt{constructor(e,n=vt.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,D(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),lb(this.priorityNode_)}static set __childrenNodeConstructor(e){NE=e}static get __childrenNodeConstructor(){return NE}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new vt(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:vt.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return ae(e)?this:oe(e)===".priority"?this.priorityNode_:vt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:vt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const r=oe(e);return r===null?n:n.isEmpty()&&r!==".priority"?this:(D(r!==".priority"||Di(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,vt.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ne(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+ab(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=VC(this.value_):e+=this.value_,this.lazyHash_=FC(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===vt.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof vt.__childrenNodeConstructor?-1:(D(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,r=typeof this.value_,i=vt.VALUE_TYPE_ORDER.indexOf(n),s=vt.VALUE_TYPE_ORDER.indexOf(r);return D(i>=0,"Unknown leaf type: "+n),D(s>=0,"Unknown leaf type: "+r),i===s?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}vt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ub,cb;function NM(t){ub=t}function DM(t){cb=t}class OM extends Vd{compare(e,n){const r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?Us(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return ue.MIN}maxPost(){return new ue(Ni,new vt("[PRIORITY-POST]",cb))}makePost(e,n){const r=ub(e);return new ue(n,new vt("[PRIORITY-POST]",r))}toString(){return".priority"}}const ze=new OM;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jM=Math.log(2);class $M{constructor(e){const n=s=>parseInt(Math.log(s)/jM,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const vf=function(t,e,n,r){t.sort(e);const i=function(l,u){const h=u-l;let f,d;if(h===0)return null;if(h===1)return f=t[l],d=n?n(f):f,new fn(d,f.node,fn.BLACK,null,null);{const p=parseInt(h/2,10)+l,g=i(l,p),v=i(p+1,u);return f=t[p],d=n?n(f):f,new fn(d,f.node,fn.BLACK,g,v)}},s=function(l){let u=null,h=null,f=t.length;const d=function(g,v){const E=f-g,m=f;f-=g;const y=i(E+1,m),_=t[E],S=n?n(_):_;p(new fn(S,_.node,v,null,y))},p=function(g){u?(u.left=g,u=g):(h=g,u=g)};for(let g=0;g<l.count;++g){const v=l.nextBitIsOne(),E=Math.pow(2,l.count-(g+1));v?d(E,fn.BLACK):(d(E,fn.BLACK),d(E,fn.RED))}return h},o=new $M(t.length),a=s(o);return new cr(r||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ey;const Qs={};class Nr{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return D(Qs&&ze,"ChildrenNode.ts has not been loaded"),Ey=Ey||new Nr({".priority":Qs},{".priority":ze}),Ey}get(e){const n=ua(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof cr?n:null}hasIndex(e){return Sr(this.indexSet_,e.toString())}addIndex(e,n){D(e!==cs,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const s=n.getIterator(ue.Wrap);let o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=vf(r,e.getCompare()):a=Qs;const l=e.toString(),u=Object.assign({},this.indexSet_);u[l]=e;const h=Object.assign({},this.indexes_);return h[l]=a,new Nr(h,u)}addToIndexes(e,n){const r=pf(this.indexes_,(i,s)=>{const o=ua(this.indexSet_,s);if(D(o,"Missing index implementation for "+s),i===Qs)if(o.isDefinedOn(e.node)){const a=[],l=n.getIterator(ue.Wrap);let u=l.getNext();for(;u;)u.name!==e.name&&a.push(u),u=l.getNext();return a.push(e),vf(a,o.getCompare())}else return Qs;else{const a=n.get(e.name);let l=i;return a&&(l=l.remove(new ue(e.name,a))),l.insert(e,e.node)}});return new Nr(r,this.indexSet_)}removeFromIndexes(e,n){const r=pf(this.indexes_,i=>{if(i===Qs)return i;{const s=n.get(e.name);return s?i.remove(new ue(e.name,s)):i}});return new Nr(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sl;class J{constructor(e,n,r){this.children_=e,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&lb(this.priorityNode_),this.children_.isEmpty()&&D(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return sl||(sl=new J(new cr(Q_),null,Nr.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||sl}updatePriority(e){return this.children_.isEmpty()?this:new J(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?sl:n}}getChild(e){const n=oe(e);return n===null?this:this.getImmediateChild(n).getChild(Ne(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(D(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const r=new ue(e,n);let i,s;n.isEmpty()?(i=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,n),s=this.indexMap_.addToIndexes(r,this.children_));const o=i.isEmpty()?sl:this.priorityNode_;return new J(i,o,s)}}updateChild(e,n){const r=oe(e);if(r===null)return n;{D(oe(e)!==".priority"||Di(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(r).updateChild(Ne(e),n);return this.updateImmediateChild(r,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let r=0,i=0,s=!0;if(this.forEachChild(ze,(o,a)=>{n[o]=a.val(e),r++,s&&J.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):s=!1}),!e&&s&&i<2*r){const o=[];for(const a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+ab(this.getPriority().val())+":"),this.forEachChild(ze,(n,r)=>{const i=r.hash();i!==""&&(e+=":"+n+":"+i)}),this.lazyHash_=e===""?"":FC(e)}return this.lazyHash_}getPredecessorChildName(e,n,r){const i=this.resolveIndex_(r);if(i){const s=i.getPredecessorKey(new ue(e,n));return s?s.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new ue(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new ue(n,this.children_.get(n)):null}forEachChild(e,n){const r=this.resolveIndex_(e);return r?r.inorderTraversal(i=>n(i.name,i.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,ue.Wrap);let s=i.peek();for(;s!=null&&n.compare(s,e)<0;)i.getNext(),s=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,ue.Wrap);let s=i.peek();for(;s!=null&&n.compare(s,e)>0;)i.getNext(),s=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Xu?-1:0}withIndex(e){if(e===cs||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new J(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===cs||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const r=this.getIterator(ze),i=n.getIterator(ze);let s=r.getNext(),o=i.getNext();for(;s&&o;){if(s.name!==o.name||!s.node.equals(o.node))return!1;s=r.getNext(),o=i.getNext()}return s===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===cs?null:this.indexMap_.get(e.toString())}}J.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class FM extends J{constructor(){super(new cr(Q_),J.EMPTY_NODE,Nr.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return J.EMPTY_NODE}isEmpty(){return!1}}const Xu=new FM;Object.defineProperties(ue,{MIN:{value:new ue(Rs,J.EMPTY_NODE)},MAX:{value:new ue(Ni,Xu)}});ob.__EMPTY_NODE=J.EMPTY_NODE;vt.__childrenNodeConstructor=J;kM(Xu);DM(Xu);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MM=!0;function lt(t,e=null){if(t===null)return J.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),D(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new vt(n,lt(e))}if(!(t instanceof Array)&&MM){const n=[];let r=!1;if(jt(t,(o,a)=>{if(o.substring(0,1)!=="."){const l=lt(a);l.isEmpty()||(r=r||!l.getPriority().isEmpty(),n.push(new ue(o,l)))}}),n.length===0)return J.EMPTY_NODE;const s=vf(n,RM,o=>o.name,Q_);if(r){const o=vf(n,ze.getCompare());return new J(s,lt(e),new Nr({".priority":o},{".priority":ze}))}else return new J(s,lt(e),Nr.Default)}else{let n=J.EMPTY_NODE;return jt(t,(r,i)=>{if(Sr(t,r)&&r.substring(0,1)!=="."){const s=lt(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(lt(e))}}NM(lt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y_ extends Vd{constructor(e){super(),this.indexPath_=e,D(!ae(e)&&oe(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?Us(e.name,n.name):s}makePost(e,n){const r=lt(e),i=J.EMPTY_NODE.updateChild(this.indexPath_,r);return new ue(n,i)}maxPost(){const e=J.EMPTY_NODE.updateChild(this.indexPath_,Xu);return new ue(Ni,e)}toString(){return _u(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VM extends Vd{compare(e,n){const r=e.node.compareTo(n.node);return r===0?Us(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return ue.MIN}maxPost(){return ue.MAX}makePost(e,n){const r=lt(e);return new ue(n,r)}toString(){return".value"}}const hb=new VM;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fb(t){return{type:"value",snapshotNode:t}}function ha(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function wu(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Eu(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function LM(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X_{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){D(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(wu(n,a)):D(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(ha(n,r)):o.trackChildChange(Eu(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(ze,(i,s)=>{n.hasChild(i)||r.trackChildChange(wu(i,s))}),n.isLeafNode()||n.forEachChild(ze,(i,s)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(Eu(i,s,o))}else r.trackChildChange(ha(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?J.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xu{constructor(e){this.indexedFilter_=new X_(e.getIndex()),this.index_=e.getIndex(),this.startPost_=xu.getStartPost_(e),this.endPost_=xu.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new ue(n,r))||(r=J.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=J.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(J.EMPTY_NODE);const s=this;return n.forEachChild(ze,(o,a)=>{s.matches(new ue(o,a))||(i=i.updateImmediateChild(o,J.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UM{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{const r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new xu(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new ue(n,r))||(r=J.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=J.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=J.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){const a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(J.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){const a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,J.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){const f=this.index_.getCompare();o=(d,p)=>f(p,d)}else o=this.index_.getCompare();const a=e;D(a.numChildren()===this.limit_,"");const l=new ue(n,r),u=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),h=this.rangedFilter_.matches(l);if(a.hasChild(n)){const f=a.getImmediateChild(n);let d=i.getChildAfterChild(this.index_,u,this.reverse_);for(;d!=null&&(d.name===n||a.hasChild(d.name));)d=i.getChildAfterChild(this.index_,d,this.reverse_);const p=d==null?1:o(d,l);if(h&&!r.isEmpty()&&p>=0)return s!=null&&s.trackChildChange(Eu(n,r,f)),a.updateImmediateChild(n,r);{s!=null&&s.trackChildChange(wu(n,f));const v=a.updateImmediateChild(n,J.EMPTY_NODE);return d!=null&&this.rangedFilter_.matches(d)?(s!=null&&s.trackChildChange(ha(d.name,d.node)),v.updateImmediateChild(d.name,d.node)):v}}else return r.isEmpty()?e:h&&o(u,l)>=0?(s!=null&&(s.trackChildChange(wu(u.name,u.node)),s.trackChildChange(ha(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(u.name,J.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J_{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ze}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return D(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return D(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Rs}hasEnd(){return this.endSet_}getIndexEndValue(){return D(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return D(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Ni}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return D(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ze}copy(){const e=new J_;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function BM(t){return t.loadsAllData()?new X_(t.getIndex()):t.hasLimit()?new UM(t):new xu(t)}function zM(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function WM(t,e,n){const r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function GM(t,e,n){const r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function HM(t,e){const n=t.copy();return n.index_=e,n}function DE(t){const e={};if(t.isDefault())return e;let n;if(t.index_===ze?n="$priority":t.index_===hb?n="$value":t.index_===cs?n="$key":(D(t.index_ instanceof Y_,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=ut(n),t.startSet_){const r=t.startAfterSet_?"startAfter":"startAt";e[r]=ut(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+ut(t.indexStartName_))}if(t.endSet_){const r=t.endBeforeSet_?"endBefore":"endAt";e[r]=ut(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+ut(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function OE(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==ze&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _f extends nb{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Yu("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(D(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=_f.getListenId_(e,r),a={};this.listens_[o]=a;const l=DE(e._queryParams);this.restRequest_(s+".json",l,(u,h)=>{let f=h;if(u===404&&(f=null,u=null),u===null&&this.onDataUpdate_(s,f,!1,r),ua(this.listens_,o)===a){let d;u?u===401?d="permission_denied":d="rest_error:"+u:d="ok",i(d,null)}})}unlisten(e,n){const r=_f.getListenId_(e,n);delete this.listens_[r]}get(e){const n=DE(e._queryParams),r=e._path.toString(),i=new qu;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+A$(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=gu(a.responseText)}catch{en("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,l)}else a.status!==401&&a.status!==404&&en("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qM{constructor(){this.rootNode_=J.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wf(){return{value:null,children:new Map}}function db(t,e,n){if(ae(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const r=oe(e);t.children.has(r)||t.children.set(r,wf());const i=t.children.get(r);e=Ne(e),db(i,e,n)}}function Pm(t,e,n){t.value!==null?n(e,t.value):KM(t,(r,i)=>{const s=new Ie(e.toString()+"/"+r);Pm(i,s,n)})}function KM(t,e){t.children.forEach((n,r)=>{e(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QM{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&jt(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jE=10*1e3,YM=30*1e3,XM=5*60*1e3;class JM{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new QM(e);const r=jE+(YM-jE)*Math.random();Ml(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;jt(e,(i,s)=>{s>0&&Sr(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),Ml(this.reportStats_.bind(this),Math.floor(Math.random()*2*XM))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qn;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(qn||(qn={}));function Z_(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function e0(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function t0(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=qn.ACK_USER_WRITE,this.source=Z_()}operationForChild(e){if(ae(this.path)){if(this.affectedTree.value!=null)return D(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Ie(e));return new Ef(Se(),n,this.revert)}}else return D(oe(this.path)===e,"operationForChild called for unrelated child."),new Ef(Ne(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Su{constructor(e,n){this.source=e,this.path=n,this.type=qn.LISTEN_COMPLETE}operationForChild(e){return ae(this.path)?new Su(this.source,Se()):new Su(this.source,Ne(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ks{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=qn.OVERWRITE}operationForChild(e){return ae(this.path)?new ks(this.source,Se(),this.snap.getImmediateChild(e)):new ks(this.source,Ne(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=qn.MERGE}operationForChild(e){if(ae(this.path)){const n=this.children.subtree(new Ie(e));return n.isEmpty()?null:n.value?new ks(this.source,Se(),n.value):new fa(this.source,Se(),n)}else return D(oe(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new fa(this.source,Ne(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ae(e))return this.isFullyInitialized()&&!this.filtered_;const n=oe(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZM{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function eV(t,e,n,r){const i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(LM(o.childName,o.snapshotNode))}),ol(t,i,"child_removed",e,r,n),ol(t,i,"child_added",e,r,n),ol(t,i,"child_moved",s,r,n),ol(t,i,"child_changed",e,r,n),ol(t,i,"value",e,r,n),i}function ol(t,e,n,r,i,s){const o=r.filter(a=>a.type===n);o.sort((a,l)=>nV(t,a,l)),o.forEach(a=>{const l=tV(t,a,s);i.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(l,t.query_))})})}function tV(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function nV(t,e,n){if(e.childName==null||n.childName==null)throw $a("Should only compare child_ events.");const r=new ue(e.childName,e.snapshotNode),i=new ue(n.childName,n.snapshotNode);return t.index_.compare(r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ld(t,e){return{eventCache:t,serverCache:e}}function Vl(t,e,n,r){return Ld(new Oi(e,n,r),t.serverCache)}function pb(t,e,n,r){return Ld(t.eventCache,new Oi(e,n,r))}function xf(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Ns(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xy;const rV=()=>(xy||(xy=new cr(VF)),xy);class ke{constructor(e,n=rV()){this.value=e,this.children=n}static fromObject(e){let n=new ke(null);return jt(e,(r,i)=>{n=n.set(new Ie(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:Se(),value:this.value};if(ae(e))return null;{const r=oe(e),i=this.children.get(r);if(i!==null){const s=i.findRootMostMatchingPathAndValue(Ne(e),n);return s!=null?{path:Qe(new Ie(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ae(e))return this;{const n=oe(e),r=this.children.get(n);return r!==null?r.subtree(Ne(e)):new ke(null)}}set(e,n){if(ae(e))return new ke(n,this.children);{const r=oe(e),s=(this.children.get(r)||new ke(null)).set(Ne(e),n),o=this.children.insert(r,s);return new ke(this.value,o)}}remove(e){if(ae(e))return this.children.isEmpty()?new ke(null):new ke(null,this.children);{const n=oe(e),r=this.children.get(n);if(r){const i=r.remove(Ne(e));let s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new ke(null):new ke(this.value,s)}else return this}}get(e){if(ae(e))return this.value;{const n=oe(e),r=this.children.get(n);return r?r.get(Ne(e)):null}}setTree(e,n){if(ae(e))return n;{const r=oe(e),s=(this.children.get(r)||new ke(null)).setTree(Ne(e),n);let o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new ke(this.value,o)}}fold(e){return this.fold_(Se(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Qe(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,Se(),n)}findOnPath_(e,n,r){const i=this.value?r(n,this.value):!1;if(i)return i;if(ae(e))return null;{const s=oe(e),o=this.children.get(s);return o?o.findOnPath_(Ne(e),Qe(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,Se(),n)}foreachOnPath_(e,n,r){if(ae(e))return this;{this.value&&r(n,this.value);const i=oe(e),s=this.children.get(i);return s?s.foreachOnPath_(Ne(e),Qe(n,i),r):new ke(null)}}foreach(e){this.foreach_(Se(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(Qe(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{constructor(e){this.writeTree_=e}static empty(){return new Xn(new ke(null))}}function Ll(t,e,n){if(ae(e))return new Xn(new ke(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){const i=r.path;let s=r.value;const o=Xt(i,e);return s=s.updateChild(o,n),new Xn(t.writeTree_.set(i,s))}else{const i=new ke(n),s=t.writeTree_.setTree(e,i);return new Xn(s)}}}function Rm(t,e,n){let r=t;return jt(n,(i,s)=>{r=Ll(r,Qe(e,i),s)}),r}function $E(t,e){if(ae(e))return Xn.empty();{const n=t.writeTree_.setTree(e,new ke(null));return new Xn(n)}}function km(t,e){return Bs(t,e)!=null}function Bs(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Xt(n.path,e)):null}function FE(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(ze,(r,i)=>{e.push(new ue(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new ue(r,i.value))}),e}function Ti(t,e){if(ae(e))return t;{const n=Bs(t,e);return n!=null?new Xn(new ke(n)):new Xn(t.writeTree_.subtree(e))}}function Nm(t){return t.writeTree_.isEmpty()}function da(t,e){return yb(Se(),t.writeTree_,e)}function yb(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(D(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=yb(Qe(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(Qe(t,".priority"),r)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ud(t,e){return _b(e,t)}function iV(t,e,n,r,i){D(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=Ll(t.visibleWrites,e,n)),t.lastWriteId=r}function sV(t,e,n,r){D(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=Rm(t.visibleWrites,e,n),t.lastWriteId=r}function oV(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}function aV(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);D(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&lV(a,r.path)?i=!1:kn(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return uV(t),!0;if(r.snap)t.visibleWrites=$E(t.visibleWrites,r.path);else{const a=r.children;jt(a,l=>{t.visibleWrites=$E(t.visibleWrites,Qe(r.path,l))})}return!0}else return!1}function lV(t,e){if(t.snap)return kn(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&kn(Qe(t.path,n),e))return!0;return!1}function uV(t){t.visibleWrites=gb(t.allWrites,cV,Se()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function cV(t){return t.visible}function gb(t,e,n){let r=Xn.empty();for(let i=0;i<t.length;++i){const s=t[i];if(e(s)){const o=s.path;let a;if(s.snap)kn(n,o)?(a=Xt(n,o),r=Ll(r,a,s.snap)):kn(o,n)&&(a=Xt(o,n),r=Ll(r,Se(),s.snap.getChild(a)));else if(s.children){if(kn(n,o))a=Xt(n,o),r=Rm(r,a,s.children);else if(kn(o,n))if(a=Xt(o,n),ae(a))r=Rm(r,Se(),s.children);else{const l=ua(s.children,oe(a));if(l){const u=l.getChild(Ne(a));r=Ll(r,Se(),u)}}}else throw $a("WriteRecord should have .snap or .children")}}return r}function mb(t,e,n,r,i){if(!r&&!i){const s=Bs(t.visibleWrites,e);if(s!=null)return s;{const o=Ti(t.visibleWrites,e);if(Nm(o))return n;if(n==null&&!km(o,Se()))return null;{const a=n||J.EMPTY_NODE;return da(o,a)}}}else{const s=Ti(t.visibleWrites,e);if(!i&&Nm(s))return n;if(!i&&n==null&&!km(s,Se()))return null;{const o=function(u){return(u.visible||i)&&(!r||!~r.indexOf(u.writeId))&&(kn(u.path,e)||kn(e,u.path))},a=gb(t.allWrites,o,e),l=n||J.EMPTY_NODE;return da(a,l)}}}function hV(t,e,n){let r=J.EMPTY_NODE;const i=Bs(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(ze,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){const s=Ti(t.visibleWrites,e);return n.forEachChild(ze,(o,a)=>{const l=da(Ti(s,new Ie(o)),a);r=r.updateImmediateChild(o,l)}),FE(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const s=Ti(t.visibleWrites,e);return FE(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function fV(t,e,n,r,i){D(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=Qe(e,n);if(km(t.visibleWrites,s))return null;{const o=Ti(t.visibleWrites,s);return Nm(o)?i.getChild(n):da(o,i.getChild(n))}}function dV(t,e,n,r){const i=Qe(e,n),s=Bs(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){const o=Ti(t.visibleWrites,i);return da(o,r.getNode().getImmediateChild(n))}else return null}function pV(t,e){return Bs(t.visibleWrites,e)}function yV(t,e,n,r,i,s,o){let a;const l=Ti(t.visibleWrites,e),u=Bs(l,Se());if(u!=null)a=u;else if(n!=null)a=da(l,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const h=[],f=o.getCompare(),d=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let p=d.getNext();for(;p&&h.length<i;)f(p,r)!==0&&h.push(p),p=d.getNext();return h}else return[]}function gV(){return{visibleWrites:Xn.empty(),allWrites:[],lastWriteId:-1}}function Sf(t,e,n,r){return mb(t.writeTree,t.treePath,e,n,r)}function n0(t,e){return hV(t.writeTree,t.treePath,e)}function ME(t,e,n,r){return fV(t.writeTree,t.treePath,e,n,r)}function Af(t,e){return pV(t.writeTree,Qe(t.treePath,e))}function mV(t,e,n,r,i,s){return yV(t.writeTree,t.treePath,e,n,r,i,s)}function r0(t,e,n){return dV(t.writeTree,t.treePath,e,n)}function vb(t,e){return _b(Qe(t.treePath,e),t.writeTree)}function _b(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vV{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;D(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),D(r!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,Eu(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,wu(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,ha(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,Eu(r,e.snapshotNode,i.oldSnap));else throw $a("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _V{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}}const wb=new _V;class i0{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new Oi(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return r0(this.writes_,e,r)}}getChildAfterChild(e,n,r){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Ns(this.viewCache_),s=mV(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wV(t){return{filter:t}}function EV(t,e){D(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),D(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function xV(t,e,n,r,i){const s=new vV;let o,a;if(n.type===qn.OVERWRITE){const u=n;u.source.fromUser?o=Dm(t,e,u.path,u.snap,r,i,s):(D(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!ae(u.path),o=Tf(t,e,u.path,u.snap,r,i,a,s))}else if(n.type===qn.MERGE){const u=n;u.source.fromUser?o=AV(t,e,u.path,u.children,r,i,s):(D(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),o=Om(t,e,u.path,u.children,r,i,a,s))}else if(n.type===qn.ACK_USER_WRITE){const u=n;u.revert?o=CV(t,e,u.path,r,i,s):o=TV(t,e,u.path,u.affectedTree,r,i,s)}else if(n.type===qn.LISTEN_COMPLETE)o=IV(t,e,n.path,r,s);else throw $a("Unknown operation type: "+n.type);const l=s.getChanges();return SV(e,o,l),{viewCache:o,changes:l}}function SV(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=xf(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(fb(xf(e)))}}function Eb(t,e,n,r,i,s){const o=e.eventCache;if(Af(r,n)!=null)return e;{let a,l;if(ae(n))if(D(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const u=Ns(e),h=u instanceof J?u:J.EMPTY_NODE,f=n0(r,h);a=t.filter.updateFullNode(e.eventCache.getNode(),f,s)}else{const u=Sf(r,Ns(e));a=t.filter.updateFullNode(e.eventCache.getNode(),u,s)}else{const u=oe(n);if(u===".priority"){D(Di(n)===1,"Can't have a priority with additional path components");const h=o.getNode();l=e.serverCache.getNode();const f=ME(r,n,h,l);f!=null?a=t.filter.updatePriority(h,f):a=o.getNode()}else{const h=Ne(n);let f;if(o.isCompleteForChild(u)){l=e.serverCache.getNode();const d=ME(r,n,o.getNode(),l);d!=null?f=o.getNode().getImmediateChild(u).updateChild(h,d):f=o.getNode().getImmediateChild(u)}else f=r0(r,u,e.serverCache);f!=null?a=t.filter.updateChild(o.getNode(),u,f,h,i,s):a=o.getNode()}}return Vl(e,a,o.isFullyInitialized()||ae(n),t.filter.filtersNodes())}}function Tf(t,e,n,r,i,s,o,a){const l=e.serverCache;let u;const h=o?t.filter:t.filter.getIndexedFilter();if(ae(n))u=h.updateFullNode(l.getNode(),r,null);else if(h.filtersNodes()&&!l.isFiltered()){const p=l.getNode().updateChild(n,r);u=h.updateFullNode(l.getNode(),p,null)}else{const p=oe(n);if(!l.isCompleteForPath(n)&&Di(n)>1)return e;const g=Ne(n),E=l.getNode().getImmediateChild(p).updateChild(g,r);p===".priority"?u=h.updatePriority(l.getNode(),E):u=h.updateChild(l.getNode(),p,E,g,wb,null)}const f=pb(e,u,l.isFullyInitialized()||ae(n),h.filtersNodes()),d=new i0(i,f,s);return Eb(t,f,n,i,d,a)}function Dm(t,e,n,r,i,s,o){const a=e.eventCache;let l,u;const h=new i0(i,e,s);if(ae(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,o),l=Vl(e,u,!0,t.filter.filtersNodes());else{const f=oe(n);if(f===".priority")u=t.filter.updatePriority(e.eventCache.getNode(),r),l=Vl(e,u,a.isFullyInitialized(),a.isFiltered());else{const d=Ne(n),p=a.getNode().getImmediateChild(f);let g;if(ae(d))g=r;else{const v=h.getCompleteChild(f);v!=null?H_(d)===".priority"&&v.getChild(ib(d)).isEmpty()?g=v:g=v.updateChild(d,r):g=J.EMPTY_NODE}if(p.equals(g))l=e;else{const v=t.filter.updateChild(a.getNode(),f,g,d,h,o);l=Vl(e,v,a.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function VE(t,e){return t.eventCache.isCompleteForChild(e)}function AV(t,e,n,r,i,s,o){let a=e;return r.foreach((l,u)=>{const h=Qe(n,l);VE(e,oe(h))&&(a=Dm(t,a,h,u,i,s,o))}),r.foreach((l,u)=>{const h=Qe(n,l);VE(e,oe(h))||(a=Dm(t,a,h,u,i,s,o))}),a}function LE(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function Om(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,u;ae(n)?u=r:u=new ke(null).setTree(n,r);const h=e.serverCache.getNode();return u.children.inorderTraversal((f,d)=>{if(h.hasChild(f)){const p=e.serverCache.getNode().getImmediateChild(f),g=LE(t,p,d);l=Tf(t,l,new Ie(f),g,i,s,o,a)}}),u.children.inorderTraversal((f,d)=>{const p=!e.serverCache.isCompleteForChild(f)&&d.value===null;if(!h.hasChild(f)&&!p){const g=e.serverCache.getNode().getImmediateChild(f),v=LE(t,g,d);l=Tf(t,l,new Ie(f),v,i,s,o,a)}}),l}function TV(t,e,n,r,i,s,o){if(Af(i,n)!=null)return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(r.value!=null){if(ae(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return Tf(t,e,n,l.getNode().getChild(n),i,s,a,o);if(ae(n)){let u=new ke(null);return l.getNode().forEachChild(cs,(h,f)=>{u=u.set(new Ie(h),f)}),Om(t,e,n,u,i,s,a,o)}else return e}else{let u=new ke(null);return r.foreach((h,f)=>{const d=Qe(n,h);l.isCompleteForPath(d)&&(u=u.set(h,l.getNode().getChild(d)))}),Om(t,e,n,u,i,s,a,o)}}function IV(t,e,n,r,i){const s=e.serverCache,o=pb(e,s.getNode(),s.isFullyInitialized()||ae(n),s.isFiltered());return Eb(t,o,n,r,wb,i)}function CV(t,e,n,r,i,s){let o;if(Af(r,n)!=null)return e;{const a=new i0(r,e,i),l=e.eventCache.getNode();let u;if(ae(n)||oe(n)===".priority"){let h;if(e.serverCache.isFullyInitialized())h=Sf(r,Ns(e));else{const f=e.serverCache.getNode();D(f instanceof J,"serverChildren would be complete if leaf node"),h=n0(r,f)}h=h,u=t.filter.updateFullNode(l,h,s)}else{const h=oe(n);let f=r0(r,h,e.serverCache);f==null&&e.serverCache.isCompleteForChild(h)&&(f=l.getImmediateChild(h)),f!=null?u=t.filter.updateChild(l,h,f,Ne(n),a,s):e.eventCache.getNode().hasChild(h)?u=t.filter.updateChild(l,h,J.EMPTY_NODE,Ne(n),a,s):u=l,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Sf(r,Ns(e)),o.isLeafNode()&&(u=t.filter.updateFullNode(u,o,s)))}return o=e.serverCache.isFullyInitialized()||Af(r,Se())!=null,Vl(e,u,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bV{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new X_(r.getIndex()),s=BM(r);this.processor_=wV(s);const o=n.serverCache,a=n.eventCache,l=i.updateFullNode(J.EMPTY_NODE,o.getNode(),null),u=s.updateFullNode(J.EMPTY_NODE,a.getNode(),null),h=new Oi(l,o.isFullyInitialized(),i.filtersNodes()),f=new Oi(u,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=Ld(f,h),this.eventGenerator_=new ZM(this.query_)}get query(){return this.query_}}function PV(t){return t.viewCache_.serverCache.getNode()}function RV(t){return xf(t.viewCache_)}function kV(t,e){const n=Ns(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!ae(e)&&!n.getImmediateChild(oe(e)).isEmpty())?n.getChild(e):null}function UE(t){return t.eventRegistrations_.length===0}function NV(t,e){t.eventRegistrations_.push(e)}function BE(t,e,n){const r=[];if(n){D(e==null,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(s=>{const o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){const o=t.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function zE(t,e,n,r){e.type===qn.MERGE&&e.source.queryId!==null&&(D(Ns(t.viewCache_),"We should always have a full cache before handling merges"),D(xf(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,s=xV(t.processor_,i,e,n,r);return EV(t.processor_,s.viewCache),D(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,xb(t,s.changes,s.viewCache.eventCache.getNode(),null)}function DV(t,e){const n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(ze,(s,o)=>{r.push(ha(s,o))}),n.isFullyInitialized()&&r.push(fb(n.getNode())),xb(t,r,n.getNode(),e)}function xb(t,e,n,r){const i=r?[r]:t.eventRegistrations_;return eV(t.eventGenerator_,e,n,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let If;class Sb{constructor(){this.views=new Map}}function OV(t){D(!If,"__referenceConstructor has already been defined"),If=t}function jV(){return D(If,"Reference.ts has not been loaded"),If}function $V(t){return t.views.size===0}function s0(t,e,n,r){const i=e.source.queryId;if(i!==null){const s=t.views.get(i);return D(s!=null,"SyncTree gave us an op for an invalid query."),zE(s,e,n,r)}else{let s=[];for(const o of t.views.values())s=s.concat(zE(o,e,n,r));return s}}function Ab(t,e,n,r,i){const s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=Sf(n,i?r:null),l=!1;a?l=!0:r instanceof J?(a=n0(n,r),l=!1):(a=J.EMPTY_NODE,l=!1);const u=Ld(new Oi(a,l,!1),new Oi(r,i,!1));return new bV(e,u)}return o}function FV(t,e,n,r,i,s){const o=Ab(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),NV(o,n),DV(o,n)}function MV(t,e,n,r){const i=e._queryIdentifier,s=[];let o=[];const a=ji(t);if(i==="default")for(const[l,u]of t.views.entries())o=o.concat(BE(u,n,r)),UE(u)&&(t.views.delete(l),u.query._queryParams.loadsAllData()||s.push(u.query));else{const l=t.views.get(i);l&&(o=o.concat(BE(l,n,r)),UE(l)&&(t.views.delete(i),l.query._queryParams.loadsAllData()||s.push(l.query)))}return a&&!ji(t)&&s.push(new(jV())(e._repo,e._path)),{removed:s,events:o}}function Tb(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Ii(t,e){let n=null;for(const r of t.views.values())n=n||kV(r,e);return n}function Ib(t,e){if(e._queryParams.loadsAllData())return Bd(t);{const r=e._queryIdentifier;return t.views.get(r)}}function Cb(t,e){return Ib(t,e)!=null}function ji(t){return Bd(t)!=null}function Bd(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cf;function VV(t){D(!Cf,"__referenceConstructor has already been defined"),Cf=t}function LV(){return D(Cf,"Reference.ts has not been loaded"),Cf}let UV=1;class WE{constructor(e){this.listenProvider_=e,this.syncPointTree_=new ke(null),this.pendingWriteTree_=gV(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function bb(t,e,n,r,i){return iV(t.pendingWriteTree_,e,n,r,i),i?Ma(t,new ks(Z_(),e,n)):[]}function BV(t,e,n,r){sV(t.pendingWriteTree_,e,n,r);const i=ke.fromObject(n);return Ma(t,new fa(Z_(),e,i))}function li(t,e,n=!1){const r=oV(t.pendingWriteTree_,e);if(aV(t.pendingWriteTree_,e)){let s=new ke(null);return r.snap!=null?s=s.set(Se(),!0):jt(r.children,o=>{s=s.set(new Ie(o),!0)}),Ma(t,new Ef(r.path,s,n))}else return[]}function Ju(t,e,n){return Ma(t,new ks(e0(),e,n))}function zV(t,e,n){const r=ke.fromObject(n);return Ma(t,new fa(e0(),e,r))}function WV(t,e){return Ma(t,new Su(e0(),e))}function GV(t,e,n){const r=a0(t,n);if(r){const i=l0(r),s=i.path,o=i.queryId,a=Xt(s,e),l=new Su(t0(o),a);return u0(t,s,l)}else return[]}function bf(t,e,n,r,i=!1){const s=e._path,o=t.syncPointTree_.get(s);let a=[];if(o&&(e._queryIdentifier==="default"||Cb(o,e))){const l=MV(o,e,n,r);$V(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));const u=l.removed;if(a=l.events,!i){const h=u.findIndex(d=>d._queryParams.loadsAllData())!==-1,f=t.syncPointTree_.findOnPath(s,(d,p)=>ji(p));if(h&&!f){const d=t.syncPointTree_.subtree(s);if(!d.isEmpty()){const p=KV(d);for(let g=0;g<p.length;++g){const v=p[g],E=v.query,m=Nb(t,v);t.listenProvider_.startListening(Ul(E),Au(t,E),m.hashFn,m.onComplete)}}}!f&&u.length>0&&!r&&(h?t.listenProvider_.stopListening(Ul(e),null):u.forEach(d=>{const p=t.queryToTagMap.get(zd(d));t.listenProvider_.stopListening(Ul(d),p)}))}QV(t,u)}return a}function Pb(t,e,n,r){const i=a0(t,r);if(i!=null){const s=l0(i),o=s.path,a=s.queryId,l=Xt(o,e),u=new ks(t0(a),l,n);return u0(t,o,u)}else return[]}function HV(t,e,n,r){const i=a0(t,r);if(i){const s=l0(i),o=s.path,a=s.queryId,l=Xt(o,e),u=ke.fromObject(n),h=new fa(t0(a),l,u);return u0(t,o,h)}else return[]}function jm(t,e,n,r=!1){const i=e._path;let s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(d,p)=>{const g=Xt(d,i);s=s||Ii(p,g),o=o||ji(p)});let a=t.syncPointTree_.get(i);a?(o=o||ji(a),s=s||Ii(a,Se())):(a=new Sb,t.syncPointTree_=t.syncPointTree_.set(i,a));let l;s!=null?l=!0:(l=!1,s=J.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((p,g)=>{const v=Ii(g,Se());v&&(s=s.updateImmediateChild(p,v))}));const u=Cb(a,e);if(!u&&!e._queryParams.loadsAllData()){const d=zd(e);D(!t.queryToTagMap.has(d),"View does not exist, but we have a tag");const p=YV();t.queryToTagMap.set(d,p),t.tagToQueryMap.set(p,d)}const h=Ud(t.pendingWriteTree_,i);let f=FV(a,e,n,h,s,l);if(!u&&!o&&!r){const d=Ib(a,e);f=f.concat(XV(t,e,d))}return f}function o0(t,e,n){const i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{const l=Xt(o,e),u=Ii(a,l);if(u)return u});return mb(i,e,s,n,!0)}function qV(t,e){const n=e._path;let r=null;t.syncPointTree_.foreachOnPath(n,(u,h)=>{const f=Xt(u,n);r=r||Ii(h,f)});let i=t.syncPointTree_.get(n);i?r=r||Ii(i,Se()):(i=new Sb,t.syncPointTree_=t.syncPointTree_.set(n,i));const s=r!=null,o=s?new Oi(r,!0,!1):null,a=Ud(t.pendingWriteTree_,e._path),l=Ab(i,e,a,s?o.getNode():J.EMPTY_NODE,s);return RV(l)}function Ma(t,e){return Rb(e,t.syncPointTree_,null,Ud(t.pendingWriteTree_,Se()))}function Rb(t,e,n,r){if(ae(t.path))return kb(t,e,n,r);{const i=e.get(Se());n==null&&i!=null&&(n=Ii(i,Se()));let s=[];const o=oe(t.path),a=t.operationForChild(o),l=e.children.get(o);if(l&&a){const u=n?n.getImmediateChild(o):null,h=vb(r,o);s=s.concat(Rb(a,l,u,h))}return i&&(s=s.concat(s0(i,t,r,n))),s}}function kb(t,e,n,r){const i=e.get(Se());n==null&&i!=null&&(n=Ii(i,Se()));let s=[];return e.children.inorderTraversal((o,a)=>{const l=n?n.getImmediateChild(o):null,u=vb(r,o),h=t.operationForChild(o);h&&(s=s.concat(kb(h,a,l,u)))}),i&&(s=s.concat(s0(i,t,r,n))),s}function Nb(t,e){const n=e.query,r=Au(t,n);return{hashFn:()=>(PV(e)||J.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?GV(t,n._path,r):WV(t,n._path);{const s=BF(i,n);return bf(t,n,null,s)}}}}function Au(t,e){const n=zd(e);return t.queryToTagMap.get(n)}function zd(t){return t._path.toString()+"$"+t._queryIdentifier}function a0(t,e){return t.tagToQueryMap.get(e)}function l0(t){const e=t.indexOf("$");return D(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Ie(t.substr(0,e))}}function u0(t,e,n){const r=t.syncPointTree_.get(e);D(r,"Missing sync point for query tag that we're tracking");const i=Ud(t.pendingWriteTree_,e);return s0(r,n,i,null)}function KV(t){return t.fold((e,n,r)=>{if(n&&ji(n))return[Bd(n)];{let i=[];return n&&(i=Tb(n)),jt(r,(s,o)=>{i=i.concat(o)}),i}})}function Ul(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(LV())(t._repo,t._path):t}function QV(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const i=zd(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}function YV(){return UV++}function XV(t,e,n){const r=e._path,i=Au(t,e),s=Nb(t,n),o=t.listenProvider_.startListening(Ul(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)D(!ji(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((u,h,f)=>{if(!ae(u)&&h&&ji(h))return[Bd(h).query];{let d=[];return h&&(d=d.concat(Tb(h).map(p=>p.query))),jt(f,(p,g)=>{d=d.concat(g)}),d}});for(let u=0;u<l.length;++u){const h=l[u];t.listenProvider_.stopListening(Ul(h),Au(t,h))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c0{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new c0(n)}node(){return this.node_}}class h0{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Qe(this.path_,e);return new h0(this.syncTree_,n)}node(){return o0(this.syncTree_,this.path_)}}const JV=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},GE=function(t,e,n){if(!t||typeof t!="object")return t;if(D(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return ZV(t[".sv"],e,n);if(typeof t[".sv"]=="object")return eL(t[".sv"],e);D(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},ZV=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:D(!1,"Unexpected server value: "+t)}},eL=function(t,e,n){t.hasOwnProperty("increment")||D(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;typeof r!="number"&&D(!1,"Unexpected increment value: "+r);const i=e.node();if(D(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return typeof o!="number"?r:o+r},Db=function(t,e,n,r){return f0(e,new h0(n,t),r)},Ob=function(t,e,n){return f0(t,new c0(e),n)};function f0(t,e,n){const r=t.getPriority().val(),i=GE(r,e.getImmediateChild(".priority"),n);let s;if(t.isLeafNode()){const o=t,a=GE(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new vt(a,lt(i)):t}else{const o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new vt(i))),o.forEachChild(ze,(a,l)=>{const u=f0(l,e.getImmediateChild(a),n);u!==l&&(s=s.updateImmediateChild(a,u))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d0{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}}function p0(t,e){let n=e instanceof Ie?e:new Ie(e),r=t,i=oe(n);for(;i!==null;){const s=ua(r.node.children,i)||{children:{},childCount:0};r=new d0(i,r,s),n=Ne(n),i=oe(n)}return r}function Va(t){return t.node.value}function jb(t,e){t.node.value=e,$m(t)}function $b(t){return t.node.childCount>0}function tL(t){return Va(t)===void 0&&!$b(t)}function Wd(t,e){jt(t.node.children,(n,r)=>{e(new d0(n,t,r))})}function Fb(t,e,n,r){n&&!r&&e(t),Wd(t,i=>{Fb(i,e,!0,r)}),n&&r&&e(t)}function nL(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Zu(t){return new Ie(t.parent===null?t.name:Zu(t.parent)+"/"+t.name)}function $m(t){t.parent!==null&&rL(t.parent,t.name,t)}function rL(t,e,n){const r=tL(n),i=Sr(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,$m(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,$m(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iL=/[\[\].#$\/\u0000-\u001F\u007F]/,sL=/[\[\].#$\u0000-\u001F\u007F]/,Sy=10*1024*1024,Gd=function(t){return typeof t=="string"&&t.length!==0&&!iL.test(t)},Mb=function(t){return typeof t=="string"&&t.length!==0&&!sL.test(t)},oL=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Mb(t)},Fm=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!U_(t)||t&&typeof t=="object"&&Sr(t,".sv")},ec=function(t,e,n,r){r&&e===void 0||Hd(Ku(t,"value"),e,n)},Hd=function(t,e,n){const r=n instanceof Ie?new xM(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Yi(r));if(typeof e=="function")throw new Error(t+"contains a function "+Yi(r)+" with contents = "+e.toString());if(U_(e))throw new Error(t+"contains "+e.toString()+" "+Yi(r));if(typeof e=="string"&&e.length>Sy/3&&Md(e)>Sy)throw new Error(t+"contains a string greater than "+Sy+" utf8 bytes "+Yi(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(jt(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!Gd(o)))throw new Error(t+" contains an invalid key ("+o+") "+Yi(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);SM(r,o),Hd(t,a,r),AM(r)}),i&&s)throw new Error(t+' contains ".value" child '+Yi(r)+" in addition to actual children.")}},aL=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];const s=_u(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!Gd(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(EM);let i=null;for(n=0;n<e.length;n++){if(r=e[n],i!==null&&kn(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},lL=function(t,e,n,r){if(r&&e===void 0)return;const i=Ku(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const s=[];jt(e,(o,a)=>{const l=new Ie(o);if(Hd(i,a,Qe(n,l)),H_(l)===".priority"&&!Fm(a))throw new Error(i+"contains an invalid value for '"+l.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(l)}),aL(i,s)},uL=function(t,e,n,r){if(!(r&&n===void 0)&&!Gd(n))throw new Error(Ku(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},y0=function(t,e,n,r){if(!(r&&n===void 0)&&!Mb(n))throw new Error(Ku(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},cL=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),y0(t,e,n,r)},Vb=function(t,e){if(oe(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},hL=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Gd(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!oL(n))throw new Error(Ku(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fL{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function qd(t,e){let n=null;for(let r=0;r<e.length;r++){const i=e[r],s=i.getPath();n!==null&&!q_(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function Lb(t,e,n){qd(t,n),Ub(t,r=>q_(r,e))}function $n(t,e,n){qd(t,n),Ub(t,r=>kn(r,e)||kn(e,r))}function Ub(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const i=t.eventLists_[r];if(i){const s=i.path;e(s)?(dL(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function dL(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const r=n.getEventRunner();us&&Ct("event: "+n.toString()),Fa(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pL="repo_interrupt",yL=25;class gL{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new fL,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=wf(),this.transactionQueueTree_=new d0,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function mL(t,e,n){if(t.stats_=W_(t.repoInfo_),t.forceRestClient_||HF())t.server_=new _f(t.repoInfo_,(r,i,s,o)=>{HE(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>qE(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{ut(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new jr(t.repoInfo_,e,(r,i,s,o)=>{HE(t,r,i,s,o)},r=>{qE(t,r)},r=>{vL(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=XF(t.repoInfo_,()=>new JM(t.stats_,t.server_)),t.infoData_=new qM,t.infoSyncTree_=new WE({startListening:(r,i,s,o)=>{let a=[];const l=t.infoData_.getNode(r._path);return l.isEmpty()||(a=Ju(t.infoSyncTree_,r._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),g0(t,"connected",!1),t.serverSyncTree_=new WE({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,l)=>{const u=o(a,l);$n(t.eventQueue_,r._path,u)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function Bb(t){const n=t.infoData_.getNode(new Ie(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Kd(t){return JV({timestamp:Bb(t)})}function HE(t,e,n,r,i){t.dataUpdateCount++;const s=new Ie(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){const l=pf(n,u=>lt(u));o=HV(t.serverSyncTree_,s,l,i)}else{const l=lt(n);o=Pb(t.serverSyncTree_,s,l,i)}else if(r){const l=pf(n,u=>lt(u));o=zV(t.serverSyncTree_,s,l)}else{const l=lt(n);o=Ju(t.serverSyncTree_,s,l)}let a=s;o.length>0&&(a=pa(t,s)),$n(t.eventQueue_,a,o)}function qE(t,e){g0(t,"connected",e),e===!1&&xL(t)}function vL(t,e){jt(e,(n,r)=>{g0(t,n,r)})}function g0(t,e,n){const r=new Ie("/.info/"+e),i=lt(n);t.infoData_.updateSnapshot(r,i);const s=Ju(t.infoSyncTree_,r,i);$n(t.eventQueue_,r,s)}function m0(t){return t.nextWriteId_++}function _L(t,e,n){const r=qV(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(i=>{const s=lt(i).withIndex(e._queryParams.getIndex());jm(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=Ju(t.serverSyncTree_,e._path,s);else{const a=Au(t.serverSyncTree_,e);o=Pb(t.serverSyncTree_,e._path,s,a)}return $n(t.eventQueue_,e._path,o),bf(t.serverSyncTree_,e,n,null,!0),s},i=>(tc(t,"get for query "+ut(e)+" failed: "+i),Promise.reject(new Error(i))))}function wL(t,e,n,r,i){tc(t,"set",{path:e.toString(),value:n,priority:r});const s=Kd(t),o=lt(n,r),a=o0(t.serverSyncTree_,e),l=Ob(o,a,s),u=m0(t),h=bb(t.serverSyncTree_,e,l,u,!0);qd(t.eventQueue_,h),t.server_.put(e.toString(),o.val(!0),(d,p)=>{const g=d==="ok";g||en("set at "+e+" failed: "+d);const v=li(t.serverSyncTree_,u,!g);$n(t.eventQueue_,e,v),Mm(t,i,d,p)});const f=_0(t,e);pa(t,f),$n(t.eventQueue_,f,[])}function EL(t,e,n,r){tc(t,"update",{path:e.toString(),value:n});let i=!0;const s=Kd(t),o={};if(jt(n,(a,l)=>{i=!1,o[a]=Db(Qe(e,a),lt(l),t.serverSyncTree_,s)}),i)Ct("update() called with empty data.  Don't do anything."),Mm(t,r,"ok",void 0);else{const a=m0(t),l=BV(t.serverSyncTree_,e,o,a);qd(t.eventQueue_,l),t.server_.merge(e.toString(),n,(u,h)=>{const f=u==="ok";f||en("update at "+e+" failed: "+u);const d=li(t.serverSyncTree_,a,!f),p=d.length>0?pa(t,e):e;$n(t.eventQueue_,p,d),Mm(t,r,u,h)}),jt(n,u=>{const h=_0(t,Qe(e,u));pa(t,h)}),$n(t.eventQueue_,e,[])}}function xL(t){tc(t,"onDisconnectEvents");const e=Kd(t),n=wf();Pm(t.onDisconnect_,Se(),(i,s)=>{const o=Db(i,s,t.serverSyncTree_,e);db(n,i,o)});let r=[];Pm(n,Se(),(i,s)=>{r=r.concat(Ju(t.serverSyncTree_,i,s));const o=_0(t,i);pa(t,o)}),t.onDisconnect_=wf(),$n(t.eventQueue_,Se(),r)}function SL(t,e,n){let r;oe(e._path)===".info"?r=jm(t.infoSyncTree_,e,n):r=jm(t.serverSyncTree_,e,n),Lb(t.eventQueue_,e._path,r)}function KE(t,e,n){let r;oe(e._path)===".info"?r=bf(t.infoSyncTree_,e,n):r=bf(t.serverSyncTree_,e,n),Lb(t.eventQueue_,e._path,r)}function AL(t){t.persistentConnection_&&t.persistentConnection_.interrupt(pL)}function tc(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Ct(n,...e)}function Mm(t,e,n,r){e&&Fa(()=>{if(n==="ok")e(null);else{const i=(n||"error").toUpperCase();let s=i;r&&(s+=": "+r);const o=new Error(s);o.code=i,e(o)}})}function zb(t,e,n){return o0(t.serverSyncTree_,e,n)||J.EMPTY_NODE}function v0(t,e=t.transactionQueueTree_){if(e||Qd(t,e),Va(e)){const n=Gb(t,e);D(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&TL(t,Zu(e),n)}else $b(e)&&Wd(e,n=>{v0(t,n)})}function TL(t,e,n){const r=n.map(u=>u.currentWriteId),i=zb(t,e,r);let s=i;const o=i.hash();for(let u=0;u<n.length;u++){const h=n[u];D(h.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;const f=Xt(e,h.path);s=s.updateChild(f,h.currentOutputSnapshotRaw)}const a=s.val(!0),l=e;t.server_.put(l.toString(),a,u=>{tc(t,"transaction put response",{path:l.toString(),status:u});let h=[];if(u==="ok"){const f=[];for(let d=0;d<n.length;d++)n[d].status=2,h=h.concat(li(t.serverSyncTree_,n[d].currentWriteId)),n[d].onComplete&&f.push(()=>n[d].onComplete(null,!0,n[d].currentOutputSnapshotResolved)),n[d].unwatcher();Qd(t,p0(t.transactionQueueTree_,e)),v0(t,t.transactionQueueTree_),$n(t.eventQueue_,e,h);for(let d=0;d<f.length;d++)Fa(f[d])}else{if(u==="datastale")for(let f=0;f<n.length;f++)n[f].status===3?n[f].status=4:n[f].status=0;else{en("transaction at "+l.toString()+" failed: "+u);for(let f=0;f<n.length;f++)n[f].status=4,n[f].abortReason=u}pa(t,e)}},o)}function pa(t,e){const n=Wb(t,e),r=Zu(n),i=Gb(t,n);return IL(t,i,r),r}function IL(t,e,n){if(e.length===0)return;const r=[];let i=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],u=Xt(n,l.path);let h=!1,f;if(D(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)h=!0,f=l.abortReason,i=i.concat(li(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=yL)h=!0,f="maxretry",i=i.concat(li(t.serverSyncTree_,l.currentWriteId,!0));else{const d=zb(t,l.path,o);l.currentInputSnapshot=d;const p=e[a].update(d.val());if(p!==void 0){Hd("transaction failed: Data returned ",p,l.path);let g=lt(p);typeof p=="object"&&p!=null&&Sr(p,".priority")||(g=g.updatePriority(d.getPriority()));const E=l.currentWriteId,m=Kd(t),y=Ob(g,d,m);l.currentOutputSnapshotRaw=g,l.currentOutputSnapshotResolved=y,l.currentWriteId=m0(t),o.splice(o.indexOf(E),1),i=i.concat(bb(t.serverSyncTree_,l.path,y,l.currentWriteId,l.applyLocally)),i=i.concat(li(t.serverSyncTree_,E,!0))}else h=!0,f="nodata",i=i.concat(li(t.serverSyncTree_,l.currentWriteId,!0))}$n(t.eventQueue_,n,i),i=[],h&&(e[a].status=2,function(d){setTimeout(d,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(f==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(f),!1,null))))}Qd(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)Fa(r[a]);v0(t,t.transactionQueueTree_)}function Wb(t,e){let n,r=t.transactionQueueTree_;for(n=oe(e);n!==null&&Va(r)===void 0;)r=p0(r,n),e=Ne(e),n=oe(e);return r}function Gb(t,e){const n=[];return Hb(t,e,n),n.sort((r,i)=>r.order-i.order),n}function Hb(t,e,n){const r=Va(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);Wd(e,i=>{Hb(t,i,n)})}function Qd(t,e){const n=Va(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,jb(e,n.length>0?n:void 0)}Wd(e,r=>{Qd(t,r)})}function _0(t,e){const n=Zu(Wb(t,e)),r=p0(t.transactionQueueTree_,e);return nL(r,i=>{Ay(t,i)}),Ay(t,r),Fb(r,i=>{Ay(t,i)}),n}function Ay(t,e){const n=Va(e);if(n){const r=[];let i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(D(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(D(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(li(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?jb(e,void 0):n.length=s+1,$n(t.eventQueue_,Zu(e),i);for(let o=0;o<r.length;o++)Fa(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CL(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function bL(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):en(`Invalid query segment '${n}' in query '${t}'`)}return e}const QE=function(t,e){const n=PL(t),r=n.namespace;n.domain==="firebase.com"&&Br(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Br("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||FF();const i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new QC(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new Ie(n.pathString)}},PL=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",l=443;if(typeof t=="string"){let u=t.indexOf("//");u>=0&&(a=t.substring(0,u-1),t=t.substring(u+2));let h=t.indexOf("/");h===-1&&(h=t.length);let f=t.indexOf("?");f===-1&&(f=t.length),e=t.substring(0,Math.min(h,f)),h<f&&(i=CL(t.substring(h,f)));const d=bL(t.substring(Math.min(t.length,f)));u=e.indexOf(":"),u>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(u+1),10)):u=e.length;const p=e.slice(0,u);if(p.toLowerCase()==="localhost")n="localhost";else if(p.split(".").length<=2)n=p;else{const g=e.indexOf(".");r=e.substring(0,g).toLowerCase(),n=e.substring(g+1),s=r}"ns"in d&&(s=d.ns)}return{host:e,port:l,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YE="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",RL=function(){let t=0;const e=[];return function(n){const r=n===t;t=n;let i;const s=new Array(8);for(i=7;i>=0;i--)s[i]=YE.charAt(n%64),n=Math.floor(n/64);D(n===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=YE.charAt(e[i]);return D(o.length===20,"nextPushId: Length should be 20."),o}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qb{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+ut(this.snapshot.exportVal())}}class Kb{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qb{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return D(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return ae(this._path)?null:H_(this._path)}get ref(){return new Ar(this._repo,this._path)}get _queryIdentifier(){const e=OE(this._queryParams),n=B_(e);return n==="{}"?"default":n}get _queryObject(){return OE(this._queryParams)}isEqual(e){if(e=Ot(e),!(e instanceof zs))return!1;const n=this._repo===e._repo,r=q_(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+wM(this._path)}}function kL(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function w0(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===cs){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==Rs)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==Ni)throw new Error(r);if(typeof n!="string")throw new Error(i)}}else if(t.getIndex()===ze){if(e!=null&&!Fm(e)||n!=null&&!Fm(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(D(t.getIndex()instanceof Y_||t.getIndex()===hb,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Yb(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Ar extends zs{constructor(e,n){super(e,n,new J_,!1)}get parent(){const e=ib(this._path);return e===null?null:new Ar(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class ya{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new Ie(e),r=ga(this.ref,e);return new ya(this._node.getChild(n),r,ze)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new ya(i,ga(this.ref,r),ze)))}hasChild(e){const n=new Ie(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function xl(t,e){return t=Ot(t),t._checkNotDeleted("ref"),e!==void 0?ga(t._root,e):t._root}function ga(t,e){return t=Ot(t),oe(t._path)===null?cL("child","path",e,!1):y0("child","path",e,!1),new Ar(t._repo,Qe(t._path,e))}function Xb(t,e){t=Ot(t),Vb("push",t._path),ec("push",e,t._path,!0);const n=Bb(t._repo),r=RL(n),i=ga(t,r),s=ga(t,r);let o;return e!=null?o=E0(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function E0(t,e){t=Ot(t),Vb("set",t._path),ec("set",e,t._path,!1);const n=new qu;return wL(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function Jb(t,e){lL("update",e,t._path,!1);const n=new qu;return EL(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function Zb(t){t=Ot(t);const e=new Qb(()=>{}),n=new Yd(e);return _L(t._repo,t,n).then(r=>new ya(r,new Ar(t._repo,t._path),t._queryParams.getIndex()))}class Yd{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const r=n._queryParams.getIndex();return new qb("value",this,new ya(e.snapshotNode,new Ar(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Kb(this,e,n):null}matches(e){return e instanceof Yd?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class x0{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Kb(this,e,n):null}createEvent(e,n){D(e.childName!=null,"Child events should have a childName.");const r=ga(new Ar(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new qb(e.type,this,new ya(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof x0?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function NL(t,e,n,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){const l=n,u=(h,f)=>{KE(t._repo,t,a),l(h,f)};u.userCallback=n.userCallback,u.context=n.context,n=u}const o=new Qb(n,s||void 0),a=e==="value"?new Yd(o):new x0(e,o);return SL(t._repo,t,a),()=>KE(t._repo,t,a)}function DL(t,e,n,r){return NL(t,"value",e,n,r)}class nc{}class OL extends nc{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){ec("endAt",this._value,e._path,!0);const n=GM(e._queryParams,this._value,this._key);if(Yb(n),w0(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new zs(e._repo,e._path,n,e._orderByCalled)}}class jL extends nc{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){ec("startAt",this._value,e._path,!0);const n=WM(e._queryParams,this._value,this._key);if(Yb(n),w0(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new zs(e._repo,e._path,n,e._orderByCalled)}}class $L extends nc{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new zs(e._repo,e._path,zM(e._queryParams,this._limit),e._orderByCalled)}}function FL(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new $L(t)}class ML extends nc{constructor(e){super(),this._path=e}_apply(e){kL(e,"orderByChild");const n=new Ie(this._path);if(ae(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new Y_(n),i=HM(e._queryParams,r);return w0(i),new zs(e._repo,e._path,i,!0)}}function VL(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return y0("orderByChild","path",t,!1),new ML(t)}class LL extends nc{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){if(ec("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new OL(this._value,this._key)._apply(new jL(this._value,this._key)._apply(e))}}function UL(t,e){return uL("equalTo","key",e,!0),new LL(t,e)}function BL(t,...e){let n=Ot(t);for(const r of e)n=r._apply(n);return n}OV(Ar);VV(Ar);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zL="FIREBASE_DATABASE_EMULATOR_HOST",Vm={};let WL=!1;function GL(t,e,n,r){t.repoInfo_=new QC(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function HL(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||Br("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Ct("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=QE(s,i),a=o.repoInfo,l,u;typeof process<"u"&&process.env&&(u=process.env[zL]),u?(l=!0,s=`http://${u}?ns=${a.namespace}`,o=QE(s,i),a=o.repoInfo):l=!o.repoInfo.secure;const h=i&&l?new zo(zo.OWNER):new KF(t.name,t.options,e);hL("Invalid Firebase Database URL",o),ae(o.path)||Br("Database URL must point to the root of a Firebase Database (not including a child path).");const f=KL(a,t,h,new qF(t.name,n));return new QL(f,t)}function qL(t,e){const n=Vm[e];(!n||n[t.key]!==t)&&Br(`Database ${e}(${t.repoInfo_}) has already been deleted.`),AL(t),delete n[t.key]}function KL(t,e,n,r){let i=Vm[e.name];i||(i={},Vm[e.name]=i);let s=i[t.toURLString()];return s&&Br("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new gL(t,WL,n,r),i[t.toURLString()]=s,s}class QL{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(mL(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Ar(this._repo,Se())),this._rootInternal}_delete(){return this._rootInternal!==null&&(qL(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Br("Cannot call "+e+" on a deleted database.")}}function YL(t=L_(),e){const n=M_(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const r=O_("database");r&&eP(n,...r)}return n}function eP(t,e,n,r={}){t=Ot(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Br("Cannot call useEmulator() after instance has already been initialized.");const i=t._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Br('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new zo(zo.OWNER);else if(r.mockUserToken){const o=typeof r.mockUserToken=="string"?r.mockUserToken:j_(r.mockUserToken,t.app.options.projectId);s=new zo(o)}GL(i,e,n,s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XL(t){NF(V_),ca(new bs("database",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return HL(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),mr(mE,vE,t),mr(mE,vE,"esm2017")}jr.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};jr.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};XL();var XE=Object.prototype.toString,tP=function(e){var n=XE.call(e),r=n==="[object Arguments]";return r||(r=n!=="[object Array]"&&e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&XE.call(e.callee)==="[object Function]"),r},Ty,JE;function JL(){if(JE)return Ty;JE=1;var t;if(!Object.keys){var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,r=tP,i=Object.prototype.propertyIsEnumerable,s=!i.call({toString:null},"toString"),o=i.call(function(){},"prototype"),a=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],l=function(d){var p=d.constructor;return p&&p.prototype===d},u={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},h=function(){if(typeof window>"u")return!1;for(var d in window)try{if(!u["$"+d]&&e.call(window,d)&&window[d]!==null&&typeof window[d]=="object")try{l(window[d])}catch{return!0}}catch{return!0}return!1}(),f=function(d){if(typeof window>"u"||!h)return l(d);try{return l(d)}catch{return!1}};t=function(p){var g=p!==null&&typeof p=="object",v=n.call(p)==="[object Function]",E=r(p),m=g&&n.call(p)==="[object String]",y=[];if(!g&&!v&&!E)throw new TypeError("Object.keys called on a non-object");var _=o&&v;if(m&&p.length>0&&!e.call(p,0))for(var S=0;S<p.length;++S)y.push(String(S));if(E&&p.length>0)for(var A=0;A<p.length;++A)y.push(String(A));else for(var T in p)!(_&&T==="prototype")&&e.call(p,T)&&y.push(String(T));if(s)for(var I=f(p),b=0;b<a.length;++b)!(I&&a[b]==="constructor")&&e.call(p,a[b])&&y.push(a[b]);return y}}return Ty=t,Ty}var ZL=Array.prototype.slice,e4=tP,ZE=Object.keys,Ih=ZE?function(e){return ZE(e)}:JL(),ex=Object.keys;Ih.shim=function(){if(Object.keys){var e=function(){var n=Object.keys(arguments);return n&&n.length===arguments.length}(1,2);e||(Object.keys=function(r){return e4(r)?ex(ZL.call(r)):ex(r)})}else Object.keys=Ih;return Object.keys||Ih};var Xd=Ih,Jd=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},n=Symbol("test"),r=Object(n);if(typeof n=="string"||Object.prototype.toString.call(n)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var i=42;e[n]=i;for(n in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var s=Object.getOwnPropertySymbols(e);if(s.length!==1||s[0]!==n||!Object.prototype.propertyIsEnumerable.call(e,n))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,n);if(o.value!==i||o.enumerable!==!0)return!1}return!0},tx=typeof Symbol<"u"&&Symbol,t4=Jd,Bi=function(){return typeof tx!="function"||typeof Symbol!="function"||typeof tx("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:t4()},n4="Function.prototype.bind called on incompatible ",Iy=Array.prototype.slice,r4=Object.prototype.toString,i4="[object Function]",s4=function(e){var n=this;if(typeof n!="function"||r4.call(n)!==i4)throw new TypeError(n4+n);for(var r=Iy.call(arguments,1),i,s=function(){if(this instanceof i){var h=n.apply(this,r.concat(Iy.call(arguments)));return Object(h)===h?h:this}else return n.apply(e,r.concat(Iy.call(arguments)))},o=Math.max(0,n.length-r.length),a=[],l=0;l<o;l++)a.push("$"+l);if(i=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(s),n.prototype){var u=function(){};u.prototype=n.prototype,i.prototype=new u,u.prototype=null}return i},o4=s4,S0=Function.prototype.bind||o4,a4=S0,A0=a4.call(Function.call,Object.prototype.hasOwnProperty),_e,ma=SyntaxError,nP=Function,Wo=TypeError,Cy=function(t){try{return nP('"use strict"; return ('+t+").constructor;")()}catch{}},hs=Object.getOwnPropertyDescriptor;if(hs)try{hs({},"")}catch{hs=null}var by=function(){throw new Wo},l4=hs?function(){try{return arguments.callee,by}catch{try{return hs(arguments,"callee").get}catch{return by}}}():by,Ys=Bi(),ei=Object.getPrototypeOf||function(t){return t.__proto__},oo={},u4=typeof Uint8Array>"u"?_e:ei(Uint8Array),Go={"%AggregateError%":typeof AggregateError>"u"?_e:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?_e:ArrayBuffer,"%ArrayIteratorPrototype%":Ys?ei([][Symbol.iterator]()):_e,"%AsyncFromSyncIteratorPrototype%":_e,"%AsyncFunction%":oo,"%AsyncGenerator%":oo,"%AsyncGeneratorFunction%":oo,"%AsyncIteratorPrototype%":oo,"%Atomics%":typeof Atomics>"u"?_e:Atomics,"%BigInt%":typeof BigInt>"u"?_e:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?_e:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?_e:Float32Array,"%Float64Array%":typeof Float64Array>"u"?_e:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?_e:FinalizationRegistry,"%Function%":nP,"%GeneratorFunction%":oo,"%Int8Array%":typeof Int8Array>"u"?_e:Int8Array,"%Int16Array%":typeof Int16Array>"u"?_e:Int16Array,"%Int32Array%":typeof Int32Array>"u"?_e:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Ys?ei(ei([][Symbol.iterator]())):_e,"%JSON%":typeof JSON=="object"?JSON:_e,"%Map%":typeof Map>"u"?_e:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Ys?_e:ei(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?_e:Promise,"%Proxy%":typeof Proxy>"u"?_e:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?_e:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?_e:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Ys?_e:ei(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?_e:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Ys?ei(""[Symbol.iterator]()):_e,"%Symbol%":Ys?Symbol:_e,"%SyntaxError%":ma,"%ThrowTypeError%":l4,"%TypedArray%":u4,"%TypeError%":Wo,"%Uint8Array%":typeof Uint8Array>"u"?_e:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?_e:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?_e:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?_e:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?_e:WeakMap,"%WeakRef%":typeof WeakRef>"u"?_e:WeakRef,"%WeakSet%":typeof WeakSet>"u"?_e:WeakSet},c4=function t(e){var n;if(e==="%AsyncFunction%")n=Cy("async function () {}");else if(e==="%GeneratorFunction%")n=Cy("function* () {}");else if(e==="%AsyncGeneratorFunction%")n=Cy("async function* () {}");else if(e==="%AsyncGenerator%"){var r=t("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if(e==="%AsyncIteratorPrototype%"){var i=t("%AsyncGenerator%");i&&(n=ei(i.prototype))}return Go[e]=n,n},nx={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},rc=S0,Pf=A0,h4=rc.call(Function.call,Array.prototype.concat),f4=rc.call(Function.apply,Array.prototype.splice),rx=rc.call(Function.call,String.prototype.replace),Rf=rc.call(Function.call,String.prototype.slice),d4=rc.call(Function.call,RegExp.prototype.exec),p4=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,y4=/\\(\\)?/g,g4=function(e){var n=Rf(e,0,1),r=Rf(e,-1);if(n==="%"&&r!=="%")throw new ma("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&n!=="%")throw new ma("invalid intrinsic syntax, expected opening `%`");var i=[];return rx(e,p4,function(s,o,a,l){i[i.length]=a?rx(l,y4,"$1"):o||s}),i},m4=function(e,n){var r=e,i;if(Pf(nx,r)&&(i=nx[r],r="%"+i[0]+"%"),Pf(Go,r)){var s=Go[r];if(s===oo&&(s=c4(r)),typeof s>"u"&&!n)throw new Wo("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:r,value:s}}throw new ma("intrinsic "+e+" does not exist!")},Kr=function(e,n){if(typeof e!="string"||e.length===0)throw new Wo("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof n!="boolean")throw new Wo('"allowMissing" argument must be a boolean');if(d4(/^%?[^%]*%?$/,e)===null)throw new ma("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=g4(e),i=r.length>0?r[0]:"",s=m4("%"+i+"%",n),o=s.name,a=s.value,l=!1,u=s.alias;u&&(i=u[0],f4(r,h4([0,1],u)));for(var h=1,f=!0;h<r.length;h+=1){var d=r[h],p=Rf(d,0,1),g=Rf(d,-1);if((p==='"'||p==="'"||p==="`"||g==='"'||g==="'"||g==="`")&&p!==g)throw new ma("property names with quotes must have matching quotes");if((d==="constructor"||!f)&&(l=!0),i+="."+d,o="%"+i+"%",Pf(Go,o))a=Go[o];else if(a!=null){if(!(d in a)){if(!n)throw new Wo("base intrinsic for "+e+" exists, but the property is not available.");return}if(hs&&h+1>=r.length){var v=hs(a,d);f=!!v,f&&"get"in v&&!("originalValue"in v.get)?a=v.get:a=a[d]}else f=Pf(a,d),a=a[d];f&&!l&&(Go[o]=a)}}return a},v4=Kr,Lm=v4("%Object.defineProperty%",!0),Um=function(){if(Lm)try{return Lm({},"a",{value:1}),!0}catch{return!1}return!1};Um.hasArrayLengthDefineBug=function(){if(!Um())return null;try{return Lm([],"length",{value:1}).length!==1}catch{return!0}};var ic=Um,_4=Xd,w4=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",E4=Object.prototype.toString,x4=Array.prototype.concat,rP=Object.defineProperty,S4=function(t){return typeof t=="function"&&E4.call(t)==="[object Function]"},A4=ic(),iP=rP&&A4,T4=function(t,e,n,r){e in t&&(!S4(r)||!r())||(iP?rP(t,e,{configurable:!0,enumerable:!1,value:n,writable:!0}):t[e]=n)},sP=function(t,e){var n=arguments.length>2?arguments[2]:{},r=_4(e);w4&&(r=x4.call(r,Object.getOwnPropertySymbols(e)));for(var i=0;i<r.length;i+=1)T4(t,r[i],e[r[i]],n[r[i]])};sP.supportsDescriptors=!!iP;var Zd=sP,oP={exports:{}};(function(t){var e=S0,n=Kr,r=n("%Function.prototype.apply%"),i=n("%Function.prototype.call%"),s=n("%Reflect.apply%",!0)||e.call(i,r),o=n("%Object.getOwnPropertyDescriptor%",!0),a=n("%Object.defineProperty%",!0),l=n("%Math.max%");if(a)try{a({},"a",{value:1})}catch{a=null}t.exports=function(f){var d=s(e,i,arguments);if(o&&a){var p=o(d,"length");p.configurable&&a(d,"length",{value:1+l(0,f.length-(arguments.length-1))})}return d};var u=function(){return s(e,r,arguments)};a?a(t.exports,"apply",{value:u}):t.exports.apply=u})(oP);var sc=oP.exports,aP=Kr,lP=sc,I4=lP(aP("String.prototype.indexOf")),nr=function(e,n){var r=aP(e,!!n);return typeof r=="function"&&I4(e,".prototype.")>-1?lP(r):r},C4=Xd,uP=Jd(),cP=nr,ix=Object,b4=cP("Array.prototype.push"),sx=cP("Object.prototype.propertyIsEnumerable"),P4=uP?Object.getOwnPropertySymbols:null,hP=function(e,n){if(e==null)throw new TypeError("target must be an object");var r=ix(e);if(arguments.length===1)return r;for(var i=1;i<arguments.length;++i){var s=ix(arguments[i]),o=C4(s),a=uP&&(Object.getOwnPropertySymbols||P4);if(a)for(var l=a(s),u=0;u<l.length;++u){var h=l[u];sx(s,h)&&b4(o,h)}for(var f=0;f<o.length;++f){var d=o[f];if(sx(s,d)){var p=s[d];r[d]=p}}}return r},Py=hP,R4=function(){if(!Object.assign)return!1;for(var t="abcdefghijklmnopqrst",e=t.split(""),n={},r=0;r<e.length;++r)n[e[r]]=e[r];var i=Object.assign({},n),s="";for(var o in i)s+=o;return t!==s},k4=function(){if(!Object.assign||!Object.preventExtensions)return!1;var t=Object.preventExtensions({1:2});try{Object.assign(t,"xy")}catch{return t[1]==="y"}return!1},fP=function(){return!Object.assign||R4()||k4()?Py:Object.assign},N4=Zd,D4=fP,O4=function(){var e=D4();return N4(Object,{assign:e},{assign:function(){return Object.assign!==e}}),e},j4=Zd,$4=sc,F4=hP,dP=fP,M4=O4,V4=$4.apply(dP()),pP=function(e,n){return V4(Object,arguments)};j4(pP,{getPolyfill:dP,implementation:F4,shim:M4});var L4=pP,ox={foo:{}},U4=Object,ep=function(){return{__proto__:ox}.foo===ox.foo&&!({__proto__:null}instanceof U4)},B4="Function.prototype.bind called on incompatible ",z4=Object.prototype.toString,W4=Math.max,G4="[object Function]",ax=function(e,n){for(var r=[],i=0;i<e.length;i+=1)r[i]=e[i];for(var s=0;s<n.length;s+=1)r[s+e.length]=n[s];return r},H4=function(e,n){for(var r=[],i=n||0,s=0;i<e.length;i+=1,s+=1)r[s]=e[i];return r},q4=function(t,e){for(var n="",r=0;r<t.length;r+=1)n+=t[r],r+1<t.length&&(n+=e);return n},K4=function(e){var n=this;if(typeof n!="function"||z4.apply(n)!==G4)throw new TypeError(B4+n);for(var r=H4(arguments,1),i,s=function(){if(this instanceof i){var h=n.apply(this,ax(r,arguments));return Object(h)===h?h:this}return n.apply(e,ax(r,arguments))},o=W4(0,n.length-r.length),a=[],l=0;l<o;l++)a[l]="$"+l;if(i=Function("binder","return function ("+q4(a,",")+"){ return binder.apply(this,arguments); }")(s),n.prototype){var u=function(){};u.prototype=n.prototype,i.prototype=new u,u.prototype=null}return i},Q4=K4,yP=Function.prototype.bind||Q4,Y4="Function.prototype.bind called on incompatible ",X4=Object.prototype.toString,J4=Math.max,Z4="[object Function]",lx=function(e,n){for(var r=[],i=0;i<e.length;i+=1)r[i]=e[i];for(var s=0;s<n.length;s+=1)r[s+e.length]=n[s];return r},e3=function(e,n){for(var r=[],i=n||0,s=0;i<e.length;i+=1,s+=1)r[s]=e[i];return r},t3=function(t,e){for(var n="",r=0;r<t.length;r+=1)n+=t[r],r+1<t.length&&(n+=e);return n},n3=function(e){var n=this;if(typeof n!="function"||X4.apply(n)!==Z4)throw new TypeError(Y4+n);for(var r=e3(arguments,1),i,s=function(){if(this instanceof i){var h=n.apply(this,lx(r,arguments));return Object(h)===h?h:this}return n.apply(e,lx(r,arguments))},o=J4(0,n.length-r.length),a=[],l=0;l<o;l++)a[l]="$"+l;if(i=Function("binder","return function ("+t3(a,",")+"){ return binder.apply(this,arguments); }")(s),n.prototype){var u=function(){};u.prototype=n.prototype,i.prototype=new u,u.prototype=null}return i},r3=n3,i3=Function.prototype.bind||r3,s3=Function.prototype.call,o3=Object.prototype.hasOwnProperty,a3=i3,tp=a3.call(s3,o3),he,va=SyntaxError,gP=Function,Ho=TypeError,Ry=function(t){try{return gP('"use strict"; return ('+t+").constructor;")()}catch{}},fs=Object.getOwnPropertyDescriptor;if(fs)try{fs({},"")}catch{fs=null}var ky=function(){throw new Ho},l3=fs?function(){try{return arguments.callee,ky}catch{try{return fs(arguments,"callee").get}catch{return ky}}}():ky,Xs=Bi(),u3=ep(),pt=Object.getPrototypeOf||(u3?function(t){return t.__proto__}:null),ao={},c3=typeof Uint8Array>"u"||!pt?he:pt(Uint8Array),ds={"%AggregateError%":typeof AggregateError>"u"?he:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?he:ArrayBuffer,"%ArrayIteratorPrototype%":Xs&&pt?pt([][Symbol.iterator]()):he,"%AsyncFromSyncIteratorPrototype%":he,"%AsyncFunction%":ao,"%AsyncGenerator%":ao,"%AsyncGeneratorFunction%":ao,"%AsyncIteratorPrototype%":ao,"%Atomics%":typeof Atomics>"u"?he:Atomics,"%BigInt%":typeof BigInt>"u"?he:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?he:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?he:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?he:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?he:Float32Array,"%Float64Array%":typeof Float64Array>"u"?he:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?he:FinalizationRegistry,"%Function%":gP,"%GeneratorFunction%":ao,"%Int8Array%":typeof Int8Array>"u"?he:Int8Array,"%Int16Array%":typeof Int16Array>"u"?he:Int16Array,"%Int32Array%":typeof Int32Array>"u"?he:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Xs&&pt?pt(pt([][Symbol.iterator]())):he,"%JSON%":typeof JSON=="object"?JSON:he,"%Map%":typeof Map>"u"?he:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Xs||!pt?he:pt(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?he:Promise,"%Proxy%":typeof Proxy>"u"?he:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?he:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?he:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Xs||!pt?he:pt(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?he:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Xs&&pt?pt(""[Symbol.iterator]()):he,"%Symbol%":Xs?Symbol:he,"%SyntaxError%":va,"%ThrowTypeError%":l3,"%TypedArray%":c3,"%TypeError%":Ho,"%Uint8Array%":typeof Uint8Array>"u"?he:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?he:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?he:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?he:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?he:WeakMap,"%WeakRef%":typeof WeakRef>"u"?he:WeakRef,"%WeakSet%":typeof WeakSet>"u"?he:WeakSet};if(pt)try{null.error}catch(t){var h3=pt(pt(t));ds["%Error.prototype%"]=h3}var f3=function t(e){var n;if(e==="%AsyncFunction%")n=Ry("async function () {}");else if(e==="%GeneratorFunction%")n=Ry("function* () {}");else if(e==="%AsyncGeneratorFunction%")n=Ry("async function* () {}");else if(e==="%AsyncGenerator%"){var r=t("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if(e==="%AsyncIteratorPrototype%"){var i=t("%AsyncGenerator%");i&&pt&&(n=pt(i.prototype))}return ds[e]=n,n},ux={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},oc=yP,kf=tp,d3=oc.call(Function.call,Array.prototype.concat),p3=oc.call(Function.apply,Array.prototype.splice),cx=oc.call(Function.call,String.prototype.replace),Nf=oc.call(Function.call,String.prototype.slice),y3=oc.call(Function.call,RegExp.prototype.exec),g3=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,m3=/\\(\\)?/g,v3=function(e){var n=Nf(e,0,1),r=Nf(e,-1);if(n==="%"&&r!=="%")throw new va("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&n!=="%")throw new va("invalid intrinsic syntax, expected opening `%`");var i=[];return cx(e,g3,function(s,o,a,l){i[i.length]=a?cx(l,m3,"$1"):o||s}),i},_3=function(e,n){var r=e,i;if(kf(ux,r)&&(i=ux[r],r="%"+i[0]+"%"),kf(ds,r)){var s=ds[r];if(s===ao&&(s=f3(r)),typeof s>"u"&&!n)throw new Ho("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:r,value:s}}throw new va("intrinsic "+e+" does not exist!")},np=function(e,n){if(typeof e!="string"||e.length===0)throw new Ho("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof n!="boolean")throw new Ho('"allowMissing" argument must be a boolean');if(y3(/^%?[^%]*%?$/,e)===null)throw new va("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=v3(e),i=r.length>0?r[0]:"",s=_3("%"+i+"%",n),o=s.name,a=s.value,l=!1,u=s.alias;u&&(i=u[0],p3(r,d3([0,1],u)));for(var h=1,f=!0;h<r.length;h+=1){var d=r[h],p=Nf(d,0,1),g=Nf(d,-1);if((p==='"'||p==="'"||p==="`"||g==='"'||g==="'"||g==="`")&&p!==g)throw new va("property names with quotes must have matching quotes");if((d==="constructor"||!f)&&(l=!0),i+="."+d,o="%"+i+"%",kf(ds,o))a=ds[o];else if(a!=null){if(!(d in a)){if(!n)throw new Ho("base intrinsic for "+e+" exists, but the property is not available.");return}if(fs&&h+1>=r.length){var v=fs(a,d);f=!!v,f&&"get"in v&&!("originalValue"in v.get)?a=v.get:a=a[d]}else f=kf(a,d),a=a[d];f&&!l&&(ds[o]=a)}}return a},mP={exports:{}},w3="Function.prototype.bind called on incompatible ",E3=Object.prototype.toString,x3=Math.max,S3="[object Function]",hx=function(e,n){for(var r=[],i=0;i<e.length;i+=1)r[i]=e[i];for(var s=0;s<n.length;s+=1)r[s+e.length]=n[s];return r},A3=function(e,n){for(var r=[],i=n||0,s=0;i<e.length;i+=1,s+=1)r[s]=e[i];return r},T3=function(t,e){for(var n="",r=0;r<t.length;r+=1)n+=t[r],r+1<t.length&&(n+=e);return n},I3=function(e){var n=this;if(typeof n!="function"||E3.apply(n)!==S3)throw new TypeError(w3+n);for(var r=A3(arguments,1),i,s=function(){if(this instanceof i){var h=n.apply(this,hx(r,arguments));return Object(h)===h?h:this}return n.apply(e,hx(r,arguments))},o=x3(0,n.length-r.length),a=[],l=0;l<o;l++)a[l]="$"+l;if(i=Function("binder","return function ("+T3(a,",")+"){ return binder.apply(this,arguments); }")(s),n.prototype){var u=function(){};u.prototype=n.prototype,i.prototype=new u,u.prototype=null}return i},C3=I3,b3=Function.prototype.bind||C3,fe,_a=SyntaxError,vP=Function,qo=TypeError,Ny=function(t){try{return vP('"use strict"; return ('+t+").constructor;")()}catch{}},ps=Object.getOwnPropertyDescriptor;if(ps)try{ps({},"")}catch{ps=null}var Dy=function(){throw new qo},P3=ps?function(){try{return arguments.callee,Dy}catch{try{return ps(arguments,"callee").get}catch{return Dy}}}():Dy,Js=Bi(),R3=ep(),yt=Object.getPrototypeOf||(R3?function(t){return t.__proto__}:null),lo={},k3=typeof Uint8Array>"u"||!yt?fe:yt(Uint8Array),ys={"%AggregateError%":typeof AggregateError>"u"?fe:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?fe:ArrayBuffer,"%ArrayIteratorPrototype%":Js&&yt?yt([][Symbol.iterator]()):fe,"%AsyncFromSyncIteratorPrototype%":fe,"%AsyncFunction%":lo,"%AsyncGenerator%":lo,"%AsyncGeneratorFunction%":lo,"%AsyncIteratorPrototype%":lo,"%Atomics%":typeof Atomics>"u"?fe:Atomics,"%BigInt%":typeof BigInt>"u"?fe:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?fe:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?fe:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?fe:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?fe:Float32Array,"%Float64Array%":typeof Float64Array>"u"?fe:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?fe:FinalizationRegistry,"%Function%":vP,"%GeneratorFunction%":lo,"%Int8Array%":typeof Int8Array>"u"?fe:Int8Array,"%Int16Array%":typeof Int16Array>"u"?fe:Int16Array,"%Int32Array%":typeof Int32Array>"u"?fe:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Js&&yt?yt(yt([][Symbol.iterator]())):fe,"%JSON%":typeof JSON=="object"?JSON:fe,"%Map%":typeof Map>"u"?fe:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Js||!yt?fe:yt(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?fe:Promise,"%Proxy%":typeof Proxy>"u"?fe:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?fe:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?fe:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Js||!yt?fe:yt(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?fe:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Js&&yt?yt(""[Symbol.iterator]()):fe,"%Symbol%":Js?Symbol:fe,"%SyntaxError%":_a,"%ThrowTypeError%":P3,"%TypedArray%":k3,"%TypeError%":qo,"%Uint8Array%":typeof Uint8Array>"u"?fe:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?fe:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?fe:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?fe:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?fe:WeakMap,"%WeakRef%":typeof WeakRef>"u"?fe:WeakRef,"%WeakSet%":typeof WeakSet>"u"?fe:WeakSet};if(yt)try{null.error}catch(t){var N3=yt(yt(t));ys["%Error.prototype%"]=N3}var D3=function t(e){var n;if(e==="%AsyncFunction%")n=Ny("async function () {}");else if(e==="%GeneratorFunction%")n=Ny("function* () {}");else if(e==="%AsyncGeneratorFunction%")n=Ny("async function* () {}");else if(e==="%AsyncGenerator%"){var r=t("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if(e==="%AsyncIteratorPrototype%"){var i=t("%AsyncGenerator%");i&&yt&&(n=yt(i.prototype))}return ys[e]=n,n},fx={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ac=b3,Df=tp,O3=ac.call(Function.call,Array.prototype.concat),j3=ac.call(Function.apply,Array.prototype.splice),dx=ac.call(Function.call,String.prototype.replace),Of=ac.call(Function.call,String.prototype.slice),$3=ac.call(Function.call,RegExp.prototype.exec),F3=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,M3=/\\(\\)?/g,V3=function(e){var n=Of(e,0,1),r=Of(e,-1);if(n==="%"&&r!=="%")throw new _a("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&n!=="%")throw new _a("invalid intrinsic syntax, expected opening `%`");var i=[];return dx(e,F3,function(s,o,a,l){i[i.length]=a?dx(l,M3,"$1"):o||s}),i},L3=function(e,n){var r=e,i;if(Df(fx,r)&&(i=fx[r],r="%"+i[0]+"%"),Df(ys,r)){var s=ys[r];if(s===lo&&(s=D3(r)),typeof s>"u"&&!n)throw new qo("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:r,value:s}}throw new _a("intrinsic "+e+" does not exist!")},U3=function(e,n){if(typeof e!="string"||e.length===0)throw new qo("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof n!="boolean")throw new qo('"allowMissing" argument must be a boolean');if($3(/^%?[^%]*%?$/,e)===null)throw new _a("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=V3(e),i=r.length>0?r[0]:"",s=L3("%"+i+"%",n),o=s.name,a=s.value,l=!1,u=s.alias;u&&(i=u[0],j3(r,O3([0,1],u)));for(var h=1,f=!0;h<r.length;h+=1){var d=r[h],p=Of(d,0,1),g=Of(d,-1);if((p==='"'||p==="'"||p==="`"||g==='"'||g==="'"||g==="`")&&p!==g)throw new _a("property names with quotes must have matching quotes");if((d==="constructor"||!f)&&(l=!0),i+="."+d,o="%"+i+"%",Df(ys,o))a=ys[o];else if(a!=null){if(!(d in a)){if(!n)throw new qo("base intrinsic for "+e+" exists, but the property is not available.");return}if(ps&&h+1>=r.length){var v=ps(a,d);f=!!v,f&&"get"in v&&!("originalValue"in v.get)?a=v.get:a=a[d]}else f=Df(a,d),a=a[d];f&&!l&&(ys[o]=a)}}return a},B3="Function.prototype.bind called on incompatible ",z3=Object.prototype.toString,W3=Math.max,G3="[object Function]",px=function(e,n){for(var r=[],i=0;i<e.length;i+=1)r[i]=e[i];for(var s=0;s<n.length;s+=1)r[s+e.length]=n[s];return r},H3=function(e,n){for(var r=[],i=n||0,s=0;i<e.length;i+=1,s+=1)r[s]=e[i];return r},q3=function(t,e){for(var n="",r=0;r<t.length;r+=1)n+=t[r],r+1<t.length&&(n+=e);return n},K3=function(e){var n=this;if(typeof n!="function"||z3.apply(n)!==G3)throw new TypeError(B3+n);for(var r=H3(arguments,1),i,s=function(){if(this instanceof i){var h=n.apply(this,px(r,arguments));return Object(h)===h?h:this}return n.apply(e,px(r,arguments))},o=W3(0,n.length-r.length),a=[],l=0;l<o;l++)a[l]="$"+l;if(i=Function("binder","return function ("+q3(a,",")+"){ return binder.apply(this,arguments); }")(s),n.prototype){var u=function(){};u.prototype=n.prototype,i.prototype=new u,u.prototype=null}return i},Q3=K3,Y3=Function.prototype.bind||Q3,de,wa=SyntaxError,_P=Function,Ko=TypeError,Oy=function(t){try{return _P('"use strict"; return ('+t+").constructor;")()}catch{}},gs=Object.getOwnPropertyDescriptor;if(gs)try{gs({},"")}catch{gs=null}var jy=function(){throw new Ko},X3=gs?function(){try{return arguments.callee,jy}catch{try{return gs(arguments,"callee").get}catch{return jy}}}():jy,Zs=Bi(),J3=ep(),gt=Object.getPrototypeOf||(J3?function(t){return t.__proto__}:null),uo={},Z3=typeof Uint8Array>"u"||!gt?de:gt(Uint8Array),ms={"%AggregateError%":typeof AggregateError>"u"?de:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?de:ArrayBuffer,"%ArrayIteratorPrototype%":Zs&&gt?gt([][Symbol.iterator]()):de,"%AsyncFromSyncIteratorPrototype%":de,"%AsyncFunction%":uo,"%AsyncGenerator%":uo,"%AsyncGeneratorFunction%":uo,"%AsyncIteratorPrototype%":uo,"%Atomics%":typeof Atomics>"u"?de:Atomics,"%BigInt%":typeof BigInt>"u"?de:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?de:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?de:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?de:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?de:Float32Array,"%Float64Array%":typeof Float64Array>"u"?de:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?de:FinalizationRegistry,"%Function%":_P,"%GeneratorFunction%":uo,"%Int8Array%":typeof Int8Array>"u"?de:Int8Array,"%Int16Array%":typeof Int16Array>"u"?de:Int16Array,"%Int32Array%":typeof Int32Array>"u"?de:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Zs&&gt?gt(gt([][Symbol.iterator]())):de,"%JSON%":typeof JSON=="object"?JSON:de,"%Map%":typeof Map>"u"?de:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Zs||!gt?de:gt(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?de:Promise,"%Proxy%":typeof Proxy>"u"?de:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?de:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?de:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Zs||!gt?de:gt(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?de:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Zs&&gt?gt(""[Symbol.iterator]()):de,"%Symbol%":Zs?Symbol:de,"%SyntaxError%":wa,"%ThrowTypeError%":X3,"%TypedArray%":Z3,"%TypeError%":Ko,"%Uint8Array%":typeof Uint8Array>"u"?de:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?de:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?de:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?de:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?de:WeakMap,"%WeakRef%":typeof WeakRef>"u"?de:WeakRef,"%WeakSet%":typeof WeakSet>"u"?de:WeakSet};if(gt)try{null.error}catch(t){var eU=gt(gt(t));ms["%Error.prototype%"]=eU}var tU=function t(e){var n;if(e==="%AsyncFunction%")n=Oy("async function () {}");else if(e==="%GeneratorFunction%")n=Oy("function* () {}");else if(e==="%AsyncGeneratorFunction%")n=Oy("async function* () {}");else if(e==="%AsyncGenerator%"){var r=t("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if(e==="%AsyncIteratorPrototype%"){var i=t("%AsyncGenerator%");i&&gt&&(n=gt(i.prototype))}return ms[e]=n,n},yx={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},lc=Y3,jf=tp,nU=lc.call(Function.call,Array.prototype.concat),rU=lc.call(Function.apply,Array.prototype.splice),gx=lc.call(Function.call,String.prototype.replace),$f=lc.call(Function.call,String.prototype.slice),iU=lc.call(Function.call,RegExp.prototype.exec),sU=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,oU=/\\(\\)?/g,aU=function(e){var n=$f(e,0,1),r=$f(e,-1);if(n==="%"&&r!=="%")throw new wa("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&n!=="%")throw new wa("invalid intrinsic syntax, expected opening `%`");var i=[];return gx(e,sU,function(s,o,a,l){i[i.length]=a?gx(l,oU,"$1"):o||s}),i},lU=function(e,n){var r=e,i;if(jf(yx,r)&&(i=yx[r],r="%"+i[0]+"%"),jf(ms,r)){var s=ms[r];if(s===uo&&(s=tU(r)),typeof s>"u"&&!n)throw new Ko("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:r,value:s}}throw new wa("intrinsic "+e+" does not exist!")},uU=function(e,n){if(typeof e!="string"||e.length===0)throw new Ko("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof n!="boolean")throw new Ko('"allowMissing" argument must be a boolean');if(iU(/^%?[^%]*%?$/,e)===null)throw new wa("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=aU(e),i=r.length>0?r[0]:"",s=lU("%"+i+"%",n),o=s.name,a=s.value,l=!1,u=s.alias;u&&(i=u[0],rU(r,nU([0,1],u)));for(var h=1,f=!0;h<r.length;h+=1){var d=r[h],p=$f(d,0,1),g=$f(d,-1);if((p==='"'||p==="'"||p==="`"||g==='"'||g==="'"||g==="`")&&p!==g)throw new wa("property names with quotes must have matching quotes");if((d==="constructor"||!f)&&(l=!0),i+="."+d,o="%"+i+"%",jf(ms,o))a=ms[o];else if(a!=null){if(!(d in a)){if(!n)throw new Ko("base intrinsic for "+e+" exists, but the property is not available.");return}if(gs&&h+1>=r.length){var v=gs(a,d);f=!!v,f&&"get"in v&&!("originalValue"in v.get)?a=v.get:a=a[d]}else f=jf(a,d),a=a[d];f&&!l&&(ms[o]=a)}}return a},cU=Kr,Ch=cU("%Object.getOwnPropertyDescriptor%",!0);if(Ch)try{Ch([],"length")}catch{Ch=null}var rp=Ch,hU=ic(),T0=uU,Bl=hU&&T0("%Object.defineProperty%",!0);if(Bl)try{Bl({},"a",{value:1})}catch{Bl=!1}var fU=T0("%SyntaxError%"),eo=T0("%TypeError%"),mx=rp,I0=function(e,n,r){if(!e||typeof e!="object"&&typeof e!="function")throw new eo("`obj` must be an object or a function`");if(typeof n!="string"&&typeof n!="symbol")throw new eo("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new eo("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new eo("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new eo("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new eo("`loose`, if provided, must be a boolean");var i=arguments.length>3?arguments[3]:null,s=arguments.length>4?arguments[4]:null,o=arguments.length>5?arguments[5]:null,a=arguments.length>6?arguments[6]:!1,l=!!mx&&mx(e,n);if(Bl)Bl(e,n,{configurable:o===null&&l?l.configurable:!o,enumerable:i===null&&l?l.enumerable:!i,value:r,writable:s===null&&l?l.writable:!s});else if(a||!i&&!s&&!o)e[n]=r;else throw new fU("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},wP=U3,vx=I0,dU=ic(),_x=rp,wx=wP("%TypeError%"),pU=wP("%Math.floor%"),EP=function(e,n){if(typeof e!="function")throw new wx("`fn` is not a function");if(typeof n!="number"||n<0||n>4294967295||pU(n)!==n)throw new wx("`length` must be a positive 32-bit integer");var r=arguments.length>2&&!!arguments[2],i=!0,s=!0;if("length"in e&&_x){var o=_x(e,"length");o&&!o.configurable&&(i=!1),o&&!o.writable&&(s=!1)}return(i||s||!r)&&(dU?vx(e,"length",n,!0,!0):vx(e,"length",n)),e};(function(t){var e=yP,n=np,r=EP,i=n("%TypeError%"),s=n("%Function.prototype.apply%"),o=n("%Function.prototype.call%"),a=n("%Reflect.apply%",!0)||e.call(o,s),l=n("%Object.defineProperty%",!0),u=n("%Math.max%");if(l)try{l({},"a",{value:1})}catch{l=null}t.exports=function(d){if(typeof d!="function")throw new i("a function is required");var p=a(e,o,arguments);return r(p,1+u(0,d.length-(arguments.length-1)),!0)};var h=function(){return a(e,s,arguments)};l?l(t.exports,"apply",{value:h}):t.exports.apply=h})(mP);var yU=mP.exports,xP=np,SP=yU,gU=SP(xP("String.prototype.indexOf")),mU=function(e,n){var r=xP(e,!!n);return typeof r=="function"&&gU(e,".prototype.")>-1?SP(r):r},vU=Xd,_U=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",wU=Object.prototype.toString,EU=Array.prototype.concat,Ex=I0,xU=function(t){return typeof t=="function"&&wU.call(t)==="[object Function]"},AP=ic(),SU=function(t,e,n,r){if(e in t){if(r===!0){if(t[e]===n)return}else if(!xU(r)||!r())return}AP?Ex(t,e,n,!0):Ex(t,e,n)},TP=function(t,e){var n=arguments.length>2?arguments[2]:{},r=vU(e);_U&&(r=EU.call(r,Object.getOwnPropertySymbols(e)));for(var i=0;i<r.length;i+=1)SU(t,r[i],e[r[i]],n[r[i]])};TP.supportsDescriptors=!!AP;var C0=TP,Tu=function(){return typeof(function(){}).name=="string"},zl=Object.getOwnPropertyDescriptor;if(zl)try{zl([],"length")}catch{zl=null}Tu.functionsHaveConfigurableNames=function(){if(!Tu()||!zl)return!1;var e=zl(function(){},"name");return!!e&&!!e.configurable};var AU=Function.prototype.bind;Tu.boundFunctionsHaveNames=function(){return Tu()&&typeof AU=="function"&&(function(){}).bind().name!==""};var TU=Tu,xx=I0,IU=ic(),CU=TU.functionsHaveConfigurableNames(),bU=TypeError,PU=function(e,n){if(typeof e!="function")throw new bU("`fn` is not a function");var r=arguments.length>2&&!!arguments[2];return(!r||CU)&&(IU?xx(e,"name",n,!0,!0):xx(e,"name",n)),e},RU=PU,kU=Object,NU=TypeError,IP=RU(function(){if(this!=null&&this!==kU(this))throw new NU("RegExp.prototype.flags getter called on non-object");var e="";return this.hasIndices&&(e+="d"),this.global&&(e+="g"),this.ignoreCase&&(e+="i"),this.multiline&&(e+="m"),this.dotAll&&(e+="s"),this.unicode&&(e+="u"),this.unicodeSets&&(e+="v"),this.sticky&&(e+="y"),e},"get flags",!0),DU=IP,OU=C0.supportsDescriptors,jU=Object.getOwnPropertyDescriptor,CP=function(){if(OU&&/a/mig.flags==="gim"){var e=jU(RegExp.prototype,"flags");if(e&&typeof e.get=="function"&&typeof RegExp.prototype.dotAll=="boolean"&&typeof RegExp.prototype.hasIndices=="boolean"){var n="",r={};if(Object.defineProperty(r,"hasIndices",{get:function(){n+="d"}}),Object.defineProperty(r,"sticky",{get:function(){n+="y"}}),n==="dy")return e.get}}return DU},$U=C0.supportsDescriptors,FU=CP,MU=Object.getOwnPropertyDescriptor,VU=Object.defineProperty,LU=TypeError,Sx=Object.getPrototypeOf,UU=/a/,BU=function(){if(!$U||!Sx)throw new LU("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var e=FU(),n=Sx(UU),r=MU(n,"flags");return(!r||r.get!==e)&&VU(n,"flags",{configurable:!0,enumerable:!1,get:e}),e},zU=C0,WU=sc,GU=IP,bP=CP,HU=BU,PP=WU(bP());zU(PP,{getPolyfill:bP,implementation:GU,shim:HU});var qU=PP,bh={exports:{}},KU=Jd,zi=function(){return KU()&&!!Symbol.toStringTag},QU=zi(),YU=nr,Bm=YU("Object.prototype.toString"),ip=function(e){return QU&&e&&typeof e=="object"&&Symbol.toStringTag in e?!1:Bm(e)==="[object Arguments]"},RP=function(e){return ip(e)?!0:e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&Bm(e)!=="[object Array]"&&Bm(e.callee)==="[object Function]"},XU=function(){return ip(arguments)}();ip.isLegacyArguments=RP;var kP=XU?ip:RP;const JU={},ZU=Object.freeze(Object.defineProperty({__proto__:null,default:JU},Symbol.toStringTag,{value:"Module"})),eB=q2(ZU);var b0=typeof Map=="function"&&Map.prototype,$y=Object.getOwnPropertyDescriptor&&b0?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Ff=b0&&$y&&typeof $y.get=="function"?$y.get:null,tB=b0&&Map.prototype.forEach,P0=typeof Set=="function"&&Set.prototype,Fy=Object.getOwnPropertyDescriptor&&P0?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Mf=P0&&Fy&&typeof Fy.get=="function"?Fy.get:null,nB=P0&&Set.prototype.forEach,rB=typeof WeakMap=="function"&&WeakMap.prototype,Wl=rB?WeakMap.prototype.has:null,iB=typeof WeakSet=="function"&&WeakSet.prototype,Gl=iB?WeakSet.prototype.has:null,sB=typeof WeakRef=="function"&&WeakRef.prototype,Ax=sB?WeakRef.prototype.deref:null,oB=Boolean.prototype.valueOf,aB=Object.prototype.toString,lB=Function.prototype.toString,uB=String.prototype.match,R0=String.prototype.slice,ui=String.prototype.replace,cB=String.prototype.toUpperCase,Tx=String.prototype.toLowerCase,NP=RegExp.prototype.test,Ix=Array.prototype.concat,or=Array.prototype.join,hB=Array.prototype.slice,Cx=Math.floor,zm=typeof BigInt=="function"?BigInt.prototype.valueOf:null,My=Object.getOwnPropertySymbols,Wm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Ea=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Ht=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Ea||"symbol")?Symbol.toStringTag:null,DP=Object.prototype.propertyIsEnumerable,bx=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function Px(t,e){if(t===1/0||t===-1/0||t!==t||t&&t>-1e3&&t<1e3||NP.call(/e/,e))return e;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof t=="number"){var r=t<0?-Cx(-t):Cx(t);if(r!==t){var i=String(r),s=R0.call(e,i.length+1);return ui.call(i,n,"$&_")+"."+ui.call(ui.call(s,/([0-9]{3})/g,"$&_"),/_$/,"")}}return ui.call(e,n,"$&_")}var Gm=eB,Rx=Gm.custom,kx=jP(Rx)?Rx:null,fB=function t(e,n,r,i){var s=n||{};if(ti(s,"quoteStyle")&&s.quoteStyle!=="single"&&s.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(ti(s,"maxStringLength")&&(typeof s.maxStringLength=="number"?s.maxStringLength<0&&s.maxStringLength!==1/0:s.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=ti(s,"customInspect")?s.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(ti(s,"indent")&&s.indent!==null&&s.indent!=="	"&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(ti(s,"numericSeparator")&&typeof s.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=s.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return FP(e,s);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var l=String(e);return a?Px(e,l):l}if(typeof e=="bigint"){var u=String(e)+"n";return a?Px(e,u):u}var h=typeof s.depth>"u"?5:s.depth;if(typeof r>"u"&&(r=0),r>=h&&h>0&&typeof e=="object")return Hm(e)?"[Array]":"[Object]";var f=RB(s,r);if(typeof i>"u")i=[];else if($P(i,e)>=0)return"[Circular]";function d(U,ce,tt){if(ce&&(i=hB.call(i),i.push(ce)),tt){var Ze={depth:s.depth};return ti(s,"quoteStyle")&&(Ze.quoteStyle=s.quoteStyle),t(U,Ze,r+1,i)}return t(U,s,r+1,i)}if(typeof e=="function"&&!Nx(e)){var p=EB(e),g=Jc(e,d);return"[Function"+(p?": "+p:" (anonymous)")+"]"+(g.length>0?" { "+or.call(g,", ")+" }":"")}if(jP(e)){var v=Ea?ui.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):Wm.call(e);return typeof e=="object"&&!Ea?al(v):v}if(CB(e)){for(var E="<"+Tx.call(String(e.nodeName)),m=e.attributes||[],y=0;y<m.length;y++)E+=" "+m[y].name+"="+OP(dB(m[y].value),"double",s);return E+=">",e.childNodes&&e.childNodes.length&&(E+="..."),E+="</"+Tx.call(String(e.nodeName))+">",E}if(Hm(e)){if(e.length===0)return"[]";var _=Jc(e,d);return f&&!PB(_)?"["+qm(_,f)+"]":"[ "+or.call(_,", ")+" ]"}if(yB(e)){var S=Jc(e,d);return!("cause"in Error.prototype)&&"cause"in e&&!DP.call(e,"cause")?"{ ["+String(e)+"] "+or.call(Ix.call("[cause]: "+d(e.cause),S),", ")+" }":S.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+or.call(S,", ")+" }"}if(typeof e=="object"&&o){if(kx&&typeof e[kx]=="function"&&Gm)return Gm(e,{depth:h-r});if(o!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(xB(e)){var A=[];return tB.call(e,function(U,ce){A.push(d(ce,e,!0)+" => "+d(U,e))}),Dx("Map",Ff.call(e),A,f)}if(TB(e)){var T=[];return nB.call(e,function(U){T.push(d(U,e))}),Dx("Set",Mf.call(e),T,f)}if(SB(e))return Vy("WeakMap");if(IB(e))return Vy("WeakSet");if(AB(e))return Vy("WeakRef");if(mB(e))return al(d(Number(e)));if(_B(e))return al(d(zm.call(e)));if(vB(e))return al(oB.call(e));if(gB(e))return al(d(String(e)));if(!pB(e)&&!Nx(e)){var I=Jc(e,d),b=bx?bx(e)===Object.prototype:e instanceof Object||e.constructor===Object,H=e instanceof Object?"":"null prototype",M=!b&&Ht&&Object(e)===e&&Ht in e?R0.call(Wi(e),8,-1):H?"Object":"",se=b||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",Z=se+(M||H?"["+or.call(Ix.call([],M||[],H||[]),": ")+"] ":"");return I.length===0?Z+"{}":f?Z+"{"+qm(I,f)+"}":Z+"{ "+or.call(I,", ")+" }"}return String(e)};function OP(t,e,n){var r=(n.quoteStyle||e)==="double"?'"':"'";return r+t+r}function dB(t){return ui.call(String(t),/"/g,"&quot;")}function Hm(t){return Wi(t)==="[object Array]"&&(!Ht||!(typeof t=="object"&&Ht in t))}function pB(t){return Wi(t)==="[object Date]"&&(!Ht||!(typeof t=="object"&&Ht in t))}function Nx(t){return Wi(t)==="[object RegExp]"&&(!Ht||!(typeof t=="object"&&Ht in t))}function yB(t){return Wi(t)==="[object Error]"&&(!Ht||!(typeof t=="object"&&Ht in t))}function gB(t){return Wi(t)==="[object String]"&&(!Ht||!(typeof t=="object"&&Ht in t))}function mB(t){return Wi(t)==="[object Number]"&&(!Ht||!(typeof t=="object"&&Ht in t))}function vB(t){return Wi(t)==="[object Boolean]"&&(!Ht||!(typeof t=="object"&&Ht in t))}function jP(t){if(Ea)return t&&typeof t=="object"&&t instanceof Symbol;if(typeof t=="symbol")return!0;if(!t||typeof t!="object"||!Wm)return!1;try{return Wm.call(t),!0}catch{}return!1}function _B(t){if(!t||typeof t!="object"||!zm)return!1;try{return zm.call(t),!0}catch{}return!1}var wB=Object.prototype.hasOwnProperty||function(t){return t in this};function ti(t,e){return wB.call(t,e)}function Wi(t){return aB.call(t)}function EB(t){if(t.name)return t.name;var e=uB.call(lB.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}function $P(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}function xB(t){if(!Ff||!t||typeof t!="object")return!1;try{Ff.call(t);try{Mf.call(t)}catch{return!0}return t instanceof Map}catch{}return!1}function SB(t){if(!Wl||!t||typeof t!="object")return!1;try{Wl.call(t,Wl);try{Gl.call(t,Gl)}catch{return!0}return t instanceof WeakMap}catch{}return!1}function AB(t){if(!Ax||!t||typeof t!="object")return!1;try{return Ax.call(t),!0}catch{}return!1}function TB(t){if(!Mf||!t||typeof t!="object")return!1;try{Mf.call(t);try{Ff.call(t)}catch{return!0}return t instanceof Set}catch{}return!1}function IB(t){if(!Gl||!t||typeof t!="object")return!1;try{Gl.call(t,Gl);try{Wl.call(t,Wl)}catch{return!0}return t instanceof WeakSet}catch{}return!1}function CB(t){return!t||typeof t!="object"?!1:typeof HTMLElement<"u"&&t instanceof HTMLElement?!0:typeof t.nodeName=="string"&&typeof t.getAttribute=="function"}function FP(t,e){if(t.length>e.maxStringLength){var n=t.length-e.maxStringLength,r="... "+n+" more character"+(n>1?"s":"");return FP(R0.call(t,0,e.maxStringLength),e)+r}var i=ui.call(ui.call(t,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,bB);return OP(i,"single",e)}function bB(t){var e=t.charCodeAt(0),n={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return n?"\\"+n:"\\x"+(e<16?"0":"")+cB.call(e.toString(16))}function al(t){return"Object("+t+")"}function Vy(t){return t+" { ? }"}function Dx(t,e,n,r){var i=r?qm(n,r):or.call(n,", ");return t+" ("+e+") {"+i+"}"}function PB(t){for(var e=0;e<t.length;e++)if($P(t[e],`
`)>=0)return!1;return!0}function RB(t,e){var n;if(t.indent==="	")n="	";else if(typeof t.indent=="number"&&t.indent>0)n=or.call(Array(t.indent+1)," ");else return null;return{base:n,prev:or.call(Array(e+1),n)}}function qm(t,e){if(t.length===0)return"";var n=`
`+e.prev+e.base;return n+or.call(t,","+n)+`
`+e.prev}function Jc(t,e){var n=Hm(t),r=[];if(n){r.length=t.length;for(var i=0;i<t.length;i++)r[i]=ti(t,i)?e(t[i],t):""}var s=typeof My=="function"?My(t):[],o;if(Ea){o={};for(var a=0;a<s.length;a++)o["$"+s[a]]=s[a]}for(var l in t)ti(t,l)&&(n&&String(Number(l))===l&&l<t.length||Ea&&o["$"+l]instanceof Symbol||(NP.call(/[^\w$]/,l)?r.push(e(l,t)+": "+e(t[l],t)):r.push(l+": "+e(t[l],t))));if(typeof My=="function")for(var u=0;u<s.length;u++)DP.call(t,s[u])&&r.push("["+e(s[u])+"]: "+e(t[s[u]],t));return r}var k0=Kr,La=nr,kB=fB,NB=k0("%TypeError%"),Zc=k0("%WeakMap%",!0),eh=k0("%Map%",!0),DB=La("WeakMap.prototype.get",!0),OB=La("WeakMap.prototype.set",!0),jB=La("WeakMap.prototype.has",!0),$B=La("Map.prototype.get",!0),FB=La("Map.prototype.set",!0),MB=La("Map.prototype.has",!0),N0=function(t,e){for(var n=t,r;(r=n.next)!==null;n=r)if(r.key===e)return n.next=r.next,r.next=t.next,t.next=r,r},VB=function(t,e){var n=N0(t,e);return n&&n.value},LB=function(t,e,n){var r=N0(t,e);r?r.value=n:t.next={key:e,next:t.next,value:n}},UB=function(t,e){return!!N0(t,e)},MP=function(){var e,n,r,i={assert:function(s){if(!i.has(s))throw new NB("Side channel does not contain "+kB(s))},get:function(s){if(Zc&&s&&(typeof s=="object"||typeof s=="function")){if(e)return DB(e,s)}else if(eh){if(n)return $B(n,s)}else if(r)return VB(r,s)},has:function(s){if(Zc&&s&&(typeof s=="object"||typeof s=="function")){if(e)return jB(e,s)}else if(eh){if(n)return MB(n,s)}else if(r)return UB(r,s);return!1},set:function(s,o){Zc&&s&&(typeof s=="object"||typeof s=="function")?(e||(e=new Zc),OB(e,s,o)):eh?(n||(n=new eh),FB(n,s,o)):(r||(r={key:{},next:null}),LB(r,s,o))}};return i},BB=Kr,zB=A0,ll=MP(),Ir=BB("%TypeError%"),D0={assert:function(t,e){if(!t||typeof t!="object"&&typeof t!="function")throw new Ir("`O` is not an object");if(typeof e!="string")throw new Ir("`slot` must be a string");if(ll.assert(t),!D0.has(t,e))throw new Ir("`slot` is not present on `O`")},get:function(t,e){if(!t||typeof t!="object"&&typeof t!="function")throw new Ir("`O` is not an object");if(typeof e!="string")throw new Ir("`slot` must be a string");var n=ll.get(t);return n&&n["$"+e]},has:function(t,e){if(!t||typeof t!="object"&&typeof t!="function")throw new Ir("`O` is not an object");if(typeof e!="string")throw new Ir("`slot` must be a string");var n=ll.get(t);return!!n&&zB(n,"$"+e)},set:function(t,e,n){if(!t||typeof t!="object"&&typeof t!="function")throw new Ir("`O` is not an object");if(typeof e!="string")throw new Ir("`slot` must be a string");var r=ll.get(t);r||(r={},ll.set(t,r)),r["$"+e]=n}};Object.freeze&&Object.freeze(D0);var WB=D0,ul=WB,GB=SyntaxError,Ox=typeof StopIteration=="object"?StopIteration:null,HB=function(e){if(!Ox)throw new GB("this environment lacks StopIteration");ul.set(e,"[[Done]]",!1);var n={next:function(){var i=ul.get(this,"[[Iterator]]"),s=ul.get(i,"[[Done]]");try{return{done:s,value:s?void 0:i.next()}}catch(o){if(ul.set(i,"[[Done]]",!0),o!==Ox)throw o;return{done:!0,value:void 0}}}};return ul.set(n,"[[Iterator]]",e),n},qB={}.toString,VP=Array.isArray||function(t){return qB.call(t)=="[object Array]"},KB=String.prototype.valueOf,QB=function(e){try{return KB.call(e),!0}catch{return!1}},YB=Object.prototype.toString,XB="[object String]",JB=zi(),LP=function(e){return typeof e=="string"?!0:typeof e!="object"?!1:JB?QB(e):YB.call(e)===XB},O0=typeof Map=="function"&&Map.prototype?Map:null,ZB=typeof Set=="function"&&Set.prototype?Set:null,Vf;O0||(Vf=function(e){return!1});var UP=O0?Map.prototype.has:null,jx=ZB?Set.prototype.has:null;!Vf&&!UP&&(Vf=function(e){return!1});var BP=Vf||function(e){if(!e||typeof e!="object")return!1;try{if(UP.call(e),jx)try{jx.call(e)}catch{return!0}return e instanceof O0}catch{}return!1},e6=typeof Map=="function"&&Map.prototype?Map:null,j0=typeof Set=="function"&&Set.prototype?Set:null,Lf;j0||(Lf=function(e){return!1});var $x=e6?Map.prototype.has:null,zP=j0?Set.prototype.has:null;!Lf&&!zP&&(Lf=function(e){return!1});var WP=Lf||function(e){if(!e||typeof e!="object")return!1;try{if(zP.call(e),$x)try{$x.call(e)}catch{return!0}return e instanceof j0}catch{}return!1},Fx=kP,Mx=HB;if(Bi()||Jd()){var Ly=Symbol.iterator;bh.exports=function(e){if(e!=null&&typeof e[Ly]<"u")return e[Ly]();if(Fx(e))return Array.prototype[Ly].call(e)}}else{var t6=VP,n6=LP,Vx=Kr,r6=Vx("%Map%",!0),i6=Vx("%Set%",!0),Ln=nr,Lx=Ln("Array.prototype.push"),Ux=Ln("String.prototype.charCodeAt"),s6=Ln("String.prototype.slice"),o6=function(e,n){var r=e.length;if(n+1>=r)return n+1;var i=Ux(e,n);if(i<55296||i>56319)return n+1;var s=Ux(e,n+1);return s<56320||s>57343?n+1:n+2},Uy=function(e){var n=0;return{next:function(){var i=n>=e.length,s;return i||(s=e[n],n+=1),{done:i,value:s}}}},Bx=function(e,n){if(t6(e)||Fx(e))return Uy(e);if(n6(e)){var r=0;return{next:function(){var s=o6(e,r),o=s6(e,r,s);return r=s,{done:s>e.length,value:o}}}}if(n&&typeof e["_es6-shim iterator_"]<"u")return e["_es6-shim iterator_"]()};if(!r6&&!i6)bh.exports=function(e){if(e!=null)return Bx(e,!0)};else{var a6=BP,l6=WP,zx=Ln("Map.prototype.forEach",!0),Wx=Ln("Set.prototype.forEach",!0);if(typeof process>"u"||!process.versions||!process.versions.node)var Gx=Ln("Map.prototype.iterator",!0),Hx=Ln("Set.prototype.iterator",!0);var qx=Ln("Map.prototype.@@iterator",!0)||Ln("Map.prototype._es6-shim iterator_",!0),Kx=Ln("Set.prototype.@@iterator",!0)||Ln("Set.prototype._es6-shim iterator_",!0),u6=function(e){if(a6(e)){if(Gx)return Mx(Gx(e));if(qx)return qx(e);if(zx){var n=[];return zx(e,function(i,s){Lx(n,[s,i])}),Uy(n)}}if(l6(e)){if(Hx)return Mx(Hx(e));if(Kx)return Kx(e);if(Wx){var r=[];return Wx(e,function(i){Lx(r,i)}),Uy(r)}}};bh.exports=function(e){return u6(e)||Bx(e)}}}var c6=bh.exports,Qx=function(t){return t!==t},GP=function(e,n){return e===0&&n===0?1/e===1/n:!!(e===n||Qx(e)&&Qx(n))},h6=GP,HP=function(){return typeof Object.is=="function"?Object.is:h6},f6=HP,d6=Zd,p6=function(){var e=f6();return d6(Object,{is:e},{is:function(){return Object.is!==e}}),e},y6=Zd,g6=sc,m6=GP,qP=HP,v6=p6,KP=g6(qP(),Object);y6(KP,{getPolyfill:qP,implementation:m6,shim:v6});var _6=KP,QP={exports:{}},w6="Function.prototype.bind called on incompatible ",By=Array.prototype.slice,E6=Object.prototype.toString,x6="[object Function]",S6=function(e){var n=this;if(typeof n!="function"||E6.call(n)!==x6)throw new TypeError(w6+n);for(var r=By.call(arguments,1),i,s=function(){if(this instanceof i){var h=n.apply(this,r.concat(By.call(arguments)));return Object(h)===h?h:this}else return n.apply(e,r.concat(By.call(arguments)))},o=Math.max(0,n.length-r.length),a=[],l=0;l<o;l++)a.push("$"+l);if(i=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(s),n.prototype){var u=function(){};u.prototype=n.prototype,i.prototype=new u,u.prototype=null}return i},A6=S6,YP=Function.prototype.bind||A6,we,xa=SyntaxError,XP=Function,Qo=TypeError,zy=function(t){try{return XP('"use strict"; return ('+t+").constructor;")()}catch{}},vs=Object.getOwnPropertyDescriptor;if(vs)try{vs({},"")}catch{vs=null}var Wy=function(){throw new Qo},T6=vs?function(){try{return arguments.callee,Wy}catch{try{return vs(arguments,"callee").get}catch{return Wy}}}():Wy,to=Bi(),ni=Object.getPrototypeOf||function(t){return t.__proto__},co={},I6=typeof Uint8Array>"u"?we:ni(Uint8Array),Yo={"%AggregateError%":typeof AggregateError>"u"?we:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?we:ArrayBuffer,"%ArrayIteratorPrototype%":to?ni([][Symbol.iterator]()):we,"%AsyncFromSyncIteratorPrototype%":we,"%AsyncFunction%":co,"%AsyncGenerator%":co,"%AsyncGeneratorFunction%":co,"%AsyncIteratorPrototype%":co,"%Atomics%":typeof Atomics>"u"?we:Atomics,"%BigInt%":typeof BigInt>"u"?we:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?we:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?we:Float32Array,"%Float64Array%":typeof Float64Array>"u"?we:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?we:FinalizationRegistry,"%Function%":XP,"%GeneratorFunction%":co,"%Int8Array%":typeof Int8Array>"u"?we:Int8Array,"%Int16Array%":typeof Int16Array>"u"?we:Int16Array,"%Int32Array%":typeof Int32Array>"u"?we:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":to?ni(ni([][Symbol.iterator]())):we,"%JSON%":typeof JSON=="object"?JSON:we,"%Map%":typeof Map>"u"?we:Map,"%MapIteratorPrototype%":typeof Map>"u"||!to?we:ni(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?we:Promise,"%Proxy%":typeof Proxy>"u"?we:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?we:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?we:Set,"%SetIteratorPrototype%":typeof Set>"u"||!to?we:ni(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?we:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":to?ni(""[Symbol.iterator]()):we,"%Symbol%":to?Symbol:we,"%SyntaxError%":xa,"%ThrowTypeError%":T6,"%TypedArray%":I6,"%TypeError%":Qo,"%Uint8Array%":typeof Uint8Array>"u"?we:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?we:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?we:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?we:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?we:WeakMap,"%WeakRef%":typeof WeakRef>"u"?we:WeakRef,"%WeakSet%":typeof WeakSet>"u"?we:WeakSet},C6=function t(e){var n;if(e==="%AsyncFunction%")n=zy("async function () {}");else if(e==="%GeneratorFunction%")n=zy("function* () {}");else if(e==="%AsyncGeneratorFunction%")n=zy("async function* () {}");else if(e==="%AsyncGenerator%"){var r=t("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if(e==="%AsyncIteratorPrototype%"){var i=t("%AsyncGenerator%");i&&(n=ni(i.prototype))}return Yo[e]=n,n},Yx={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},uc=YP,Uf=A0,b6=uc.call(Function.call,Array.prototype.concat),P6=uc.call(Function.apply,Array.prototype.splice),Xx=uc.call(Function.call,String.prototype.replace),Bf=uc.call(Function.call,String.prototype.slice),R6=uc.call(Function.call,RegExp.prototype.exec),k6=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,N6=/\\(\\)?/g,D6=function(e){var n=Bf(e,0,1),r=Bf(e,-1);if(n==="%"&&r!=="%")throw new xa("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&n!=="%")throw new xa("invalid intrinsic syntax, expected opening `%`");var i=[];return Xx(e,k6,function(s,o,a,l){i[i.length]=a?Xx(l,N6,"$1"):o||s}),i},O6=function(e,n){var r=e,i;if(Uf(Yx,r)&&(i=Yx[r],r="%"+i[0]+"%"),Uf(Yo,r)){var s=Yo[r];if(s===co&&(s=C6(r)),typeof s>"u"&&!n)throw new Qo("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:r,value:s}}throw new xa("intrinsic "+e+" does not exist!")},JP=function(e,n){if(typeof e!="string"||e.length===0)throw new Qo("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof n!="boolean")throw new Qo('"allowMissing" argument must be a boolean');if(R6(/^%?[^%]*%?$/,e)===null)throw new xa("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=D6(e),i=r.length>0?r[0]:"",s=O6("%"+i+"%",n),o=s.name,a=s.value,l=!1,u=s.alias;u&&(i=u[0],P6(r,b6([0,1],u)));for(var h=1,f=!0;h<r.length;h+=1){var d=r[h],p=Bf(d,0,1),g=Bf(d,-1);if((p==='"'||p==="'"||p==="`"||g==='"'||g==="'"||g==="`")&&p!==g)throw new xa("property names with quotes must have matching quotes");if((d==="constructor"||!f)&&(l=!0),i+="."+d,o="%"+i+"%",Uf(Yo,o))a=Yo[o];else if(a!=null){if(!(d in a)){if(!n)throw new Qo("base intrinsic for "+e+" exists, but the property is not available.");return}if(vs&&h+1>=r.length){var v=vs(a,d);f=!!v,f&&"get"in v&&!("originalValue"in v.get)?a=v.get:a=a[d]}else f=Uf(a,d),a=a[d];f&&!l&&(Yo[o]=a)}}return a};(function(t){var e=YP,n=JP,r=n("%Function.prototype.apply%"),i=n("%Function.prototype.call%"),s=n("%Reflect.apply%",!0)||e.call(i,r),o=n("%Object.getOwnPropertyDescriptor%",!0),a=n("%Object.defineProperty%",!0),l=n("%Math.max%");if(a)try{a({},"a",{value:1})}catch{a=null}t.exports=function(f){var d=s(e,i,arguments);if(o&&a){var p=o(d,"length");p.configurable&&a(d,"length",{value:1+l(0,f.length-(arguments.length-1))})}return d};var u=function(){return s(e,r,arguments)};a?a(t.exports,"apply",{value:u}):t.exports.apply=u})(QP);var ZP=QP.exports,eR=JP,tR=ZP,j6=tR(eR("String.prototype.indexOf")),$6=function(e,n){var r=eR(e,!!n);return typeof r=="function"&&j6(e,".prototype.")>-1?tR(r):r},nR=Function.prototype.toString,Ro=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,Km,Ph;if(typeof Ro=="function"&&typeof Object.defineProperty=="function")try{Km=Object.defineProperty({},"length",{get:function(){throw Ph}}),Ph={},Ro(function(){throw 42},null,Km)}catch(t){t!==Ph&&(Ro=null)}else Ro=null;var F6=/^\s*class\b/,Qm=function(e){try{var n=nR.call(e);return F6.test(n)}catch{return!1}},Gy=function(e){try{return Qm(e)?!1:(nR.call(e),!0)}catch{return!1}},Rh=Object.prototype.toString,M6="[object Object]",V6="[object Function]",L6="[object GeneratorFunction]",U6="[object HTMLAllCollection]",B6="[object HTML document.all class]",z6="[object HTMLCollection]",W6=typeof Symbol=="function"&&!!Symbol.toStringTag,G6=!(0 in[,]),Ym=function(){return!1};if(typeof document=="object"){var H6=document.all;Rh.call(H6)===Rh.call(document.all)&&(Ym=function(e){if((G6||!e)&&(typeof e>"u"||typeof e=="object"))try{var n=Rh.call(e);return(n===U6||n===B6||n===z6||n===M6)&&e("")==null}catch{}return!1})}var q6=Ro?function(e){if(Ym(e))return!0;if(!e||typeof e!="function"&&typeof e!="object")return!1;try{Ro(e,null,Km)}catch(n){if(n!==Ph)return!1}return!Qm(e)&&Gy(e)}:function(e){if(Ym(e))return!0;if(!e||typeof e!="function"&&typeof e!="object")return!1;if(W6)return Gy(e);if(Qm(e))return!1;var n=Rh.call(e);return n!==V6&&n!==L6&&!/^\[object HTML/.test(n)?!1:Gy(e)},K6=q6,Q6=Object.prototype.toString,rR=Object.prototype.hasOwnProperty,Y6=function(e,n,r){for(var i=0,s=e.length;i<s;i++)rR.call(e,i)&&(r==null?n(e[i],i,e):n.call(r,e[i],i,e))},X6=function(e,n,r){for(var i=0,s=e.length;i<s;i++)r==null?n(e.charAt(i),i,e):n.call(r,e.charAt(i),i,e)},J6=function(e,n,r){for(var i in e)rR.call(e,i)&&(r==null?n(e[i],i,e):n.call(r,e[i],i,e))},Z6=function(e,n,r){if(!K6(n))throw new TypeError("iterator must be a function");var i;arguments.length>=3&&(i=r),Q6.call(e)==="[object Array]"?Y6(e,n,i):typeof e=="string"?X6(e,n,i):J6(e,n,i)},iR=Z6,Hy=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],e5=typeof globalThis>"u"?jv:globalThis,sR=function(){for(var e=[],n=0;n<Hy.length;n++)typeof e5[Hy[n]]=="function"&&(e[e.length]=Hy[n]);return e},oR=iR,t5=sR,$0=nr,n5=$0("Object.prototype.toString"),aR=zi(),kh=rp,r5=typeof globalThis>"u"?jv:globalThis,lR=t5(),i5=$0("Array.prototype.indexOf",!0)||function(e,n){for(var r=0;r<e.length;r+=1)if(e[r]===n)return r;return-1},s5=$0("String.prototype.slice"),uR={},qy=Object.getPrototypeOf;aR&&kh&&qy&&oR(lR,function(t){var e=new r5[t];if(Symbol.toStringTag in e){var n=qy(e),r=kh(n,Symbol.toStringTag);if(!r){var i=qy(n);r=kh(i,Symbol.toStringTag)}uR[t]=r.get}});var o5=function(e){var n=!1;return oR(uR,function(r,i){if(!n)try{n=r.call(e)===i}catch{}}),n},cR=function(e){if(!e||typeof e!="object")return!1;if(!aR||!(Symbol.toStringTag in e)){var n=s5(n5(e),8,-1);return i5(lR,n)>-1}return kh?o5(e):!1},a5=ZP,l5=$6,hR=np,u5=cR,Jx=hR("ArrayBuffer",!0),Zx=hR("Float32Array",!0),Nh=l5("ArrayBuffer.prototype.byteLength",!0),eS=Jx&&!Nh&&new Jx().slice,tS=eS&&a5(eS),c5=Nh||tS?function(e){if(!e||typeof e!="object")return!1;try{return Nh?Nh(e):tS(e,0),!0}catch{return!1}}:Zx?function(e){try{return new Zx(e).buffer===e&&!u5(e)}catch(n){return typeof e=="object"&&n.name==="RangeError"}}:function(e){return!1},h5=Date.prototype.getDay,f5=function(e){try{return h5.call(e),!0}catch{return!1}},d5=Object.prototype.toString,p5="[object Date]",y5=zi(),g5=function(e){return typeof e!="object"||e===null?!1:y5?f5(e):d5.call(e)===p5},Xm=nr,fR=zi(),dR,pR,Jm,Zm;if(fR){dR=Xm("Object.prototype.hasOwnProperty"),pR=Xm("RegExp.prototype.exec"),Jm={};var Ky=function(){throw Jm};Zm={toString:Ky,valueOf:Ky},typeof Symbol.toPrimitive=="symbol"&&(Zm[Symbol.toPrimitive]=Ky)}var m5=Xm("Object.prototype.toString"),v5=Object.getOwnPropertyDescriptor,_5="[object RegExp]",w5=fR?function(e){if(!e||typeof e!="object")return!1;var n=v5(e,"lastIndex"),r=n&&dR(n,"value");if(!r)return!1;try{pR(e,Zm)}catch(i){return i===Jm}}:function(e){return!e||typeof e!="object"&&typeof e!="function"?!1:m5(e)===_5},E5=nr,nS=E5("SharedArrayBuffer.prototype.byteLength",!0),x5=nS?function(e){if(!e||typeof e!="object")return!1;try{return nS(e),!0}catch{return!1}}:function(e){return!1},S5=Number.prototype.toString,A5=function(e){try{return S5.call(e),!0}catch{return!1}},T5=Object.prototype.toString,I5="[object Number]",C5=zi(),b5=function(e){return typeof e=="number"?!0:typeof e!="object"?!1:C5?A5(e):T5.call(e)===I5},yR=nr,P5=yR("Boolean.prototype.toString"),R5=yR("Object.prototype.toString"),k5=function(e){try{return P5(e),!0}catch{return!1}},N5="[object Boolean]",D5=zi(),O5=function(e){return typeof e=="boolean"?!0:e===null||typeof e!="object"?!1:D5&&Symbol.toStringTag in e?k5(e):R5(e)===N5},ev={exports:{}},j5=Object.prototype.toString,$5=Bi();if($5){var F5=Symbol.prototype.toString,M5=/^Symbol\(.*\)$/,V5=function(e){return typeof e.valueOf()!="symbol"?!1:M5.test(F5.call(e))};ev.exports=function(e){if(typeof e=="symbol")return!0;if(j5.call(e)!=="[object Symbol]")return!1;try{return V5(e)}catch{return!1}}}else ev.exports=function(e){return!1};var L5=ev.exports,tv={exports:{}},rS=typeof BigInt<"u"&&BigInt,U5=function(){return typeof rS=="function"&&typeof BigInt=="function"&&typeof rS(42)=="bigint"&&typeof BigInt(42)=="bigint"},B5=U5();if(B5){var z5=BigInt.prototype.valueOf,W5=function(e){try{return z5.call(e),!0}catch{}return!1};tv.exports=function(e){return e===null||typeof e>"u"||typeof e=="boolean"||typeof e=="string"||typeof e=="number"||typeof e=="symbol"||typeof e=="function"?!1:typeof e=="bigint"?!0:W5(e)}}else tv.exports=function(e){return!1};var G5=tv.exports,H5=LP,q5=b5,K5=O5,Q5=L5,Y5=G5,X5=function(e){if(e==null||typeof e!="object"&&typeof e!="function")return null;if(H5(e))return"String";if(q5(e))return"Number";if(K5(e))return"Boolean";if(Q5(e))return"Symbol";if(Y5(e))return"BigInt"},zf=typeof WeakMap=="function"&&WeakMap.prototype?WeakMap:null,iS=typeof WeakSet=="function"&&WeakSet.prototype?WeakSet:null,Wf;zf||(Wf=function(e){return!1});var nv=zf?zf.prototype.has:null,Qy=iS?iS.prototype.has:null;!Wf&&!nv&&(Wf=function(e){return!1});var J5=Wf||function(e){if(!e||typeof e!="object")return!1;try{if(nv.call(e,nv),Qy)try{Qy.call(e,Qy)}catch{return!0}return e instanceof zf}catch{}return!1},rv={exports:{}},Z5=Kr,gR=nr,e9=Z5("%WeakSet%",!0),Yy=gR("WeakSet.prototype.has",!0);if(Yy){var Xy=gR("WeakMap.prototype.has",!0);rv.exports=function(e){if(!e||typeof e!="object")return!1;try{if(Yy(e,Yy),Xy)try{Xy(e,Xy)}catch{return!0}return e instanceof e9}catch{}return!1}}else rv.exports=function(e){return!1};var t9=rv.exports,n9=BP,r9=WP,i9=J5,s9=t9,o9=function(e){if(e&&typeof e=="object"){if(n9(e))return"Map";if(r9(e))return"Set";if(i9(e))return"WeakMap";if(s9(e))return"WeakSet"}return!1},mR={exports:{}},a9="Function.prototype.bind called on incompatible ",l9=Object.prototype.toString,u9=Math.max,c9="[object Function]",sS=function(e,n){for(var r=[],i=0;i<e.length;i+=1)r[i]=e[i];for(var s=0;s<n.length;s+=1)r[s+e.length]=n[s];return r},h9=function(e,n){for(var r=[],i=n||0,s=0;i<e.length;i+=1,s+=1)r[s]=e[i];return r},f9=function(t,e){for(var n="",r=0;r<t.length;r+=1)n+=t[r],r+1<t.length&&(n+=e);return n},d9=function(e){var n=this;if(typeof n!="function"||l9.apply(n)!==c9)throw new TypeError(a9+n);for(var r=h9(arguments,1),i,s=function(){if(this instanceof i){var h=n.apply(this,sS(r,arguments));return Object(h)===h?h:this}return n.apply(e,sS(r,arguments))},o=u9(0,n.length-r.length),a=[],l=0;l<o;l++)a[l]="$"+l;if(i=Function("binder","return function ("+f9(a,",")+"){ return binder.apply(this,arguments); }")(s),n.prototype){var u=function(){};u.prototype=n.prototype,i.prototype=new u,u.prototype=null}return i},p9=d9,vR=Function.prototype.bind||p9,pe,Sa=SyntaxError,_R=Function,Xo=TypeError,Jy=function(t){try{return _R('"use strict"; return ('+t+").constructor;")()}catch{}},_s=Object.getOwnPropertyDescriptor;if(_s)try{_s({},"")}catch{_s=null}var Zy=function(){throw new Xo},y9=_s?function(){try{return arguments.callee,Zy}catch{try{return _s(arguments,"callee").get}catch{return Zy}}}():Zy,no=Bi(),g9=ep(),mt=Object.getPrototypeOf||(g9?function(t){return t.__proto__}:null),ho={},m9=typeof Uint8Array>"u"||!mt?pe:mt(Uint8Array),ws={"%AggregateError%":typeof AggregateError>"u"?pe:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?pe:ArrayBuffer,"%ArrayIteratorPrototype%":no&&mt?mt([][Symbol.iterator]()):pe,"%AsyncFromSyncIteratorPrototype%":pe,"%AsyncFunction%":ho,"%AsyncGenerator%":ho,"%AsyncGeneratorFunction%":ho,"%AsyncIteratorPrototype%":ho,"%Atomics%":typeof Atomics>"u"?pe:Atomics,"%BigInt%":typeof BigInt>"u"?pe:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?pe:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?pe:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?pe:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?pe:Float32Array,"%Float64Array%":typeof Float64Array>"u"?pe:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?pe:FinalizationRegistry,"%Function%":_R,"%GeneratorFunction%":ho,"%Int8Array%":typeof Int8Array>"u"?pe:Int8Array,"%Int16Array%":typeof Int16Array>"u"?pe:Int16Array,"%Int32Array%":typeof Int32Array>"u"?pe:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":no&&mt?mt(mt([][Symbol.iterator]())):pe,"%JSON%":typeof JSON=="object"?JSON:pe,"%Map%":typeof Map>"u"?pe:Map,"%MapIteratorPrototype%":typeof Map>"u"||!no||!mt?pe:mt(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?pe:Promise,"%Proxy%":typeof Proxy>"u"?pe:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?pe:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?pe:Set,"%SetIteratorPrototype%":typeof Set>"u"||!no||!mt?pe:mt(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?pe:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":no&&mt?mt(""[Symbol.iterator]()):pe,"%Symbol%":no?Symbol:pe,"%SyntaxError%":Sa,"%ThrowTypeError%":y9,"%TypedArray%":m9,"%TypeError%":Xo,"%Uint8Array%":typeof Uint8Array>"u"?pe:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?pe:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?pe:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?pe:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?pe:WeakMap,"%WeakRef%":typeof WeakRef>"u"?pe:WeakRef,"%WeakSet%":typeof WeakSet>"u"?pe:WeakSet};if(mt)try{null.error}catch(t){var v9=mt(mt(t));ws["%Error.prototype%"]=v9}var _9=function t(e){var n;if(e==="%AsyncFunction%")n=Jy("async function () {}");else if(e==="%GeneratorFunction%")n=Jy("function* () {}");else if(e==="%AsyncGeneratorFunction%")n=Jy("async function* () {}");else if(e==="%AsyncGenerator%"){var r=t("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if(e==="%AsyncIteratorPrototype%"){var i=t("%AsyncGenerator%");i&&mt&&(n=mt(i.prototype))}return ws[e]=n,n},oS={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},cc=vR,Gf=tp,w9=cc.call(Function.call,Array.prototype.concat),E9=cc.call(Function.apply,Array.prototype.splice),aS=cc.call(Function.call,String.prototype.replace),Hf=cc.call(Function.call,String.prototype.slice),x9=cc.call(Function.call,RegExp.prototype.exec),S9=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,A9=/\\(\\)?/g,T9=function(e){var n=Hf(e,0,1),r=Hf(e,-1);if(n==="%"&&r!=="%")throw new Sa("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&n!=="%")throw new Sa("invalid intrinsic syntax, expected opening `%`");var i=[];return aS(e,S9,function(s,o,a,l){i[i.length]=a?aS(l,A9,"$1"):o||s}),i},I9=function(e,n){var r=e,i;if(Gf(oS,r)&&(i=oS[r],r="%"+i[0]+"%"),Gf(ws,r)){var s=ws[r];if(s===ho&&(s=_9(r)),typeof s>"u"&&!n)throw new Xo("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:r,value:s}}throw new Sa("intrinsic "+e+" does not exist!")},wR=function(e,n){if(typeof e!="string"||e.length===0)throw new Xo("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof n!="boolean")throw new Xo('"allowMissing" argument must be a boolean');if(x9(/^%?[^%]*%?$/,e)===null)throw new Sa("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=T9(e),i=r.length>0?r[0]:"",s=I9("%"+i+"%",n),o=s.name,a=s.value,l=!1,u=s.alias;u&&(i=u[0],E9(r,w9([0,1],u)));for(var h=1,f=!0;h<r.length;h+=1){var d=r[h],p=Hf(d,0,1),g=Hf(d,-1);if((p==='"'||p==="'"||p==="`"||g==='"'||g==="'"||g==="`")&&p!==g)throw new Sa("property names with quotes must have matching quotes");if((d==="constructor"||!f)&&(l=!0),i+="."+d,o="%"+i+"%",Gf(ws,o))a=ws[o];else if(a!=null){if(!(d in a)){if(!n)throw new Xo("base intrinsic for "+e+" exists, but the property is not available.");return}if(_s&&h+1>=r.length){var v=_s(a,d);f=!!v,f&&"get"in v&&!("originalValue"in v.get)?a=v.get:a=a[d]}else f=Gf(a,d),a=a[d];f&&!l&&(ws[o]=a)}}return a};(function(t){var e=vR,n=wR,r=EP,i=n("%TypeError%"),s=n("%Function.prototype.apply%"),o=n("%Function.prototype.call%"),a=n("%Reflect.apply%",!0)||e.call(o,s),l=n("%Object.defineProperty%",!0),u=n("%Math.max%");if(l)try{l({},"a",{value:1})}catch{l=null}t.exports=function(d){if(typeof d!="function")throw new i("a function is required");var p=a(e,o,arguments);return r(p,1+u(0,d.length-(arguments.length-1)),!0)};var h=function(){return a(e,s,arguments)};l?l(t.exports,"apply",{value:h}):t.exports.apply=h})(mR);var ER=mR.exports,xR=wR,SR=ER,C9=SR(xR("String.prototype.indexOf")),b9=function(e,n){var r=xR(e,!!n);return typeof r=="function"&&C9(e,".prototype.")>-1?SR(r):r},qf=iR,P9=sR,lS=ER,F0=b9,Dh=rp,R9=F0("Object.prototype.toString"),AR=zi(),uS=typeof globalThis>"u"?jv:globalThis,iv=P9(),M0=F0("String.prototype.slice"),eg=Object.getPrototypeOf,k9=F0("Array.prototype.indexOf",!0)||function(e,n){for(var r=0;r<e.length;r+=1)if(e[r]===n)return r;return-1},Kf={__proto__:null};AR&&Dh&&eg?qf(iv,function(t){var e=new uS[t];if(Symbol.toStringTag in e){var n=eg(e),r=Dh(n,Symbol.toStringTag);if(!r){var i=eg(n);r=Dh(i,Symbol.toStringTag)}Kf["$"+t]=lS(r.get)}}):qf(iv,function(t){var e=new uS[t],n=e.slice||e.set;n&&(Kf["$"+t]=lS(n))});var N9=function(e){var n=!1;return qf(Kf,function(r,i){if(!n)try{"$"+r(e)===i&&(n=M0(i,1))}catch{}}),n},D9=function(e){var n=!1;return qf(Kf,function(r,i){if(!n)try{r(e),n=M0(i,1)}catch{}}),n},O9=function(e){if(!e||typeof e!="object")return!1;if(!AR){var n=M0(R9(e),8,-1);return k9(iv,n)>-1?n:n!=="Object"?!1:D9(e)}return Dh?N9(e):null},tg,cS;function j9(){if(cS)return tg;cS=1;var t=sc,e=nr,n=Kr,r=cR,i=n("ArrayBuffer",!0),s=n("Float32Array",!0),o=e("ArrayBuffer.prototype.byteLength",!0),a=i&&!o&&new i().slice,l=a&&t(a);return tg=o||l?function(h){if(!h||typeof h!="object")return!1;try{return o?o(h):l(h,0),!0}catch{return!1}}:s?function(h){try{return new s(h).buffer===h&&!r(h)}catch{return!1}}:function(h){return!1},tg}var $9=nr,hS=$9("ArrayBuffer.prototype.byteLength",!0),F9=j9(),M9=function(e){return F9(e)?hS?hS(e):e.byteLength:NaN},TR=L4,Tr=mU,fS=qU,V9=np,Aa=c6,L9=MP,dS=_6,pS=kP,yS=VP,gS=c5,mS=g5,vS=w5,_S=x5,wS=Xd,ES=X5,xS=o9,SS=O9,AS=M9,TS=Tr("SharedArrayBuffer.prototype.byteLength",!0),IS=Tr("Date.prototype.getTime"),ng=Object.getPrototypeOf,CS=Tr("Object.prototype.toString"),Qf=V9("%Set%",!0),sv=Tr("Map.prototype.has",!0),Yf=Tr("Map.prototype.get",!0),bS=Tr("Map.prototype.size",!0),Xf=Tr("Set.prototype.add",!0),IR=Tr("Set.prototype.delete",!0),Jf=Tr("Set.prototype.has",!0),Oh=Tr("Set.prototype.size",!0);function PS(t,e,n,r){for(var i=Aa(t),s;(s=i.next())&&!s.done;)if(Jn(e,s.value,n,r))return IR(t,s.value),!0;return!1}function CR(t){if(typeof t>"u")return null;if(typeof t!="object")return typeof t=="symbol"?!1:typeof t=="string"||typeof t=="number"?+t==+t:!0}function U9(t,e,n,r,i,s){var o=CR(n);if(o!=null)return o;var a=Yf(e,o),l=TR({},i,{strict:!1});return typeof a>"u"&&!sv(e,o)||!Jn(r,a,l,s)?!1:!sv(t,o)&&Jn(r,a,l,s)}function B9(t,e,n){var r=CR(n);return r??(Jf(e,r)&&!Jf(t,r))}function RS(t,e,n,r,i,s){for(var o=Aa(t),a,l;(a=o.next())&&!a.done;)if(l=a.value,Jn(n,l,i,s)&&Jn(r,Yf(e,l),i,s))return IR(t,l),!0;return!1}function Jn(t,e,n,r){var i=n||{};if(i.strict?dS(t,e):t===e)return!0;var s=ES(t),o=ES(e);if(s!==o)return!1;if(!t||!e||typeof t!="object"&&typeof e!="object")return i.strict?dS(t,e):t==e;var a=r.has(t),l=r.has(e),u;if(a&&l){if(r.get(t)===r.get(e))return!0}else u={};return a||r.set(t,u),l||r.set(e,u),G9(t,e,i,r)}function kS(t){return!t||typeof t!="object"||typeof t.length!="number"||typeof t.copy!="function"||typeof t.slice!="function"||t.length>0&&typeof t[0]!="number"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}function z9(t,e,n,r){if(Oh(t)!==Oh(e))return!1;for(var i=Aa(t),s=Aa(e),o,a,l;(o=i.next())&&!o.done;)if(o.value&&typeof o.value=="object")l||(l=new Qf),Xf(l,o.value);else if(!Jf(e,o.value)){if(n.strict||!B9(t,e,o.value))return!1;l||(l=new Qf),Xf(l,o.value)}if(l){for(;(a=s.next())&&!a.done;)if(a.value&&typeof a.value=="object"){if(!PS(l,a.value,n.strict,r))return!1}else if(!n.strict&&!Jf(t,a.value)&&!PS(l,a.value,n.strict,r))return!1;return Oh(l)===0}return!0}function W9(t,e,n,r){if(bS(t)!==bS(e))return!1;for(var i=Aa(t),s=Aa(e),o,a,l,u,h,f;(o=i.next())&&!o.done;)if(u=o.value[0],h=o.value[1],u&&typeof u=="object")l||(l=new Qf),Xf(l,u);else if(f=Yf(e,u),typeof f>"u"&&!sv(e,u)||!Jn(h,f,n,r)){if(n.strict||!U9(t,e,u,h,n,r))return!1;l||(l=new Qf),Xf(l,u)}if(l){for(;(a=s.next())&&!a.done;)if(u=a.value[0],f=a.value[1],u&&typeof u=="object"){if(!RS(l,t,u,f,n,r))return!1}else if(!n.strict&&(!t.has(u)||!Jn(Yf(t,u),f,n,r))&&!RS(l,t,u,f,TR({},n,{strict:!1}),r))return!1;return Oh(l)===0}return!0}function G9(t,e,n,r){var i,s;if(typeof t!=typeof e||t==null||e==null||CS(t)!==CS(e)||pS(t)!==pS(e))return!1;var o=yS(t),a=yS(e);if(o!==a)return!1;var l=t instanceof Error,u=e instanceof Error;if(l!==u||(l||u)&&(t.name!==e.name||t.message!==e.message))return!1;var h=vS(t),f=vS(e);if(h!==f||(h||f)&&(t.source!==e.source||fS(t)!==fS(e)))return!1;var d=mS(t),p=mS(e);if(d!==p||(d||p)&&IS(t)!==IS(e)||n.strict&&ng&&ng(t)!==ng(e))return!1;var g=SS(t),v=SS(e);if(g!==v)return!1;if(g||v){if(t.length!==e.length)return!1;for(i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}var E=kS(t),m=kS(e);if(E!==m)return!1;if(E||m){if(t.length!==e.length)return!1;for(i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}var y=gS(t),_=gS(e);if(y!==_)return!1;if(y||_)return AS(t)!==AS(e)?!1:typeof Uint8Array=="function"&&Jn(new Uint8Array(t),new Uint8Array(e),n,r);var S=_S(t),A=_S(e);if(S!==A)return!1;if(S||A)return TS(t)!==TS(e)?!1:typeof Uint8Array=="function"&&Jn(new Uint8Array(t),new Uint8Array(e),n,r);if(typeof t!=typeof e)return!1;var T=wS(t),I=wS(e);if(T.length!==I.length)return!1;for(T.sort(),I.sort(),i=T.length-1;i>=0;i--)if(T[i]!=I[i])return!1;for(i=T.length-1;i>=0;i--)if(s=T[i],!Jn(t[s],e[s],n,r))return!1;var b=xS(t),H=xS(e);return b!==H?!1:b==="Set"||H==="Set"?z9(t,e,n,r):b==="Map"?W9(t,e,n,r):!0}var H9=function(e,n,r){return Jn(e,n,r,L9())};const q9=iT(H9),K9=(t,e)=>q9(t,e);var Q9="firebase",Y9="10.5.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mr(Q9,Y9,"app");const X9={apiKey:"AIzaSyCa4jaiAOgH5H8B6hSo4DU49WnkpGPeavA",authDomain:"hkmjbs-streaming.firebaseapp.com",databaseURL:"https://hkmjbs-streaming-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"hkmjbs-streaming",storageBucket:"hkmjbs-streaming.appspot.com",messagingSenderId:"537815456325",appId:"1:537815456325:web:c387796326f9db2726a12c"},V0=NC(X9),fo=YL(V0);window.location.hostname==="localhost"&&eP(fo,"localhost",9e3);const bR={database:fo,get:t=>{const e=xl(fo,t);return Zb(e).then(n=>{if(n.exists())return n.val()}).catch(n=>{throw console.error(n),n})},set:(t,e)=>{const n=xl(fo,t);return E0(n,e).catch(r=>{throw console.error(r),r})},update:(t,e)=>{const n=xl(fo,t);return Jb(n,e).catch(r=>{throw console.error(r),r})},push:(t,e)=>{const n=xl(fo,t);return Xb(n,e).catch(r=>{throw console.error(r),r})}},L0=w.createContext(bR);function J9({children:t}){return c.jsx(L0.Provider,{value:bR,children:t})}const Z9=()=>w.useContext(L0),zr=(t,e)=>{const{database:n}=w.useContext(L0),r=w.useMemo(()=>xl(n,t),[n,t]),[i,s]=w.useState(),[o,a]=w.useState(e),l=w.useCallback(d=>E0(r,d),[r]),u=w.useCallback(d=>Jb(r,d),[r]),h=w.useCallback(d=>Xb(r,d),[r]);return w.useEffect(()=>{K9(e,o)||a(e)},[o,e]),w.useEffect(()=>{const d=[];o!=null&&o.order&&o.order.byChild&&d.push(VL(o.order.byChild)),o!=null&&o.filter&&(typeof o.filter.equalTo<"u"&&d.push(UL(o.filter.equalTo)),typeof o.filter.limitToLast<"u"&&d.push(FL(o.filter.limitToLast)));const p=d.length>0?BL(r,...d):r;o!=null&&o.onlyOnce?Zb(p).then(g=>{g.exists()&&s(g.val())}):DL(p,g=>{s(g.val())},o??{})},[o,r]),{data:w.useMemo(()=>i,[i]),set:l,update:u,push:h}};function PR(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=PR(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function e8(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=PR(t))&&(r&&(r+=" "),r+=e);return r}const NS=t=>typeof t=="boolean"?"".concat(t):t===0?"0":t,DS=e8,RR=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return DS(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:i,defaultVariants:s}=e,o=Object.keys(i).map(u=>{const h=n==null?void 0:n[u],f=s==null?void 0:s[u];if(h===null)return null;const d=NS(h)||NS(f);return i[u][d]}),a=n&&Object.entries(n).reduce((u,h)=>{let[f,d]=h;return d===void 0||(u[f]=d),u},{}),l=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((u,h)=>{let{class:f,className:d,...p}=h;return Object.entries(p).every(g=>{let[v,E]=g;return Array.isArray(E)?E.includes({...s,...a}[v]):{...s,...a}[v]===E})?[...u,f,d]:u},[]);return DS(t,o,l,n==null?void 0:n.class,n==null?void 0:n.className)},t8=RR(["font-semibold"],{variants:{variant:{contained:["border","rounded"],text:[],icon:["hover:enabled:bg-opacity-50 leading-4"]},color:{primary:[],secondary:[],success:[],danger:[],inverted:[]},size:{small:["text-sm"],medium:["text-base"],large:["text-md"],xlarge:["text-2xl"]},disabled:{true:["cursor-not-allowed opacity-30"]},loading:{true:["cursor-wait opacity-30"]}},compoundVariants:[{variant:"contained",size:"small",className:"py-1 px-2"},{variant:"contained",size:"medium",className:"py-2 px-4"},{variant:"contained",size:"large",className:"py-2 px-4"},{variant:"contained",size:"xlarge",className:"py-4 px-4"},{color:"primary",variant:"contained",className:"bg-teal-800 text-white border-transparent hover:enabled:bg-teal-700"},{color:"secondary",variant:"contained",className:"bg-white text-gray-800 border-gray-400 hover:enabled:bg-gray-100"},{color:"success",variant:"contained",className:"bg-green-100 text-green-500 border-green-400 hover:enabled:bg-green-200"},{color:"danger",variant:"contained",className:"bg-red-100 text-red-500 border-red-400 hover:enabled:bg-red-200"},{color:"primary",variant:"text",className:"text-teal-800 hover:enabled:text-teal-700"},{color:"secondary",variant:"text",className:"text-gray-800 hover:enabled:text-gray-700"},{color:"success",variant:"text",className:"text-green-800 hover:enabled:text-green-700"},{color:"danger",variant:"text",className:"text-red-800 hover:enabled:text-red-700"},{color:"inverted",variant:"text",className:"text-gray-100 hover:enabled:text-gray-0"},{color:"primary",variant:"icon",className:"text-teal-800 hover:enabled:text-teal-700 hover:enabled:bg-teal-100"},{color:"secondary",variant:"icon",className:"text-gray-800 hover:enabled:text-gray-700 hover:enabled:bg-gray-100"},{color:"success",variant:"icon",className:"text-green-800 hover:enabled:text-green-700 hover:enabled:bg-green-100"},{color:"danger",variant:"icon",className:"text-red-800 hover:enabled:text-red-700 hover:enabled:bg-red-100"},{color:"primary",size:"medium",className:"uppercase"}],defaultVariants:{color:"primary",size:"medium",variant:"contained"}});function De({color:t,size:e,variant:n,className:r,type:i="button",loading:s,...o}){const a=w.useMemo(()=>t8({color:t,size:e,variant:n,disabled:o.disabled,loading:s,className:r}),[t,e,n,o.disabled,s,r]);return c.jsx("button",{type:i,className:a,disabled:o.disabled||s,...o})}function n8(){return c.jsx("div",{className:"container mx-auto max-w-screen-sm ",children:c.jsxs("div",{className:"h-screen flex flex-col py-16 gap-y-12",children:[c.jsx("div",{className:"shrink-0",children:c.jsx("h1",{className:"text-5xl text-center",children:"日麻比賽直播系統 (牌藝攻防)"})}),c.jsx("div",{className:"text-center",children:c.jsx("img",{src:"/images/master-logo.jpeg",className:"w-48 mx-auto",alt:"HKMSCA"})}),c.jsxs("div",{className:"shrink-0 space-y-4",children:[c.jsx("div",{children:c.jsx("a",{href:"/create-match",children:c.jsx(De,{className:"w-full",size:"xlarge",children:"開新對局"})})}),c.jsx("div",{children:c.jsx("div",{className:"text-center",children:c.jsx("a",{href:"/obs/1",target:"_blank",children:c.jsx(De,{color:"secondary",size:"large",children:"直播頁面"})})})}),c.jsx("div",{className:"flex gap-x-4"})]})]})})}const r8=t=>{const e={};for(let n=0;n<t.length;n+=1)e[n.toString()]=t[n];return e},OS=t=>{if(t.length!==0)return t[t.length-1]},Ua=t=>{const{data:e,update:n}=zr(`/matches/${t}`),{data:r,update:i,push:s}=zr("matchRounds",{order:{byChild:"matchId"},filter:{equalTo:t}}),o=w.useMemo(()=>OS(Object.values(r??{}))??void 0,[r]),a=w.useMemo(()=>Object.values((o==null?void 0:o.doras)??{}),[o]),l=w.useCallback(p=>{const g=OS(Object.keys(r??{}));g&&i({[g]:{...o,...p}})},[o,r,i]),u=w.useCallback(p=>{l({doras:r8(p)})},[l]),h=w.useCallback(p=>{n({name:p})},[n]),f=w.useCallback(p=>{n({activeResultDetail:p})},[n]),d=w.useCallback(p=>{i({[p]:{...r==null?void 0:r[p],hasBroadcasted:!0}})},[r,i]);return{match:e,matchRounds:r,matchCurrentRound:o,matchCurrentRoundDoras:a,setMatchName:h,setMatchActiveResultDetail:f,setMatchRoundHasBroadcastedToTrue:d,setCurrentRoundDoras:u,updateCurrentMatchRound:l,pushMatchRound:s}};var Zn=(t=>(t[t.Unknown=0]="Unknown",t[t.Exhausted=-1]="Exhausted",t[t.Ron=1]="Ron",t[t.SelfDrawn=2]="SelfDrawn",t[t.Hotfix=-2]="Hotfix",t))(Zn||{}),ot=(t=>(t[t.Unknown=0]="Unknown",t[t.NextRound=1]="NextRound",t[t.Extended=2]="Extended",t[t.NextRoundAndExtended=3]="NextRoundAndExtended",t[t.Hotfix=-2]="Hotfix",t[t.End=-1]="End",t))(ot||{}),sn=(t=>(t[t.Win=1]="Win",t[t.Lose=-1]="Lose",t[t.None=0]="None",t))(sn||{}),ci=(t=>(t[t.East=0]="East",t[t.South=1]="South",t[t.West=2]="West",t[t.North=3]="North",t))(ci||{});let i8=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,n)=>(n&=63,n<36?e+=n.toString(36):n<62?e+=(n-26).toString(36).toUpperCase():n>62?e+="-":e+="_",e),"");const U0=(t=12)=>i8(t),s8=()=>{const t=new Date;return`${t.getFullYear()}${t.getMonth()+1}${t.getDate()}`},o8=t=>`https://api.qrserver.com/v1/create-qr-code/?size=512x512&data=${t}`,a8=t=>{let e=parseInt(t.substring(1,3),16),n=parseInt(t.substring(3,5),16),r=parseInt(t.substring(5,7),16);e=Math.round(e*1.5),n=Math.round(n*1.5),r=Math.round(r*1.5),e=e<255?e:255,n=n<255?n:255,r=r<255?r:255,e=Math.round(e),n=Math.round(n),r=Math.round(r);const i=e.toString(16).length===1?`0${e.toString(16)}`:e.toString(16),s=n.toString(16).length===1?`0${n.toString(16)}`:n.toString(16),o=r.toString(16).length===1?`0${r.toString(16)}`:r.toString(16);return`#${i}${s}${o}`},rg=t=>{switch(Math.floor((t-1)/4)){case 0:return"東";case 1:return"南";case 2:return"西";case 3:return"北"}return"東"},jS=(t,e)=>{switch((parseInt(e)-(t-1)%4+4)%4){case 0:return"東";case 1:return"南";case 2:return"西";case 3:return"北"}return"東"},ig=[ci.East,ci.South,ci.West,ci.North],$S=["0","1","2","3"],l8=t=>parseInt(t,10),sp=(t,e)=>ig[(4+l8(t)-(e-1)%ig.length)%ig.length],op=(t,e)=>sp(t,e)===ci.East,ro={"1h20f":{ne:200,e:400,ner:1e3,er:1500},"1h25f":{ne:200,e:400,ner:1e3,er:1500},"1h30f":{ne:300,e:500,ner:1e3,er:1500},"1h40f":{ne:400,e:700,ner:1300,er:2e3},"1h50f":{ne:400,e:800,ner:1600,er:2400},"1h60f":{ne:500,e:1e3,ner:2e3,er:2900},"1h70f":{ne:600,e:1200,ner:2300,er:3400},"1h80f":{ne:700,e:1300,ner:2600,er:3900},"1h90f":{ne:800,e:1500,ner:2900,er:4400},"1h100f":{ne:800,e:1600,ner:3200,er:4800},"1h110f":{ne:900,e:1800,ner:3600,er:5300},"2h20f":{ne:400,e:700,ner:1500,er:2100},"2h25f":{ne:400,e:800,ner:1600,er:2400},"2h30f":{ne:500,e:1e3,ner:2e3,er:2900},"2h40f":{ne:700,e:1300,ner:2600,er:3900},"2h50f":{ne:800,e:1600,ner:3200,er:4800},"2h60f":{ne:1e3,e:2e3,ner:3900,er:5800},"2h70f":{ne:1200,e:2300,ner:4500,er:6800},"2h80f":{ne:1300,e:2600,ner:5200,er:7700},"2h90f":{ne:1500,e:2900,ner:5800,er:8700},"2h100f":{ne:1600,e:3200,ner:6400,er:9600},"2h110f":{ne:1800,e:3600,ner:7100,er:10600},"3h20f":{ne:700,e:1300,ner:2600,er:3900},"3h25f":{ne:800,e:1600,ner:3200,er:4800},"3h30f":{ne:1e3,e:2e3,ner:3900,er:5800},"3h40f":{ne:1300,e:2600,ner:5200,er:7700},"3h50f":{ne:1600,e:3200,ner:6400,er:9600},"3h60f":{ne:2e3,e:3900,ner:7700,er:11600},"4h20f":{ne:1300,e:2600,ner:5200,er:7700},"4h25f":{ne:1600,e:3200,ner:6400,er:9600},"4h30f":{ne:2e3,e:3900,ner:7700,er:11600},"5h":{ne:2e3,e:4e3,ner:8e3,er:12e3},"6h":{ne:3e3,e:6e3,ner:12e3,er:18e3},"7h":{ne:3e3,e:6e3,ner:12e3,er:18e3},"8h":{ne:4e3,e:8e3,ner:16e3,er:24e3},"9h":{ne:4e3,e:8e3,ner:16e3,er:24e3},"10h":{ne:4e3,e:8e3,ner:16e3,er:24e3},"11h":{ne:6e3,e:12e3,ner:24e3,er:36e3},"12h":{ne:6e3,e:12e3,ner:24e3,er:36e3},"13h":{ne:8e3,e:16e3,ner:32e3,er:48e3}},u8=(t,e,n)=>{let r;const i=parseInt(t,10);if(Number.isNaN(i))throw new Error(`han "${t}" is NaN`);const s=parseInt(e,10);if(Number.isNaN(s))throw new Error(`fu "${e}" is NaN`);return i>=13?r=ro["13h"]:i>=5?r=ro[`${i}h`]:i>=4&&s>=(n!=null&&n.roundUp?30:40)||i>=3&&s>=(n!=null&&n.roundUp?60:70)?r=ro["5h"]:r=ro[`${i}h${s}f`],r||ro["1h30f"]},c8=(t,e,n,r,i)=>{const s=u8(t,e,i);return n?r?{win:s.er,target:s.er}:{win:s.e*3,all:s.e}:r?{win:s.ner,target:s.ner}:{win:s.e+2*s.ne,east:s.e,others:s.ne}},h8=t=>t.all||t.east?Zn.SelfDrawn:t.target?Zn.Ron:Zn.Unknown,FS=t=>$S[(t-1)%$S.length],f8=t=>({0:{beforeScore:t[0].afterScore,afterScore:t[0].afterScore,isRevealed:!1,isRiichi:!1,type:sn.None,scoreChanges:[],prevScoreChanges:t[0].scoreChanges??[]},1:{beforeScore:t[1].afterScore,afterScore:t[1].afterScore,isRevealed:!1,isRiichi:!1,type:sn.None,scoreChanges:[],prevScoreChanges:t[1].scoreChanges??[]},2:{beforeScore:t[2].afterScore,afterScore:t[2].afterScore,isRevealed:!1,isRiichi:!1,type:sn.None,scoreChanges:[],prevScoreChanges:t[2].scoreChanges??[]},3:{beforeScore:t[3].afterScore,afterScore:t[3].afterScore,isRevealed:!1,isRiichi:!1,type:sn.None,scoreChanges:[],prevScoreChanges:t[3].scoreChanges??[]}}),MS=t=>f8({0:t[0],1:t[1],2:t[2],3:t[3]}),d8=()=>`${s8()}-${U0(6)}`,ov=(t,e,n)=>`${t}-${e}.${n}`,p8={1:"東 1 局",2:"東 2 局",3:"東 3 局",4:"東 4 局",5:"南 1 局",6:"南 2 局",7:"南 3 局",8:"南 4 局",9:"西 1 局",10:"西 2 局",11:"西 3 局",12:"西 4 局",13:"北 1 局",14:"北 2 局",15:"北 3 局",16:"北 4 局"},kR=(t,e,n=8)=>{try{const r=p8[Math.min(t,n)];if(!r)throw new Error(`Unable to parse round=${t} in MJMatchCounterSpan`);return e&&e!==0?`${r}${e}本場`:r}catch(r){return console.error(r),`${t}.${e??0}`}};function dn({signed:t,className:e,positiveClassName:n,negativeClassName:r,value:i,animated:s,hideZero:o,title:a}){const[l,u]=w.useState(i),h=w.useRef(null),f=w.useCallback(g=>g===0?o?"":g.toLocaleString("en-US"):g>0?`${t?"+":""}${Math.floor(g).toLocaleString("en-US")}`:Math.floor(g).toLocaleString("en-US"),[o,t]),d=w.useMemo(()=>f(l),[f,l]),p=w.useMemo(()=>i>0?`${e??""} ${n??""}`:i<0?`${e??""} ${r??""}`:e,[e,r,n,i]);return w.useEffect(()=>{if(l!==i)if(s){for(let E=16;E<1e3;E+=16)setTimeout(()=>{h.current&&(h.current.innerText=Math.floor(l-(l-i)*(E/1e3)).toLocaleString("en-US"))},E);setTimeout(()=>{u(i)},1e3+16)}else u(i)},[s,l,i]),w.useEffect(()=>{h.current&&(h.current.innerText=d)},[d]),c.jsx("span",{title:a,ref:h,className:p})}const VS={"1m":"bg-[left_0%_top_0%]","2m":"bg-[left_10%_top_0%]","3m":"bg-[left_20%_top_0%]","4m":"bg-[left_30%_top_0%]","5m":"bg-[left_40%_top_0%]","6m":"bg-[left_50%_top_0%]","7m":"bg-[left_60%_top_0%]","8m":"bg-[left_70%_top_0%]","9m":"bg-[left_80%_top_0%]","0m":"bg-[left_30%_top_80%]","1p":"bg-[left_0%_top_20%]","2p":"bg-[left_10%_top_20%]","3p":"bg-[left_20%_top_20%]","4p":"bg-[left_30%_top_20%]","5p":"bg-[left_40%_top_20%]","6p":"bg-[left_50%_top_20%]","7p":"bg-[left_60%_top_20%]","8p":"bg-[left_70%_top_20%]","9p":"bg-[left_80%_top_20%]","0p":"bg-[left_40%_top_80%]","1s":"bg-[left_0%_top_40%]","2s":"bg-[left_10%_top_40%]","3s":"bg-[left_20%_top_40%]","4s":"bg-[left_30%_top_40%]","5s":"bg-[left_40%_top_40%]","6s":"bg-[left_50%_top_40%]","7s":"bg-[left_60%_top_40%]","8s":"bg-[left_70%_top_40%]","9s":"bg-[left_80%_top_40%]","0s":"bg-[left_50%_top_80%]","1z":"bg-[left_0%_top_60%]","2z":"bg-[left_10%_top_60%]","3z":"bg-[left_20%_top_60%]","4z":"bg-[left_30%_top_60%]","5z":"bg-[left_40%_top_60%]","6z":"bg-[left_50%_top_60%]","7z":"bg-[left_60%_top_60%]",default:"bg-[left_70%_top_60%]"};function hc({className:t,children:e,...n}){const r=w.useMemo(()=>VS[e==null?void 0:e.toString()]??VS.default,[e]);return c.jsx("div",{className:`mahjong-tile ${r} ${t}`,...n})}function Ds({player:t,playerIndex:e,score:n,scoreChanges:r=[],isEast:i,isRiichi:s,waitingTiles:o,onClickWaitingTiles:a,className:l,...u}){const[h,f]=w.useState(n),[d,p]=w.useState(void 0),g=w.useMemo(()=>a8(t.color??"#000000"),[t.color]),v=w.useMemo(()=>!!d,[d]);return w.useEffect(()=>{n!==h&&(p(r),setTimeout(()=>{f(n)},2550),setTimeout(()=>{p(void 0)},3e3))},[n,r,h]),c.jsxs("div",{className:"min-w-[5.35em] mx-auto [&_.hide-if-changing]:transition-opacity [&_.hide-if-changing]:data-[score-changing='1']:opacity-0","data-score-changing":v?"1":"0",children:[c.jsxs("div",{className:"flex items-end gap-x-[0.1em]",children:[c.jsxs("div",{className:"shrink-0 w-[1.75em] h-full relative -bottom-[0.075em] -left-[0.075em]",children:[c.jsx("div",{className:"absolute w-full h-full bg-[#d1b571] overflow-hidden rounded-[0.08em]",style:{opacity:s?1:0},children:c.jsx("div",{className:"origin-bottom w-[200%] h-[100%] bg-[#d1291d] animate-[riichi_8s_ease-in-out_infinite]"})}),c.jsx("div",{className:"relative z-10 w-full aspect-[90/125] p-[0.075em]",children:c.jsxs("div",{className:"w-full h-full bg-white rounded-[0.08em] overflow-hidden",style:{background:`linear-gradient(180deg, ${t.color}, ${g})`},children:[t.teamPicUrl&&c.jsx("div",{className:"absolute inset-[0.075em] overflow-hidden",children:c.jsx("img",{className:"absolute max-w-[none] h-[2.2em] w-[2.2em] opacity-30 animate-[scrollFromRightToLeft_12s_linear_infinite]",src:t.teamPicUrl,alt:t.name})}),t.proPicUrl&&c.jsx("img",{className:"relative z-10 w-full h-full rounded-[0.08em]",src:t.proPicUrl,alt:t.name})]})})]}),c.jsxs("div",{className:"flex-1 flex flex-col gap-y-[0.075em] items-start justify-end",children:[c.jsxs("div",{className:"bg-black bg-opacity-60 rounded text-[0.5em] flex gap-x-[0.2em] p-[0.1em] pr-[0.2em] opacity-0 transition-opacity data-[has-waiting-tiles='1']:opacity-100 hide-if-changing cursor-pointer","data-has-waiting-tiles":o&&o.length>0||a?"1":"0",onClick:a,"data-player-index":e,children:[c.jsx("div",{className:"flex-1 leading-none min-h-[1.19em] flex flex-wrap gap-[0.15em]",children:o==null?void 0:o.map(E=>c.jsx(hc,{className:"inline-block align-bottom w-[0.85em] animate-[fadeIn_1s_ease-in-out]",children:E},E))}),c.jsx("div",{className:"bg-[#DDDDDD] w-px"}),c.jsxs("div",{className:"text-[#DDDDDD] text-[0.35em] leading-[1.2em] flex items-center",children:["待",c.jsx("br",{}),"牌"]})]}),c.jsxs("div",{className:`relative w-full text-left bg-white px-[0.1em] py-[0.1em] pt-[0.08em] ${l}`,...u,style:{background:`linear-gradient(260deg, transparent, transparent 22px, ${g} 23px, ${t.color} 100%`},children:[c.jsxs("div",{className:"flex flex-col justify-center h-[0.6em] gap-y-[0.075em]",children:[c.jsx("div",{className:"text-[0.24em] ml-[0.1em] leading-none text-white hide-if-changing",children:t.title||"　"}),c.jsx("div",{className:"text-[0.24em] ml-[0.1em] leading-none text-white hide-if-changing",children:t.name})]}),d&&c.jsx("div",{className:"absolute bottom-[2.25em] pr-[0.125em] left-0 text-[0.70em] leading-none animate-[drop_3s_ease-in-out] font-numeric",children:d.map(E=>c.jsx("div",{children:c.jsx(dn,{signed:!0,value:E,positiveClassName:"text-green-400",negativeClassName:"text-red-400"})}))}),c.jsx("div",{className:"text-[0.70em] flex-1 leading-none text-white font-numeric mt-[0.05em]",children:c.jsx(dn,{animated:!0,value:h})})]})]})]}),c.jsx("div",{className:`mt-[0.2em] h-[0.075em] rounded-full ${i&&"bg-red-500"}`})]})}function $r({roundCount:t,extendedRoundCount:e,max:n=16,...r}){const i=w.useMemo(()=>kR(t,e??0,n),[t,n,e]);return c.jsx("span",{...r,children:i})}$r.defaultProps={extendedRoundCount:0};function ns({player:t,onClickEdit:e,children:n,...r}){const i=w.useCallback(()=>{e==null||e(t)},[e,t]);return c.jsxs("div",{className:"flex-1 flex items-center gap-x-2 rounded p-2 text-white",style:{background:t.color??"#115e59"},...r,children:[c.jsx("div",{className:"shrink-0",children:c.jsx("div",{className:"w-14 h-14 bg-center bg-contain bg-no-repeat rounded",style:{backgroundImage:`url(${t.proPicUrl||"/images/portrait-placeholder.jpeg"})`}})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{children:t.title??"(無頭銜)"}),c.jsx("div",{className:"text-2xl",children:t.name??"(無名稱)"})]}),e&&c.jsx("div",{className:"shrink-0",children:c.jsx(De,{variant:"icon",color:"inverted",type:"button",onClick:i,children:c.jsx("span",{className:"material-symbols-outlined",children:"edit"})})})]})}function th({value:t}){return c.jsx(dn,{value:t,positiveClassName:"text-green-600",negativeClassName:"text-red-600",signed:!0,hideZero:!0})}function ap({players:t,matchRounds:e,...n}){const r=w.useMemo(()=>Object.entries(e??{}),[e]);return c.jsxs("table",{...n,children:[c.jsx("thead",{children:c.jsxs("tr",{className:"border-b border-gray-400 [&>th]:p-2",children:[c.jsx("th",{children:"局數"}),c.jsx("th",{className:"w-min-[120px]",children:c.jsx(ns,{player:t[0]})}),c.jsx("th",{className:"w-min-[120px]",children:c.jsx(ns,{player:t[1]})}),c.jsx("th",{className:"w-min-[120px]",children:c.jsx(ns,{player:t[2]})}),c.jsx("th",{className:"w-min-[120px]",children:c.jsx(ns,{player:t[3]})})]})}),c.jsxs("tbody",{children:[r[0]&&c.jsxs("tr",{className:"even:bg-gray-200 [&>td]:p-2",children:[c.jsx("td",{className:"text-center"}),c.jsx("td",{className:"text-center",children:c.jsx(dn,{value:r[0][1].playerResults[0].beforeScore})}),c.jsx("td",{className:"text-center",children:c.jsx(dn,{value:r[0][1].playerResults[1].beforeScore})}),c.jsx("td",{className:"text-center",children:c.jsx(dn,{value:r[0][1].playerResults[2].beforeScore})}),c.jsx("td",{className:"text-center",children:c.jsx(dn,{value:r[0][1].playerResults[3].beforeScore})})]}),r.map(([i,s])=>s.resultType===Zn.Hotfix?c.jsxs("tr",{className:"even:bg-gray-200 [&>td]:p-2",children:[c.jsx("td",{className:"text-center",children:"手動調整"}),c.jsx("td",{className:"text-center",children:s.playerResults[0].afterScore}),c.jsx("td",{className:"text-center",children:s.playerResults[1].afterScore}),c.jsx("td",{className:"text-center",children:s.playerResults[2].afterScore}),c.jsx("td",{className:"text-center",children:s.playerResults[3].afterScore})]},i):c.jsxs("tr",{className:"even:bg-gray-200 [&>td]:p-2",children:[c.jsx("td",{className:"text-center",children:c.jsx($r,{roundCount:s.roundCount,extendedRoundCount:s.extendedRoundCount,max:8})}),c.jsx("td",{className:"text-center",children:c.jsx(th,{value:s.playerResults[0].afterScore-s.playerResults[0].beforeScore})}),c.jsx("td",{className:"text-center",children:c.jsx(th,{value:s.playerResults[1].afterScore-s.playerResults[1].beforeScore})}),c.jsx("td",{className:"text-center",children:c.jsx(th,{value:s.playerResults[2].afterScore-s.playerResults[2].beforeScore})}),c.jsx("td",{className:"text-center",children:c.jsx(th,{value:s.playerResults[3].afterScore-s.playerResults[3].beforeScore})})]},i)),r[r.length-1]&&c.jsxs("tr",{className:"even:bg-gray-200 [&>td]:p-2",children:[c.jsx("td",{className:"text-center"}),c.jsx("td",{className:"text-center font-bold text-lg",children:c.jsx(dn,{value:r[r.length-1][1].playerResults[0].afterScore})}),c.jsx("td",{className:"text-center font-bold text-lg",children:c.jsx(dn,{value:r[r.length-1][1].playerResults[1].afterScore})}),c.jsx("td",{className:"text-center font-bold text-lg",children:c.jsx(dn,{value:r[r.length-1][1].playerResults[2].afterScore})}),c.jsx("td",{className:"text-center font-bold text-lg",children:c.jsx(dn,{value:r[r.length-1][1].playerResults[3].afterScore})})]})]})]})}function y8({params:{matchId:t}}){const{match:e,matchRounds:n,matchCurrentRound:r,matchCurrentRoundDoras:i}=Ua(t);return!e||!r?c.jsx("div",{children:"對局讀取失敗。"}):c.jsx("div",{children:c.jsxs("div",{className:"container mx-auto my-8 px-8 space-y-6",children:[c.jsxs("div",{className:"flex flex-row items-stretch gap-x-4 text-white",children:[c.jsxs("div",{className:"shrink-0 rounded-[1rem] bg-black bg-opacity-50 p-2 flex items-stretch gap-x-4",children:[c.jsx("div",{className:"text-[2.5rem] leading-none border-[.25rem] rounded-[.75rem] pb-[0.3em] pt-[0.2em] px-4 border-current flex items-center justify-center",children:c.jsx($r,{roundCount:r.roundCount,max:8})}),c.jsxs("div",{className:"flex flex-col justify-around",children:[c.jsxs("div",{className:"flex-1 flex flex-row items-center gap-x-2",children:[c.jsx("div",{className:"flex-1",children:c.jsx("img",{src:"/images/score-hundred.png",alt:"hundred",className:"h-4"})}),c.jsx("div",{children:r.extendedRoundCount??0})]}),c.jsxs("div",{className:"flex-1 flex flex-row items-center gap-x-2",children:[c.jsx("div",{className:"flex-1",children:c.jsx("img",{src:"/images/score-thousand.png",alt:"thousand",className:"h-4"})}),c.jsx("div",{children:r.cumulatedThousands??0})]})]}),c.jsx("div",{className:"flex items-center gap-x-2",children:i.map((s,o)=>c.jsx(hc,{className:"w-9 cursor-pointer","data-index":o,children:s},s))})]}),c.jsx("div",{className:"flex-1"})]}),c.jsx("div",{className:"space-y-4",children:["0","1","2","3"].map(s=>c.jsx("div",{className:"flex gap-x-2 items-center",children:c.jsx("div",{className:"flex-1 text-[2.5rem]",children:c.jsx(Ds,{player:e.players[s],score:r.playerResults[s].beforeScore,scoreChanges:r.playerResults[s].prevScoreChanges,isEast:op(s,r.roundCount),isRiichi:r.playerResults[s].isRiichi})})}))}),c.jsx(ap,{players:e.players,matchRounds:n,className:"w-full table-auto"})]})})}function LS({className:t,children:e,...n}){return c.jsx("div",{className:`w-screen h-screen mx-auto py-8 ${t} overflow-hidden text-[4.8rem]`,style:{background:"linear-gradient(transparent, transparent 73%, rgba(0, 0, 0, 0.25))"},...n,children:e})}const US=`body { 
  background-color: rgba(0, 0, 0, 0); 
  color: rgba(0, 0, 0, 0); 
  margin: 0px auto; 
  overflow: hidden; 
}

.body-hidden {
  display: none;
}`;function g8({matchId:t}){const e=w.useMemo(()=>`${window.location.origin}/match/${t}/control`,[t]),n=w.useCallback(()=>{window.navigator.clipboard.writeText(US)},[]);return c.jsxs("div",{className:"flex items-center justify-center gap-x-8",children:[c.jsxs("div",{children:[c.jsx("p",{children:"1. 打開OBS"}),c.jsxs("p",{children:["2. 來源 ","->"," + ","->"," 瀏覽器，然後照下面設定"]}),c.jsxs("p",{children:["- 網址 = 此頁的網址 ",c.jsx("strong",{children:window.location.href}),c.jsx("br",{}),"- 寬度 = 1920, 高度 = 1080",c.jsx("br",{})," - 自訂CSS ="," ",c.jsxs("div",{className:"relative bg-gray-700 text-white p-4 rounded",children:[c.jsx("pre",{children:US}),c.jsx("div",{className:"absolute top-2 right-2",children:c.jsx("button",{type:"button",onClick:n,children:c.jsx("span",{className:"material-symbols-outlined",children:"content_copy"})})})]})]})]}),c.jsxs("div",{children:[c.jsx("p",{children:'3. 在管理後台點擊右上角的 "開始OBS" '}),c.jsx("p",{children:"4. 確定"})]}),c.jsx("div",{className:"shrink-0",children:c.jsxs("a",{href:e,target:"_blank",rel:"noreferrer",className:"text-center underline",children:[c.jsx("img",{className:"block w-32 h-32",src:o8(e),alt:""}),c.jsx("p",{children:"管理後台"})]})})]})}function m8({han:t,fu:e,...n}){const r=w.useMemo(()=>{if(t>=13)return"役滿";if(t>=11)return"三倍滿";if(t>=8)return"倍滿";if(t>=6)return"跳滿";if(t>=5)return"滿貫";if(t>=4&&typeof e<"u"&&e>=40)return"滿貫";if(t>=3&&typeof e<"u"&&e>=70)return"滿貫";if(typeof e<"u")return},[t,e]);return r?c.jsx("div",{...n,children:r}):c.jsxs("div",{...n,children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:t}),c.jsx("span",{children:"飜"})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:e}),c.jsx("span",{children:"符"})]})]})}function NR({params:{matchId:t}}){const{match:e,matchCurrentRound:n,matchCurrentRoundDoras:r}=Ua(t),i=w.useMemo(()=>!e||!n?[]:["0","1","2","3"].map(s=>({...e.players[s],color:e.players[s].color,currentStatus:{...n.playerResults[s],isEast:op(s,n.roundCount)}})),[e,n]);return!e||!n?c.jsx(LS,{children:c.jsx("div",{className:"text-current",children:"對局讀取失敗。"})}):c.jsxs(LS,{children:[c.jsxs("div",{className:"flex flex-row items-stretch gap-x-4 text-white",children:[c.jsxs("div",{className:"text-[0.6em] p-2 pl-10 pr-[1em] flex items-center gap-x-8 transition-[width]",style:{background:"linear-gradient(280deg, transparent, transparent 0.5em, #00000080 0.5em, #00000080 100%)"},children:[c.jsxs("div",{className:"",children:[c.jsx("div",{className:"text-[0.5em]",children:e.name}),c.jsxs("div",{className:"flex gap-x-8 items-center",children:[c.jsx("div",{className:"min-w-[3.5em]",children:c.jsx($r,{roundCount:n.roundCount,max:8})}),c.jsxs("div",{className:"flex flex-col justify-around gap-2",children:[c.jsxs("div",{className:"flex-1 flex flex-row items-center gap-x-3",children:[c.jsx("div",{className:"flex-1",children:c.jsx("img",{src:"/images/score-hundred.png",alt:"hundred",className:"h-[0.25em] mt-[0.1em]"})}),c.jsx("div",{className:"text-[0.45em] leading-none",children:n.extendedRoundCount??0})]}),c.jsxs("div",{className:"flex-1 flex flex-row items-center gap-x-3",children:[c.jsx("div",{className:"flex-1",children:c.jsx("img",{src:"/images/score-thousand.png",alt:"thousand",className:"h-[0.25em] mt-[0.1em]"})}),c.jsx("div",{className:"text-[0.45em] leading-none",children:n.cumulatedThousands??0})]})]})]})]}),c.jsx("div",{className:"flex items-center gap-x-2",children:r.map(s=>c.jsx(hc,{className:"w-[1.4em] animate-[fadeIn_0.5s_ease-in-out]",children:s},s))})]}),c.jsx("div",{className:"flex-1"})]}),c.jsx("div",{className:"flex items-center justify-center mt-20",children:c.jsx("div",{className:"body-hidden mx-20 text-[16px]",children:c.jsx(g8,{matchId:t})})}),c.jsx("div",{className:"fixed bottom-0 left-0 right-0 px-10 pb-6 grid grid-cols-4 items-end gap-x-8 text-white transition-opacity animate-[fadeInFromBottom_1s_ease-in-out]",style:{opacity:e.activeResultDetail?0:"inherit"},children:i.map(s=>c.jsx("div",{className:"w-[5.35em]",children:c.jsx(Ds,{player:s,score:s.currentStatus.afterScore,scoreChanges:s.currentStatus.scoreChanges,isEast:s.currentStatus.isEast,isRiichi:s.currentStatus.isRiichi,waitingTiles:s.currentStatus.waitingTiles})},s.name))}),e.activeResultDetail&&c.jsxs("div",{className:"fixed bottom-0 left-0 right-0 px-10 pb-6 grid grid-cols-4 gap-x-8 text-white transition-opacity animate-[fadeInFromBottom_1s_ease-in-out]",children:[c.jsx("div",{className:"w-[5.35em]",children:c.jsx(Ds,{player:e.players[e.activeResultDetail.winnerPlayerIndex],score:n.playerResults[e.activeResultDetail.winnerPlayerIndex].afterScore})}),c.jsxs("div",{className:"col-span-3 bg-black bg-opacity-50 py-6 px-8 text-[0.5em] flex items-stretch gap-x-4",children:[c.jsx("div",{className:`flex-1 flex flex-wrap gap-x-[0.75em] ${e.activeResultDetail.isYakuman?"self-center justify-center":""}`,children:e.activeResultDetail.yakusInText.map(s=>c.jsx("span",{children:s},s))}),c.jsx("div",{className:"shrink-0 w-px bg-neutral-200"}),c.jsx("div",{className:"shrink-0 min-w-[3em] self-center text-green-400 text-[1.4em] text-center",children:c.jsx(m8,{han:Math.min(e.activeResultDetail.isYakuman?13:12,e.activeResultDetail.han),fu:e.activeResultDetail.fu})})]})]})]})}function wr({open:t,title:e,children:n,onClose:r,hideCloseButton:i}){const s=w.useRef(null);w.useEffect(()=>{if(s!=null&&s.current&&t){s.current.showModal();const{current:a}=s;return()=>{a.close()}}},[t]);const o=w.useCallback(()=>{r==null||r()},[r]);return c.jsx("dialog",{ref:s,onClose:o,children:c.jsxs("div",{className:"p-6",children:[c.jsxs("div",{className:"flex mb-4",children:[c.jsx("div",{className:"flex-1 items-center font-bold text-lg",children:e}),!i&&c.jsx("div",{className:"shrink-0",children:c.jsx("button",{type:"button",className:"absolute top-4 right-4",onClick:o,children:c.jsx("span",{className:"material-symbols-outlined",children:"close"})})})]}),n]})})}function v8({title:t,children:e,okButtonText:n="確認",cancelButtonText:r="取消",onClickOk:i,onClickCancel:s,...o}){const[a,l]=w.useState(!1),u=w.useCallback(()=>{i&&(l(!0),i().finally(()=>{l(!1)}))},[i]);return c.jsxs(wr,{title:t,...o,children:[c.jsx("div",{className:"mb-4",children:e}),c.jsxs("div",{className:"flex gap-x-4",children:[c.jsx("div",{className:"flex-1",children:c.jsx(De,{type:"button",color:"secondary",className:"w-full",onClick:s,disabled:a,children:r})}),c.jsx("div",{className:"flex-1",children:c.jsx(De,{type:"button",color:"danger",className:"w-full",onClick:u,disabled:a,children:a?c.jsx("span",{className:"material-symbols-outlined animate-spin leading-none",children:"horizontal_rule"}):n})})]})]})}const _8={isShowConfirmDialog:!1,setIsShowConfirmDialog:()=>{},confirmDialogOptions:{title:"警告"},setConfirmDialogOptions:()=>{}},DR=w.createContext(_8);function w8({children:t}){const[e,n]=w.useState(!1),[r,i]=w.useState({title:"警告"}),s=w.useMemo(()=>({isShowConfirmDialog:e,setIsShowConfirmDialog:n,confirmDialogOptions:r,setConfirmDialogOptions:i}),[r,e]),o=w.useCallback(()=>{n(!1)},[]);return c.jsxs(DR.Provider,{value:s,children:[t,c.jsx(v8,{open:e,okButtonText:r.okButtonText,cancelButtonText:r.cancelButtonText,onClickOk:r.onClickOk,onClickCancel:r.onClickCancel,onClose:o,...r,hideCloseButton:!0,children:r.content})]})}const E8=()=>{const t=w.useContext(DR);return{showConfirmDialog:w.useCallback(n=>{const r=async()=>(n.onClickOk??(async()=>Promise.resolve()))().then(()=>{t.setIsShowConfirmDialog(!1)}),i=async()=>(n.onClickCancel??(async()=>Promise.resolve()))().then(()=>{t.setIsShowConfirmDialog(!1)});t.setConfirmDialogOptions({...n,onClickOk:r,onClickCancel:i}),t.setIsShowConfirmDialog(!0)},[t])}};function ko({className:t,onChange:e,onChangeValue:n,...r}){const i=w.useMemo(()=>`block w-full rounded-md border-0 px-1 py-[9px] text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6 ${t}`,[t]),s=w.useCallback(o=>{e==null||e(o),n==null||n(o.currentTarget.value)},[e,n]);return c.jsx("select",{className:i,onChange:s,...r})}function x8({score:t,...e}){const n=w.useMemo(()=>t?t.target?t.target:t.all?`${t.all} ALL`:`${t.others},${t.east}`:"(錯誤)",[t]);return c.jsx("div",{...e,children:n})}var Zf=function(){return Zf=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Zf.apply(this,arguments)};function OR(){var t=w.useRef(!1),e=w.useCallback(function(){return t.current},[]);return w.useEffect(function(){return t.current=!0,function(){t.current=!1}},[]),e}function lp(t,e,n){e===void 0&&(e=[]),n===void 0&&(n={loading:!1});var r=w.useRef(0),i=OR(),s=w.useState(n),o=s[0],a=s[1],l=w.useCallback(function(){for(var u=[],h=0;h<arguments.length;h++)u[h]=arguments[h];var f=++r.current;return o.loading||a(function(d){return Zf(Zf({},d),{loading:!0})}),t.apply(void 0,u).then(function(d){return i()&&f===r.current&&a({value:d,loading:!1}),d},function(d){return i()&&f===r.current&&a({error:d,loading:!1}),d})},e);return[o,l]}function S8(t,e){e===void 0&&(e=[]);var n=lp(t,e,{loading:!0}),r=n[0],i=n[1];return w.useEffect(function(){i()},[i]),r}var sg=function(){},A8=function(t,e){return typeof e=="boolean"?e:!t},T8=function(t){return w.useReducer(A8,t)};const Ci=T8;var I8=function(t,e){return function(n,r){var i=n.getData("text/uri-list");if(i){(t.onUri||sg)(i,r);return}if(n.files&&n.files.length){(t.onFiles||sg)(Array.from(n.files),r);return}n.items&&n.items.length&&n.items[0].getAsString(function(s){e&&(t.onText||sg)(s,r)})}},C8=function(t,e){return{onDragOver:function(n){n.preventDefault()},onDragEnter:function(n){n.preventDefault(),e(!0)},onDragLeave:function(){e(!1)},onDrop:function(n){n.preventDefault(),n.persist(),e(!1),t(n.dataTransfer,n)},onPaste:function(n){n.persist(),t(n.clipboardData,n)}}},b8=function(t){t===void 0&&(t={});var e=t.onFiles,n=t.onText,r=t.onUri,i=OR(),s=w.useState(!1),o=s[0],a=s[1],l=w.useMemo(function(){return I8(t,i())},[e,n,r]),u=w.useMemo(function(){return C8(l,a)},[l,a]);return[u,{over:o}]};const P8=b8;function jR({onChange:t,onChangeChecked:e,className:n,...r}){const i=w.useCallback(s=>{t==null||t(s),e==null||e(s.currentTarget.checked)},[t,e]);return c.jsx("input",{className:"mt-[0.3rem] mr-2 h-3.5 w-8 appearance-none rounded-[0.4375rem] bg-neutral-300 dark:bg-neutral-600 before:pointer-events-none before:absolute before:h-3.5 before:w-3.5 before:rounded-full before:bg-transparent before:content-[''] after:absolute after:z-[2] after:-mt-[0.1875rem] after:h-5 after:w-5 after:rounded-full after:border-none after:bg-neutral-100 dark:after:bg-neutral-400 after:shadow-[0_0px_3px_0_rgb(0_0_0_/_7%),_0_2px_2px_0_rgb(0_0_0_/_4%)] after:transition-[background-color_0.2s,transform_0.2s] after:content-[''] checked:bg-blue-600 dark:checked:bg-blue-600 checked:after:absolute checked:after:z-[2] checked:after:-mt-[3px] checked:after:ml-[1.0625rem] checked:after:h-5 checked:after:w-5 checked:after:rounded-full checked:after:border-none checked:after:bg-blue-600 dark:checked:after:bg-blue-600 checked:after:shadow-[0_3px_1px_-2px_rgba(0,0,0,0.2),_0_2px_2px_0_rgba(0,0,0,0.14),_0_1px_5px_0_rgba(0,0,0,0.12)] checked:after:transition-[background-color_0.2s,transform_0.2s] checked:after:content-[''] hover:cursor-pointer focus:before:scale-100 focus:before:opacity-[0.12] focus:before:shadow-[3px_-1px_0px_13px_rgba(0,0,0,0.6)] focus:before:transition-[box-shadow_0.2s,transform_0.2s] focus:after:absolute focus:after:z-[1] focus:after:block focus:after:h-5 focus:after:w-5 focus:after:rounded-full focus:after:content-[''] checked:focus:border-blue-600 checked:focus:bg-blue-600 checked:focus:before:ml-[1.0625rem] checked:focus:before:scale-100 checked:focus:before:shadow-[3px_-1px_0px_13px_#3b71ca] checked:focus:before:transition-[box-shadow_0.2s,transform_0.2s]",type:"checkbox",role:"switch",id:"flexSwitchCheckDefault",onChange:i,...r})}function av({han:t,fu:e,raw:n,isManganRoundUp:r,...i}){const s=w.useMemo(()=>n?typeof e<"u"&&t<=4?`${t}飜${e}符`:`${t}飜`:t>=13?"役滿":t>=11?"三倍滿":t>=8?"倍滿":t>=6?"跳滿":t>=5||t>=4&&typeof e<"u"&&(e>=40||r&&e>=30)||t>=3&&typeof e<"u"&&(e>=70||r&&e>=60)?"滿貫":typeof e<"u"?`${t}飜${e}符`:`${t}飜`,[n,t,e,r]);return c.jsx("div",{...i,children:s})}const Xi=[{id:"riichi",label:"立直",han:1,hanIfOpened:0},{id:"ippatsu",label:"一發",han:1,hanIfOpened:0},{id:"menzenchin-tsumohou",label:"門前清自摸和",han:1,hanIfOpened:0},{id:"pinfu",label:"平和",han:1,hanIfOpened:0},{id:"iipeikou",label:"一盃口",han:1,hanIfOpened:0},{id:"haitei-raoyue",label:"海底撈月",han:1,hanIfOpened:1},{id:"houtei-raoyui",label:"河底撈魚",han:1,hanIfOpened:1},{id:"rinshan-kaihou",label:"嶺上開花",han:1,hanIfOpened:1},{id:"chankan",label:"搶槓",han:1,hanIfOpened:1},{id:"tanyao",label:"斷么九",han:1,hanIfOpened:1},{id:"yakuhai-match-kazehai",label:"場風",han:1,hanIfOpened:1},{id:"yakuhai-self-kazehai",label:"自風",han:1,hanIfOpened:1},{id:"yakuhai-double-kazehai",label:"雙風",han:2,hanIfOpened:2,hidden:!0},{id:"yakuhai-chun",label:"中",han:1,hanIfOpened:1},{id:"yakuhai-haku",label:"白",han:1,hanIfOpened:1},{id:"yakuhai-hatsu",label:"發",han:1,hanIfOpened:1},{id:"double-riichi",label:"雙立直",han:2,hanIfOpened:0},{id:"chantaiyao",label:"全帶么九",han:2,hanIfOpened:1},{id:"sanshoku-doujun",label:"三色同順",han:2,hanIfOpened:1},{id:"ittsu",label:"一氣通貫",han:2,hanIfOpened:1},{id:"toitoi",label:"對對和",han:2,hanIfOpened:2},{id:"sanankou",label:"三暗刻",han:2,hanIfOpened:2},{id:"sanshku-doukou",label:"三色同刻",han:2,hanIfOpened:2},{id:"sankantsu",label:"三槓子",han:2,hanIfOpened:2},{id:"chiitoitsu",label:"七對子",han:2,hanIfOpened:0,overrideFu:25},{id:"honroutou",label:"混老頭",han:2,hanIfOpened:2},{id:"shousangen",label:"小三元",han:2,hanIfOpened:2},{id:"honitsu",label:"混一色",han:3,hanIfOpened:2},{id:"junchan-taiyao",label:"純全帶么",han:3,hanIfOpened:2},{id:"ryanpeikou",label:"二盃口",han:3,hanIfOpened:0},{id:"chinitsu",label:"清一色",han:6,hanIfOpened:5},{id:"kazoe-yakuman",label:"累計役滿",han:13,hanIfOpened:13},{id:"kokushi-musou",label:"國士無雙",han:13,hanIfOpened:0},{id:"suuankou",label:"四暗刻",han:13,hanIfOpened:0},{id:"daisangen",label:"大三元",han:13,hanIfOpened:13},{id:"shousuushii",label:"小四喜",han:13,hanIfOpened:13},{id:"daisuushii",label:"大四喜",han:13,hanIfOpened:13},{id:"tsuuiisou",label:"字一色",han:13,hanIfOpened:13},{id:"chinroutou",label:"清老頭",han:13,hanIfOpened:13},{id:"ryuuiisou",label:"綠一色",han:13,hanIfOpened:13},{id:"chuuren-poutou",label:"九連寶燈",han:13,hanIfOpened:0},{id:"suukantsu",label:"四槓子",han:13,hanIfOpened:13},{id:"tenhou",label:"天和",han:13,hanIfOpened:0},{id:"chiihou",label:"地和",han:13,hanIfOpened:0}],cl={1:Xi.filter(({han:t,hidden:e})=>t===1&&!e),2:Xi.filter(({han:t,hidden:e})=>t===2&&!e),3:Xi.filter(({han:t,hidden:e})=>t===3&&!e),6:Xi.filter(({han:t,hidden:e})=>t===6&&!e),13:Xi.filter(({han:t,hidden:e})=>t===13&&!e)},hl=({yaku:t,active:e,isOpened:n,disabled:r,onClick:i})=>c.jsx("button",{"data-id":t.id,"data-han":n?t.hanIfOpened:t.han,"data-active":e?"1":"0",disabled:r,className:"text-center px-3 rounded-full border border-neutral-200 text-neutral-400 cursor-pointer hover:opacity-80 data-[han='0']:cursor-not-allowed disabled:opacity-30 disabled:hover:opacity-30 data-[active='1']:enabled:border-teal-500 data-[active='1']:enabled:text-teal-600 data-[active='1']:enabled:bg-teal-100",onClick:i,children:t.label},t.id),R8=({round:t,activePlayerIndex:e,isEast:n,isRon:r,setting:i,onChange:s})=>{const[o,a]=w.useState({}),[l,u]=Ci(!1),[h,f]=Ci(!1),[d,p]=w.useState("0"),[g,v]=w.useState("0"),[E,m]=w.useState("0"),[y,_]=w.useState("30"),S=w.useCallback(I=>{const b=I.currentTarget.getAttribute("data-id");!b||!Xi.find(({id:M})=>M===b)||a(M=>({...M,[b]:!M[b]}))},[]),A=w.useCallback(()=>{a({}),u(!1),p("0"),v("0"),m("0"),_("30")},[u]),T=w.useMemo(()=>{let I=0,b=parseInt(y),H=!1;const M=[],se={...o};se["yakuhai-match-kazehai"]&&se["yakuhai-self-kazehai"]&&rg(t)===jS(t,e)&&(se["yakuhai-double-kazehai"]=!0,se["yakuhai-match-kazehai"]=!1,se["yakuhai-self-kazehai"]=!1);const Z=Xi.filter(({id:U})=>!!se[U]);for(const U of Z){const ce=l?U.hanIfOpened:U.han;ce!==0&&(h&&ce<13||!h&&ce>=13||(I+=ce,typeof U.overrideFu<"u"&&(b=U.overrideFu,H=!0),U.id==="yakuhai-match-kazehai"?M.push(rg(t)):U.id==="yakuhai-self-kazehai"?M.push(jS(t,e)):U.id==="yakuhai-double-kazehai"?M.push(`雙${rg(t)}`):M.push(U.label)))}return d!=="0"&&(I+=parseInt(d),M.push(`寶牌${d}`)),g!=="0"&&(I+=parseInt(g),M.push(`赤寶牌${g}`)),E!=="0"&&(I+=parseInt(E),M.push(`裡寶牌${E}`)),{yakusInText:M,han:I,fu:b,isFuOverrided:H,isYakuman:h}},[l,t,e,o,d,g,E,y,h]);return w.useEffect(()=>{s&&s(T)},[T,s,n,r]),c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsxs("div",{children:[c.jsx(jR,{checked:l,onChangeChecked:u})," ","有副露？"]}),c.jsxs("div",{className:"space-x-4",children:[c.jsx("button",{className:"text-sm text-teal-700 underline",onClick:f,children:h?"一般役":"役滿役"}),c.jsx("button",{className:"text-sm text-teal-700 underline",onClick:A,children:"重置"})]})]}),!h&&c.jsxs("div",{children:[c.jsx("table",{children:c.jsxs("tbody",{children:[c.jsxs("tr",{children:[c.jsx("th",{className:"bg-neutral-100 px-1 border-neutral-100 border-t border-b",children:"1番"}),c.jsx("td",{className:"py-1 pl-2 border-neutral-100 border-t border-b",colSpan:3,children:c.jsx("div",{className:"flex flex-wrap gap-1",children:cl[1].map(I=>c.jsx(hl,{yaku:I,isOpened:l,active:o[I.id],disabled:l&&I.hanIfOpened===0,onClick:S,children:I.label},I.id))})})]}),c.jsxs("tr",{children:[c.jsx("th",{className:"bg-neutral-100 px-1 border-neutral-100 border-t border-b",children:"2番"}),c.jsx("td",{className:"py-1 pl-2 border-neutral-100 border-t border-b",colSpan:3,children:c.jsx("div",{className:"flex flex-wrap gap-1",children:cl[2].map(I=>c.jsx(hl,{yaku:I,isOpened:l,active:o[I.id],disabled:l&&I.hanIfOpened===0,onClick:S,children:I.label},I.id))})})]}),c.jsxs("tr",{children:[c.jsx("th",{className:"bg-neutral-100 px-1 border-neutral-100 border-t border-b",children:"3番"}),c.jsx("td",{className:"py-1 pl-2 border-neutral-100 border-t border-b w-1/2",children:c.jsx("div",{className:"flex flex-wrap gap-1",children:cl[3].map(I=>c.jsx(hl,{yaku:I,isOpened:l,active:o[I.id],disabled:l&&I.hanIfOpened===0,onClick:S,children:I.label},I.id))})}),c.jsx("th",{className:"bg-neutral-100 px-1 border-neutral-100 border-t border-b",children:"6番"}),c.jsx("td",{className:"py-1 pl-2 border-neutral-100 border-t border-b w-1/2",children:c.jsx("div",{className:"flex flex-wrap gap-1",children:cl[6].map(I=>c.jsx(hl,{yaku:I,isOpened:l,active:o[I.id],disabled:l&&I.hanIfOpened===0,onClick:S,children:I.label},I.id))})})]})]})}),c.jsx("table",{className:"w-full mt-2",children:c.jsxs("tbody",{children:[c.jsx("th",{className:"w-16 bg-neutral-200 px-1 border-neutral-100 border-t border-b",children:"寶牌"}),c.jsx("td",{className:"w-auto pr-4",children:c.jsxs("select",{className:"w-full py-2 border border-neutral-100",value:d,onChange:I=>p(I.currentTarget.value),children:[c.jsx("option",{children:"0"}),c.jsx("option",{children:"1"}),c.jsx("option",{children:"2"}),c.jsx("option",{children:"3"}),c.jsx("option",{children:"4"}),c.jsx("option",{children:"5"}),c.jsx("option",{children:"6"}),c.jsx("option",{children:"7"}),c.jsx("option",{children:"8"}),c.jsx("option",{children:"9"}),c.jsx("option",{children:"10"}),c.jsx("option",{children:"11"}),c.jsx("option",{children:"12"}),c.jsx("option",{children:"13"}),c.jsx("option",{children:"14"}),c.jsx("option",{children:"15"}),c.jsx("option",{children:"16"}),c.jsx("option",{children:"17"}),c.jsx("option",{children:"18"})]})}),c.jsx("th",{className:"w-16 bg-neutral-200 px-1 border-neutral-100 border-t border-b",children:"赤寶牌"}),c.jsx("td",{className:"w-auto pr-4",children:c.jsxs("select",{className:"w-full py-2 border border-neutral-100",value:g,onChange:I=>v(I.currentTarget.value),children:[c.jsx("option",{children:"0"}),c.jsx("option",{children:"1"}),c.jsx("option",{children:"2"}),c.jsx("option",{children:"3"}),c.jsx("option",{children:"4"}),c.jsx("option",{children:"5"}),c.jsx("option",{children:"6"}),c.jsx("option",{children:"7"}),c.jsx("option",{children:"8"}),c.jsx("option",{children:"9"}),c.jsx("option",{children:"10"}),c.jsx("option",{children:"11"}),c.jsx("option",{children:"12"}),c.jsx("option",{children:"13"}),c.jsx("option",{children:"14"}),c.jsx("option",{children:"15"}),c.jsx("option",{children:"16"}),c.jsx("option",{children:"17"}),c.jsx("option",{children:"18"})]})}),c.jsx("th",{className:"w-16 bg-neutral-200 px-1 border-neutral-100 border-t border-b",children:"裡寶牌"}),c.jsx("td",{className:"w-auto pr-4",children:c.jsxs("select",{className:"w-full py-2 border border-neutral-100",value:E,onChange:I=>m(I.currentTarget.value),children:[c.jsx("option",{children:"0"}),c.jsx("option",{children:"1"}),c.jsx("option",{children:"2"}),c.jsx("option",{children:"3"}),c.jsx("option",{children:"4"}),c.jsx("option",{children:"5"}),c.jsx("option",{children:"6"}),c.jsx("option",{children:"7"}),c.jsx("option",{children:"8"}),c.jsx("option",{children:"9"}),c.jsx("option",{children:"10"}),c.jsx("option",{children:"11"}),c.jsx("option",{children:"12"}),c.jsx("option",{children:"13"}),c.jsx("option",{children:"14"}),c.jsx("option",{children:"15"}),c.jsx("option",{children:"16"}),c.jsx("option",{children:"17"}),c.jsx("option",{children:"18"})]})}),c.jsx("th",{className:"w-16 bg-neutral-200 px-1 border-neutral-100 border-t border-b",children:"符數"}),c.jsx("td",{className:"w-auto pr-4",children:c.jsxs("select",{className:"w-full py-2 border border-neutral-100",value:T.isFuOverrided?T.fu:y,onChange:I=>_(I.currentTarget.value),disabled:T.isFuOverrided,children:[c.jsx("option",{value:"20",children:"20符"}),c.jsx("option",{value:"25",children:"25符"}),c.jsx("option",{value:"30",children:"30符"}),c.jsx("option",{value:"40",children:"40符"}),c.jsx("option",{value:"50",children:"50符"}),c.jsx("option",{value:"60",children:"60符"}),c.jsx("option",{value:"70",children:"70符"}),c.jsx("option",{value:"80",children:"80符"}),c.jsx("option",{value:"90",children:"90符"}),c.jsx("option",{value:"100",children:"100符"}),c.jsx("option",{value:"110",children:"110符"})]})})]})})]}),h&&c.jsx("div",{children:c.jsx("table",{children:c.jsx("tbody",{children:c.jsxs("tr",{children:[c.jsx("th",{className:"bg-neutral-100 px-1 border-neutral-100 border-t border-b",children:"役滿"}),c.jsx("td",{className:"py-1 pl-2 border-neutral-100 border-t border-b",colSpan:3,children:c.jsx("div",{className:"flex flex-wrap gap-1",children:cl[13].map(I=>c.jsx(hl,{yaku:I,isOpened:l,active:o[I.id],disabled:l&&I.hanIfOpened===0,onClick:S,children:I.label},I.id))})})]})})})}),c.jsx("table",{className:"w-full mt-2 bg-teal-100",children:c.jsxs("tbody",{children:[c.jsx("th",{className:"w-16 bg-teal-400 py-2 px-1",children:"結算"}),c.jsx("td",{className:"flex flex-wrap gap-2 p-2",children:T.yakusInText.map(I=>c.jsx("span",{children:I},I))}),c.jsxs("td",{className:"w-32 bg-teal-400 text-center",children:[c.jsx(av,{han:Math.min(h?13:12,T.han),fu:T.fu,isManganRoundUp:i.isManganRoundUp==="1"}),c.jsx(av,{className:"text-xs text-neutral-600",han:T.han,fu:T.fu,isManganRoundUp:i.isManganRoundUp==="1",raw:!0})]})]})})]})};function k8({match:t,currentMatchRound:e,initialActivePlayerIndex:n="0",initialTargetPlayerIndex:r="-1",onSubmit:i,...s}){const[o,a]=w.useState(),[l,u]=w.useState({win:1e3,target:1e3}),h=w.useMemo(()=>Object.keys(t.players).map(A=>({index:A.toString(),name:t.players[A].name,position:sp(A,e.roundCount)})),[t.players,e.roundCount]),[f,d]=w.useState(n),p=w.useMemo(()=>typeof f<"u"?h==null?void 0:h.find(({index:S})=>S===f):void 0,[f,h]),[g,v]=w.useState(r),E=w.useCallback(S=>{const A=c8(Math.min(S.han,S.isYakuman?13:12),S.fu,(p==null?void 0:p.position)===ci.East,g!=="-1",{roundUp:t.setting.isManganRoundUp==="1"});e.extendedRoundCount>0&&(A.win+=e.extendedRoundCount*300,A.target&&(A.target+=e.extendedRoundCount*300),A.all&&(A.all+=e.extendedRoundCount*100),A.east&&(A.east+=e.extendedRoundCount*100),A.others&&(A.others+=e.extendedRoundCount*100)),e.cumulatedThousands>0&&(A.win+=e.cumulatedThousands*1e3),a(S),u(A)},[p==null?void 0:p.position,g,t.setting.isManganRoundUp,e.extendedRoundCount,e.cumulatedThousands]),m=w.useMemo(()=>c.jsxs("div",{children:[c.jsx($r,{roundCount:e.roundCount,extendedRoundCount:e.extendedRoundCount,max:8}),c.jsx("span",{children:" 和了"})]}),[e.roundCount,e.extendedRoundCount]),y=w.useMemo(()=>{const S=Object.keys(e.playerResults),A={0:{...e.playerResults[0],beforeScore:e.playerResults[0].beforeScore,afterScore:e.playerResults[0].beforeScore,type:0,scoreChanges:[],prevScoreChanges:e.playerResults[0].scoreChanges??[]},1:{...e.playerResults[1],beforeScore:e.playerResults[1].beforeScore,afterScore:e.playerResults[1].beforeScore,type:0,scoreChanges:[],prevScoreChanges:e.playerResults[1].scoreChanges??[]},2:{...e.playerResults[2],beforeScore:e.playerResults[2].beforeScore,afterScore:e.playerResults[2].beforeScore,type:0,scoreChanges:[],prevScoreChanges:e.playerResults[2].scoreChanges??[]},3:{...e.playerResults[3],beforeScore:e.playerResults[3].beforeScore,afterScore:e.playerResults[3].beforeScore,type:0,scoreChanges:[],prevScoreChanges:e.playerResults[3].scoreChanges??[]}};if(f===g)return A;let T=0;for(let I=0;I<S.length;I+=1){const b=S[I];b===f?(A[b].afterScore+=l.win,A[b].type=sn.Win,A[b].scoreChanges=[l.win]):l.target&&b===g?(A[b].afterScore-=l.target,A[b].type=sn.Lose,A[b].scoreChanges=[-l.target]):l.all?(A[b].afterScore-=l.all,A[b].type=sn.Lose,A[b].scoreChanges=[-l.all]):l.east&&l.others&&(op(b,e.roundCount)?(A[b].afterScore-=l.east,A[b].type=sn.Lose,A[b].scoreChanges=[-l.east]):(A[b].afterScore-=l.others,A[b].type=sn.Lose,A[b].scoreChanges=[-l.others])),b!==f&&A[b].isRiichi&&(A[b].afterScore-=1e3,A[b].scoreChanges.unshift(-1e3),T+=1e3)}return f&&T>0&&(A[f].afterScore+=T,A[f].scoreChanges.unshift(T)),A[f].detail=o,A},[f,l.all,l.east,l.others,l.target,l.win,e,g,o]),_=w.useCallback(()=>{if(!i||!o)return;const S={...e,resultType:h8(l),playerResults:y,nextRoundCumulatedThousands:0,resultDetail:{winnerPlayerIndex:f,...o}};i(S)},[f,l,e,i,y,o]);return w.useEffect(()=>{s.open&&d(n)},[s.open,n]),c.jsx(wr,{title:m,...s,children:c.jsxs("div",{className:"space-y-8",children:[c.jsxs("div",{className:"flex gap-x-4 items-center",children:[c.jsx("div",{className:"flex-1",children:c.jsx(ko,{value:f,onChangeValue:d,children:h.map(({index:S,name:A})=>c.jsx("option",{value:S,children:A},S))})}),c.jsx("div",{className:"text-xs text-gray-500",children:"和了"}),c.jsx("div",{className:"flex-1",children:c.jsxs(ko,{value:g,onChangeValue:v,children:[c.jsx("option",{value:"-1",children:"自摸"}),h.map(({index:S,name:A})=>c.jsx("option",{value:S,children:A},S))]})})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("h5",{className:"font-bold",children:"役種"}),c.jsxs("div",{children:[c.jsx(R8,{round:e.roundCount,activePlayerIndex:n,isEast:(p==null?void 0:p.position)===ci.East,isRon:g!=="-1",onChange:E,setting:t.setting}),c.jsx("div",{className:"text-3xl font-bold text-center bg-teal-400 py-2",children:c.jsx(x8,{score:l})})]})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("h5",{className:"font-bold",children:"分數變動"}),c.jsx("table",{className:"w-full",children:c.jsx("tbody",{children:Object.keys(t.players).map(S=>c.jsxs("tr",{children:[c.jsx("th",{className:"text-white py-1",style:{background:t.players[S].color},children:t.players[S].name}),c.jsx("td",{className:"px-2",children:y[S].beforeScore}),c.jsx("td",{children:c.jsx(dn,{signed:!0,value:y[S].afterScore-y[S].beforeScore,positiveClassName:"text-green-400",negativeClassName:"text-red-400"})}),c.jsx("td",{className:"text-right",children:y[S].afterScore})]},S))})})]}),c.jsx("div",{className:"space-y-2",children:c.jsx(De,{onClick:_,className:"w-full",disabled:!o||o.yakusInText.length<=0,children:"提交並播出分數變動動畫"})})]})})}const N8=[["1m","2m","3m","4m","5m","6m","7m","8m","9m","0m"],["1p","2p","3p","4p","5p","6p","7p","8p","9p","0p"],["1s","2s","3s","4s","5s","6s","7s","8s","9s","0s"],["1z","2z","3z","4z","5z","6z","7z"]],BS={m:0,p:1,s:2,z:3},D8=(t,e)=>{const[n,r]=[t[0],t[1]],[i,s]=[e[0],e[1]];return r!==s?BS[r]-BS[s]:parseInt(n,10)-parseInt(i,10)};function zS({onSubmit:t,onRemove:e,canRemove:n,hideRedTiles:r,multiple:i,defaultValue:s}){const[o,a]=w.useState([]),l=w.useCallback(f=>{var p;const d=(p=f.currentTarget)==null?void 0:p.getAttribute("data-key");d&&a(i?g=>{const v=g.indexOf(d);if(v===-1)return[...g,d].sort(D8);const E=[...g];return E.splice(v,1),E}:[d])},[i]),u=w.useCallback(()=>{o&&t&&(t==null||t(o),a([]))},[t,o]),h=w.useCallback(()=>{n&&(e==null||e(),a([]))},[n,e]);return w.useEffect(()=>{a(s??[])},[s]),c.jsxs("div",{children:[c.jsx("div",{className:`mb-4 grid ${r?"grid-cols-9":"grid-cols-10"} gap-1 lg:gap-x-2 lg:gap-y-4 items-center text-center`,children:N8.map(f=>f.map(d=>(!d.startsWith("0")||!r)&&c.jsx("button",{type:"button",onClick:l,"data-key":d,className:`${o.indexOf(d)!==-1?"bg-blue-400":"bg-black bg-opacity-20"} rounded p-1 lg:p-2`,children:c.jsx(hc,{children:d})})))}),c.jsxs("div",{className:"flex gap-x-4",children:[n&&c.jsx("div",{className:"flex-1",children:c.jsx(De,{className:"w-full",type:"button",color:"secondary",onClick:h,children:"移除"})}),c.jsx("div",{className:"flex-1",children:c.jsx(De,{className:"w-full",type:"button",color:"primary",onClick:u,disabled:o.length===0,children:"確定"})})]})]})}function O8({match:t,currentMatchRound:e,onSubmit:n,...r}){const i=w.useMemo(()=>Object.keys(t.players).map(d=>({index:d.toString(),name:t.players[d].name,position:sp(d,e.roundCount)})),[t.players,e.roundCount]),[s,o]=w.useState({0:!1,1:!1,2:!1,3:!1}),a=w.useCallback(f=>{var g,v;const d=(g=f.currentTarget)==null?void 0:g.checked,p=(v=f.currentTarget)==null?void 0:v.getAttribute("data-player-index");typeof d>"u"||!p||o(E=>({...E,[p]:d}))},[]),l=w.useMemo(()=>c.jsxs("div",{children:[c.jsx($r,{roundCount:e.roundCount,extendedRoundCount:e.extendedRoundCount,max:8}),c.jsx("span",{children:" 流局"})]}),[e.roundCount,e.extendedRoundCount]),u=w.useMemo(()=>{const f=Object.keys(e.playerResults),d={0:{...e.playerResults[0],beforeScore:e.playerResults[0].beforeScore,afterScore:e.playerResults[0].beforeScore,type:0,scoreChanges:[],prevScoreChanges:e.playerResults[0].prevScoreChanges??[]},1:{...e.playerResults[1],beforeScore:e.playerResults[1].beforeScore,afterScore:e.playerResults[1].beforeScore,type:0,scoreChanges:[],prevScoreChanges:e.playerResults[1].prevScoreChanges??[]},2:{...e.playerResults[2],beforeScore:e.playerResults[2].beforeScore,afterScore:e.playerResults[2].beforeScore,type:0,scoreChanges:[],prevScoreChanges:e.playerResults[2].prevScoreChanges??[]},3:{...e.playerResults[3],beforeScore:e.playerResults[3].beforeScore,afterScore:e.playerResults[3].beforeScore,type:0,scoreChanges:[],prevScoreChanges:e.playerResults[3].prevScoreChanges??[]}};let p=0,g=0;const v=Object.values(s).filter(E=>!!E).length;v===1?(p=3e3,g=1e3):v===2?(p=1500,g=1500):v===3&&(p=1e3,g=3e3);for(let E=0;E<f.length;E+=1){const m=f[E];p&&g&&(s[m]?(d[m].afterScore+=p,d[m].type=sn.Win,d[m].scoreChanges=[p]):(d[m].afterScore-=g,d[m].type=sn.Lose,d[m].scoreChanges=[-g])),d[m].isRiichi&&(d[m].afterScore-=1e3,d[m].scoreChanges.unshift(-1e3))}return d},[e.playerResults,s]),h=w.useCallback(()=>{if(!n)return;const f={...e,resultType:Zn.Exhausted,playerResults:u,nextRoundCumulatedThousands:e.cumulatedThousands+Object.values(u).filter(({isRiichi:d})=>!!d).length};n(f)},[e,n,u]);return w.useEffect(()=>{r.open&&o({0:!1,1:!1,2:!1,3:!1})},[r.open]),c.jsx(wr,{title:l,...r,children:c.jsxs("div",{className:"space-y-8",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"text-right text-xs text-gray-500",children:"聽牌？"}),i.map(f=>c.jsxs("div",{className:"flex",children:[c.jsx("div",{className:"flex-1",children:f.name}),c.jsx("div",{className:"shrink-0",children:c.jsx(jR,{checked:s[f.index],onChange:a,"data-player-index":f.index})})]},f.index))]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("h5",{className:"font-bold",children:"分數變動"}),c.jsx("table",{className:"text-sm w-full",children:c.jsx("tbody",{children:Object.keys(t.players).map(f=>c.jsxs("tr",{children:[c.jsx("th",{children:t.players[f].name}),c.jsx("td",{children:u[f].beforeScore}),c.jsx("td",{children:c.jsx(dn,{signed:!0,value:u[f].afterScore-u[f].beforeScore,positiveClassName:"text-green-400",negativeClassName:"text-red-400"})}),c.jsx("td",{className:"text-right",children:u[f].afterScore})]},f))})})]}),c.jsx("div",{className:"space-y-2",children:c.jsx(De,{onClick:h,className:"w-full",children:"提交並播出分數變動動畫"})})]})})}var fc=t=>t.type==="checkbox",No=t=>t instanceof Date,Yt=t=>t==null;const $R=t=>typeof t=="object";var dt=t=>!Yt(t)&&!Array.isArray(t)&&$R(t)&&!No(t),FR=t=>dt(t)&&t.target?fc(t.target)?t.target.checked:t.target.value:t,j8=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,MR=(t,e)=>t.has(j8(e)),$8=t=>{const e=t.constructor&&t.constructor.prototype;return dt(e)&&e.hasOwnProperty("isPrototypeOf")},B0=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Bn(t){let e;const n=Array.isArray(t);if(t instanceof Date)e=new Date(t);else if(t instanceof Set)e=new Set(t);else if(!(B0&&(t instanceof Blob||t instanceof FileList))&&(n||dt(t)))if(e=n?[]:{},!n&&!$8(t))e=t;else for(const r in t)t.hasOwnProperty(r)&&(e[r]=Bn(t[r]));else return t;return e}var dc=t=>Array.isArray(t)?t.filter(Boolean):[],Ke=t=>t===void 0,L=(t,e,n)=>{if(!e||!dt(t))return n;const r=dc(e.split(/[,[\].]+?/)).reduce((i,s)=>Yt(i)?i:i[s],t);return Ke(r)||r===t?Ke(t[e])?n:t[e]:r},lr=t=>typeof t=="boolean";const ed={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Hn={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Cr={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},F8=le.createContext(null),z0=()=>le.useContext(F8);var VR=(t,e,n,r=!0)=>{const i={defaultValues:e._defaultValues};for(const s in t)Object.defineProperty(i,s,{get:()=>{const o=s;return e._proxyFormState[o]!==Hn.all&&(e._proxyFormState[o]=!r||Hn.all),n&&(n[o]=!0),t[o]}});return i},An=t=>dt(t)&&!Object.keys(t).length,LR=(t,e,n,r)=>{n(t);const{name:i,...s}=t;return An(s)||Object.keys(s).length>=Object.keys(e).length||Object.keys(s).find(o=>e[o]===(!r||Hn.all))},jh=t=>Array.isArray(t)?t:[t],UR=(t,e,n)=>!t||!e||t===e||jh(t).some(r=>r&&(n?r===e:r.startsWith(e)||e.startsWith(r)));function W0(t){const e=le.useRef(t);e.current=t,le.useEffect(()=>{const n=!t.disabled&&e.current.subject&&e.current.subject.subscribe({next:e.current.next});return()=>{n&&n.unsubscribe()}},[t.disabled])}function M8(t){const e=z0(),{control:n=e.control,disabled:r,name:i,exact:s}=t||{},[o,a]=le.useState(n._formState),l=le.useRef(!0),u=le.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1}),h=le.useRef(i);return h.current=i,W0({disabled:r,next:f=>l.current&&UR(h.current,f.name,s)&&LR(f,u.current,n._updateFormState)&&a({...n._formState,...f}),subject:n._subjects.state}),le.useEffect(()=>(l.current=!0,u.current.isValid&&n._updateValid(!0),()=>{l.current=!1}),[n]),VR(o,n,u.current,!1)}var hr=t=>typeof t=="string",BR=(t,e,n,r,i)=>hr(t)?(r&&e.watch.add(t),L(n,t,i)):Array.isArray(t)?t.map(s=>(r&&e.watch.add(s),L(n,s))):(r&&(e.watchAll=!0),n);function up(t){const e=z0(),{control:n=e.control,name:r,defaultValue:i,disabled:s,exact:o}=t||{},a=le.useRef(r);a.current=r,W0({disabled:s,subject:n._subjects.values,next:h=>{UR(a.current,h.name,o)&&u(Bn(BR(a.current,n._names,h.values||n._formValues,!1,i)))}});const[l,u]=le.useState(n._getWatch(r,i));return le.useEffect(()=>n._removeUnmounted()),l}var G0=t=>/^\w*$/.test(t),zR=t=>dc(t.replace(/["|']|\]/g,"").split(/\.|\[/));function Re(t,e,n){let r=-1;const i=G0(e)?[e]:zR(e),s=i.length,o=s-1;for(;++r<s;){const a=i[r];let l=n;if(r!==o){const u=t[a];l=dt(u)||Array.isArray(u)?u:isNaN(+i[r+1])?{}:[]}t[a]=l,t=t[a]}return t}function V8(t){const e=z0(),{name:n,disabled:r,control:i=e.control,shouldUnregister:s}=t,o=MR(i._names.array,n),a=up({control:i,name:n,defaultValue:L(i._formValues,n,L(i._defaultValues,n,t.defaultValue)),exact:!0}),l=M8({control:i,name:n}),u=le.useRef(i.register(n,{...t.rules,value:a}));return u.current=i.register(n,t.rules),le.useEffect(()=>{const h=i._options.shouldUnregister||s,f=(d,p)=>{const g=L(i._fields,d);g&&(g._f.mount=p)};if(f(n,!0),h){const d=Bn(L(i._options.defaultValues,n));Re(i._defaultValues,n,d),Ke(L(i._formValues,n))&&Re(i._formValues,n,d)}return()=>{(o?h&&!i._state.action:h)?i.unregister(n):f(n,!1)}},[n,i,o,s]),le.useEffect(()=>{L(i._fields,n)&&i._updateDisabledField({disabled:r,fields:i._fields,name:n,value:L(i._fields,n)._f.value})},[r,n,i]),{field:{name:n,value:a,...lr(r)||lr(l.disabled)?{disabled:l.disabled||r}:{},onChange:le.useCallback(h=>u.current.onChange({target:{value:FR(h),name:n},type:ed.CHANGE}),[n]),onBlur:le.useCallback(()=>u.current.onBlur({target:{value:L(i._formValues,n),name:n},type:ed.BLUR}),[n,i]),ref:h=>{const f=L(i._fields,n);f&&h&&(f._f.ref={focus:()=>h.focus(),select:()=>h.select(),setCustomValidity:d=>h.setCustomValidity(d),reportValidity:()=>h.reportValidity()})}},formState:l,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!L(l.errors,n)},isDirty:{enumerable:!0,get:()=>!!L(l.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!L(l.touchedFields,n)},error:{enumerable:!0,get:()=>L(l.errors,n)}})}}const on=t=>t.render(V8(t));var L8=(t,e,n,r,i)=>e?{...n[t],types:{...n[t]&&n[t].types?n[t].types:{},[r]:i||!0}}:{},WS=t=>({isOnSubmit:!t||t===Hn.onSubmit,isOnBlur:t===Hn.onBlur,isOnChange:t===Hn.onChange,isOnAll:t===Hn.all,isOnTouch:t===Hn.onTouched}),GS=(t,e,n)=>!n&&(e.watchAll||e.watch.has(t)||[...e.watch].some(r=>t.startsWith(r)&&/^\.\w+/.test(t.slice(r.length))));const $h=(t,e,n,r)=>{for(const i of n||Object.keys(t)){const s=L(t,i);if(s){const{_f:o,...a}=s;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],i)&&!r)break;if(o.ref&&e(o.ref,o.name)&&!r)break}else dt(a)&&$h(a,e)}}};var U8=(t,e,n)=>{const r=dc(L(t,n));return Re(r,"root",e[n]),Re(t,n,r),t},H0=t=>t.type==="file",hi=t=>typeof t=="function",td=t=>{if(!B0)return!1;const e=t?t.ownerDocument:0;return t instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},Fh=t=>hr(t),q0=t=>t.type==="radio",nd=t=>t instanceof RegExp;const HS={value:!1,isValid:!1},qS={value:!0,isValid:!0};var WR=t=>{if(Array.isArray(t)){if(t.length>1){const e=t.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:e,isValid:!!e.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!Ke(t[0].attributes.value)?Ke(t[0].value)||t[0].value===""?qS:{value:t[0].value,isValid:!0}:qS:HS}return HS};const KS={isValid:!1,value:null};var GR=t=>Array.isArray(t)?t.reduce((e,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:e,KS):KS;function QS(t,e,n="validate"){if(Fh(t)||Array.isArray(t)&&t.every(Fh)||lr(t)&&!t)return{type:n,message:Fh(t)?t:"",ref:e}}var io=t=>dt(t)&&!nd(t)?t:{value:t,message:""},YS=async(t,e,n,r,i)=>{const{ref:s,refs:o,required:a,maxLength:l,minLength:u,min:h,max:f,pattern:d,validate:p,name:g,valueAsNumber:v,mount:E,disabled:m}=t._f,y=L(e,g);if(!E||m)return{};const _=o?o[0]:s,S=Z=>{r&&_.reportValidity&&(_.setCustomValidity(lr(Z)?"":Z||""),_.reportValidity())},A={},T=q0(s),I=fc(s),b=T||I,H=(v||H0(s))&&Ke(s.value)&&Ke(y)||td(s)&&s.value===""||y===""||Array.isArray(y)&&!y.length,M=L8.bind(null,g,n,A),se=(Z,U,ce,tt=Cr.maxLength,Ze=Cr.minLength)=>{const $t=Z?U:ce;A[g]={type:Z?tt:Ze,message:$t,ref:s,...M(Z?tt:Ze,$t)}};if(i?!Array.isArray(y)||!y.length:a&&(!b&&(H||Yt(y))||lr(y)&&!y||I&&!WR(o).isValid||T&&!GR(o).isValid)){const{value:Z,message:U}=Fh(a)?{value:!!a,message:a}:io(a);if(Z&&(A[g]={type:Cr.required,message:U,ref:_,...M(Cr.required,U)},!n))return S(U),A}if(!H&&(!Yt(h)||!Yt(f))){let Z,U;const ce=io(f),tt=io(h);if(!Yt(y)&&!isNaN(y)){const Ze=s.valueAsNumber||y&&+y;Yt(ce.value)||(Z=Ze>ce.value),Yt(tt.value)||(U=Ze<tt.value)}else{const Ze=s.valueAsDate||new Date(y),$t=te=>new Date(new Date().toDateString()+" "+te),F=s.type=="time",X=s.type=="week";hr(ce.value)&&y&&(Z=F?$t(y)>$t(ce.value):X?y>ce.value:Ze>new Date(ce.value)),hr(tt.value)&&y&&(U=F?$t(y)<$t(tt.value):X?y<tt.value:Ze<new Date(tt.value))}if((Z||U)&&(se(!!Z,ce.message,tt.message,Cr.max,Cr.min),!n))return S(A[g].message),A}if((l||u)&&!H&&(hr(y)||i&&Array.isArray(y))){const Z=io(l),U=io(u),ce=!Yt(Z.value)&&y.length>+Z.value,tt=!Yt(U.value)&&y.length<+U.value;if((ce||tt)&&(se(ce,Z.message,U.message),!n))return S(A[g].message),A}if(d&&!H&&hr(y)){const{value:Z,message:U}=io(d);if(nd(Z)&&!y.match(Z)&&(A[g]={type:Cr.pattern,message:U,ref:s,...M(Cr.pattern,U)},!n))return S(U),A}if(p){if(hi(p)){const Z=await p(y,e),U=QS(Z,_);if(U&&(A[g]={...U,...M(Cr.validate,U.message)},!n))return S(U.message),A}else if(dt(p)){let Z={};for(const U in p){if(!An(Z)&&!n)break;const ce=QS(await p[U](y,e),_,U);ce&&(Z={...ce,...M(U,ce.message)},S(ce.message),n&&(A[g]=Z))}if(!An(Z)&&(A[g]={ref:_,...Z},!n))return A}}return S(!0),A};function B8(t,e){const n=e.slice(0,-1).length;let r=0;for(;r<n;)t=Ke(t)?r++:t[e[r++]];return t}function z8(t){for(const e in t)if(t.hasOwnProperty(e)&&!Ke(t[e]))return!1;return!0}function At(t,e){const n=Array.isArray(e)?e:G0(e)?[e]:zR(e),r=n.length===1?t:B8(t,n),i=n.length-1,s=n[i];return r&&delete r[s],i!==0&&(dt(r)&&An(r)||Array.isArray(r)&&z8(r))&&At(t,n.slice(0,-1)),t}function og(){let t=[];return{get observers(){return t},next:i=>{for(const s of t)s.next&&s.next(i)},subscribe:i=>(t.push(i),{unsubscribe:()=>{t=t.filter(s=>s!==i)}}),unsubscribe:()=>{t=[]}}}var rd=t=>Yt(t)||!$R(t);function rs(t,e){if(rd(t)||rd(e))return t===e;if(No(t)&&No(e))return t.getTime()===e.getTime();const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n){const s=t[i];if(!r.includes(i))return!1;if(i!=="ref"){const o=e[i];if(No(s)&&No(o)||dt(s)&&dt(o)||Array.isArray(s)&&Array.isArray(o)?!rs(s,o):s!==o)return!1}}return!0}var HR=t=>t.type==="select-multiple",W8=t=>q0(t)||fc(t),ag=t=>td(t)&&t.isConnected,qR=t=>{for(const e in t)if(hi(t[e]))return!0;return!1};function id(t,e={}){const n=Array.isArray(t);if(dt(t)||n)for(const r in t)Array.isArray(t[r])||dt(t[r])&&!qR(t[r])?(e[r]=Array.isArray(t[r])?[]:{},id(t[r],e[r])):Yt(t[r])||(e[r]=!0);return e}function KR(t,e,n){const r=Array.isArray(t);if(dt(t)||r)for(const i in t)Array.isArray(t[i])||dt(t[i])&&!qR(t[i])?Ke(e)||rd(n[i])?n[i]=Array.isArray(t[i])?id(t[i],[]):{...id(t[i])}:KR(t[i],Yt(e)?{}:e[i],n[i]):n[i]=!rs(t[i],e[i]);return n}var lg=(t,e)=>KR(t,e,id(e)),QR=(t,{valueAsNumber:e,valueAsDate:n,setValueAs:r})=>Ke(t)?t:e?t===""?NaN:t&&+t:n&&hr(t)?new Date(t):r?r(t):t;function ug(t){const e=t.ref;if(!(t.refs?t.refs.every(n=>n.disabled):e.disabled))return H0(e)?e.files:q0(e)?GR(t.refs).value:HR(e)?[...e.selectedOptions].map(({value:n})=>n):fc(e)?WR(t.refs).value:QR(Ke(e.value)?t.ref.value:e.value,t)}var G8=(t,e,n,r)=>{const i={};for(const s of t){const o=L(e,s);o&&Re(i,s,o._f)}return{criteriaMode:n,names:[...t],fields:i,shouldUseNativeValidation:r}},fl=t=>Ke(t)?t:nd(t)?t.source:dt(t)?nd(t.value)?t.value.source:t.value:t,H8=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate);function XS(t,e,n){const r=L(t,n);if(r||G0(n))return{error:r,name:n};const i=n.split(".");for(;i.length;){const s=i.join("."),o=L(e,s),a=L(t,s);if(o&&!Array.isArray(o)&&n!==s)return{name:n};if(a&&a.type)return{name:s,error:a};i.pop()}return{name:n}}var q8=(t,e,n,r,i)=>i.isOnAll?!1:!n&&i.isOnTouch?!(e||t):(n?r.isOnBlur:i.isOnBlur)?!t:(n?r.isOnChange:i.isOnChange)?t:!0,K8=(t,e)=>!dc(L(t,e)).length&&At(t,e);const Q8={mode:Hn.onSubmit,reValidateMode:Hn.onChange,shouldFocusError:!0};function Y8(t={},e){let n={...Q8,...t},r={submitCount:0,isDirty:!1,isLoading:hi(n.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},errors:{},disabled:!1},i={},s=dt(n.defaultValues)||dt(n.values)?Bn(n.defaultValues||n.values)||{}:{},o=n.shouldUnregister?{}:Bn(s),a={action:!1,mount:!1,watch:!1},l={mount:new Set,unMount:new Set,array:new Set,watch:new Set},u,h=0;const f={isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},d={values:og(),array:og(),state:og()},p=t.resetOptions&&t.resetOptions.keepDirtyValues,g=WS(n.mode),v=WS(n.reValidateMode),E=n.criteriaMode===Hn.all,m=x=>C=>{clearTimeout(h),h=setTimeout(x,C)},y=async x=>{if(f.isValid||x){const C=n.resolver?An((await H()).errors):await se(i,!0);C!==r.isValid&&d.state.next({isValid:C})}},_=x=>f.isValidating&&d.state.next({isValidating:x}),S=(x,C=[],P,W,V=!0,O=!0)=>{if(W&&P){if(a.action=!0,O&&Array.isArray(L(i,x))){const Y=P(L(i,x),W.argA,W.argB);V&&Re(i,x,Y)}if(O&&Array.isArray(L(r.errors,x))){const Y=P(L(r.errors,x),W.argA,W.argB);V&&Re(r.errors,x,Y),K8(r.errors,x)}if(f.touchedFields&&O&&Array.isArray(L(r.touchedFields,x))){const Y=P(L(r.touchedFields,x),W.argA,W.argB);V&&Re(r.touchedFields,x,Y)}f.dirtyFields&&(r.dirtyFields=lg(s,o)),d.state.next({name:x,isDirty:U(x,C),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else Re(o,x,C)},A=(x,C)=>{Re(r.errors,x,C),d.state.next({errors:r.errors})},T=(x,C,P,W)=>{const V=L(i,x);if(V){const O=L(o,x,Ke(P)?L(s,x):P);Ke(O)||W&&W.defaultChecked||C?Re(o,x,C?O:ug(V._f)):Ze(x,O),a.mount&&y()}},I=(x,C,P,W,V)=>{let O=!1,Y=!1;const Pe={name:x};if(!P||W){f.isDirty&&(Y=r.isDirty,r.isDirty=Pe.isDirty=U(),O=Y!==Pe.isDirty);const nt=rs(L(s,x),C);Y=L(r.dirtyFields,x),nt?At(r.dirtyFields,x):Re(r.dirtyFields,x,!0),Pe.dirtyFields=r.dirtyFields,O=O||f.dirtyFields&&Y!==!nt}if(P){const nt=L(r.touchedFields,x);nt||(Re(r.touchedFields,x,P),Pe.touchedFields=r.touchedFields,O=O||f.touchedFields&&nt!==P)}return O&&V&&d.state.next(Pe),O?Pe:{}},b=(x,C,P,W)=>{const V=L(r.errors,x),O=f.isValid&&lr(C)&&r.isValid!==C;if(t.delayError&&P?(u=m(()=>A(x,P)),u(t.delayError)):(clearTimeout(h),u=null,P?Re(r.errors,x,P):At(r.errors,x)),(P?!rs(V,P):V)||!An(W)||O){const Y={...W,...O&&lr(C)?{isValid:C}:{},errors:r.errors,name:x};r={...r,...Y},d.state.next(Y)}_(!1)},H=async x=>n.resolver(o,n.context,G8(x||l.mount,i,n.criteriaMode,n.shouldUseNativeValidation)),M=async x=>{const{errors:C}=await H(x);if(x)for(const P of x){const W=L(C,P);W?Re(r.errors,P,W):At(r.errors,P)}else r.errors=C;return C},se=async(x,C,P={valid:!0})=>{for(const W in x){const V=x[W];if(V){const{_f:O,...Y}=V;if(O){const Pe=l.array.has(O.name),nt=await YS(V,o,E,n.shouldUseNativeValidation&&!C,Pe);if(nt[O.name]&&(P.valid=!1,C))break;!C&&(L(nt,O.name)?Pe?U8(r.errors,nt,O.name):Re(r.errors,O.name,nt[O.name]):At(r.errors,O.name))}Y&&await se(Y,C,P)}}return P.valid},Z=()=>{for(const x of l.unMount){const C=L(i,x);C&&(C._f.refs?C._f.refs.every(P=>!ag(P)):!ag(C._f.ref))&&rr(x)}l.unMount=new Set},U=(x,C)=>(x&&C&&Re(o,x,C),!rs(me(),s)),ce=(x,C,P)=>BR(x,l,{...a.mount?o:Ke(C)?s:hr(x)?{[x]:C}:C},P,C),tt=x=>dc(L(a.mount?o:s,x,t.shouldUnregister?L(s,x,[]):[])),Ze=(x,C,P={})=>{const W=L(i,x);let V=C;if(W){const O=W._f;O&&(!O.disabled&&Re(o,x,QR(C,O)),V=td(O.ref)&&Yt(C)?"":C,HR(O.ref)?[...O.ref.options].forEach(Y=>Y.selected=V.includes(Y.value)):O.refs?fc(O.ref)?O.refs.length>1?O.refs.forEach(Y=>(!Y.defaultChecked||!Y.disabled)&&(Y.checked=Array.isArray(V)?!!V.find(Pe=>Pe===Y.value):V===Y.value)):O.refs[0]&&(O.refs[0].checked=!!V):O.refs.forEach(Y=>Y.checked=Y.value===V):H0(O.ref)?O.ref.value="":(O.ref.value=V,O.ref.type||d.values.next({name:x,values:{...o}})))}(P.shouldDirty||P.shouldTouch)&&I(x,V,P.shouldTouch,P.shouldDirty,!0),P.shouldValidate&&be(x)},$t=(x,C,P)=>{for(const W in C){const V=C[W],O=`${x}.${W}`,Y=L(i,O);(l.array.has(x)||!rd(V)||Y&&!Y._f)&&!No(V)?$t(O,V,P):Ze(O,V,P)}},F=(x,C,P={})=>{const W=L(i,x),V=l.array.has(x),O=Bn(C);Re(o,x,O),V?(d.array.next({name:x,values:{...o}}),(f.isDirty||f.dirtyFields)&&P.shouldDirty&&d.state.next({name:x,dirtyFields:lg(s,o),isDirty:U(x,O)})):W&&!W._f&&!Yt(O)?$t(x,O,P):Ze(x,O,P),GS(x,l)&&d.state.next({...r}),d.values.next({name:x,values:{...o}}),!a.mount&&e()},X=async x=>{const C=x.target;let P=C.name,W=!0;const V=L(i,P),O=()=>C.type?ug(V._f):FR(x),Y=Pe=>{W=Number.isNaN(Pe)||Pe===L(o,P,Pe)};if(V){let Pe,nt;const Nc=O(),qs=x.type===ed.BLUR||x.type===ed.FOCUS_OUT,z2=!H8(V._f)&&!n.resolver&&!L(r.errors,P)&&!V._f.deps||q8(qs,L(r.touchedFields,P),r.isSubmitted,v,g),Vp=GS(P,l,qs);Re(o,P,Nc),qs?(V._f.onBlur&&V._f.onBlur(x),u&&u(0)):V._f.onChange&&V._f.onChange(x);const Lp=I(P,Nc,qs,!1),W2=!An(Lp)||Vp;if(!qs&&d.values.next({name:P,type:x.type,values:{...o}}),z2)return f.isValid&&y(),W2&&d.state.next({name:P,...Vp?{}:Lp});if(!qs&&Vp&&d.state.next({...r}),_(!0),n.resolver){const{errors:Hw}=await H([P]);if(Y(Nc),W){const G2=XS(r.errors,i,P),qw=XS(Hw,i,G2.name||P);Pe=qw.error,P=qw.name,nt=An(Hw)}}else Pe=(await YS(V,o,E,n.shouldUseNativeValidation))[P],Y(Nc),W&&(Pe?nt=!1:f.isValid&&(nt=await se(i,!0)));W&&(V._f.deps&&be(V._f.deps),b(P,nt,Pe,Lp))}},te=(x,C)=>{if(L(r.errors,C)&&x.focus)return x.focus(),1},be=async(x,C={})=>{let P,W;const V=jh(x);if(_(!0),n.resolver){const O=await M(Ke(x)?x:V);P=An(O),W=x?!V.some(Y=>L(O,Y)):P}else x?(W=(await Promise.all(V.map(async O=>{const Y=L(i,O);return await se(Y&&Y._f?{[O]:Y}:Y)}))).every(Boolean),!(!W&&!r.isValid)&&y()):W=P=await se(i);return d.state.next({...!hr(x)||f.isValid&&P!==r.isValid?{}:{name:x},...n.resolver||!x?{isValid:P}:{},errors:r.errors,isValidating:!1}),C.shouldFocus&&!W&&$h(i,te,x?V:l.mount),W},me=x=>{const C={...s,...a.mount?o:{}};return Ke(x)?C:hr(x)?L(C,x):x.map(P=>L(C,P))},En=(x,C)=>({invalid:!!L((C||r).errors,x),isDirty:!!L((C||r).dirtyFields,x),isTouched:!!L((C||r).touchedFields,x),error:L((C||r).errors,x)}),Fn=x=>{x&&jh(x).forEach(C=>At(r.errors,C)),d.state.next({errors:x?r.errors:{}})},Yr=(x,C,P)=>{const W=(L(i,x,{_f:{}})._f||{}).ref;Re(r.errors,x,{...C,ref:W}),d.state.next({name:x,errors:r.errors,isValid:!1}),P&&P.shouldFocus&&W&&W.focus&&W.focus()},Mn=(x,C)=>hi(x)?d.values.subscribe({next:P=>x(ce(void 0,C),P)}):ce(x,C,!0),rr=(x,C={})=>{for(const P of x?jh(x):l.mount)l.mount.delete(P),l.array.delete(P),C.keepValue||(At(i,P),At(o,P)),!C.keepError&&At(r.errors,P),!C.keepDirty&&At(r.dirtyFields,P),!C.keepTouched&&At(r.touchedFields,P),!n.shouldUnregister&&!C.keepDefaultValue&&At(s,P);d.values.next({values:{...o}}),d.state.next({...r,...C.keepDirty?{isDirty:U()}:{}}),!C.keepIsValid&&y()},Pc=({disabled:x,name:C,field:P,fields:W,value:V})=>{if(lr(x)){const O=x?void 0:Ke(V)?ug(P?P._f:L(W,C)._f):V;Re(o,C,O),I(C,O,!1,!1,!0)}},Ka=(x,C={})=>{let P=L(i,x);const W=lr(C.disabled);return Re(i,x,{...P||{},_f:{...P&&P._f?P._f:{ref:{name:x}},name:x,mount:!0,...C}}),l.mount.add(x),P?Pc({field:P,disabled:C.disabled,name:x}):T(x,!0,C.value),{...W?{disabled:C.disabled}:{},...n.progressive?{required:!!C.required,min:fl(C.min),max:fl(C.max),minLength:fl(C.minLength),maxLength:fl(C.maxLength),pattern:fl(C.pattern)}:{},name:x,onChange:X,onBlur:X,ref:V=>{if(V){Ka(x,C),P=L(i,x);const O=Ke(V.value)&&V.querySelectorAll&&V.querySelectorAll("input,select,textarea")[0]||V,Y=W8(O),Pe=P._f.refs||[];if(Y?Pe.find(nt=>nt===O):O===P._f.ref)return;Re(i,x,{_f:{...P._f,...Y?{refs:[...Pe.filter(ag),O,...Array.isArray(L(s,x))?[{}]:[]],ref:{type:O.type,name:x}}:{ref:O}}}),T(x,!1,void 0,O)}else P=L(i,x,{}),P._f&&(P._f.mount=!1),(n.shouldUnregister||C.shouldUnregister)&&!(MR(l.array,x)&&a.action)&&l.unMount.add(x)}}},Rc=()=>n.shouldFocusError&&$h(i,te,l.mount),j=x=>{lr(x)&&(d.state.next({disabled:x}),$h(i,C=>{C.disabled=x},0,!1))},G=(x,C)=>async P=>{P&&(P.preventDefault&&P.preventDefault(),P.persist&&P.persist());let W=Bn(o);if(d.state.next({isSubmitting:!0}),n.resolver){const{errors:V,values:O}=await H();r.errors=V,W=O}else await se(i);At(r.errors,"root"),An(r.errors)?(d.state.next({errors:{}}),await x(W,P)):(C&&await C({...r.errors},P),Rc(),setTimeout(Rc)),d.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:An(r.errors),submitCount:r.submitCount+1,errors:r.errors})},Ve=(x,C={})=>{L(i,x)&&(Ke(C.defaultValue)?F(x,L(s,x)):(F(x,C.defaultValue),Re(s,x,C.defaultValue)),C.keepTouched||At(r.touchedFields,x),C.keepDirty||(At(r.dirtyFields,x),r.isDirty=C.defaultValue?U(x,L(s,x)):U()),C.keepError||(At(r.errors,x),f.isValid&&y()),d.state.next({...r}))},xn=(x,C={})=>{const P=x?Bn(x):s,W=Bn(P),V=x&&!An(x)?W:s;if(C.keepDefaultValues||(s=P),!C.keepValues){if(C.keepDirtyValues||p)for(const O of l.mount)L(r.dirtyFields,O)?Re(V,O,L(o,O)):F(O,L(V,O));else{if(B0&&Ke(x))for(const O of l.mount){const Y=L(i,O);if(Y&&Y._f){const Pe=Array.isArray(Y._f.refs)?Y._f.refs[0]:Y._f.ref;if(td(Pe)){const nt=Pe.closest("form");if(nt){nt.reset();break}}}}i={}}o=t.shouldUnregister?C.keepDefaultValues?Bn(s):{}:Bn(V),d.array.next({values:{...V}}),d.values.next({values:{...V}})}l={mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},!a.mount&&e(),a.mount=!f.isValid||!!C.keepIsValid,a.watch=!!t.shouldUnregister,d.state.next({submitCount:C.keepSubmitCount?r.submitCount:0,isDirty:C.keepDirty?r.isDirty:!!(C.keepDefaultValues&&!rs(x,s)),isSubmitted:C.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:C.keepDirtyValues?r.dirtyFields:C.keepDefaultValues&&x?lg(s,x):{},touchedFields:C.keepTouched?r.touchedFields:{},errors:C.keepErrors?r.errors:{},isSubmitSuccessful:C.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1})},kc=(x,C)=>xn(hi(x)?x(o):x,C);return{control:{register:Ka,unregister:rr,getFieldState:En,handleSubmit:G,setError:Yr,_executeSchema:H,_getWatch:ce,_getDirty:U,_updateValid:y,_removeUnmounted:Z,_updateFieldArray:S,_updateDisabledField:Pc,_getFieldArray:tt,_reset:xn,_resetDefaultValues:()=>hi(n.defaultValues)&&n.defaultValues().then(x=>{kc(x,n.resetOptions),d.state.next({isLoading:!1})}),_updateFormState:x=>{r={...r,...x}},_disableForm:j,_subjects:d,_proxyFormState:f,get _fields(){return i},get _formValues(){return o},get _state(){return a},set _state(x){a=x},get _defaultValues(){return s},get _names(){return l},set _names(x){l=x},get _formState(){return r},set _formState(x){r=x},get _options(){return n},set _options(x){n={...n,...x}}},trigger:be,register:Ka,handleSubmit:G,watch:Mn,setValue:F,getValues:me,reset:kc,resetField:Ve,clearErrors:Fn,unregister:rr,setError:Yr,setFocus:(x,C={})=>{const P=L(i,x),W=P&&P._f;if(W){const V=W.refs?W.refs[0]:W.ref;V.focus&&(V.focus(),C.shouldSelect&&V.select())}},getFieldState:En}}function cp(t={}){const e=le.useRef(),n=le.useRef(),[r,i]=le.useState({isDirty:!1,isValidating:!1,isLoading:hi(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},errors:{},disabled:!1,defaultValues:hi(t.defaultValues)?void 0:t.defaultValues});e.current||(e.current={...Y8(t,()=>i(o=>({...o}))),formState:r});const s=e.current.control;return s._options=t,W0({subject:s._subjects.state,next:o=>{LR(o,s._proxyFormState,s._updateFormState,!0)&&i({...s._formState})}}),le.useEffect(()=>s._disableForm(t.disabled),[s,t.disabled]),le.useEffect(()=>{if(s._proxyFormState.isDirty){const o=s._getDirty();o!==r.isDirty&&s._subjects.state.next({isDirty:o})}},[s,r.isDirty]),le.useEffect(()=>{t.values&&!rs(t.values,n.current)?(s._reset(t.values,s._options.resetOptions),n.current=t.values):s._resetDefaultValues()},[t.values,s]),le.useEffect(()=>{s._state.mount||(s._updateValid(),s._state.mount=!0),s._state.watch&&(s._state.watch=!1,s._subjects.state.next({...s._formState})),s._removeUnmounted()}),e.current.formState=VR(r,s),e.current}const X8=RR(["block w-full rounded-md border-0 p-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600"]);function fi({className:t,...e}){const n=w.useMemo(()=>X8({className:t}),[t]);return c.jsx("input",{className:n,...e})}function J8({match:t,currentMatchRound:e,onSubmit:n,...r}){const{reset:i,handleSubmit:s,control:o}=cp({defaultValues:{player_0:0,player_1:0,player_2:0,player_3:0,cumulatedThousands:0,roundCount:0,extendedRoundCount:0}}),a=w.useMemo(()=>Object.keys(t.players).map(h=>({...t.players[h],index:h.toString(),position:sp(h,e.roundCount)})),[t.players,e.roundCount]),l=w.useMemo(()=>s(u=>{if(!n)return;const h={...e,resultType:Zn.Hotfix,playerResults:{0:{...e.playerResults[0],afterScore:parseInt(u.player_0,10)},1:{...e.playerResults[1],afterScore:parseInt(u.player_1,10)},2:{...e.playerResults[2],afterScore:parseInt(u.player_2,10)},3:{...e.playerResults[3],afterScore:parseInt(u.player_3,10)}},cumulatedThousands:parseInt(u.cumulatedThousands,10),roundCount:parseInt(u.roundCount,10),extendedRoundCount:parseInt(u.extendedRoundCount,10)};n(h)}),[e,s,n]);return w.useEffect(()=>{r.open&&i({player_0:e.playerResults[0].beforeScore,player_1:e.playerResults[1].beforeScore,player_2:e.playerResults[2].beforeScore,player_3:e.playerResults[3].beforeScore,cumulatedThousands:e.cumulatedThousands,roundCount:e.roundCount,extendedRoundCount:e.extendedRoundCount})},[e.cumulatedThousands,e.extendedRoundCount,e.playerResults,e.roundCount,r.open,i]),c.jsx(wr,{title:"手動調整分數",...r,children:c.jsxs("div",{className:"space-y-8",children:[c.jsx("div",{className:"space-y-2",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{className:"w-1/2",children:"玩家"}),c.jsx("th",{className:"w-1/4",children:"現在分數"}),c.jsx("th",{className:"w-1/4",children:"新的分數"})]})}),c.jsxs("tbody",{children:[a.map(u=>c.jsxs("tr",{children:[c.jsx("td",{className:"px-2 border border-gray-200 align-middle",children:c.jsx(ns,{player:u})}),c.jsx("td",{className:"text-center px-2 border border-gray-200 align-middle",children:e.playerResults[u.index].beforeScore}),c.jsx("td",{className:"px-2 border border-gray-200 align-middle",children:c.jsx(on,{name:`player_${u.index}`,control:o,rules:{required:!0},render:({field:h})=>c.jsx(fi,{className:"text-center",type:"number",...h})})})]},u.index)),c.jsxs("tr",{children:[c.jsx("td",{className:"px-2 border border-gray-200 align-middle",children:"供托"}),c.jsx("td",{className:"text-center px-2 border border-gray-200 align-middle",children:e.cumulatedThousands}),c.jsx("td",{className:"px-2 border border-gray-200 align-middle",children:c.jsx(on,{name:"cumulatedThousands",control:o,rules:{required:!0},render:({field:u})=>c.jsx(fi,{className:"text-center",type:"number",...u})})})]}),c.jsxs("tr",{children:[c.jsx("td",{className:"px-2 border border-gray-200 align-middle",children:"局數(東1局=1, 東2局=2, ...)"}),c.jsx("td",{className:"text-center px-2 border border-gray-200 align-middle",children:e.roundCount}),c.jsx("td",{className:"px-2 border border-gray-200 align-middle",children:c.jsx(on,{name:"roundCount",control:o,rules:{required:!0},render:({field:u})=>c.jsx(fi,{className:"text-center",type:"number",...u})})})]}),c.jsxs("tr",{children:[c.jsx("td",{className:"px-2 border border-gray-200 align-middle",children:"本場數"}),c.jsx("td",{className:"text-center px-2 border border-gray-200 align-middle",children:e.extendedRoundCount}),c.jsx("td",{className:"px-2 border border-gray-200 align-middle",children:c.jsx(on,{name:"extendedRoundCount",control:o,rules:{required:!0},render:({field:u})=>c.jsx(fi,{className:"text-center",type:"number",...u})})})]})]})]})}),c.jsx("div",{className:"space-y-2",children:c.jsx(De,{onClick:l,className:"w-full",children:"提交並更新直播畫面"})})]})})}function Z8({params:{matchId:t}}){const{data:e,set:n}=zr("obs/1"),{match:r,matchRounds:i,matchCurrentRound:s,matchCurrentRoundDoras:o,updateCurrentMatchRound:a,pushMatchRound:l,setCurrentRoundDoras:u,setMatchName:h,setMatchActiveResultDetail:f,setMatchRoundHasBroadcastedToTrue:d}=Ua(t),p=w.useMemo(()=>Object.entries(i??{}).filter(([j,G])=>!!G.resultDetail).map(([j,G])=>({id:j,...G})).reverse()??[],[i]),[g,v]=w.useState(void 0),[E,m]=Ci(!1),[y,_]=w.useState({initialActivePlayerIndex:"0"}),S=E8(),[A,T]=Ci(!1),[I,b]=Ci(!1);w.useCallback(j=>{const G=j.currentTarget.getAttribute("data-player-index");!G||!(r!=null&&r.players[G])||a({playerResults:{...s==null?void 0:s.playerResults,[G]:{...s==null?void 0:s.playerResults[G],isRevealed:!(s!=null&&s.playerResults[G].isRevealed)}}})},[r==null?void 0:r.players,s==null?void 0:s.playerResults,a]);const H=w.useCallback(j=>{const G=j.currentTarget.getAttribute("data-player-index");if(!G)return;const Ve=r==null?void 0:r.players[G];if(!Ve)return;const xn=!(s!=null&&s.playerResults[G].isRiichi);S.showConfirmDialog({title:xn?"確定要立直嗎？":"取消立直？",content:xn?`一旦點擊確定，就會播出立直動畫，請確定立直的是 ${Ve.name}！`:`你是否想取消 ${Ve.name} 的立直？`,onClickOk:async()=>(a({playerResults:{...s==null?void 0:s.playerResults,[G]:{...s==null?void 0:s.playerResults[G],isRiichi:!(s!=null&&s.playerResults[G].isRiichi)}}}),new Promise(kc=>{setTimeout(kc,xn?3e3:10)}))})},[S,r==null?void 0:r.players,s==null?void 0:s.playerResults,a]),M=w.useCallback(j=>{var Ve;const G=parseInt((Ve=j.currentTarget)==null?void 0:Ve.getAttribute("data-index"),10);typeof G<"u"&&!Number.isNaN(G)&&v(G)},[]),se=w.useCallback(j=>{if(typeof g<"u"){const G=j[0];if(!G)return;const Ve=[...o];g===-1?Ve.push(G):Ve[g]=G,u(Ve),v(void 0)}},[g,o,u]),Z=w.useCallback(()=>{if(typeof g<"u"){const j=[...o];g>-1&&(j.splice(g,1),u(j),v(void 0))}},[g,o,u]),U=w.useCallback(()=>{v(void 0)},[]),ce=w.useCallback(j=>{const G=j==null?void 0:j.currentTarget.getAttribute("data-player-index");G&&(_({initialActivePlayerIndex:G}),m())},[m]),tt=w.useCallback(()=>{T(!0)},[T]),Ze=w.useCallback(()=>{b(!0)},[b]),$t=w.useCallback(j=>{try{const G=FS(j.roundCount),Ve=j.playerResults[G].type===sn.Win,xn=!Ve&&j.roundCount>=8;xn&&alert("對局結束。"),a({...j,nextRoundType:xn?ot.End:Ve?ot.Extended:ot.NextRound}),m(!1)}catch(G){console.error(G)}},[m,a]),F=w.useCallback(j=>{try{const G=FS(j.roundCount),Ve=j.playerResults[G].type!==sn.Win,xn=Ve&&j.roundCount>=8;xn&&alert("對局結束。"),a({...j,nextRoundType:xn?ot.End:Ve?ot.NextRoundAndExtended:ot.Extended}),T(!1)}catch(G){console.error(G)}},[T,a]),X=w.useCallback(j=>{try{a({playerResults:j.playerResults,resultType:Zn.Hotfix});const G={matchId:t,code:ov(t,j.roundCount,j.extendedRoundCount),roundCount:j.roundCount,extendedRoundCount:j.extendedRoundCount,cumulatedThousands:j.cumulatedThousands,nextRoundCumulatedThousands:0,resultType:Zn.Unknown,nextRoundType:ot.Unknown,playerResults:MS(j.playerResults),doras:{}};l(G),b(!1)}catch(G){console.error(G)}},[t,l,b,a]),te=w.useCallback(()=>{if(!s)return;const j=s.nextRoundType===ot.NextRound||s.nextRoundType===ot.NextRoundAndExtended?s.roundCount+1:s.roundCount,G=s.nextRoundType===ot.Extended||s.nextRoundType===ot.NextRoundAndExtended?s.extendedRoundCount+1:0,Ve={matchId:t,code:ov(t,j,G),roundCount:j,extendedRoundCount:G,cumulatedThousands:s.nextRoundCumulatedThousands,nextRoundCumulatedThousands:0,resultType:Zn.Unknown,nextRoundType:ot.Unknown,playerResults:MS(s.playerResults),doras:{}};l(Ve),v(-1)},[s,t,l]),be=w.useCallback(()=>{n({matchId:t})},[t,n]),[me,En]=w.useState(null),Fn=w.useCallback(j=>{const G=j.currentTarget.getAttribute("data-player-index");typeof G>"u"||!(s!=null&&s.playerResults[G])||En({index:G,tiles:(s==null?void 0:s.playerResults[G].waitingTiles)??[]})},[s==null?void 0:s.playerResults]),Yr=w.useCallback(()=>{En(null)},[]),Mn=w.useCallback(j=>{me&&(a({playerResults:{...s==null?void 0:s.playerResults,[me.index]:{...s==null?void 0:s.playerResults[me.index],waitingTiles:j}}}),En(null))},[me,s==null?void 0:s.playerResults,a]),rr=w.useCallback(()=>{me&&(a({playerResults:{...s==null?void 0:s.playerResults,[me.index]:{...s==null?void 0:s.playerResults[me.index],waitingTiles:[]}}}),En(null))},[me,s==null?void 0:s.playerResults,a]),Pc=w.useCallback(j=>{if(j.preventDefault(),!r)return;const G=prompt("對局名稱",r.name);G&&h(G)},[r,h]),Ka=w.useCallback(j=>{if(!i)return;const G=j.currentTarget.getAttribute("data-match-round-id");if(!G)return;const Ve=i[G].resultDetail;Ve&&(f(Ve),d(G),setTimeout(()=>{f(null)},2e4))},[i]),Rc=w.useCallback(()=>{f(null)},[]);return!r||!s?c.jsx("div",{children:"對局讀取失敗。"}):c.jsxs("div",{children:[c.jsxs("div",{className:"container mx-auto my-8 px-8 space-y-6",children:[c.jsxs("div",{className:"flex flex-row items-center gap-x-4 text-white",children:[c.jsxs("div",{className:"p-2 pl-4 pr-10 flex items-center gap-x-8 transition-[width] text-[4rem]",style:{background:"linear-gradient(280deg, transparent, transparent 22px, #00000080 23px, #00000080 100%)"},children:[c.jsxs("div",{className:"text-[0.5em]",children:[c.jsxs("div",{className:"text-[0.5em]",children:[r.name," ",c.jsx("button",{type:"button",onClick:Pc,children:c.jsx("span",{className:"material-symbols-outlined text-sm underline decoration-dotted",children:"edit"})})]}),c.jsxs("div",{className:"flex gap-x-8 items-center",children:[c.jsx("div",{children:c.jsx($r,{roundCount:s.roundCount,max:8})}),c.jsxs("div",{className:"flex flex-col justify-around",children:[c.jsxs("div",{className:"flex-1 flex flex-row items-center gap-x-3",children:[c.jsx("div",{className:"flex-1",children:c.jsx("img",{src:"/images/score-hundred.png",alt:"hundred",className:"h-2"})}),c.jsx("div",{className:"text-[0.4em] pb-1.5 leading-none",children:s.extendedRoundCount??0})]}),c.jsxs("div",{className:"flex-1 flex flex-row items-center gap-x-3",children:[c.jsx("div",{className:"flex-1",children:c.jsx("img",{src:"/images/score-thousand.png",alt:"thousand",className:"h-2"})}),c.jsx("div",{className:"text-[0.4em] pb-1.5 leading-none",children:s.cumulatedThousands??0})]})]})]})]}),c.jsxs("div",{className:"flex items-center gap-x-2",children:[o.map((j,G)=>c.jsx("button",{"data-index":G,onClick:M,className:"hover:opacity-80",children:c.jsx(hc,{className:"w-12 animate-[fadeIn_0.5s_ease-in-out]",children:j},j)})),c.jsx(De,{type:"button",color:"secondary",className:`${o.length===0&&"animate-bounce"}`,"data-index":"-1",onClick:M,children:"+懸賞"})]})]}),c.jsx("div",{className:"flex-1"}),c.jsx("div",{className:"shrink-0",children:(e==null?void 0:e.matchId)!==t&&c.jsx(De,{color:"success",type:"button",className:"animate-pulse",onClick:be,children:"開始OBS"})})]}),c.jsxs("div",{className:"text-right space-x-4",children:[r.activeResultDetail&&c.jsxs(De,{color:"secondary",type:"button",onClick:Rc,children:["結束播放中的和牌詳情",c.jsx("br",{}),c.jsx("span",{className:"text-xs",children:"(或最多20秒後自動結束)"})]}),s.nextRoundType!==ot.Unknown&&s.nextRoundType!==ot.End&&c.jsxs(De,{color:"success",type:"button",className:"animate-pulse",onClick:te,children:["進入",c.jsx($r,{roundCount:s.nextRoundType===ot.NextRound||s.nextRoundType===ot.NextRoundAndExtended?s.roundCount+1:s.roundCount,extendedRoundCount:s.nextRoundType===ot.Extended||s.nextRoundType===ot.NextRoundAndExtended?s.extendedRoundCount+1:0})]}),c.jsx(De,{color:"secondary",type:"button",onClick:tt,children:"流局"})]}),c.jsx("div",{className:"space-y-4",children:["0","1","2","3"].map(j=>c.jsxs("div",{className:"flex gap-x-2 items-center",children:[c.jsx("div",{className:"flex-1 text-[2.5rem]",children:c.jsx(Ds,{player:r.players[j],playerIndex:j,score:s.playerResults[j].afterScore,scoreChanges:s.playerResults[j].scoreChanges,isEast:op(j,s.roundCount),isRiichi:s.playerResults[j].isRiichi,waitingTiles:s.playerResults[j].waitingTiles,onClickWaitingTiles:Fn})}),c.jsx("div",{children:c.jsx("button",{type:"button",className:`${s.playerResults[j].isRiichi?"bg-orange-600 text-white":"bg-white text-orange-600 opacity-30"} h-16 w-16 border-2 border-orange-600  rounded-full text-lg`,onClick:H,"data-player-index":j,children:s.playerResults[j].isRiichi?"已立直":"立直?"})}),c.jsx("div",{className:"pl-6",children:c.jsx(De,{color:"danger",type:"button",onClick:ce,"data-player-index":j,children:"和了"})})]}))}),c.jsx("h4",{className:"text-3xl",children:"和牌記錄"}),c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"局數"}),c.jsx("th",{children:"玩家"}),c.jsx("th",{children:"分數＆細節"}),c.jsx("th",{className:"text-right px-2",children:"操作"})]})}),c.jsx("tbody",{children:p.map(j=>c.jsxs("tr",{className:"odd:bg-neutral-200",children:[c.jsx("td",{className:"text-center py-1",children:c.jsx($r,{roundCount:j.roundCount,extendedRoundCount:j.extendedRoundCount})}),c.jsx("td",{className:"text-center py-1",style:{background:r.players[j.resultDetail.winnerPlayerIndex].color},children:r.players[j.resultDetail.winnerPlayerIndex].name}),c.jsxs("td",{className:"text-center py-1",children:[c.jsx("p",{children:j.resultDetail.yakusInText.join(" ")}),c.jsx("p",{children:c.jsx(av,{han:Math.min(j.resultDetail.isYakuman?13:12,j.resultDetail.han),fu:j.resultDetail.fu,isManganRoundUp:r.setting.isManganRoundUp==="1"})})]}),c.jsx("td",{className:"text-right py-1 px-2",children:c.jsx(De,{color:j.hasBroadcasted?"secondary":"success",type:"button",className:j.hasBroadcasted?"opacity-50":"animate-pulse",onClick:Ka,"data-match-round-id":j.id,children:j.hasBroadcasted?"已播放過":"播放和牌詳情"})})]},j.id))})]}),c.jsx("h4",{className:"text-3xl",children:"分數"}),c.jsx(ap,{players:r.players,matchRounds:i??{},className:"w-full table-auto"}),c.jsx("div",{children:c.jsx(De,{color:"secondary",type:"button",onClick:Ze,children:"手動調整分數"})})]}),c.jsx(wr,{open:typeof g<"u",title:"選擇懸賞",onClose:U,children:c.jsx(zS,{hideRedTiles:!0,onSubmit:se,onRemove:Z,canRemove:typeof g<"u"&&g>0,defaultValue:typeof g<"u"?[o[g]]:void 0})}),c.jsx(wr,{open:!!me,title:"選擇待牌",onClose:Yr,children:c.jsx(zS,{hideRedTiles:!0,onSubmit:Mn,onRemove:rr,defaultValue:me==null?void 0:me.tiles,multiple:!0,canRemove:!0})}),c.jsx(k8,{match:r,currentMatchRound:s,open:E,onSubmit:$t,onClose:()=>m(!1),...y}),c.jsx(O8,{match:r,currentMatchRound:s,open:A,onSubmit:F,onClose:()=>T(!1),...y}),c.jsx(J8,{match:r,currentMatchRound:s,open:I,onSubmit:X,onClose:()=>b(!1),...y})]})}function Cn({children:t,label:e,action:n,...r}){return c.jsx("div",{...r,children:c.jsxs("label",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("p",{className:"text-sm text-gray-800 font-bold",children:e}),c.jsx("div",{children:n})]}),c.jsx("div",{children:t})]})})}function q(){return q=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},q.apply(this,arguments)}function Qr(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}var lv=t=>/^#?([A-Fa-f0-9]{3,4}){1,2}$/.test(t),Do=255,di=100,Sl=t=>{var{r:e,g:n,b:r,a:i}=t,s=Math.max(e,n,r),o=s-Math.min(e,n,r),a=o?s===e?(n-r)/o:s===n?2+(r-e)/o:4+(e-n)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*di:0,v:s/Do*di,a:i}},YR=t=>{var{h:e,s:n,l:r,a:i}=XR(t);return"hsla("+e+", "+n+"%, "+r+"%, "+i+")"},XR=t=>{var{h:e,s:n,v:r,a:i}=t,s=(200-n)*r/di;return{h:e,s:s>0&&s<200?n*r/di/(s<=di?s:200-s)*di:0,l:s/2,a:i}},JR=t=>{var{r:e,g:n,b:r}=t,i=e<<16|n<<8|r;return"#"+(s=>new Array(7-s.length).join("0")+s)(i.toString(16))},ez=t=>{var{r:e,g:n,b:r,a:i}=t,s=typeof i=="number"&&(i*255|256).toString(16).slice(1);return""+JR({r:e,g:n,b:r,a:i})+(s||"")},Iu=t=>Sl(tz(t)),tz=t=>{var e=t.replace("#","");/^#?/.test(t)&&e.length===3&&(t="#"+e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2));var n=new RegExp("[A-Za-z0-9]{2}","g"),[r,i,s=0,o]=t.match(n).map(a=>parseInt(a,16));return{r,g:i,b:s,a:(o??255)/Do}},hp=t=>{var{h:e,s:n,v:r,a:i}=t,s=e/60,o=n/di,a=r/di,l=Math.floor(s)%6,u=s-Math.floor(s),h=Do*a*(1-o),f=Do*a*(1-o*u),d=Do*a*(1-o*(1-u));a*=Do;var p={};switch(l){case 0:p.r=a,p.g=d,p.b=h;break;case 1:p.r=f,p.g=a,p.b=h;break;case 2:p.r=h,p.g=a,p.b=d;break;case 3:p.r=h,p.g=f,p.b=a;break;case 4:p.r=d,p.g=h,p.b=a;break;case 5:p.r=a,p.g=h,p.b=f;break}return p.r=Math.round(p.r),p.g=Math.round(p.g),p.b=Math.round(p.b),q({},p,{a:i})},nz=t=>{var{r:e,g:n,b:r,a:i}=hp(t);return"rgba("+e+", "+n+", "+r+", "+i+")"},rz=t=>{var{r:e,g:n,b:r}=t;return{r:e,g:n,b:r}},iz=t=>{var{h:e,s:n,l:r}=t;return{h:e,s:n,l:r}},uv=t=>JR(hp(t)),sz=t=>{var{h:e,s:n,v:r}=t;return{h:e,s:n,v:r}},Oo=t=>{var e,n,r,i,s,o,a,l;return typeof t=="string"&&lv(t)?(o=Iu(t),a=t):typeof t!="string"&&(o=t),o&&(r=sz(o),s=XR(o),i=hp(o),l=ez(i),a=uv(o),n=iz(s),e=rz(i)),{rgb:e,hsl:n,hsv:r,rgba:i,hsla:s,hsva:o,hex:a,hexa:l}};function JS(t){var e=w.useRef(t);return w.useEffect(()=>{e.current=t}),w.useCallback((n,r)=>e.current&&e.current(n,r),[])}var Hl=t=>"touches"in t,ZS=t=>{!Hl(t)&&t.preventDefault&&t.preventDefault()},eA=function(e,n,r){return n===void 0&&(n=0),r===void 0&&(r=1),e>r?r:e<n?n:e},tA=(t,e)=>{var n=t.getBoundingClientRect(),r=Hl(e)?e.touches[0]:e;return{left:eA((r.pageX-(n.left+window.pageXOffset))/n.width),top:eA((r.pageY-(n.top+window.pageYOffset))/n.height),width:n.width,height:n.height,x:r.pageX-(n.left+window.pageXOffset),y:r.pageY-(n.top+window.pageYOffset)}},oz=["prefixCls","className","onMove","onDown"],ZR=le.forwardRef((t,e)=>{var{prefixCls:n="w-color-interactive",className:r,onMove:i,onDown:s}=t,o=Qr(t,oz),a=w.useRef(null),l=w.useRef(!1),[u,h]=w.useState(!1),f=JS(i),d=JS(s),p=y=>l.current&&!Hl(y)?!1:(l.current=Hl(y),!0),g=w.useCallback(y=>{ZS(y);var _=Hl(y)?y.touches.length>0:y.buttons>0;_&&a.current?f&&f(tA(a.current,y),y):h(!1)},[f]),v=w.useCallback(()=>h(!1),[]),E=w.useCallback(y=>{var _=y?window.addEventListener:window.removeEventListener;_(l.current?"touchmove":"mousemove",g),_(l.current?"touchend":"mouseup",v)},[]);w.useEffect(()=>(E(u),()=>{u&&E(!1)}),[u,E]);var m=w.useCallback(y=>{ZS(y.nativeEvent),p(y.nativeEvent)&&(d&&d(tA(a.current,y.nativeEvent),y.nativeEvent),h(!0))},[d]);return c.jsx("div",q({},o,{className:[n,r||""].filter(Boolean).join(" "),style:q({},o.style,{touchAction:"none"}),ref:a,tabIndex:0,onMouseDown:m,onTouchStart:m}))});ZR.displayName="Interactive";const ek=ZR;var az=t=>{var{className:e,color:n,left:r,top:i,prefixCls:s}=t,o={position:"absolute",top:i,left:r},a={"--saturation-pointer-box-shadow":"rgb(255 255 255) 0px 0px 0px 1.5px, rgb(0 0 0 / 30%) 0px 0px 1px 1px inset, rgb(0 0 0 / 40%) 0px 0px 1px 2px",width:6,height:6,transform:"translate(-3px, -3px)",boxShadow:"var(--saturation-pointer-box-shadow)",borderRadius:"50%",backgroundColor:n};return w.useMemo(()=>c.jsx("div",{className:s+"-pointer "+(e||""),style:o,children:c.jsx("div",{className:s+"-fill",style:a})}),[i,r,n,e,s])},lz=["prefixCls","radius","pointer","className","hue","style","hsva","onChange"],tk=le.forwardRef((t,e)=>{var n,{prefixCls:r="w-color-saturation",radius:i=0,pointer:s,className:o,hue:a=0,style:l,hsva:u,onChange:h}=t,f=Qr(t,lz),d=q({width:200,height:200,borderRadius:i},l,{position:"relative"}),p=(v,E)=>{h&&u&&h({h:u.h,s:v.left*100,v:(1-v.top)*100,a:u.a})},g=w.useMemo(()=>{if(!u)return null;var v={top:100-u.v+"%",left:u.s+"%",color:YR(u)};return s&&typeof s=="function"?s(q({prefixCls:r},v)):c.jsx(az,q({prefixCls:r},v))},[u,s,r]);return c.jsx(ek,q({className:[r,o||""].filter(Boolean).join(" ")},f,{style:q({position:"absolute",inset:0,cursor:"crosshair",backgroundImage:"linear-gradient(0deg, #000, transparent), linear-gradient(90deg, #fff, hsl("+((n=u==null?void 0:u.h)!=null?n:a)+", 100%, 50%))"},d),ref:e,onMove:p,onDown:p,children:g}))});tk.displayName="Saturation";const uz=tk;var cz=["className","prefixCls","left","top","style","fillProps"],hz=t=>{var{className:e,prefixCls:n,left:r,top:i,style:s,fillProps:o}=t,a=Qr(t,cz),l=q({},s,{position:"absolute",left:r,top:i}),u=q({width:18,height:18,boxShadow:"var(--alpha-pointer-box-shadow)",borderRadius:"50%",backgroundColor:"var(--alpha-pointer-background-color)"},o==null?void 0:o.style,{transform:r?"translate(-9px, -1px)":"translate(-1px, -9px)"});return c.jsx("div",q({className:n+"-pointer "+(e||""),style:l},a,{children:c.jsx("div",q({className:n+"-fill"},o,{style:u}))}))},fz=["prefixCls","className","hsva","background","bgProps","innerProps","pointerProps","radius","width","height","direction","style","onChange","pointer"],dz="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAMUlEQVQ4T2NkYGAQYcAP3uCTZhw1gGGYhAGBZIA/nYDCgBDAm9BGDWAAJyRCgLaBCAAgXwixzAS0pgAAAABJRU5ErkJggg==",nk=le.forwardRef((t,e)=>{var{prefixCls:n="w-color-alpha",className:r,hsva:i,background:s,bgProps:o={},innerProps:a={},pointerProps:l={},radius:u=0,width:h,height:f=16,direction:d="horizontal",style:p,onChange:g,pointer:v}=t,E=Qr(t,fz),m=I=>{g&&g(q({},i,{a:d==="horizontal"?I.left:I.top}),I)},y=YR(Object.assign({},i,{a:1})),_="linear-gradient(to "+(d==="horizontal"?"right":"bottom")+", rgba(244, 67, 54, 0) 0%, "+y+" 100%)",S={};d==="horizontal"?S.left=i.a*100+"%":S.top=i.a*100+"%";var A=q({"--alpha-background-color":"#fff","--alpha-pointer-background-color":"rgb(248, 248, 248)","--alpha-pointer-box-shadow":"rgb(0 0 0 / 37%) 0px 1px 4px 0px",borderRadius:u,background:"url("+dz+") left center",backgroundColor:"var(--alpha-background-color)"},p,{position:"relative"},{width:h,height:f}),T=v&&typeof v=="function"?v(q({prefixCls:n},l,S)):c.jsx(hz,q({},l,{prefixCls:n},S));return c.jsxs("div",q({},E,{className:[n,n+"-"+d,r||""].filter(Boolean).join(" "),style:A,ref:e,children:[c.jsx("div",q({},o,{style:q({inset:0,position:"absolute",background:s||_,borderRadius:u},o.style)})),c.jsx(ek,q({},a,{style:q({},a.style,{inset:0,zIndex:1,position:"absolute"}),onMove:m,onDown:m,children:T}))]}))});nk.displayName="Alpha";const cv=nk;var pz=["prefixCls","placement","label","value","className","style","labelStyle","inputStyle","onChange","onBlur"],yz=t=>/^#?([A-Fa-f0-9]{3,4}){1,2}$/.test(t),gz=t=>Number(String(t).replace(/%/g,"")),rk=le.forwardRef((t,e)=>{var{prefixCls:n="w-color-editable-input",placement:r="bottom",label:i,value:s,className:o,style:a,labelStyle:l,inputStyle:u,onChange:h,onBlur:f}=t,d=Qr(t,pz),[p,g]=w.useState(s),v=w.useRef(!1);w.useEffect(()=>{t.value!==p&&(v.current||g(t.value))},[t.value]);function E(A,T){var I=(T||A.target.value).trim().replace(/^#/,"");yz(I)&&h&&h(A,I);var b=gz(I);isNaN(b)||h&&h(A,b),g(I)}function m(A){v.current=!1,g(t.value),f&&f(A)}var y={};r==="bottom"&&(y.flexDirection="column"),r==="top"&&(y.flexDirection="column-reverse"),r==="left"&&(y.flexDirection="row-reverse");var _=q({"--editable-input-label-color":"rgb(153, 153, 153)","--editable-input-box-shadow":"rgb(204 204 204) 0px 0px 0px 1px inset","--editable-input-color":"#666",position:"relative",alignItems:"center",display:"flex",fontSize:11},y,a),S=q({width:"100%",paddingTop:2,paddingBottom:2,paddingLeft:3,paddingRight:3,fontSize:11,background:"transparent",boxSizing:"border-box",border:"none",color:"var(--editable-input-color)",boxShadow:"var(--editable-input-box-shadow)"},u);return c.jsxs("div",{className:[n,o||""].filter(Boolean).join(" "),style:_,children:[c.jsx("input",q({ref:e,value:p,onChange:E,onBlur:m,autoComplete:"off",onFocus:()=>v.current=!0},d,{style:S})),i&&c.jsx("span",{style:q({color:"var(--editable-input-label-color)",textTransform:"capitalize"},l),children:i})]})});rk.displayName="EditableInput";const Al=rk;var mz=["prefixCls","hsva","placement","rProps","gProps","bProps","aProps","className","style","onChange"],ik=le.forwardRef((t,e)=>{var{prefixCls:n="w-color-editable-input-rgba",hsva:r,placement:i="bottom",rProps:s={},gProps:o={},bProps:a={},aProps:l={},className:u,style:h,onChange:f}=t,d=Qr(t,mz),p=r?hp(r):{};function g(E){var m=Number(E.target.value);m&&m>255&&(E.target.value="255"),m&&m<0&&(E.target.value="0")}var v=(E,m,y)=>{typeof E=="number"&&(m==="a"&&(E<0&&(E=0),E>100&&(E=100),f&&f(Oo(Sl(q({},p,{a:E/100}))))),E>255&&(E=255,y.target.value="255"),E<0&&(E=0,y.target.value="0"),m==="r"&&f&&f(Oo(Sl(q({},p,{r:E})))),m==="g"&&f&&f(Oo(Sl(q({},p,{g:E})))),m==="b"&&f&&f(Oo(Sl(q({},p,{b:E})))))};return c.jsxs("div",q({ref:e,className:[n,u||""].filter(Boolean).join(" ")},d,{style:q({fontSize:11,display:"flex"},h),children:[c.jsx(Al,q({label:"R",value:p.r||0,onBlur:g,placement:i,onChange:(E,m)=>v(m,"r",E)},s,{style:q({},s.style)})),c.jsx(Al,q({label:"G",value:p.g||0,onBlur:g,placement:i,onChange:(E,m)=>v(m,"g",E)},o,{style:q({marginLeft:5},s.style)})),c.jsx(Al,q({label:"B",value:p.b||0,onBlur:g,placement:i,onChange:(E,m)=>v(m,"b",E)},a,{style:q({marginLeft:5},a.style)})),l&&c.jsx(Al,q({label:"A",value:p.a?parseInt(String(p.a*100),10):0,onBlur:g,placement:i,onChange:(E,m)=>v(m,"a",E)},l,{style:q({marginLeft:5},l.style)}))]}))});ik.displayName="EditableInputRGBA";const vz=ik;var _z=["prefixCls","className","hue","onChange","direction"],sk=le.forwardRef((t,e)=>{var{prefixCls:n="w-color-hue",className:r,hue:i=0,onChange:s,direction:o="horizontal"}=t,a=Qr(t,_z);return c.jsx(cv,q({ref:e,className:n+" "+(r||"")},a,{direction:o,background:"linear-gradient(to "+(o==="horizontal"?"right":"bottom")+", rgb(255, 0, 0) 0%, rgb(255, 255, 0) 17%, rgb(0, 255, 0) 33%, rgb(0, 255, 255) 50%, rgb(0, 0, 255) 67%, rgb(255, 0, 255) 83%, rgb(255, 0, 0) 100%)",hsva:{h:i,s:100,v:100,a:i/360},onChange:(l,u)=>{s&&s({h:o==="horizontal"?360*u.left:360*u.top})}}))});sk.displayName="Hue";const wz=sk;var Ez=["prefixCls","className","color","colors","style","rectProps","onChange","addonAfter","addonBefore","rectRender"],ok=le.forwardRef((t,e)=>{var{prefixCls:n="w-color-swatch",className:r,color:i,colors:s=[],style:o,rectProps:a={},onChange:l,addonAfter:u,addonBefore:h,rectRender:f}=t,d=Qr(t,Ez),p=q({"--swatch-background-color":"rgb(144, 19, 254)",background:"var(--swatch-background-color)",height:15,width:15,marginRight:5,marginBottom:5,cursor:"pointer",position:"relative",outline:"none",borderRadius:2},a.style),g=(v,E)=>{l&&l(Iu(v),Oo(Iu(v)),E)};return c.jsxs("div",q({ref:e},d,{className:[n,r||""].filter(Boolean).join(" "),style:q({display:"flex",flexWrap:"wrap",position:"relative"},o),children:[h&&le.isValidElement(h)&&h,s&&Array.isArray(s)&&s.map((v,E)=>{var m="",y="";typeof v=="string"&&(m=v,y=v),typeof v=="object"&&v.color&&(m=v.title||v.color,y=v.color);var _=i&&i.toLocaleLowerCase()===y.toLocaleLowerCase(),S=f&&f({key:E,title:m,color:y,checked:!!_,style:q({},p,{background:y}),onClick:T=>g(y,T)});if(S)return S;var A=a.children&&le.isValidElement(a.children)?le.cloneElement(a.children,{color:y,checked:_}):null;return c.jsx("div",q({tabIndex:0,title:m,onClick:T=>g(y,T)},a,{children:A,style:q({},p,{background:y})}),E)}),u&&le.isValidElement(u)&&u]}))});ok.displayName="Swatch";const xz=ok;var Sz=["prefixCls","className","onChange","width","presetColors","color","editableDisable","disableAlpha","style"],Az=["#D0021B","#F5A623","#f8e61b","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF"],nA=t=>c.jsx("div",{style:{boxShadow:"rgb(0 0 0 / 60%) 0px 0px 2px",width:4,top:1,bottom:1,left:t.left,borderRadius:1,position:"absolute",backgroundColor:"#fff"}}),ak=le.forwardRef((t,e)=>{var{prefixCls:n="w-color-sketch",className:r,onChange:i,width:s=218,presetColors:o=Az,color:a,editableDisable:l=!0,disableAlpha:u=!1,style:h}=t,f=Qr(t,Sz),[d,p]=w.useState({h:209,s:36,v:90,a:1});w.useEffect(()=>{typeof a=="string"&&lv(a)&&p(Iu(a)),typeof a=="object"&&p(a)},[a]);var g=T=>{p(T),i&&i(Oo(T))},v=(T,I)=>{typeof T=="string"&&lv(T)&&/(3|6)/.test(String(T.length))&&g(Iu(T))},E=T=>g(q({},d,{a:T.a})),m=T=>g(q({},d,T,{a:d.a})),y=q({"--sketch-background":"rgb(255, 255, 255)","--sketch-box-shadow":"rgb(0 0 0 / 15%) 0px 0px 0px 1px, rgb(0 0 0 / 15%) 0px 8px 16px","--sketch-swatch-box-shadow":"rgb(0 0 0 / 15%) 0px 0px 0px 1px inset","--sketch-alpha-box-shadow":"rgb(0 0 0 / 15%) 0px 0px 0px 1px inset, rgb(0 0 0 / 25%) 0px 0px 4px inset","--sketch-swatch-border-top":"1px solid rgb(238, 238, 238)",background:"var(--sketch-background)",borderRadius:4,boxShadow:"var(--sketch-box-shadow)",width:s},h),_={borderRadius:2,background:nz(d),boxShadow:"var(--sketch-alpha-box-shadow)"},S={borderTop:"var(--sketch-swatch-border-top)",paddingTop:10,paddingLeft:10},A={marginRight:10,marginBottom:10,borderRadius:3,boxShadow:"var(--sketch-swatch-box-shadow)"};return c.jsxs("div",q({},f,{className:n+" "+(r||""),ref:e,style:y,children:[c.jsxs("div",{style:{padding:"10px 10px 8px"},children:[c.jsx(uz,{hsva:d,style:{width:"auto",height:150},onChange:m}),c.jsxs("div",{style:{display:"flex",marginTop:4},children:[c.jsxs("div",{style:{flex:1},children:[c.jsx(wz,{width:"auto",height:10,hue:d.h,pointer:nA,innerProps:{style:{marginLeft:1,marginRight:5}},onChange:T=>g(q({},d,T))}),!u&&c.jsx(cv,{width:"auto",height:10,hsva:d,pointer:nA,style:{marginTop:4},innerProps:{style:{marginLeft:1,marginRight:5}},onChange:E})]}),!u&&c.jsx(cv,{width:24,height:24,hsva:d,radius:2,style:{marginLeft:4},bgProps:{style:{background:"transparent"}},innerProps:{style:_},pointer:()=>c.jsx(w.Fragment,{})})]})]}),l&&c.jsxs("div",{style:{display:"flex",margin:"0 10px 3px 10px"},children:[c.jsx(Al,{label:"Hex",value:uv(d).replace(/^#/,"").toLocaleUpperCase(),onChange:(T,I)=>v(I),style:{minWidth:58}}),c.jsx(vz,{hsva:d,style:{marginLeft:6},aProps:u?!1:{},onChange:T=>g(T.hsva)})]}),o&&o.length>0&&c.jsx(xz,{style:S,colors:o,color:uv(d),onChange:T=>g(T),rectProps:{style:A}})]}))});ak.displayName="Sketch";const Tz=ak;function lk({value:t,onChange:e,onBlur:n}){const r=w.useCallback(i=>{e==null||e(i.hex)},[e]);return c.jsx(Tz,{disableAlpha:!0,onChange:r,onBlur:n,color:t})}const Iz=async()=>new Promise(t=>{const e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","image/*"),e.addEventListener("change",n=>{var i;const r=(i=n.target.files)==null?void 0:i[0];r&&t(r)}),e.click()}),rA=({children:t,helperText:e,onChangeFile:n=async()=>{},...r})=>{const i=w.useMemo(()=>t||c.jsxs("div",{className:"space-y-2 text-center text-xs",children:[c.jsx("p",{children:c.jsx("span",{className:"material-symbols-outlined",children:"upload"})}),c.jsx("p",{children:"拖拉檔案上傳 ／ 點擊上傳"}),c.jsx("p",{children:e})]}),[t,e]),[{loading:s},o]=lp(n),a=w.useCallback(()=>{Iz().then(o)},[o]),l=w.useMemo(()=>({onFiles:h=>{const f=h.find(d=>!!d);f&&o(f)}}),[o]),[u]=P8(l);return c.jsxs("div",{className:"relative",children:[c.jsx("div",{...r,className:"bg-neutral-50 border border-neutral-200 border-dashed p-1 cursor-pointer hover:border-neutral-400 text-neutral-400",onClick:a,...u,children:i}),s&&c.jsx("div",{className:"absolute z-10 cursor-not-allowed inset-0 bg-neutral-300 text-white flex gap-x-1 items-center justify-center",children:c.jsx("span",{className:"material-symbols-outlined animate-spin",children:"progress_activity"})})]})};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uk="firebasestorage.googleapis.com",ck="storageBucket",Cz=2*60*1e3,bz=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je extends Ls{constructor(e,n,r=0){super(cg(e),`Firebase Storage: ${n} (${cg(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Je.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return cg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ye;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ye||(Ye={}));function cg(t){return"storage/"+t}function K0(){const t="An unknown error occurred, please check the error payload for server response.";return new Je(Ye.UNKNOWN,t)}function Pz(t){return new Je(Ye.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function Rz(t){return new Je(Ye.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function kz(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Je(Ye.UNAUTHENTICATED,t)}function Nz(){return new Je(Ye.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function Dz(t){return new Je(Ye.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function Oz(){return new Je(Ye.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function jz(){return new Je(Ye.CANCELED,"User canceled the upload/download.")}function $z(t){return new Je(Ye.INVALID_URL,"Invalid URL '"+t+"'.")}function Fz(t){return new Je(Ye.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function Mz(){return new Je(Ye.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+ck+"' property when initializing the app?")}function Vz(){return new Je(Ye.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Lz(){return new Je(Ye.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function Uz(t){return new Je(Ye.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function hv(t){return new Je(Ye.INVALID_ARGUMENT,t)}function hk(){return new Je(Ye.APP_DELETED,"The Firebase app was deleted.")}function Bz(t){return new Je(Ye.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function ql(t,e){return new Je(Ye.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function dl(t){throw new Je(Ye.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=yn.makeFromUrl(e,n)}catch{return new yn(e,"")}if(r.path==="")return r;throw Fz(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(S){S.path.charAt(S.path.length-1)==="/"&&(S.path_=S.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),l={bucket:1,path:3};function u(S){S.path_=decodeURIComponent(S.path)}const h="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",p=new RegExp(`^https?://${f}/${h}/b/${i}/o${d}`,"i"),g={bucket:1,path:3},v=n===uk?"(?:storage.googleapis.com|storage.cloud.google.com)":n,E="([^?#]*)",m=new RegExp(`^https?://${v}/${i}/${E}`,"i"),_=[{regex:a,indices:l,postModify:s},{regex:p,indices:g,postModify:u},{regex:m,indices:{bucket:1,path:2},postModify:u}];for(let S=0;S<_.length;S++){const A=_[S],T=A.regex.exec(e);if(T){const I=T[A.indices.bucket];let b=T[A.indices.path];b||(b=""),r=new yn(I,b),A.postModify(r);break}}if(r==null)throw $z(e);return r}}class zz{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wz(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function l(){return a===2}let u=!1;function h(...E){u||(u=!0,e.apply(null,E))}function f(E){i=setTimeout(()=>{i=null,t(p,l())},E)}function d(){s&&clearTimeout(s)}function p(E,...m){if(u){d();return}if(E){d(),h.call(null,E,...m);return}if(l()||o){d(),h.call(null,E,...m);return}r<64&&(r*=2);let _;a===1?(a=2,_=0):_=(r+Math.random())*1e3,f(_)}let g=!1;function v(E){g||(g=!0,d(),!u&&(i!==null?(E||(a=2),clearTimeout(i),f(0)):E||(a=1)))}return f(0),s=setTimeout(()=>{o=!0,v(!0)},n),v}function Gz(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hz(t){return t!==void 0}function qz(t){return typeof t=="object"&&!Array.isArray(t)}function Q0(t){return typeof t=="string"||t instanceof String}function iA(t){return Y0()&&t instanceof Blob}function Y0(){return typeof Blob<"u"&&!y$()}function sA(t,e,n,r){if(r<e)throw hv(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw hv(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X0(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function fk(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Es;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Es||(Es={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kz(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qz{constructor(e,n,r,i,s,o,a,l,u,h,f,d=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=u,this.progressCallback_=h,this.connectionFactory_=f,this.retry=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,g)=>{this.resolve_=p,this.reject_=g,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new nh(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const l=a.loaded,u=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,u)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===Es.NO_ERROR,l=s.getStatus();if(!a||Kz(l,this.additionalRetryCodes_)&&this.retry){const h=s.getErrorCode()===Es.ABORT;r(!1,new nh(!1,null,h));return}const u=this.successCodes_.indexOf(l)!==-1;r(!0,new nh(u,s))})},n=(r,i)=>{const s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());Hz(l)?s(l):s()}catch(l){o(l)}else if(a!==null){const l=K0();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(i.canceled){const l=this.appDelete_?hk():jz();o(l)}else{const l=Oz();o(l)}};this.canceled_?n(!1,new nh(!1,null,!0)):this.backoffId_=Wz(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Gz(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class nh{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function Yz(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function Xz(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Jz(t,e){e&&(t["X-Firebase-GMPID"]=e)}function Zz(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function eW(t,e,n,r,i,s,o=!0){const a=fk(t.urlParams),l=t.url+a,u=Object.assign({},t.headers);return Jz(u,e),Yz(u,n),Xz(u,s),Zz(u,r),new Qz(l,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tW(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function nW(...t){const e=tW();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(Y0())return new Blob(t);throw new Je(Ye.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function rW(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iW(t){if(typeof atob>"u")throw Uz("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class hg{constructor(e,n){this.data=e,this.contentType=n||null}}function sW(t,e){switch(t){case fr.RAW:return new hg(dk(e));case fr.BASE64:case fr.BASE64URL:return new hg(pk(t,e));case fr.DATA_URL:return new hg(aW(e),lW(e))}throw K0()}function dk(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const s=r,o=t.charCodeAt(++n);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function oW(t){let e;try{e=decodeURIComponent(t)}catch{throw ql(fr.DATA_URL,"Malformed data URL.")}return dk(e)}function pk(t,e){switch(t){case fr.BASE64:{const i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw ql(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case fr.BASE64URL:{const i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw ql(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=iW(e)}catch(i){throw i.message.includes("polyfill")?i:ql(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class yk{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw ql(fr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=uW(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function aW(t){const e=new yk(t);return e.base64?pk(fr.BASE64,e.rest):oW(e.rest)}function lW(t){return new yk(t).contentType}function uW(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e,n){let r=0,i="";iA(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(iA(this.data_)){const r=this.data_,i=rW(r,e,n);return i===null?null:new si(i)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new si(r,!0)}}static getBlob(...e){if(Y0()){const n=e.map(r=>r instanceof si?r.data_:r);return new si(nW.apply(null,n))}else{const n=e.map(o=>Q0(o)?sW(fr.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const i=new Uint8Array(r);let s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new si(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gk(t){let e;try{e=JSON.parse(t)}catch{return null}return qz(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cW(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function hW(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function mk(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fW(t,e){return e}class Kt{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||fW}}let rh=null;function dW(t){return!Q0(t)||t.length<2?t:mk(t)}function vk(){if(rh)return rh;const t=[];t.push(new Kt("bucket")),t.push(new Kt("generation")),t.push(new Kt("metageneration")),t.push(new Kt("name","fullPath",!0));function e(s,o){return dW(o)}const n=new Kt("name");n.xform=e,t.push(n);function r(s,o){return o!==void 0?Number(o):o}const i=new Kt("size");return i.xform=r,t.push(i),t.push(new Kt("timeCreated")),t.push(new Kt("updated")),t.push(new Kt("md5Hash",null,!0)),t.push(new Kt("cacheControl",null,!0)),t.push(new Kt("contentDisposition",null,!0)),t.push(new Kt("contentEncoding",null,!0)),t.push(new Kt("contentLanguage",null,!0)),t.push(new Kt("contentType",null,!0)),t.push(new Kt("metadata","customMetadata",!0)),rh=t,rh}function pW(t,e){function n(){const r=t.bucket,i=t.fullPath,s=new yn(r,i);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function yW(t,e,n){const r={};r.type="file";const i=n.length;for(let s=0;s<i;s++){const o=n[s];r[o.local]=o.xform(r,e[o.server])}return pW(r,t),r}function _k(t,e,n){const r=gk(e);return r===null?null:yW(t,r,n)}function gW(t,e,n,r){const i=gk(e);if(i===null||!Q0(i.downloadTokens))return null;const s=i.downloadTokens;if(s.length===0)return null;const o=encodeURIComponent;return s.split(",").map(u=>{const h=t.bucket,f=t.fullPath,d="/b/"+o(h)+"/o/"+o(f),p=X0(d,n,r),g=fk({alt:"media",token:u});return p+g})[0]}function mW(t,e){const n={},r=e.length;for(let i=0;i<r;i++){const s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}class wk{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ek(t){if(!t)throw K0()}function vW(t,e){function n(r,i){const s=_k(t,i,e);return Ek(s!==null),s}return n}function _W(t,e){function n(r,i){const s=_k(t,i,e);return Ek(s!==null),gW(s,i,t.host,t._protocol)}return n}function xk(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=Nz():i=kz():n.getStatus()===402?i=Rz(t.bucket):n.getStatus()===403?i=Dz(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function wW(t){const e=xk(t);function n(r,i){let s=e(r,i);return r.getStatus()===404&&(s=Pz(t.path)),s.serverResponse=i.serverResponse,s}return n}function EW(t,e,n){const r=e.fullServerUrl(),i=X0(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new wk(i,s,_W(t,n),o);return a.errorHandler=wW(e),a}function xW(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function SW(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=xW(null,e)),r}function AW(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let _="";for(let S=0;S<2;S++)_=_+Math.random().toString().slice(2);return _}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const u=SW(e,r,i),h=mW(u,n),f="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+l+`\r
Content-Type: `+u.contentType+`\r
\r
`,d=`\r
--`+l+"--",p=si.getBlob(f,r,d);if(p===null)throw Vz();const g={name:u.fullPath},v=X0(s,t.host,t._protocol),E="POST",m=t.maxUploadRetryTime,y=new wk(v,E,vW(t,n),m);return y.urlParams=g,y.headers=o,y.body=p.uploadData(),y.errorHandler=xk(e),y}class TW{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Es.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Es.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Es.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i){if(this.sent_)throw dl("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw dl("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw dl("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw dl("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw dl("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class IW extends TW{initXhr(){this.xhr_.responseType="text"}}function Sk(){return new IW}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Os{constructor(e,n){this._service=e,n instanceof yn?this._location=n:this._location=yn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Os(e,n)}get root(){const e=new yn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return mk(this._location.path)}get storage(){return this._service}get parent(){const e=cW(this._location.path);if(e===null)return null;const n=new yn(this._location.bucket,e);return new Os(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw Bz(e)}}function CW(t,e,n){t._throwIfRoot("uploadBytes");const r=AW(t.storage,t._location,vk(),new si(e,!0),n);return t.storage.makeRequestWithTokens(r,Sk).then(i=>({metadata:i,ref:t}))}function bW(t){t._throwIfRoot("getDownloadURL");const e=EW(t.storage,t._location,vk());return t.storage.makeRequestWithTokens(e,Sk).then(n=>{if(n===null)throw Lz();return n})}function PW(t,e){const n=hW(t._location.path,e),r=new yn(t._location.bucket,n);return new Os(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RW(t){return/^[A-Za-z]+:\/\//.test(t)}function kW(t,e){return new Os(t,e)}function Ak(t,e){if(t instanceof J0){const n=t;if(n._bucket==null)throw Mz();const r=new Os(n,n._bucket);return e!=null?Ak(r,e):r}else return e!==void 0?PW(t,e):t}function NW(t,e){if(e&&RW(e)){if(t instanceof J0)return kW(t,e);throw hv("To use ref(service, url), the first argument must be a Storage instance.")}else return Ak(t,e)}function oA(t,e){const n=e==null?void 0:e[ck];return n==null?null:yn.makeFromBucketSpec(n,t)}function DW(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:j_(i,t.app.options.projectId))}class J0{constructor(e,n,r,i,s){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=uk,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Cz,this._maxUploadRetryTime=bz,this._requests=new Set,i!=null?this._bucket=yn.makeFromBucketSpec(i,this._host):this._bucket=oA(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=yn.makeFromBucketSpec(this._url,e):this._bucket=oA(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){sA("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){sA("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Os(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new zz(hk());{const o=eW(e,this._appId,r,i,n,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const aA="@firebase/storage",lA="0.11.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tk="storage";function OW(t,e,n){return t=Ot(t),CW(t,e,n)}function jW(t){return t=Ot(t),bW(t)}function $W(t,e){return t=Ot(t),NW(t,e)}function FW(t=L_(),e){t=Ot(t);const r=M_(t,Tk).getImmediate({identifier:e}),i=O_("storage");return i&&MW(r,...i),r}function MW(t,e,n,r={}){DW(t,e,n,r)}function VW(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new J0(n,r,i,e,V_)}function LW(){ca(new bs(Tk,VW,"PUBLIC").setMultipleInstances(!0)),mr(aA,lA,""),mr(aA,lA,"esm2017")}LW();const UW=FW(V0),uA=(t,e)=>{const n=e??`images/uploads/ungroup/image_${U0()}`,r=$W(UW,n);return OW(r,t).then(async i=>({url:await jW(i.ref)}))},cA={title:"",name:"新的玩家",color:"#FF0000",proPicUrl:""};function Ik({defaultValue:t,onSubmit:e}){const{reset:n,setValue:r,control:i,handleSubmit:s}=cp({defaultValues:cA}),[{loading:o},a]=lp(e,[e]),l=w.useMemo(()=>s(g=>{a(g)}),[a,s]),u=up({control:i}),h=w.useCallback(g=>uA(g).then(({url:v})=>{r("proPicUrl",v)}),[r]),f=w.useCallback(()=>{r("proPicUrl",null)},[r]),d=w.useCallback(g=>uA(g).then(({url:v})=>{r("teamPicUrl",v)}),[r]),p=w.useCallback(()=>{r("teamPicUrl",null)},[r]);return w.useEffect(()=>{n(t??cA)},[t,n]),c.jsxs("form",{onSubmit:l,className:"space-y-6",children:[c.jsxs("div",{className:"flex gap-x-6",children:[c.jsx("div",{className:"shrink-0",children:c.jsx(Cn,{label:"顏色",children:c.jsx(on,{name:"color",control:i,render:({field:g})=>c.jsx(lk,{...g}),disabled:o})})}),c.jsxs("div",{className:"flex-1 space-y-6",children:[c.jsx(Cn,{label:"稱號",children:c.jsx(on,{name:"title",control:i,render:({field:g})=>c.jsx(fi,{type:"text",...g,placeholder:"例：天鳳鳳位、雀魂x段",disabled:o})})}),c.jsx(Cn,{className:"mb-6",label:"名字",children:c.jsx(on,{name:"name",control:i,rules:{required:!0},render:({field:g})=>c.jsx(fi,{...g}),disabled:o})}),c.jsxs("div",{className:"grid grid-cols-2 gap-x-6",children:[c.jsx(Cn,{className:"mb-6",label:"玩家圖片",action:u.proPicUrl&&c.jsx("a",{href:"#",className:"text-xs underline text-teal-800",onClick:f,children:"移除"}),children:c.jsx(rA,{helperText:"建議大小 360px * 500px (18:25)",onChangeFile:h,children:u.proPicUrl&&c.jsx("img",{className:"aspect-[18/25]",src:u.proPicUrl})})}),c.jsx(Cn,{className:"mb-6",label:"隊伍圖片",action:u.teamPicUrl&&c.jsx("a",{href:"#",className:"text-xs underline text-teal-800",onClick:p,children:"移除"}),children:c.jsx(rA,{helperText:"建議大小 500px * 500px (1:1)",onChangeFile:d,children:u.teamPicUrl&&c.jsx("img",{className:"aspect-square",src:u.teamPicUrl})})})]})]})]}),c.jsxs("div",{children:[c.jsx("div",{className:"mb-2",children:"預覽"}),c.jsx("div",{className:"text-[4rem] p-4 bg-gray-800 text-white",children:c.jsx(Ds,{player:u,score:25e3,waitingTiles:["5m","6m","7m"],isRiichi:!0,isEast:!0})})]}),c.jsx("div",{children:c.jsx(De,{type:"submit",loading:o,children:"儲存"})})]})}function BW(){const[t,e]=w.useState(),n=w.useMemo(()=>[],[]),[r,i]=Ci(!1),s=w.useCallback(()=>i(!1),[i]),o=w.useCallback(()=>{e(void 0),i(!0)},[i]),a=w.useCallback(u=>{e(u),i(!0)},[i]),l=w.useCallback(()=>Promise.resolve(),[]);return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"container mx-auto max-w-screen-sm space-y-4 py-16",children:[c.jsx("div",{className:"shrink-0",children:c.jsx("a",{href:"/",className:"underline",children:"< 回上一頁"})}),c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("div",{children:c.jsx("h1",{className:"text-4xl",children:"玩家"})}),c.jsx("div",{children:c.jsx(De,{onClick:o,children:"新增"})})]}),c.jsx("div",{className:"space-y-2",children:n.map(u=>c.jsx(ns,{player:u,onClickEdit:a}))})]}),c.jsx(wr,{title:"新增／修改玩家",open:r,onClose:s,children:c.jsx("div",{className:"container space-y-6",children:c.jsx(Ik,{onSubmit:l,defaultValue:t})})})]})}const zW={0:"東",1:"南",2:"西",3:"北"};function WW({playerIndex:t,...e}){return c.jsx("span",{...e,children:zW[t]})}var GW=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},$,Z0=Z0||{},ne=GW||self;function fp(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function pc(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function HW(t){return Object.prototype.hasOwnProperty.call(t,fg)&&t[fg]||(t[fg]=++qW)}var fg="closure_uid_"+(1e9*Math.random()>>>0),qW=0;function KW(t,e,n){return t.call.apply(t.bind,arguments)}function QW(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function zt(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?zt=KW:zt=QW,zt.apply(null,arguments)}function ih(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function St(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function Gi(){this.s=this.s,this.o=this.o}var YW=0;Gi.prototype.s=!1;Gi.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),YW!=0)&&HW(this)};Gi.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Ck=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function ew(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function hA(t,e){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(fp(r)){const i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function Wt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Wt.prototype.h=function(){this.defaultPrevented=!0};var XW=function(){if(!ne.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{ne.addEventListener("test",()=>{},e),ne.removeEventListener("test",()=>{},e)}catch{}return t}();function Cu(t){return/^[\s\xa0]*$/.test(t)}function dp(){var t=ne.navigator;return t&&(t=t.userAgent)?t:""}function ur(t){return dp().indexOf(t)!=-1}function tw(t){return tw[" "](t),t}tw[" "]=function(){};function JW(t,e){var n=WG;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var ZW=ur("Opera"),Ta=ur("Trident")||ur("MSIE"),bk=ur("Edge"),fv=bk||Ta,Pk=ur("Gecko")&&!(dp().toLowerCase().indexOf("webkit")!=-1&&!ur("Edge"))&&!(ur("Trident")||ur("MSIE"))&&!ur("Edge"),eG=dp().toLowerCase().indexOf("webkit")!=-1&&!ur("Edge");function Rk(){var t=ne.document;return t?t.documentMode:void 0}var dv;e:{var dg="",pg=function(){var t=dp();if(Pk)return/rv:([^\);]+)(\)|;)/.exec(t);if(bk)return/Edge\/([\d\.]+)/.exec(t);if(Ta)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(eG)return/WebKit\/(\S+)/.exec(t);if(ZW)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(pg&&(dg=pg?pg[1]:""),Ta){var yg=Rk();if(yg!=null&&yg>parseFloat(dg)){dv=String(yg);break e}}dv=dg}var pv;if(ne.document&&Ta){var fA=Rk();pv=fA||parseInt(dv,10)||void 0}else pv=void 0;var tG=pv;function bu(t,e){if(Wt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(Pk){e:{try{tw(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:nG[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&bu.$.h.call(this)}}St(bu,Wt);var nG={2:"touch",3:"pen",4:"mouse"};bu.prototype.h=function(){bu.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var yc="closure_listenable_"+(1e6*Math.random()|0),rG=0;function iG(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++rG,this.fa=this.ia=!1}function pp(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function nw(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function sG(t,e){for(const n in t)e.call(void 0,t[n],n,t)}function kk(t){const e={};for(const n in t)e[n]=t[n];return e}const dA="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Nk(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<dA.length;s++)n=dA[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function yp(t){this.src=t,this.g={},this.h=0}yp.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=gv(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new iG(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function yv(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=Ck(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(pp(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function gv(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var rw="closure_lm_"+(1e6*Math.random()|0),gg={};function Dk(t,e,n,r,i){if(r&&r.once)return jk(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)Dk(t,e[s],n,r,i);return null}return n=ow(n),t&&t[yc]?t.O(e,n,pc(r)?!!r.capture:!!r,i):Ok(t,e,n,!1,r,i)}function Ok(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=pc(i)?!!i.capture:!!i,a=sw(t);if(a||(t[rw]=a=new yp(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=oG(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)XW||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Fk(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function oG(){function t(n){return e.call(t.src,t.listener,n)}const e=aG;return t}function jk(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)jk(t,e[s],n,r,i);return null}return n=ow(n),t&&t[yc]?t.P(e,n,pc(r)?!!r.capture:!!r,i):Ok(t,e,n,!0,r,i)}function $k(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)$k(t,e[s],n,r,i);else r=pc(r)?!!r.capture:!!r,n=ow(n),t&&t[yc]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=gv(s,n,r,i),-1<n&&(pp(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=sw(t))&&(e=t.g[e.toString()],t=-1,e&&(t=gv(e,n,r,i)),(n=-1<t?e[t]:null)&&iw(n))}function iw(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[yc])yv(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Fk(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=sw(e))?(yv(n,t),n.h==0&&(n.src=null,e[rw]=null)):pp(t)}}}function Fk(t){return t in gg?gg[t]:gg[t]="on"+t}function aG(t,e){if(t.fa)t=!0;else{e=new bu(e,this);var n=t.listener,r=t.la||t.src;t.ia&&iw(t),t=n.call(r,e)}return t}function sw(t){return t=t[rw],t instanceof yp?t:null}var mg="__closure_events_fn_"+(1e9*Math.random()>>>0);function ow(t){return typeof t=="function"?t:(t[mg]||(t[mg]=function(e){return t.handleEvent(e)}),t[mg])}function xt(){Gi.call(this),this.i=new yp(this),this.S=this,this.J=null}St(xt,Gi);xt.prototype[yc]=!0;xt.prototype.removeEventListener=function(t,e,n,r){$k(this,t,e,n,r)};function kt(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new Wt(e,t);else if(e instanceof Wt)e.target=e.target||t;else{var i=e;e=new Wt(r,t),Nk(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=sh(o,r,!0,e)&&i}if(o=e.g=t,i=sh(o,r,!0,e)&&i,i=sh(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=sh(o,r,!1,e)&&i}xt.prototype.N=function(){if(xt.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)pp(n[r]);delete t.g[e],t.h--}}this.J=null};xt.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};xt.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function sh(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,l=o.la||o.src;o.ia&&yv(t.i,o),i=a.call(l,r)!==!1&&i}}return i&&!r.defaultPrevented}var aw=ne.JSON.stringify;class lG{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function uG(){var t=lw;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class cG{constructor(){this.h=this.g=null}add(e,n){const r=Mk.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var Mk=new lG(()=>new hG,t=>t.reset());class hG{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function fG(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function dG(t){ne.setTimeout(()=>{throw t},0)}let Pu,Ru=!1,lw=new cG,Vk=()=>{const t=ne.Promise.resolve(void 0);Pu=()=>{t.then(pG)}};var pG=()=>{for(var t;t=uG();){try{t.h.call(t.g)}catch(n){dG(n)}var e=Mk;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Ru=!1};function gp(t,e){xt.call(this),this.h=t||1,this.g=e||ne,this.j=zt(this.qb,this),this.l=Date.now()}St(gp,xt);$=gp.prototype;$.ga=!1;$.T=null;$.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),kt(this,"tick"),this.ga&&(uw(this),this.start()))}};$.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function uw(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}$.N=function(){gp.$.N.call(this),uw(this),delete this.g};function cw(t,e,n){if(typeof t=="function")n&&(t=zt(t,n));else if(t&&typeof t.handleEvent=="function")t=zt(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:ne.setTimeout(t,e||0)}function Lk(t){t.g=cw(()=>{t.g=null,t.i&&(t.i=!1,Lk(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class yG extends Gi{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Lk(this)}N(){super.N(),this.g&&(ne.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ku(t){Gi.call(this),this.h=t,this.g={}}St(ku,Gi);var pA=[];function Uk(t,e,n,r){Array.isArray(n)||(n&&(pA[0]=n.toString()),n=pA);for(var i=0;i<n.length;i++){var s=Dk(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function Bk(t){nw(t.g,function(e,n){this.g.hasOwnProperty(n)&&iw(e)},t),t.g={}}ku.prototype.N=function(){ku.$.N.call(this),Bk(this)};ku.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function mp(){this.g=!0}mp.prototype.Ea=function(){this.g=!1};function gG(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var u=a[l].split("=");if(1<u.length){var h=u[0];u=u[1];var f=h.split("_");o=2<=f.length&&f[1]=="type"?o+(h+"="+u+"&"):o+(h+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function mG(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function jo(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+_G(t,n)+(r?" "+r:"")})}function vG(t,e){t.info(function(){return"TIMEOUT: "+e})}mp.prototype.info=function(){};function _G(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return aw(n)}catch{return e}}var Ws={},yA=null;function vp(){return yA=yA||new xt}Ws.Ta="serverreachability";function zk(t){Wt.call(this,Ws.Ta,t)}St(zk,Wt);function Nu(t){const e=vp();kt(e,new zk(e))}Ws.STAT_EVENT="statevent";function Wk(t,e){Wt.call(this,Ws.STAT_EVENT,t),this.stat=e}St(Wk,Wt);function Jt(t){const e=vp();kt(e,new Wk(e,t))}Ws.Ua="timingevent";function Gk(t,e){Wt.call(this,Ws.Ua,t),this.size=e}St(Gk,Wt);function gc(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return ne.setTimeout(function(){t()},e)}var _p={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Hk={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function hw(){}hw.prototype.h=null;function gA(t){return t.h||(t.h=t.i())}function qk(){}var mc={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function fw(){Wt.call(this,"d")}St(fw,Wt);function dw(){Wt.call(this,"c")}St(dw,Wt);var mv;function wp(){}St(wp,hw);wp.prototype.g=function(){return new XMLHttpRequest};wp.prototype.i=function(){return{}};mv=new wp;function vc(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new ku(this),this.P=wG,t=fv?125:void 0,this.V=new gp(t),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Kk}function Kk(){this.i=null,this.g="",this.h=!1}var wG=45e3,vv={},sd={};$=vc.prototype;$.setTimeout=function(t){this.P=t};function _v(t,e,n){t.L=1,t.v=xp(Wr(e)),t.s=n,t.S=!0,Qk(t,null)}function Qk(t,e){t.G=Date.now(),_c(t),t.A=Wr(t.v);var n=t.A,r=t.W;Array.isArray(r)||(r=[String(r)]),rN(n.i,"t",r),t.C=0,n=t.l.J,t.h=new Kk,t.g=AN(t.l,n?e:null,!t.s),0<t.O&&(t.M=new yG(zt(t.Pa,t,t.g),t.O)),Uk(t.U,t.g,"readystatechange",t.nb),e=t.I?kk(t.I):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.A,t.u,t.s,e)):(t.u="GET",t.g.ha(t.A,t.u,null,e)),Nu(),gG(t.j,t.u,t.A,t.m,t.W,t.s)}$.nb=function(t){t=t.target;const e=this.M;e&&dr(t)==3?e.l():this.Pa(t)};$.Pa=function(t){try{if(t==this.g)e:{const h=dr(this.g);var e=this.g.Ia();const f=this.g.da();if(!(3>h)&&(h!=3||fv||this.g&&(this.h.h||this.g.ja()||wA(this.g)))){this.J||h!=4||e==7||(e==8||0>=f?Nu(3):Nu(2)),Ep(this);var n=this.g.da();this.ca=n;t:if(Yk(this)){var r=wA(this.g);t="";var i=r.length,s=dr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){is(this),Kl(this);var o="";break t}this.h.i=new ne.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.splice(0,i),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,mG(this.j,this.u,this.A,this.m,this.W,h,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Cu(a)){var u=a;break t}}u=null}if(n=u)jo(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,wv(this,n);else{this.i=!1,this.o=3,Jt(12),is(this),Kl(this);break e}}this.S?(Xk(this,h,o),fv&&this.i&&h==3&&(Uk(this.U,this.V,"tick",this.mb),this.V.start())):(jo(this.j,this.m,o,null),wv(this,o)),h==4&&is(this),this.i&&!this.J&&(h==4?wN(this.l,this):(this.i=!1,_c(this)))}else UG(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.o=3,Jt(12)):(this.o=0,Jt(13)),is(this),Kl(this)}}}catch{}finally{}};function Yk(t){return t.g?t.u=="GET"&&t.L!=2&&t.l.Ha:!1}function Xk(t,e,n){let r=!0,i;for(;!t.J&&t.C<n.length;)if(i=EG(t,n),i==sd){e==4&&(t.o=4,Jt(14),r=!1),jo(t.j,t.m,null,"[Incomplete Response]");break}else if(i==vv){t.o=4,Jt(15),jo(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else jo(t.j,t.m,i,null),wv(t,i);Yk(t)&&i!=sd&&i!=vv&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,Jt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),_w(e),e.M=!0,Jt(11))):(jo(t.j,t.m,n,"[Invalid Chunked Response]"),is(t),Kl(t))}$.mb=function(){if(this.g){var t=dr(this.g),e=this.g.ja();this.C<e.length&&(Ep(this),Xk(this,t,e),this.i&&t!=4&&_c(this))}};function EG(t,e){var n=t.C,r=e.indexOf(`
`,n);return r==-1?sd:(n=Number(e.substring(n,r)),isNaN(n)?vv:(r+=1,r+n>e.length?sd:(e=e.slice(r,r+n),t.C=r+n,e)))}$.cancel=function(){this.J=!0,is(this)};function _c(t){t.Y=Date.now()+t.P,Jk(t,t.P)}function Jk(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=gc(zt(t.lb,t),e)}function Ep(t){t.B&&(ne.clearTimeout(t.B),t.B=null)}$.lb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(vG(this.j,this.A),this.L!=2&&(Nu(),Jt(17)),is(this),this.o=2,Kl(this)):Jk(this,this.Y-t)};function Kl(t){t.l.H==0||t.J||wN(t.l,t)}function is(t){Ep(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,uw(t.V),Bk(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function wv(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||Ev(n.i,t))){if(!t.K&&Ev(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)ld(n),Tp(n);else break e;vw(n),Jt(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=gc(zt(n.ib,n),6e3));if(1>=oN(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else ss(n,11)}else if((t.K||n.g==t)&&ld(n),!Cu(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let u=i[e];if(n.V=u[0],u=u[1],n.H==2)if(u[0]=="c"){n.K=u[1],n.pa=u[2];const h=u[3];h!=null&&(n.ra=h,n.l.info("VER="+n.ra));const f=u[4];f!=null&&(n.Ga=f,n.l.info("SVER="+n.Ga));const d=u[5];d!=null&&typeof d=="number"&&0<d&&(r=1.5*d,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const p=t.g;if(p){const g=p.g?p.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(g){var s=r.i;s.g||g.indexOf("spdy")==-1&&g.indexOf("quic")==-1&&g.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(pw(s,s.h),s.h=null))}if(r.F){const v=p.g?p.g.getResponseHeader("X-HTTP-Session-Id"):null;v&&(r.Da=v,$e(r.I,r.F,v))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=SN(r,r.J?r.pa:null,r.Y),o.K){aN(r.i,o);var a=o,l=r.L;l&&a.setTimeout(l),a.B&&(Ep(a),_c(a)),r.g=o}else vN(r);0<n.j.length&&Ip(n)}else u[0]!="stop"&&u[0]!="close"||ss(n,7);else n.H==3&&(u[0]=="stop"||u[0]=="close"?u[0]=="stop"?ss(n,7):mw(n):u[0]!="noop"&&n.h&&n.h.Aa(u),n.A=0)}}Nu(4)}catch{}}function xG(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(fp(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function SG(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(fp(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}function Zk(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(fp(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=SG(t),r=xG(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var eN=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function AG(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function xs(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof xs){this.h=t.h,od(this,t.j),this.s=t.s,this.g=t.g,ad(this,t.m),this.l=t.l;var e=t.i,n=new Du;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),mA(this,n),this.o=t.o}else t&&(e=String(t).match(eN))?(this.h=!1,od(this,e[1]||"",!0),this.s=Tl(e[2]||""),this.g=Tl(e[3]||"",!0),ad(this,e[4]),this.l=Tl(e[5]||"",!0),mA(this,e[6]||"",!0),this.o=Tl(e[7]||"")):(this.h=!1,this.i=new Du(null,this.h))}xs.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Il(e,vA,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Il(e,vA,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(Il(n,n.charAt(0)=="/"?CG:IG,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Il(n,PG)),t.join("")};function Wr(t){return new xs(t)}function od(t,e,n){t.j=n?Tl(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function ad(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function mA(t,e,n){e instanceof Du?(t.i=e,RG(t.i,t.h)):(n||(e=Il(e,bG)),t.i=new Du(e,t.h))}function $e(t,e,n){t.i.set(e,n)}function xp(t){return $e(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Tl(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Il(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,TG),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function TG(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var vA=/[#\/\?@]/g,IG=/[#\?:]/g,CG=/[#\?]/g,bG=/[#\?@]/g,PG=/#/g;function Du(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Hi(t){t.g||(t.g=new Map,t.h=0,t.i&&AG(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}$=Du.prototype;$.add=function(t,e){Hi(this),this.i=null,t=Ba(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function tN(t,e){Hi(t),e=Ba(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function nN(t,e){return Hi(t),e=Ba(t,e),t.g.has(e)}$.forEach=function(t,e){Hi(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};$.ta=function(){Hi(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};$.Z=function(t){Hi(this);let e=[];if(typeof t=="string")nN(this,t)&&(e=e.concat(this.g.get(Ba(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};$.set=function(t,e){return Hi(this),this.i=null,t=Ba(this,t),nN(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};$.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function rN(t,e,n){tN(t,e),0<n.length&&(t.i=null,t.g.set(Ba(t,e),ew(n)),t.h+=n.length)}$.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function Ba(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function RG(t,e){e&&!t.j&&(Hi(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(tN(this,r),rN(this,i,n))},t)),t.j=e}var kG=class{constructor(t,e){this.g=t,this.map=e}};function iN(t){this.l=t||NG,ne.PerformanceNavigationTiming?(t=ne.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(ne.g&&ne.g.Ka&&ne.g.Ka()&&ne.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var NG=10;function sN(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function oN(t){return t.h?1:t.g?t.g.size:0}function Ev(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function pw(t,e){t.g?t.g.add(e):t.h=e}function aN(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}iN.prototype.cancel=function(){if(this.i=lN(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function lN(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return ew(t.i)}var DG=class{stringify(t){return ne.JSON.stringify(t,void 0)}parse(t){return ne.JSON.parse(t,void 0)}};function OG(){this.g=new DG}function jG(t,e,n){const r=n||"";try{Zk(t,function(i,s){let o=i;pc(i)&&(o=aw(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function $G(t,e){const n=new mp;if(ne.Image){const r=new Image;r.onload=ih(oh,n,r,"TestLoadImage: loaded",!0,e),r.onerror=ih(oh,n,r,"TestLoadImage: error",!1,e),r.onabort=ih(oh,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=ih(oh,n,r,"TestLoadImage: timeout",!1,e),ne.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function oh(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function wc(t){this.l=t.ec||null,this.j=t.ob||!1}St(wc,hw);wc.prototype.g=function(){return new Sp(this.l,this.j)};wc.prototype.i=function(t){return function(){return t}}({});function Sp(t,e){xt.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=yw,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}St(Sp,xt);var yw=0;$=Sp.prototype;$.open=function(t,e){if(this.readyState!=yw)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Ou(this)};$.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||ne).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};$.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ec(this)),this.readyState=yw};$.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Ou(this)),this.g&&(this.readyState=3,Ou(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof ne.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;uN(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function uN(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}$.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Ec(this):Ou(this),this.readyState==3&&uN(this)}};$.Za=function(t){this.g&&(this.response=this.responseText=t,Ec(this))};$.Ya=function(t){this.g&&(this.response=t,Ec(this))};$.ka=function(){this.g&&Ec(this)};function Ec(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Ou(t)}$.setRequestHeader=function(t,e){this.v.append(t,e)};$.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};$.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Ou(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Sp.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var FG=ne.JSON.parse;function Xe(t){xt.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=cN,this.L=this.M=!1}St(Xe,xt);var cN="",MG=/^https?$/i,VG=["POST","PUT"];$=Xe.prototype;$.Oa=function(t){this.M=t};$.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():mv.g(),this.C=this.u?gA(this.u):gA(mv),this.g.onreadystatechange=zt(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){_A(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=ne.FormData&&t instanceof ne.FormData,!(0<=Ck(VG,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{dN(this),0<this.B&&((this.L=LG(this.g))?(this.g.timeout=this.B,this.g.ontimeout=zt(this.ua,this)):this.A=cw(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){_A(this,s)}};function LG(t){return Ta&&typeof t.timeout=="number"&&t.ontimeout!==void 0}$.ua=function(){typeof Z0<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,kt(this,"timeout"),this.abort(8))};function _A(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,hN(t),Ap(t)}function hN(t){t.F||(t.F=!0,kt(t,"complete"),kt(t,"error"))}$.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,kt(this,"complete"),kt(this,"abort"),Ap(this))};$.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ap(this,!0)),Xe.$.N.call(this)};$.La=function(){this.s||(this.G||this.v||this.l?fN(this):this.kb())};$.kb=function(){fN(this)};function fN(t){if(t.h&&typeof Z0<"u"&&(!t.C[1]||dr(t)!=4||t.da()!=2)){if(t.v&&dr(t)==4)cw(t.La,0,t);else if(kt(t,"readystatechange"),dr(t)==4){t.h=!1;try{const o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(eN)[1]||null;!i&&ne.self&&ne.self.location&&(i=ne.self.location.protocol.slice(0,-1)),r=!MG.test(i?i.toLowerCase():"")}n=r}if(n)kt(t,"complete"),kt(t,"success");else{t.m=6;try{var s=2<dr(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",hN(t)}}finally{Ap(t)}}}}function Ap(t,e){if(t.g){dN(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||kt(t,"ready");try{n.onreadystatechange=r}catch{}}}function dN(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(ne.clearTimeout(t.A),t.A=null)}$.isActive=function(){return!!this.g};function dr(t){return t.g?t.g.readyState:0}$.da=function(){try{return 2<dr(this)?this.g.status:-1}catch{return-1}};$.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};$.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),FG(e)}};function wA(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case cN:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function UG(t){const e={};t=(t.g&&2<=dr(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(Cu(t[r]))continue;var n=fG(t[r]);const i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();const s=e[i]||[];e[i]=s,s.push(n)}sG(e,function(r){return r.join(", ")})}$.Ia=function(){return this.m};$.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function pN(t){let e="";return nw(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function gw(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=pN(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):$e(t,e,n))}function pl(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function yN(t){this.Ga=0,this.j=[],this.l=new mp,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=pl("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=pl("baseRetryDelayMs",5e3,t),this.hb=pl("retryDelaySeedMs",1e4,t),this.eb=pl("forwardChannelMaxRetries",2,t),this.xa=pl("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new iN(t&&t.concurrentRequestLimit),this.Ja=new OG,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}$=yN.prototype;$.ra=8;$.H=1;function mw(t){if(gN(t),t.H==3){var e=t.W++,n=Wr(t.I);if($e(n,"SID",t.K),$e(n,"RID",e),$e(n,"TYPE","terminate"),xc(t,n),e=new vc(t,t.l,e),e.L=2,e.v=xp(Wr(n)),n=!1,ne.navigator&&ne.navigator.sendBeacon)try{n=ne.navigator.sendBeacon(e.v.toString(),"")}catch{}!n&&ne.Image&&(new Image().src=e.v,n=!0),n||(e.g=AN(e.l,null),e.g.ha(e.v)),e.G=Date.now(),_c(e)}xN(t)}function Tp(t){t.g&&(_w(t),t.g.cancel(),t.g=null)}function gN(t){Tp(t),t.u&&(ne.clearTimeout(t.u),t.u=null),ld(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&ne.clearTimeout(t.m),t.m=null)}function Ip(t){if(!sN(t.i)&&!t.m){t.m=!0;var e=t.Na;Pu||Vk(),Ru||(Pu(),Ru=!0),lw.add(e,t),t.C=0}}function BG(t,e){return oN(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=gc(zt(t.Na,t,e),EN(t,t.C)),t.C++,!0)}$.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const i=new vc(this,this.l,t);let s=this.s;if(this.U&&(s?(s=kk(s),Nk(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=mN(this,i,e),n=Wr(this.I),$e(n,"RID",t),$e(n,"CVER",22),this.F&&$e(n,"X-HTTP-Session-Id",this.F),xc(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(pN(s)))+"&"+e:this.o&&gw(n,this.o,s)),pw(this.i,i),this.bb&&$e(n,"TYPE","init"),this.P?($e(n,"$req",e),$e(n,"SID","null"),i.aa=!0,_v(i,n,null)):_v(i,n,e),this.H=2}}else this.H==3&&(t?EA(this,t):this.j.length==0||sN(this.i)||EA(this))};function EA(t,e){var n;e?n=e.m:n=t.W++;const r=Wr(t.I);$e(r,"SID",t.K),$e(r,"RID",n),$e(r,"AID",t.V),xc(t,r),t.o&&t.s&&gw(r,t.o,t.s),n=new vc(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=mN(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),pw(t.i,n),_v(n,r,e)}function xc(t,e){t.na&&nw(t.na,function(n,r){$e(e,r,n)}),t.h&&Zk({},function(n,r){$e(e,r,n)})}function mN(t,e,n){n=Math.min(t.j.length,n);var r=t.h?zt(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){const o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let l=0;l<n;l++){let u=i[l].g;const h=i[l].map;if(u-=s,0>u)s=Math.max(0,i[l].g-100),a=!1;else try{jG(h,o,"req"+u+"_")}catch{r&&r(h)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function vN(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Pu||Vk(),Ru||(Pu(),Ru=!0),lw.add(e,t),t.A=0}}function vw(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=gc(zt(t.Ma,t),EN(t,t.A)),t.A++,!0)}$.Ma=function(){if(this.u=null,_N(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=gc(zt(this.jb,this),t)}};$.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Jt(10),Tp(this),_N(this))};function _w(t){t.B!=null&&(ne.clearTimeout(t.B),t.B=null)}function _N(t){t.g=new vc(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=Wr(t.wa);$e(e,"RID","rpc"),$e(e,"SID",t.K),$e(e,"AID",t.V),$e(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&$e(e,"TO",t.qa),$e(e,"TYPE","xmlhttp"),xc(t,e),t.o&&t.s&&gw(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.v=xp(Wr(e)),n.s=null,n.S=!0,Qk(n,t)}$.ib=function(){this.v!=null&&(this.v=null,Tp(this),vw(this),Jt(19))};function ld(t){t.v!=null&&(ne.clearTimeout(t.v),t.v=null)}function wN(t,e){var n=null;if(t.g==e){ld(t),_w(t),t.g=null;var r=2}else if(Ev(t.i,e))n=e.F,aN(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.s?e.s.length:0,e=Date.now()-e.G;var i=t.C;r=vp(),kt(r,new Gk(r,n)),Ip(t)}else vN(t);else if(i=e.o,i==3||i==0&&0<e.ca||!(r==1&&BG(t,e)||r==2&&vw(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:ss(t,5);break;case 4:ss(t,10);break;case 3:ss(t,6);break;default:ss(t,2)}}}function EN(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function ss(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=zt(t.pb,t);n||(n=new xs("//www.google.com/images/cleardot.gif"),ne.location&&ne.location.protocol=="http"||od(n,"https"),xp(n)),$G(n.toString(),r)}else Jt(2);t.H=0,t.h&&t.h.za(e),xN(t),gN(t)}$.pb=function(t){t?(this.l.info("Successfully pinged google.com"),Jt(2)):(this.l.info("Failed to ping google.com"),Jt(1))};function xN(t){if(t.H=0,t.ma=[],t.h){const e=lN(t.i);(e.length!=0||t.j.length!=0)&&(hA(t.ma,e),hA(t.ma,t.j),t.i.i.length=0,ew(t.j),t.j.length=0),t.h.ya()}}function SN(t,e,n){var r=n instanceof xs?Wr(n):new xs(n);if(r.g!="")e&&(r.g=e+"."+r.g),ad(r,r.m);else{var i=ne.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new xs(null);r&&od(s,r),e&&(s.g=e),i&&ad(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&$e(r,n,e),$e(r,"VER",t.ra),xc(t,r),r}function AN(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ha&&!t.va?new Xe(new wc({ob:!0})):new Xe(t.va),e.Oa(t.J),e}$.isActive=function(){return!!this.h&&this.h.isActive(this)};function TN(){}$=TN.prototype;$.Ba=function(){};$.Aa=function(){};$.za=function(){};$.ya=function(){};$.isActive=function(){return!0};$.Va=function(){};function ud(){if(Ta&&!(10<=Number(tG)))throw Error("Environmental error: no available transport.")}ud.prototype.g=function(t,e){return new vn(t,e)};function vn(t,e){xt.call(this),this.g=new yN(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!Cu(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Cu(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new za(this)}St(vn,xt);vn.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;Jt(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=SN(t,null,t.Y),Ip(t)};vn.prototype.close=function(){mw(this.g)};vn.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=aw(t),t=n);e.j.push(new kG(e.fb++,t)),e.H==3&&Ip(e)};vn.prototype.N=function(){this.g.h=null,delete this.j,mw(this.g),delete this.g,vn.$.N.call(this)};function IN(t){fw.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}St(IN,fw);function CN(){dw.call(this),this.status=1}St(CN,dw);function za(t){this.g=t}St(za,TN);za.prototype.Ba=function(){kt(this.g,"a")};za.prototype.Aa=function(t){kt(this.g,new IN(t))};za.prototype.za=function(t){kt(this.g,new CN)};za.prototype.ya=function(){kt(this.g,"b")};function zG(){this.blockSize=-1}function tr(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}St(tr,zG);tr.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function vg(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}tr.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)vg(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){vg(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){vg(this,r),i=0;break}}this.h=i,this.i+=e};tr.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function Ce(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var WG={};function ww(t){return-128<=t&&128>t?JW(t,function(e){return new Ce([e|0],0>e?-1:0)}):new Ce([t|0],0>t?-1:0)}function pr(t){if(isNaN(t)||!isFinite(t))return Jo;if(0>t)return bt(pr(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=xv;return new Ce(e,0)}function bN(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return bt(bN(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=pr(Math.pow(e,8)),r=Jo,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=pr(Math.pow(e,s)),r=r.R(s).add(pr(o))):(r=r.R(n),r=r.add(pr(o)))}return r}var xv=4294967296,Jo=ww(0),Sv=ww(1),xA=ww(16777216);$=Ce.prototype;$.ea=function(){if(bn(this))return-bt(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:xv+r)*e,e*=xv}return t};$.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Dr(this))return"0";if(bn(this))return"-"+bt(this).toString(t);for(var e=pr(Math.pow(t,6)),n=this,r="";;){var i=hd(n,e).g;n=cd(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,Dr(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};$.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Dr(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function bn(t){return t.h==-1}$.X=function(t){return t=cd(this,t),bn(t)?-1:Dr(t)?0:1};function bt(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new Ce(n,~t.h).add(Sv)}$.abs=function(){return bn(this)?bt(this):this};$.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new Ce(n,n[n.length-1]&-2147483648?-1:0)};function cd(t,e){return t.add(bt(e))}$.R=function(t){if(Dr(this)||Dr(t))return Jo;if(bn(this))return bn(t)?bt(this).R(bt(t)):bt(bt(this).R(t));if(bn(t))return bt(this.R(bt(t)));if(0>this.X(xA)&&0>t.X(xA))return pr(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,l=t.D(i)&65535;n[2*r+2*i]+=o*l,ah(n,2*r+2*i),n[2*r+2*i+1]+=s*l,ah(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,ah(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,ah(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new Ce(n,0)};function ah(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function yl(t,e){this.g=t,this.h=e}function hd(t,e){if(Dr(e))throw Error("division by zero");if(Dr(t))return new yl(Jo,Jo);if(bn(t))return e=hd(bt(t),e),new yl(bt(e.g),bt(e.h));if(bn(e))return e=hd(t,bt(e)),new yl(bt(e.g),e.h);if(30<t.g.length){if(bn(t)||bn(e))throw Error("slowDivide_ only works with positive integers.");for(var n=Sv,r=e;0>=r.X(t);)n=SA(n),r=SA(r);var i=so(n,1),s=so(r,1);for(r=so(r,2),n=so(n,2);!Dr(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=so(r,1),n=so(n,1)}return e=cd(t,i.R(e)),new yl(i,e)}for(i=Jo;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=pr(n),o=s.R(e);bn(o)||0<o.X(t);)n-=r,s=pr(n),o=s.R(e);Dr(s)&&(s=Sv),i=i.add(s),t=cd(t,o)}return new yl(i,t)}$.gb=function(t){return hd(this,t).h};$.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new Ce(n,this.h&t.h)};$.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new Ce(n,this.h|t.h)};$.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new Ce(n,this.h^t.h)};function SA(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new Ce(n,t.h)}function so(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new Ce(i,t.h)}ud.prototype.createWebChannel=ud.prototype.g;vn.prototype.send=vn.prototype.u;vn.prototype.open=vn.prototype.m;vn.prototype.close=vn.prototype.close;_p.NO_ERROR=0;_p.TIMEOUT=8;_p.HTTP_ERROR=6;Hk.COMPLETE="complete";qk.EventType=mc;mc.OPEN="a";mc.CLOSE="b";mc.ERROR="c";mc.MESSAGE="d";xt.prototype.listen=xt.prototype.O;Xe.prototype.listenOnce=Xe.prototype.P;Xe.prototype.getLastError=Xe.prototype.Sa;Xe.prototype.getLastErrorCode=Xe.prototype.Ia;Xe.prototype.getStatus=Xe.prototype.da;Xe.prototype.getResponseJson=Xe.prototype.Wa;Xe.prototype.getResponseText=Xe.prototype.ja;Xe.prototype.send=Xe.prototype.ha;Xe.prototype.setWithCredentials=Xe.prototype.Oa;tr.prototype.digest=tr.prototype.l;tr.prototype.reset=tr.prototype.reset;tr.prototype.update=tr.prototype.j;Ce.prototype.add=Ce.prototype.add;Ce.prototype.multiply=Ce.prototype.R;Ce.prototype.modulo=Ce.prototype.gb;Ce.prototype.compare=Ce.prototype.X;Ce.prototype.toNumber=Ce.prototype.ea;Ce.prototype.toString=Ce.prototype.toString;Ce.prototype.getBits=Ce.prototype.D;Ce.fromNumber=pr;Ce.fromString=bN;var GG=function(){return new ud},HG=function(){return vp()},_g=_p,qG=Hk,KG=Ws,AA={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},QG=wc,lh=qk,YG=Xe,XG=tr,Zo=Ce;const TA="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Lt.UNAUTHENTICATED=new Lt(null),Lt.GOOGLE_CREDENTIALS=new Lt("google-credentials-uid"),Lt.FIRST_PARTY=new Lt("first-party-uid"),Lt.MOCK_USER=new Lt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wa="10.5.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const js=new $_("@firebase/firestore");function gl(){return js.logLevel}function z(t,...e){if(js.logLevel<=Ee.DEBUG){const n=e.map(Ew);js.debug(`Firestore (${Wa}): ${t}`,...n)}}function Gr(t,...e){if(js.logLevel<=Ee.ERROR){const n=e.map(Ew);js.error(`Firestore (${Wa}): ${t}`,...n)}}function Ia(t,...e){if(js.logLevel<=Ee.WARN){const n=e.map(Ew);js.warn(`Firestore (${Wa}): ${t}`,...n)}}function Ew(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ee(t="Unexpected state"){const e=`FIRESTORE (${Wa}) INTERNAL ASSERTION FAILED: `+t;throw Gr(e),new Error(e)}function Me(t,e){t||ee()}function ie(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class K extends Ls{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PN{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class JG{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Lt.UNAUTHENTICATED))}shutdown(){}}class ZG{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class eH{constructor(e){this.t=e,this.currentUser=Lt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new bi;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new bi,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{z("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(z("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new bi)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(z("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Me(typeof r.accessToken=="string"),new PN(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Me(e===null||typeof e=="string"),new Lt(e)}}class tH{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Lt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class nH{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new tH(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Lt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class rH{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class iH{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){const r=s=>{s.error!=null&&z("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,z("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{z("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):z("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Me(typeof n.token=="string"),this.R=n.token,new rH(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sH(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RN{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=sH(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function Ae(t,e){return t<e?-1:t>e?1:0}function Ca(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new K(k.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new K(k.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new K(k.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new K(k.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ft.fromMillis(Date.now())}static fromDate(e){return ft.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new ft(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ae(this.nanoseconds,e.nanoseconds):Ae(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class re{constructor(e){this.timestamp=e}static fromTimestamp(e){return new re(e)}static min(){return new re(new ft(0,0))}static max(){return new re(new ft(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(e,n,r){n===void 0?n=0:n>e.length&&ee(),r===void 0?r=e.length-n:r>e.length-n&&ee(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return ju.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ju?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Ue extends ju{construct(e,n,r){return new Ue(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new K(k.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new Ue(n)}static emptyPath(){return new Ue([])}}const oH=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Pt extends ju{construct(e,n,r){return new Pt(e,n,r)}static isValidIdentifier(e){return oH.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Pt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Pt(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new K(k.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new K(k.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new K(k.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new K(k.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Pt(n)}static emptyPath(){return new Pt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q{constructor(e){this.path=e}static fromPath(e){return new Q(Ue.fromString(e))}static fromName(e){return new Q(Ue.fromString(e).popFirst(5))}static empty(){return new Q(Ue.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ue.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ue.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Q(new Ue(e.slice()))}}function aH(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=re.fromTimestamp(r===1e9?new ft(n+1,0):new ft(n,r));return new $i(i,Q.empty(),e)}function lH(t){return new $i(t.readTime,t.key,-1)}class $i{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new $i(re.min(),Q.empty(),-1)}static max(){return new $i(re.max(),Q.empty(),-1)}}function uH(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Q.comparator(t.documentKey,e.documentKey),n!==0?n:Ae(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cH="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class hH{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sc(t){if(t.code!==k.FAILED_PRECONDITION||t.message!==cH)throw t;z("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ee(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new R((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof R?n:R.resolve(n)}catch(n){return R.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):R.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):R.reject(n)}static resolve(e){return new R((n,r)=>{n(e)})}static reject(e){return new R((n,r)=>{r(e)})}static waitFor(e){return new R((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=R.resolve(!1);for(const r of e)n=n.next(i=>i?R.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new R((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const u=l;n(e[u]).next(h=>{o[u]=h,++a,a===s&&r(o)},h=>i(h))}})}static doWhile(e,n){return new R((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}function Ac(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xw{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.se(r),this.oe=r=>n.writeSequenceNumber(r))}se(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.oe&&this.oe(e),e}}xw._e=-1;function Cp(t){return t==null}function fd(t){return t===0&&1/t==-1/0}function fH(t){return typeof t=="number"&&Number.isInteger(t)&&!fd(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IA(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ga(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function kN(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class He{constructor(e,n){this.comparator=e,this.root=n||It.EMPTY}insert(e,n){return new He(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,It.BLACK,null,null))}remove(e){return new He(this.comparator,this.root.remove(e,this.comparator).copy(null,null,It.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new uh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new uh(this.root,e,this.comparator,!1)}getReverseIterator(){return new uh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new uh(this.root,e,this.comparator,!0)}}class uh{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class It{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??It.RED,this.left=i??It.EMPTY,this.right=s??It.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new It(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return It.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return It.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,It.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,It.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ee();const e=this.left.check();if(e!==this.right.check())throw ee();return e+(this.isRed()?0:1)}}It.EMPTY=null,It.RED=!0,It.BLACK=!1;It.EMPTY=new class{constructor(){this.size=0}get key(){throw ee()}get value(){throw ee()}get color(){throw ee()}get left(){throw ee()}get right(){throw ee()}copy(e,n,r,i,s){return this}insert(e,n,r){return new It(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{constructor(e){this.comparator=e,this.data=new He(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new CA(this.data.getIterator())}getIteratorFrom(e){return new CA(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Nt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Nt(this.comparator);return n.data=e,n}}class CA{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e){this.fields=e,e.sort(Pt.comparator)}static empty(){return new Kn([])}unionWith(e){let n=new Nt(Pt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Kn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ca(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NN extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new NN("Invalid base64 string: "+s):s}}(e);return new qt(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new qt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ae(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}qt.EMPTY_BYTE_STRING=new qt("");const dH=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Fi(t){if(Me(!!t),typeof t=="string"){let e=0;const n=dH.exec(t);if(Me(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:it(t.seconds),nanos:it(t.nanos)}}function it(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function $s(t){return typeof t=="string"?qt.fromBase64String(t):qt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sw(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Aw(t){const e=t.mapValue.fields.__previous_value__;return Sw(e)?Aw(e):e}function $u(t){const e=Fi(t.mapValue.fields.__local_write_time__.timestampValue);return new ft(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pH{constructor(e,n,r,i,s,o,a,l,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u}}class Fu{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Fu("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Fu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ch={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Fs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Sw(t)?4:yH(t)?9007199254740991:10:ee()}function Er(t,e){if(t===e)return!0;const n=Fs(t);if(n!==Fs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return $u(t).isEqual($u(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Fi(i.timestampValue),a=Fi(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return $s(i.bytesValue).isEqual($s(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return it(i.geoPointValue.latitude)===it(s.geoPointValue.latitude)&&it(i.geoPointValue.longitude)===it(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return it(i.integerValue)===it(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=it(i.doubleValue),a=it(s.doubleValue);return o===a?fd(o)===fd(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Ca(t.arrayValue.values||[],e.arrayValue.values||[],Er);case 10:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(IA(o)!==IA(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Er(o[l],a[l])))return!1;return!0}(t,e);default:return ee()}}function Mu(t,e){return(t.values||[]).find(n=>Er(n,e))!==void 0}function ba(t,e){if(t===e)return 0;const n=Fs(t),r=Fs(e);if(n!==r)return Ae(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ae(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=it(s.integerValue||s.doubleValue),l=it(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return bA(t.timestampValue,e.timestampValue);case 4:return bA($u(t),$u(e));case 5:return Ae(t.stringValue,e.stringValue);case 6:return function(s,o){const a=$s(s),l=$s(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const h=Ae(a[u],l[u]);if(h!==0)return h}return Ae(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=Ae(it(s.latitude),it(o.latitude));return a!==0?a:Ae(it(s.longitude),it(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){const a=s.values||[],l=o.values||[];for(let u=0;u<a.length&&u<l.length;++u){const h=ba(a[u],l[u]);if(h)return h}return Ae(a.length,l.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===ch.mapValue&&o===ch.mapValue)return 0;if(s===ch.mapValue)return 1;if(o===ch.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),u=o.fields||{},h=Object.keys(u);l.sort(),h.sort();for(let f=0;f<l.length&&f<h.length;++f){const d=Ae(l[f],h[f]);if(d!==0)return d;const p=ba(a[l[f]],u[h[f]]);if(p!==0)return p}return Ae(l.length,h.length)}(t.mapValue,e.mapValue);default:throw ee()}}function bA(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ae(t,e);const n=Fi(t),r=Fi(e),i=Ae(n.seconds,r.seconds);return i!==0?i:Ae(n.nanos,r.nanos)}function Pa(t){return Av(t)}function Av(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Fi(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return $s(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Q.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Av(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Av(n.fields[o])}`;return i+"}"}(t.mapValue):ee()}function Tv(t){return!!t&&"integerValue"in t}function Tw(t){return!!t&&"arrayValue"in t}function PA(t){return!!t&&"nullValue"in t}function RA(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Mh(t){return!!t&&"mapValue"in t}function Ql(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ga(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Ql(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ql(t.arrayValue.values[n]);return e}return Object.assign({},t)}function yH(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e){this.value=e}static empty(){return new Pn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Mh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ql(n)}setAll(e){let n=Pt.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Ql(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Mh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Er(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Mh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Ga(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Pn(Ql(this.value))}}function DN(t){const e=[];return Ga(t.fields,(n,r)=>{const i=new Pt([n]);if(Mh(r)){const s=DN(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Kn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Bt(e,0,re.min(),re.min(),re.min(),Pn.empty(),0)}static newFoundDocument(e,n,r,i){return new Bt(e,1,n,re.min(),r,i,0)}static newNoDocument(e,n){return new Bt(e,2,n,re.min(),re.min(),Pn.empty(),0)}static newUnknownDocument(e,n){return new Bt(e,3,n,re.min(),re.min(),Pn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(re.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Pn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Pn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=re.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Bt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Bt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{constructor(e,n){this.position=e,this.inclusive=n}}function kA(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=Q.comparator(Q.fromName(o.referenceValue),n.key):r=ba(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function NA(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Er(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(e,n="asc"){this.field=e,this.dir=n}}function gH(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ON{}class ct extends ON{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new vH(e,n,r):n==="array-contains"?new EH(e,r):n==="in"?new xH(e,r):n==="not-in"?new SH(e,r):n==="array-contains-any"?new AH(e,r):new ct(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new _H(e,r):new wH(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(ba(n,this.value)):n!==null&&Fs(this.value)===Fs(n)&&this.matchesComparison(ba(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ee()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class xr extends ON{constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new xr(e,n)}matches(e){return jN(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function jN(t){return t.op==="and"}function $N(t){return mH(t)&&jN(t)}function mH(t){for(const e of t.filters)if(e instanceof xr)return!1;return!0}function Iv(t){if(t instanceof ct)return t.field.canonicalString()+t.op.toString()+Pa(t.value);if($N(t))return t.filters.map(e=>Iv(e)).join(",");{const e=t.filters.map(n=>Iv(n)).join(",");return`${t.op}(${e})`}}function FN(t,e){return t instanceof ct?function(r,i){return i instanceof ct&&r.op===i.op&&r.field.isEqual(i.field)&&Er(r.value,i.value)}(t,e):t instanceof xr?function(r,i){return i instanceof xr&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&FN(o,i.filters[a]),!0):!1}(t,e):void ee()}function MN(t){return t instanceof ct?function(n){return`${n.field.canonicalString()} ${n.op} ${Pa(n.value)}`}(t):t instanceof xr?function(n){return n.op.toString()+" {"+n.getFilters().map(MN).join(" ,")+"}"}(t):"Filter"}class vH extends ct{constructor(e,n,r){super(e,n,r),this.key=Q.fromName(r.referenceValue)}matches(e){const n=Q.comparator(e.key,this.key);return this.matchesComparison(n)}}class _H extends ct{constructor(e,n){super(e,"in",n),this.keys=VN("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class wH extends ct{constructor(e,n){super(e,"not-in",n),this.keys=VN("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function VN(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>Q.fromName(r.referenceValue))}class EH extends ct{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Tw(n)&&Mu(n.arrayValue,this.value)}}class xH extends ct{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Mu(this.value.arrayValue,n)}}class SH extends ct{constructor(e,n){super(e,"not-in",n)}matches(e){if(Mu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Mu(this.value.arrayValue,n)}}class AH extends ct{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Tw(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Mu(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TH{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}}function DA(t,e=null,n=[],r=[],i=null,s=null,o=null){return new TH(t,e,n,r,i,s,o)}function Iw(t){const e=ie(t);if(e.ce===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Iv(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Cp(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Pa(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Pa(r)).join(",")),e.ce=n}return e.ce}function Cw(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!gH(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!FN(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!NA(t.startAt,e.startAt)&&NA(t.endAt,e.endAt)}function Cv(t){return Q.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bp{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function IH(t,e,n,r,i,s,o,a){return new bp(t,e,n,r,i,s,o,a)}function LN(t){return new bp(t)}function OA(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function CH(t){return t.collectionGroup!==null}function Yl(t){const e=ie(t);if(e.le===null){e.le=[];const n=new Set;for(const s of e.explicitOrderBy)e.le.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Nt(Pt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.le.push(new pd(s,r))}),n.has(Pt.keyField().canonicalString())||e.le.push(new pd(Pt.keyField(),r))}return e.le}function vr(t){const e=ie(t);return e.he||(e.he=bH(e,Yl(t))),e.he}function bH(t,e){if(t.limitType==="F")return DA(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new pd(i.field,s)});const n=t.endAt?new dd(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new dd(t.startAt.position,t.startAt.inclusive):null;return DA(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function bv(t,e,n){return new bp(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Pp(t,e){return Cw(vr(t),vr(e))&&t.limitType===e.limitType}function UN(t){return`${Iw(vr(t))}|lt:${t.limitType}`}function po(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>MN(i)).join(", ")}]`),Cp(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Pa(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Pa(i)).join(",")),`Target(${r})`}(vr(t))}; limitType=${t.limitType})`}function Rp(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):Q.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Yl(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const u=kA(o,a,l);return o.inclusive?u<=0:u<0}(r.startAt,Yl(r),i)||r.endAt&&!function(o,a,l){const u=kA(o,a,l);return o.inclusive?u>=0:u>0}(r.endAt,Yl(r),i))}(t,e)}function PH(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function BN(t){return(e,n)=>{let r=!1;for(const i of Yl(t)){const s=RH(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function RH(t,e,n){const r=t.field.isKeyField()?Q.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),u=a.data.field(s);return l!==null&&u!==null?ba(l,u):ee()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ee()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ga(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return kN(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kH=new He(Q.comparator);function Hr(){return kH}const zN=new He(Q.comparator);function Cl(...t){let e=zN;for(const n of t)e=e.insert(n.key,n);return e}function WN(t){let e=zN;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function os(){return Xl()}function GN(){return Xl()}function Xl(){return new Ha(t=>t.toString(),(t,e)=>t.isEqual(e))}const NH=new He(Q.comparator),DH=new Nt(Q.comparator);function ye(...t){let e=DH;for(const n of t)e=e.add(n);return e}const OH=new Nt(Ae);function jH(){return OH}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HN(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:fd(e)?"-0":e}}function qN(t){return{integerValue:""+t}}function $H(t,e){return fH(e)?qN(e):HN(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kp{constructor(){this._=void 0}}function FH(t,e,n){return t instanceof yd?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Sw(s)&&(s=Aw(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof Vu?QN(t,e):t instanceof Lu?YN(t,e):function(i,s){const o=KN(i,s),a=jA(o)+jA(i.Ie);return Tv(o)&&Tv(i.Ie)?qN(a):HN(i.serializer,a)}(t,e)}function MH(t,e,n){return t instanceof Vu?QN(t,e):t instanceof Lu?YN(t,e):n}function KN(t,e){return t instanceof gd?function(r){return Tv(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class yd extends kp{}class Vu extends kp{constructor(e){super(),this.elements=e}}function QN(t,e){const n=XN(e);for(const r of t.elements)n.some(i=>Er(i,r))||n.push(r);return{arrayValue:{values:n}}}class Lu extends kp{constructor(e){super(),this.elements=e}}function YN(t,e){let n=XN(e);for(const r of t.elements)n=n.filter(i=>!Er(i,r));return{arrayValue:{values:n}}}class gd extends kp{constructor(e,n){super(),this.serializer=e,this.Ie=n}}function jA(t){return it(t.integerValue||t.doubleValue)}function XN(t){return Tw(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function VH(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Vu&&i instanceof Vu||r instanceof Lu&&i instanceof Lu?Ca(r.elements,i.elements,Er):r instanceof gd&&i instanceof gd?Er(r.Ie,i.Ie):r instanceof yd&&i instanceof yd}(t.transform,e.transform)}class LH{constructor(e,n){this.version=e,this.transformResults=n}}class Fr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Fr}static exists(e){return new Fr(void 0,e)}static updateTime(e){return new Fr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Vh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Np{}function JN(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new e2(t.key,Fr.none()):new Tc(t.key,t.data,Fr.none());{const n=t.data,r=Pn.empty();let i=new Nt(Pt.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Gs(t.key,r,new Kn(i.toArray()),Fr.none())}}function UH(t,e,n){t instanceof Tc?function(i,s,o){const a=i.value.clone(),l=FA(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Gs?function(i,s,o){if(!Vh(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=FA(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(ZN(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Jl(t,e,n,r){return t instanceof Tc?function(s,o,a,l){if(!Vh(s.precondition,o))return a;const u=s.value.clone(),h=MA(s.fieldTransforms,l,o);return u.setAll(h),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof Gs?function(s,o,a,l){if(!Vh(s.precondition,o))return a;const u=MA(s.fieldTransforms,l,o),h=o.data;return h.setAll(ZN(s)),h.setAll(u),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(s,o,a){return Vh(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function BH(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=KN(r.transform,i||null);s!=null&&(n===null&&(n=Pn.empty()),n.set(r.field,s))}return n||null}function $A(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Ca(r,i,(s,o)=>VH(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Tc extends Np{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Gs extends Np{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function ZN(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function FA(t,e,n){const r=new Map;Me(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,MH(o,a,n[i]))}return r}function MA(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,FH(s,o,e))}return r}class e2 extends Np{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class zH extends Np{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WH{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&UH(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Jl(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Jl(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=GN();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=JN(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(re.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ye())}isEqual(e){return this.batchId===e.batchId&&Ca(this.mutations,e.mutations,(n,r)=>$A(n,r))&&Ca(this.baseMutations,e.baseMutations,(n,r)=>$A(n,r))}}class bw{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Me(e.mutations.length===r.length);let i=function(){return NH}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new bw(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GH{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HH{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rt,ve;function qH(t){switch(t){default:return ee();case k.CANCELLED:case k.UNKNOWN:case k.DEADLINE_EXCEEDED:case k.RESOURCE_EXHAUSTED:case k.INTERNAL:case k.UNAVAILABLE:case k.UNAUTHENTICATED:return!1;case k.INVALID_ARGUMENT:case k.NOT_FOUND:case k.ALREADY_EXISTS:case k.PERMISSION_DENIED:case k.FAILED_PRECONDITION:case k.ABORTED:case k.OUT_OF_RANGE:case k.UNIMPLEMENTED:case k.DATA_LOSS:return!0}}function t2(t){if(t===void 0)return Gr("GRPC error has no .code"),k.UNKNOWN;switch(t){case rt.OK:return k.OK;case rt.CANCELLED:return k.CANCELLED;case rt.UNKNOWN:return k.UNKNOWN;case rt.DEADLINE_EXCEEDED:return k.DEADLINE_EXCEEDED;case rt.RESOURCE_EXHAUSTED:return k.RESOURCE_EXHAUSTED;case rt.INTERNAL:return k.INTERNAL;case rt.UNAVAILABLE:return k.UNAVAILABLE;case rt.UNAUTHENTICATED:return k.UNAUTHENTICATED;case rt.INVALID_ARGUMENT:return k.INVALID_ARGUMENT;case rt.NOT_FOUND:return k.NOT_FOUND;case rt.ALREADY_EXISTS:return k.ALREADY_EXISTS;case rt.PERMISSION_DENIED:return k.PERMISSION_DENIED;case rt.FAILED_PRECONDITION:return k.FAILED_PRECONDITION;case rt.ABORTED:return k.ABORTED;case rt.OUT_OF_RANGE:return k.OUT_OF_RANGE;case rt.UNIMPLEMENTED:return k.UNIMPLEMENTED;case rt.DATA_LOSS:return k.DATA_LOSS;default:return ee()}}(ve=rt||(rt={}))[ve.OK=0]="OK",ve[ve.CANCELLED=1]="CANCELLED",ve[ve.UNKNOWN=2]="UNKNOWN",ve[ve.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ve[ve.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ve[ve.NOT_FOUND=5]="NOT_FOUND",ve[ve.ALREADY_EXISTS=6]="ALREADY_EXISTS",ve[ve.PERMISSION_DENIED=7]="PERMISSION_DENIED",ve[ve.UNAUTHENTICATED=16]="UNAUTHENTICATED",ve[ve.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ve[ve.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ve[ve.ABORTED=10]="ABORTED",ve[ve.OUT_OF_RANGE=11]="OUT_OF_RANGE",ve[ve.UNIMPLEMENTED=12]="UNIMPLEMENTED",ve[ve.INTERNAL=13]="INTERNAL",ve[ve.UNAVAILABLE=14]="UNAVAILABLE",ve[ve.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KH(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QH=new Zo([4294967295,4294967295],0);function VA(t){const e=KH().encode(t),n=new XG;return n.update(e),new Uint8Array(n.digest())}function LA(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Zo([n,r],0),new Zo([i,s],0)]}class Pw{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new bl(`Invalid padding: ${n}`);if(r<0)throw new bl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new bl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new bl(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=Zo.fromNumber(this.Te)}de(e,n,r){let i=e.add(n.multiply(Zo.fromNumber(r)));return i.compare(QH)===1&&(i=new Zo([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;const n=VA(e),[r,i]=LA(n);for(let s=0;s<this.hashCount;s++){const o=this.de(r,i,s);if(!this.Ae(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Pw(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Te===0)return;const n=VA(e),[r,i]=LA(n);for(let s=0;s<this.hashCount;s++){const o=this.de(r,i,s);this.Re(o)}}Re(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class bl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dp{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Ic.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Dp(re.min(),i,new He(Ae),Hr(),ye())}}class Ic{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Ic(r,n,ye(),ye(),ye())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh{constructor(e,n,r,i){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=i}}class n2{constructor(e,n){this.targetId=e,this.fe=n}}class r2{constructor(e,n,r=qt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class UA{constructor(){this.ge=0,this.pe=zA(),this.ye=qt.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=ye(),n=ye(),r=ye();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:ee()}}),new Ic(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=zA()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1}Be(){this.Se=!0,this.we=!0}}class YH{constructor(e){this.Le=e,this.ke=new Map,this.qe=Hr(),this.Qe=BA(),this.Ke=new He(Ae)}$e(e){for(const n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(const n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{const r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:ee()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){const n=e.targetId,r=e.fe.count,i=this.Ye(n);if(i){const s=i.target;if(Cv(s))if(r===0){const o=new Q(s.path);this.We(n,o,Bt.newNoDocument(o,re.min()))}else Me(r===1);else{const o=this.Ze(n);if(o!==r){const a=this.Xe(e),l=a?this.et(a,e,o):1;if(l!==0){this.He(n);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,u)}}}}}Xe(e){const n=e.fe.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=$s(r).toUint8Array()}catch(l){if(l instanceof NN)return Ia("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Pw(o,i,s)}catch(l){return Ia(l instanceof bl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Te===0?null:a}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(n,s,null),i++)}),i}it(e){const n=new Map;this.ke.forEach((s,o)=>{const a=this.Ye(o);if(a){if(s.current&&Cv(a.target)){const l=new Q(a.target.path);this.qe.get(l)!==null||this.st(o,l)||this.We(o,l,Bt.newNoDocument(l,e))}s.De&&(n.set(o,s.ve()),s.Fe())}});let r=ye();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.Ye(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(e));const i=new Dp(e,n,this.Ke,this.qe,r);return this.qe=Hr(),this.Qe=BA(),this.Ke=new He(Ae),i}Ue(e,n){if(!this.je(e))return;const r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;const i=this.ze(e);this.st(e,n)?i.Me(n,1):i.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){const n=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new UA,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new Nt(Ae),this.Qe=this.Qe.insert(e,n)),n}je(e){const n=this.Ye(e)!==null;return n||z("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){const n=this.ke.get(e);return n&&n.be?null:this.Le._t(e)}He(e){this.ke.set(e,new UA),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function BA(){return new He(Q.comparator)}function zA(){return new He(Q.comparator)}const XH=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),JH=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),ZH=(()=>({and:"AND",or:"OR"}))();class e7{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Pv(t,e){return t.useProto3Json||Cp(e)?e:{value:e}}function md(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function i2(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function t7(t,e){return md(t,e.toTimestamp())}function _r(t){return Me(!!t),re.fromTimestamp(function(n){const r=Fi(n);return new ft(r.seconds,r.nanos)}(t))}function Rw(t,e){return function(r){return new Ue(["projects",r.projectId,"databases",r.database])}(t).child("documents").child(e).canonicalString()}function s2(t){const e=Ue.fromString(t);return Me(u2(e)),e}function Rv(t,e){return Rw(t.databaseId,e.path)}function wg(t,e){const n=s2(e);if(n.get(1)!==t.databaseId.projectId)throw new K(k.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new K(k.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Q(o2(n))}function kv(t,e){return Rw(t.databaseId,e)}function n7(t){const e=s2(t);return e.length===4?Ue.emptyPath():o2(e)}function Nv(t){return new Ue(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function o2(t){return Me(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function WA(t,e,n){return{name:Rv(t,e),fields:n.value.mapValue.fields}}function r7(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:ee()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,h){return u.useProto3Json?(Me(h===void 0||typeof h=="string"),qt.fromBase64String(h||"")):(Me(h===void 0||h instanceof Uint8Array),qt.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const h=u.code===void 0?k.UNKNOWN:t2(u.code);return new K(h,u.message||"")}(o);n=new r2(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=wg(t,r.document.name),s=_r(r.document.updateTime),o=r.document.createTime?_r(r.document.createTime):re.min(),a=new Pn({mapValue:{fields:r.document.fields}}),l=Bt.newFoundDocument(i,s,o,a),u=r.targetIds||[],h=r.removedTargetIds||[];n=new Lh(u,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=wg(t,r.document),s=r.readTime?_r(r.readTime):re.min(),o=Bt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Lh([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=wg(t,r.document),s=r.removedTargetIds||[];n=new Lh([],s,i,null)}else{if(!("filter"in e))return ee();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new HH(i,s),a=r.targetId;n=new n2(a,o)}}return n}function i7(t,e){let n;if(e instanceof Tc)n={update:WA(t,e.key,e.value)};else if(e instanceof e2)n={delete:Rv(t,e.key)};else if(e instanceof Gs)n={update:WA(t,e.key,e.data),updateMask:d7(e.fieldMask)};else{if(!(e instanceof zH))return ee();n={verify:Rv(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof yd)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Vu)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Lu)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof gd)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw ee()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:t7(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ee()}(t,e.precondition)),n}function s7(t,e){return t&&t.length>0?(Me(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?_r(i.updateTime):_r(s);return o.isEqual(re.min())&&(o=_r(s)),new LH(o,i.transformResults||[])}(n,e))):[]}function o7(t,e){return{documents:[kv(t,e.path)]}}function a7(t,e){const n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=kv(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=kv(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(l){if(l.length!==0)return l2(xr.create(l,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const s=function(l){if(l.length!==0)return l.map(u=>function(f){return{field:yo(f.field),direction:c7(f.dir)}}(u))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const o=Pv(t,e.limit);return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),n}function l7(t){let e=n7(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Me(r===1);const h=n.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];n.where&&(s=function(f){const d=a2(f);return d instanceof xr&&$N(d)?d.getFilters():[d]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(d=>function(g){return new pd(go(g.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(d))}(n.orderBy));let a=null;n.limit&&(a=function(f){let d;return d=typeof f=="object"?f.value:f,Cp(d)?null:d}(n.limit));let l=null;n.startAt&&(l=function(f){const d=!!f.before,p=f.values||[];return new dd(p,d)}(n.startAt));let u=null;return n.endAt&&(u=function(f){const d=!f.before,p=f.values||[];return new dd(p,d)}(n.endAt)),IH(e,i,o,s,a,"F",l,u)}function u7(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ee()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function a2(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=go(n.unaryFilter.field);return ct.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=go(n.unaryFilter.field);return ct.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=go(n.unaryFilter.field);return ct.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=go(n.unaryFilter.field);return ct.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ee()}}(t):t.fieldFilter!==void 0?function(n){return ct.create(go(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ee()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return xr.create(n.compositeFilter.filters.map(r=>a2(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ee()}}(n.compositeFilter.op))}(t):ee()}function c7(t){return XH[t]}function h7(t){return JH[t]}function f7(t){return ZH[t]}function yo(t){return{fieldPath:t.canonicalString()}}function go(t){return Pt.fromServerFormat(t.fieldPath)}function l2(t){return t instanceof ct?function(n){if(n.op==="=="){if(RA(n.value))return{unaryFilter:{field:yo(n.field),op:"IS_NAN"}};if(PA(n.value))return{unaryFilter:{field:yo(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(RA(n.value))return{unaryFilter:{field:yo(n.field),op:"IS_NOT_NAN"}};if(PA(n.value))return{unaryFilter:{field:yo(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:yo(n.field),op:h7(n.op),value:n.value}}}(t):t instanceof xr?function(n){const r=n.getFilters().map(i=>l2(i));return r.length===1?r[0]:{compositeFilter:{op:f7(n.op),filters:r}}}(t):ee()}function d7(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function u2(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e,n,r,i,s=re.min(),o=re.min(),a=qt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new pi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new pi(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new pi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new pi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p7{constructor(e){this.ut=e}}function y7(t){const e=l7({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?bv(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g7{constructor(){this.on=new m7}addToCollectionParentIndex(e,n){return this.on.add(n),R.resolve()}getCollectionParents(e,n){return R.resolve(this.on.getEntries(n))}addFieldIndex(e,n){return R.resolve()}deleteFieldIndex(e,n){return R.resolve()}deleteAllFieldIndexes(e){return R.resolve()}createTargetIndexes(e,n){return R.resolve()}getDocumentsMatchingTarget(e,n){return R.resolve(null)}getIndexType(e,n){return R.resolve(0)}getFieldIndexes(e,n){return R.resolve([])}getNextCollectionGroupToUpdate(e){return R.resolve(null)}getMinOffset(e,n){return R.resolve($i.min())}getMinOffsetFromCollectionGroup(e,n){return R.resolve($i.min())}updateCollectionGroup(e,n,r){return R.resolve()}updateIndexEntries(e,n){return R.resolve()}}class m7{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Nt(Ue.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Nt(Ue.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new Ra(0)}static Nn(){return new Ra(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v7{constructor(){this.changes=new Ha(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Bt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?R.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _7{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w7{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Jl(r.mutation,i,Kn.empty(),ft.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ye()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ye()){const i=os();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Cl();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=os();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ye()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Hr();const o=Xl(),a=function(){return Xl()}();return n.forEach((l,u)=>{const h=r.get(u.key);i.has(u.key)&&(h===void 0||h.mutation instanceof Gs)?s=s.insert(u.key,u):h!==void 0?(o.set(u.key,h.mutation.getFieldMask()),Jl(h.mutation,u,h.mutation.getFieldMask(),ft.now())):o.set(u.key,Kn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,h)=>o.set(u,h)),n.forEach((u,h)=>{var f;return a.set(u,new _7(h,(f=o.get(u))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,n){const r=Xl();let i=new He((o,a)=>o-a),s=ye();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=n.get(l);if(u===null)return;let h=r.get(l)||Kn.empty();h=a.applyToLocalView(u,h),r.set(l,h);const f=(i.get(a.batchId)||ye()).add(l);i=i.insert(a.batchId,f)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,h=l.value,f=GN();h.forEach(d=>{if(!s.has(d)){const p=JN(n.get(d),r.get(d));p!==null&&f.set(d,p),s=s.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,f))}return R.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return Q.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):CH(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):R.resolve(os());let a=-1,l=s;return o.next(u=>R.forEach(u,(h,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),s.get(h)?R.resolve():this.remoteDocumentCache.getEntry(e,h).next(d=>{l=l.insert(h,d)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,ye())).next(h=>({batchId:a,changes:WN(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Q(n)).next(r=>{let i=Cl();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=Cl();return this.indexManager.getCollectionParents(e,s).next(a=>R.forEach(a,l=>{const u=function(f,d){return new bp(d,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(h=>{h.forEach((f,d)=>{o=o.insert(f,d)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,u)=>{const h=u.getKey();o.get(h)===null&&(o=o.insert(h,Bt.newInvalidDocument(h)))});let a=Cl();return o.forEach((l,u)=>{const h=s.get(l);h!==void 0&&Jl(h.mutation,u,Kn.empty(),ft.now()),Rp(n,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E7{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,n){return R.resolve(this.ur.get(n))}saveBundleMetadata(e,n){return this.ur.set(n.id,function(i){return{id:i.id,version:i.version,createTime:_r(i.createTime)}}(n)),R.resolve()}getNamedQuery(e,n){return R.resolve(this.cr.get(n))}saveNamedQuery(e,n){return this.cr.set(n.name,function(i){return{name:i.name,query:y7(i.bundledQuery),readTime:_r(i.readTime)}}(n)),R.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x7{constructor(){this.overlays=new He(Q.comparator),this.lr=new Map}getOverlay(e,n){return R.resolve(this.overlays.get(n))}getOverlays(e,n){const r=os();return R.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.lt(e,n,s)}),R.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.lr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(r)),R.resolve()}getOverlaysForCollection(e,n,r){const i=os(),s=n.length+1,o=new Q(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return R.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new He((u,h)=>u-h);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let h=s.get(u.largestBatchId);h===null&&(h=os(),s=s.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const a=os(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,h)=>a.set(u,h)),!(a.size()>=i)););return R.resolve(a)}lt(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.lr.get(i.largestBatchId).delete(r.key);this.lr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new GH(n,r));let s=this.lr.get(n);s===void 0&&(s=ye(),this.lr.set(n,s)),this.lr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kw{constructor(){this.hr=new Nt(_t.Pr),this.Ir=new Nt(_t.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,n){const r=new _t(e,n);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.dr(new _t(e,n))}Ar(e,n){e.forEach(r=>this.removeReference(r,n))}Rr(e){const n=new Q(new Ue([])),r=new _t(n,e),i=new _t(n,e+1),s=[];return this.Ir.forEachInRange([r,i],o=>{this.dr(o),s.push(o.key)}),s}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const n=new Q(new Ue([])),r=new _t(n,e),i=new _t(n,e+1);let s=ye();return this.Ir.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new _t(e,0),r=this.hr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class _t{constructor(e,n){this.key=e,this.gr=n}static Pr(e,n){return Q.comparator(e.key,n.key)||Ae(e.gr,n.gr)}static Tr(e,n){return Ae(e.gr,n.gr)||Q.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S7{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.pr=1,this.yr=new Nt(_t.Pr)}checkEmpty(e){return R.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new WH(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.yr=this.yr.add(new _t(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return R.resolve(o)}lookupMutationBatch(e,n){return R.resolve(this.wr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.Sr(r),s=i<0?0:i;return R.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return R.resolve(this.mutationQueue.length===0?-1:this.pr-1)}getAllMutationBatches(e){return R.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new _t(n,0),i=new _t(n,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([r,i],o=>{const a=this.wr(o.gr);s.push(a)}),R.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Nt(Ae);return n.forEach(i=>{const s=new _t(i,0),o=new _t(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,o],a=>{r=r.add(a.gr)})}),R.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;Q.isDocumentKey(s)||(s=s.child(""));const o=new _t(new Q(s),0);let a=new Nt(Ae);return this.yr.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(l.gr)),!0)},o),R.resolve(this.br(a))}br(e){const n=[];return e.forEach(r=>{const i=this.wr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){Me(this.Dr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.yr;return R.forEach(n.mutations,i=>{const s=new _t(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,n){const r=new _t(n,0),i=this.yr.firstAfterOrEqual(r);return R.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,R.resolve()}Dr(e,n){return this.Sr(e)}Sr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}wr(e){const n=this.Sr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A7{constructor(e){this.Cr=e,this.docs=function(){return new He(Q.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Cr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return R.resolve(r?r.document.mutableCopy():Bt.newInvalidDocument(n))}getEntries(e,n){let r=Hr();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Bt.newInvalidDocument(i))}),R.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Hr();const o=n.path,a=new Q(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:h}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||uH(lH(h),r)<=0||(i.has(h.key)||Rp(n,h))&&(s=s.insert(h.key,h.mutableCopy()))}return R.resolve(s)}getAllFromCollectionGroup(e,n,r,i){ee()}vr(e,n){return R.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new T7(this)}getSize(e){return R.resolve(this.size)}}class T7 extends v7{constructor(e){super(),this._r=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this._r.addEntry(e,i)):this._r.removeEntry(r)}),R.waitFor(n)}getFromCache(e,n){return this._r.getEntry(e,n)}getAllFromCache(e,n){return this._r.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I7{constructor(e){this.persistence=e,this.Fr=new Ha(n=>Iw(n),Cw),this.lastRemoteSnapshotVersion=re.min(),this.highestTargetId=0,this.Mr=0,this.Or=new kw,this.targetCount=0,this.Nr=Ra.On()}forEachTarget(e,n){return this.Fr.forEach((r,i)=>n(i)),R.resolve()}getLastRemoteSnapshotVersion(e){return R.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return R.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),R.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Mr&&(this.Mr=n),R.resolve()}kn(e){this.Fr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Nr=new Ra(n),this.highestTargetId=n),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,n){return this.kn(n),this.targetCount+=1,R.resolve()}updateTargetData(e,n){return this.kn(n),R.resolve()}removeTargetData(e,n){return this.Fr.delete(n.target),this.Or.Rr(n.targetId),this.targetCount-=1,R.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Fr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Fr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),R.waitFor(s).next(()=>i)}getTargetCount(e){return R.resolve(this.targetCount)}getTargetData(e,n){const r=this.Fr.get(n)||null;return R.resolve(r)}addMatchingKeys(e,n,r){return this.Or.Er(n,r),R.resolve()}removeMatchingKeys(e,n,r){this.Or.Ar(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),R.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Or.Rr(n),R.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Or.mr(n);return R.resolve(r)}containsKey(e,n){return R.resolve(this.Or.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C7{constructor(e,n){this.Br={},this.overlays={},this.Lr=new xw(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new I7(this),this.indexManager=new g7,this.remoteDocumentCache=function(i){return new A7(i)}(r=>this.referenceDelegate.Qr(r)),this.serializer=new p7(n),this.Kr=new E7(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new x7,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Br[e.toKey()];return r||(r=new S7(n,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,n,r){z("MemoryPersistence","Starting transaction:",e);const i=new b7(this.Lr.next());return this.referenceDelegate.$r(),r(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(e,n){return R.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,n)))}}class b7 extends hH{constructor(e){super(),this.currentSequenceNumber=e}}class Nw{constructor(e){this.persistence=e,this.Gr=new kw,this.zr=null}static jr(e){return new Nw(e)}get Hr(){if(this.zr)return this.zr;throw ee()}addReference(e,n,r){return this.Gr.addReference(r,n),this.Hr.delete(r.toString()),R.resolve()}removeReference(e,n,r){return this.Gr.removeReference(r,n),this.Hr.add(r.toString()),R.resolve()}markPotentiallyOrphaned(e,n){return this.Hr.add(n.toString()),R.resolve()}removeTarget(e,n){this.Gr.Rr(n.targetId).forEach(i=>this.Hr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}$r(){this.zr=new Set}Ur(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return R.forEach(this.Hr,r=>{const i=Q.fromPath(r);return this.Jr(e,i).next(s=>{s||n.removeEntry(i,re.min())})}).next(()=>(this.zr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Jr(e,n).next(r=>{r?this.Hr.delete(n.toString()):this.Hr.add(n.toString())})}Qr(e){return 0}Jr(e,n){return R.or([()=>R.resolve(this.Gr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Wr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dw{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.ki=r,this.qi=i}static Qi(e,n){let r=ye(),i=ye();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Dw(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P7{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R7{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(e,n){this.Gi=e,this.indexManager=n,this.Ki=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.zi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ji(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new P7;return this.Hi(e,n,o).next(a=>{if(s.result=a,this.$i)return this.Ji(e,n,o,a.size)})}).next(()=>s.result)}Ji(e,n,r,i){return r.documentReadCount<this.Ui?(gl()<=Ee.DEBUG&&z("QueryEngine","SDK will not create cache indexes for query:",po(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),R.resolve()):(gl()<=Ee.DEBUG&&z("QueryEngine","Query:",po(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Wi*i?(gl()<=Ee.DEBUG&&z("QueryEngine","The SDK decides to create cache indexes for query:",po(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,vr(n))):R.resolve())}zi(e,n){if(OA(n))return R.resolve(null);let r=vr(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=bv(n,null,"F"),r=vr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=ye(...s);return this.Gi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.Yi(n,a);return this.Zi(n,u,o,l.readTime)?this.zi(e,bv(n,null,"F")):this.Xi(e,u,n,l)}))})))}ji(e,n,r,i){return OA(n)||i.isEqual(re.min())?R.resolve(null):this.Gi.getDocuments(e,r).next(s=>{const o=this.Yi(n,s);return this.Zi(n,o,r,i)?R.resolve(null):(gl()<=Ee.DEBUG&&z("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),po(n)),this.Xi(e,o,n,aH(i,-1)).next(a=>a))})}Yi(e,n){let r=new Nt(BN(e));return n.forEach((i,s)=>{Rp(e,s)&&(r=r.add(s))}),r}Zi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(e,n,r){return gl()<=Ee.DEBUG&&z("QueryEngine","Using full collection scan to execute query:",po(n)),this.Gi.getDocumentsMatchingQuery(e,n,$i.min(),r)}Xi(e,n,r,i){return this.Gi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k7{constructor(e,n,r,i){this.persistence=e,this.es=n,this.serializer=i,this.ts=new He(Ae),this.ns=new Ha(s=>Iw(s),Cw),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new w7(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ts))}}function N7(t,e,n,r){return new k7(t,e,n,r)}async function c2(t,e){const n=ie(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.os(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=ye();for(const u of i){o.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}for(const u of s){a.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}return n.localDocuments.getDocuments(r,l).next(u=>({_s:u,removedBatchIds:o,addedBatchIds:a}))})})}function D7(t,e){const n=ie(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.ss.newChangeBuffer({trackRemovals:!0});return function(a,l,u,h){const f=u.batch,d=f.keys();let p=R.resolve();return d.forEach(g=>{p=p.next(()=>h.getEntry(l,g)).next(v=>{const E=u.docVersions.get(g);Me(E!==null),v.version.compareTo(E)<0&&(f.applyToRemoteDocument(v,u),v.isValidDocument()&&(v.setReadTime(u.commitVersion),h.addEntry(v)))})}),p.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=ye();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function h2(t){const e=ie(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.qr.getLastRemoteSnapshotVersion(n))}function O7(t,e){const n=ie(t),r=e.snapshotVersion;let i=n.ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.ss.newChangeBuffer({trackRemovals:!0});i=n.ts;const a=[];e.targetChanges.forEach((h,f)=>{const d=i.get(f);if(!d)return;a.push(n.qr.removeMatchingKeys(s,h.removedDocuments,f).next(()=>n.qr.addMatchingKeys(s,h.addedDocuments,f)));let p=d.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?p=p.withResumeToken(qt.EMPTY_BYTE_STRING,re.min()).withLastLimboFreeSnapshotVersion(re.min()):h.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(h.resumeToken,r)),i=i.insert(f,p),function(v,E,m){return v.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=3e8?!0:m.addedDocuments.size+m.modifiedDocuments.size+m.removedDocuments.size>0}(d,p,h)&&a.push(n.qr.updateTargetData(s,p))});let l=Hr(),u=ye();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,h))}),a.push(j7(s,o,e.documentUpdates).next(h=>{l=h.us,u=h.cs})),!r.isEqual(re.min())){const h=n.qr.getLastRemoteSnapshotVersion(s).next(f=>n.qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(h)}return R.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(n.ts=i,s))}function j7(t,e,n){let r=ye(),i=ye();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Hr();return n.forEach((a,l)=>{const u=s.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(re.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):z("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{us:o,cs:i}})}function $7(t,e){const n=ie(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function F7(t,e){const n=ie(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.qr.getTargetData(r,e).next(s=>s?(i=s,R.resolve(i)):n.qr.allocateTargetId(r).next(o=>(i=new pi(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.qr.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.ts.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ts=n.ts.insert(r.targetId,r),n.ns.set(e,r.targetId)),r})}async function Dv(t,e,n){const r=ie(t),i=r.ts.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Ac(o))throw o;z("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ts=r.ts.remove(e),r.ns.delete(i.target)}function GA(t,e,n){const r=ie(t);let i=re.min(),s=ye();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,h){const f=ie(l),d=f.ns.get(h);return d!==void 0?R.resolve(f.ts.get(d)):f.qr.getTargetData(u,h)}(r,o,vr(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.es.getDocumentsMatchingQuery(o,e,n?i:re.min(),n?s:ye())).next(a=>(M7(r,PH(e),a),{documents:a,ls:s})))}function M7(t,e,n){let r=t.rs.get(e)||re.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.rs.set(e,r)}class HA{constructor(){this.activeTargetIds=jH()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class V7{constructor(){this.eo=new HA,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,n,r){this.no[e]=n}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new HA,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L7{ro(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qA{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){z("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){z("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hh=null;function Eg(){return hh===null?hh=function(){return 268435456+Math.round(2147483648*Math.random())}():hh++,"0x"+hh.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U7={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B7{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}onMessage(e){this.Eo=e}close(){this.lo()}send(e){this.co(e)}Ao(){this.Po()}Ro(e){this.To(e)}Vo(e){this.Eo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vt="WebChannelConnection";class z7 extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.mo=r+"://"+n.host,this.fo=`projects/${i}/databases/${s}`,this.po=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get yo(){return!1}wo(n,r,i,s,o){const a=Eg(),l=this.So(n,r);z("RestConnection",`Sending RPC '${n}' ${a}:`,l,i);const u={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(u,s,o),this.Do(n,l,u,i).then(h=>(z("RestConnection",`Received RPC '${n}' ${a}: `,h),h),h=>{throw Ia("RestConnection",`RPC '${n}' ${a} failed with error: `,h,"url: ",l,"request:",i),h})}Co(n,r,i,s,o,a){return this.wo(n,r,i,s,o)}bo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Wa}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}So(n,r){const i=U7[n];return`${this.mo}/v1/${r}:${i}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Do(e,n,r,i){const s=Eg();return new Promise((o,a)=>{const l=new YG;l.setWithCredentials(!0),l.listenOnce(qG.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case _g.NO_ERROR:const h=l.getResponseJson();z(Vt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),o(h);break;case _g.TIMEOUT:z(Vt,`RPC '${e}' ${s} timed out`),a(new K(k.DEADLINE_EXCEEDED,"Request time out"));break;case _g.HTTP_ERROR:const f=l.getStatus();if(z(Vt,`RPC '${e}' ${s} failed with status:`,f,"response text:",l.getResponseText()),f>0){let d=l.getResponseJson();Array.isArray(d)&&(d=d[0]);const p=d==null?void 0:d.error;if(p&&p.status&&p.message){const g=function(E){const m=E.toLowerCase().replace(/_/g,"-");return Object.values(k).indexOf(m)>=0?m:k.UNKNOWN}(p.status);a(new K(g,p.message))}else a(new K(k.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new K(k.UNAVAILABLE,"Connection failed."));break;default:ee()}}finally{z(Vt,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);z(Vt,`RPC '${e}' ${s} sending request:`,i),l.send(n,"POST",u,r,15)})}vo(e,n,r){const i=Eg(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=GG(),a=HG(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.xmlHttpFactory=new QG({})),this.bo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const h=s.join("");z(Vt,`Creating RPC '${e}' stream ${i}: ${h}`,l);const f=o.createWebChannel(h,l);let d=!1,p=!1;const g=new B7({co:E=>{p?z(Vt,`Not sending because RPC '${e}' stream ${i} is closed:`,E):(d||(z(Vt,`Opening RPC '${e}' stream ${i} transport.`),f.open(),d=!0),z(Vt,`RPC '${e}' stream ${i} sending:`,E),f.send(E))},lo:()=>f.close()}),v=(E,m,y)=>{E.listen(m,_=>{try{y(_)}catch(S){setTimeout(()=>{throw S},0)}})};return v(f,lh.EventType.OPEN,()=>{p||z(Vt,`RPC '${e}' stream ${i} transport opened.`)}),v(f,lh.EventType.CLOSE,()=>{p||(p=!0,z(Vt,`RPC '${e}' stream ${i} transport closed`),g.Ro())}),v(f,lh.EventType.ERROR,E=>{p||(p=!0,Ia(Vt,`RPC '${e}' stream ${i} transport errored:`,E),g.Ro(new K(k.UNAVAILABLE,"The operation could not be completed")))}),v(f,lh.EventType.MESSAGE,E=>{var m;if(!p){const y=E.data[0];Me(!!y);const _=y,S=_.error||((m=_[0])===null||m===void 0?void 0:m.error);if(S){z(Vt,`RPC '${e}' stream ${i} received error:`,S);const A=S.status;let T=function(H){const M=rt[H];if(M!==void 0)return t2(M)}(A),I=S.message;T===void 0&&(T=k.INTERNAL,I="Unknown error status: "+A+" with message "+S.message),p=!0,g.Ro(new K(T,I)),f.close()}else z(Vt,`RPC '${e}' stream ${i} received:`,y),g.Vo(y)}}),v(a,KG.STAT_EVENT,E=>{E.stat===AA.PROXY?z(Vt,`RPC '${e}' stream ${i} detected buffering proxy`):E.stat===AA.NOPROXY&&z(Vt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{g.Ao()},0),g}}function xg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Op(t){return new e7(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f2{constructor(e,n,r=1e3,i=1.5,s=6e4){this.si=e,this.timerId=n,this.Fo=r,this.Mo=i,this.xo=s,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(e){this.cancel();const n=Math.floor(this.Oo+this.qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,n-r);i>0&&z("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Oo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){this.No!==null&&(this.No.skipDelay(),this.No=null)}cancel(){this.No!==null&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d2{constructor(e,n,r,i,s,o,a,l){this.si=e,this.Ko=r,this.$o=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new f2(e,n)}jo(){return this.state===1||this.state===5||this.Ho()}Ho(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Jo()}async stop(){this.jo()&&await this.close(0)}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&this.Wo===null&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(e){this.t_(),this.stream.send(e)}async Xo(){if(this.Ho())return this.close(0)}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}async close(e,n){this.t_(),this.n_(),this.zo.cancel(),this.Uo++,e!==4?this.zo.reset():n&&n.code===k.RESOURCE_EXHAUSTED?(Gr(n.toString()),Gr("Using maximum backoff delay to prevent overloading the backend."),this.zo.Lo()):n&&n.code===k.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.r_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Io(n)}r_(){}auth(){this.state=1;const e=this.i_(this.Uo),n=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Uo===n&&this.s_(r,i)},r=>{e(()=>{const i=new K(k.UNKNOWN,"Fetching auth token failed: "+r.message);return this.o_(i)})})}s_(e,n){const r=this.i_(this.Uo);this.stream=this.__(e,n),this.stream.ho(()=>{r(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(i=>{r(()=>this.o_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Jo(){this.state=5,this.zo.ko(async()=>{this.state=0,this.start()})}o_(e){return z("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}i_(e){return n=>{this.si.enqueueAndForget(()=>this.Uo===e?n():(z("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class W7 extends d2{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}__(e,n){return this.connection.vo("Listen",e,n)}onMessage(e){this.zo.reset();const n=r7(this.serializer,e),r=function(s){if(!("targetChange"in s))return re.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?re.min():o.readTime?_r(o.readTime):re.min()}(e);return this.listener.a_(n,r)}u_(e){const n={};n.database=Nv(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=Cv(l)?{documents:o7(s,l)}:{query:a7(s,l)},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=i2(s,o.resumeToken);const u=Pv(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(re.min())>0){a.readTime=md(s,o.snapshotVersion.toTimestamp());const u=Pv(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=u7(this.serializer,e);r&&(n.labels=r),this.e_(n)}c_(e){const n={};n.database=Nv(this.serializer),n.removeTarget=e,this.e_(n)}}class G7 extends d2{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(e,n){return this.connection.vo("Write",e,n)}onMessage(e){if(Me(!!e.streamToken),this.lastStreamToken=e.streamToken,this.l_){this.zo.reset();const n=s7(e.writeResults,e.commitTime),r=_r(e.commitTime);return this.listener.I_(r,n)}return Me(!e.writeResults||e.writeResults.length===0),this.l_=!0,this.listener.T_()}E_(){const e={};e.database=Nv(this.serializer),this.e_(e)}P_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>i7(this.serializer,r))};this.e_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H7 extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.d_=!1}A_(){if(this.d_)throw new K(k.FAILED_PRECONDITION,"The client has already been terminated.")}wo(e,n,r){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.wo(e,n,r,i,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===k.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new K(k.UNKNOWN,i.toString())})}Co(e,n,r,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,n,r,s,o,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===k.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new K(k.UNKNOWN,s.toString())})}terminate(){this.d_=!0}}class q7{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){this.V_===0&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(e){this.state==="Online"?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.p_("Offline")))}set(e){this.S_(),this.V_=0,e==="Online"&&(this.f_=!1),this.p_(e)}p_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}y_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(Gr(n),this.f_=!1):z("OnlineStateTracker",n)}S_(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K7{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=s,this.F_.ro(o=>{r.enqueueAndForget(async()=>{Hs(this)&&(z("RemoteStore","Restarting streams for network reachability change."),await async function(l){const u=ie(l);u.C_.add(4),await Cc(u),u.M_.set("Unknown"),u.C_.delete(4),await jp(u)}(this))})}),this.M_=new q7(r,i)}}async function jp(t){if(Hs(t))for(const e of t.v_)await e(!0)}async function Cc(t){for(const e of t.v_)await e(!1)}function p2(t,e){const n=ie(t);n.D_.has(e.targetId)||(n.D_.set(e.targetId,e),$w(n)?jw(n):qa(n).Ho()&&Ow(n,e))}function y2(t,e){const n=ie(t),r=qa(n);n.D_.delete(e),r.Ho()&&g2(n,e),n.D_.size===0&&(r.Ho()?r.Zo():Hs(n)&&n.M_.set("Unknown"))}function Ow(t,e){if(t.x_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(re.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}qa(t).u_(e)}function g2(t,e){t.x_.Oe(e),qa(t).c_(e)}function jw(t){t.x_=new YH({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.D_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),qa(t).start(),t.M_.g_()}function $w(t){return Hs(t)&&!qa(t).jo()&&t.D_.size>0}function Hs(t){return ie(t).C_.size===0}function m2(t){t.x_=void 0}async function Q7(t){t.D_.forEach((e,n)=>{Ow(t,e)})}async function Y7(t,e){m2(t),$w(t)?(t.M_.w_(e),jw(t)):t.M_.set("Unknown")}async function X7(t,e,n){if(t.M_.set("Online"),e instanceof r2&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.D_.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.D_.delete(a),i.x_.removeTarget(a))}(t,e)}catch(r){z("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await vd(t,r)}else if(e instanceof Lh?t.x_.$e(e):e instanceof n2?t.x_.Je(e):t.x_.Ge(e),!n.isEqual(re.min()))try{const r=await h2(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.x_.it(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const h=s.D_.get(u);h&&s.D_.set(u,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const h=s.D_.get(l);if(!h)return;s.D_.set(l,h.withResumeToken(qt.EMPTY_BYTE_STRING,h.snapshotVersion)),g2(s,l);const f=new pi(h.target,l,u,h.sequenceNumber);Ow(s,f)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){z("RemoteStore","Failed to raise snapshot:",r),await vd(t,r)}}async function vd(t,e,n){if(!Ac(e))throw e;t.C_.add(1),await Cc(t),t.M_.set("Offline"),n||(n=()=>h2(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{z("RemoteStore","Retrying IndexedDB access"),await n(),t.C_.delete(1),await jp(t)})}function v2(t,e){return e().catch(n=>vd(t,n,e))}async function $p(t){const e=ie(t),n=Mi(e);let r=e.b_.length>0?e.b_[e.b_.length-1].batchId:-1;for(;J7(e);)try{const i=await $7(e.localStore,r);if(i===null){e.b_.length===0&&n.Zo();break}r=i.batchId,Z7(e,i)}catch(i){await vd(e,i)}_2(e)&&w2(e)}function J7(t){return Hs(t)&&t.b_.length<10}function Z7(t,e){t.b_.push(e);const n=Mi(t);n.Ho()&&n.h_&&n.P_(e.mutations)}function _2(t){return Hs(t)&&!Mi(t).jo()&&t.b_.length>0}function w2(t){Mi(t).start()}async function eq(t){Mi(t).E_()}async function tq(t){const e=Mi(t);for(const n of t.b_)e.P_(n.mutations)}async function nq(t,e,n){const r=t.b_.shift(),i=bw.from(r,e,n);await v2(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await $p(t)}async function rq(t,e){e&&Mi(t).h_&&await async function(r,i){if(function(o){return qH(o)&&o!==k.ABORTED}(i.code)){const s=r.b_.shift();Mi(r).Yo(),await v2(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await $p(r)}}(t,e),_2(t)&&w2(t)}async function KA(t,e){const n=ie(t);n.asyncQueue.verifyOperationInProgress(),z("RemoteStore","RemoteStore received new credentials");const r=Hs(n);n.C_.add(3),await Cc(n),r&&n.M_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.C_.delete(3),await jp(n)}async function iq(t,e){const n=ie(t);e?(n.C_.delete(2),await jp(n)):e||(n.C_.add(2),await Cc(n),n.M_.set("Unknown"))}function qa(t){return t.O_||(t.O_=function(n,r,i){const s=ie(n);return s.A_(),new W7(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:Q7.bind(null,t),Io:Y7.bind(null,t),a_:X7.bind(null,t)}),t.v_.push(async e=>{e?(t.O_.Yo(),$w(t)?jw(t):t.M_.set("Unknown")):(await t.O_.stop(),m2(t))})),t.O_}function Mi(t){return t.N_||(t.N_=function(n,r,i){const s=ie(n);return s.A_(),new G7(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:eq.bind(null,t),Io:rq.bind(null,t),T_:tq.bind(null,t),I_:nq.bind(null,t)}),t.v_.push(async e=>{e?(t.N_.Yo(),await $p(t)):(await t.N_.stop(),t.b_.length>0&&(z("RemoteStore",`Stopping write stream with ${t.b_.length} pending writes`),t.b_=[]))})),t.N_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fw{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new bi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new Fw(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new K(k.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Mw(t,e){if(Gr("AsyncQueue",`${e}: ${t}`),Ac(t))return new K(k.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ea{constructor(e){this.comparator=e?(n,r)=>e(n,r)||Q.comparator(n.key,r.key):(n,r)=>Q.comparator(n.key,r.key),this.keyedMap=Cl(),this.sortedSet=new He(this.comparator)}static emptySet(e){return new ea(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ea)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ea;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QA{constructor(){this.B_=new He(Q.comparator)}track(e){const n=e.doc.key,r=this.B_.get(n);r?e.type!==0&&r.type===3?this.B_=this.B_.insert(n,e):e.type===3&&r.type!==1?this.B_=this.B_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.B_=this.B_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.B_=this.B_.remove(n):e.type===1&&r.type===2?this.B_=this.B_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):ee():this.B_=this.B_.insert(n,e)}L_(){const e=[];return this.B_.inorderTraversal((n,r)=>{e.push(r)}),e}}class ka{constructor(e,n,r,i,s,o,a,l,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new ka(e,n,ea.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Pp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sq{constructor(){this.k_=void 0,this.listeners=[]}}class oq{constructor(){this.queries=new Ha(e=>UN(e),Pp),this.onlineState="Unknown",this.q_=new Set}}async function aq(t,e){const n=ie(t),r=e.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new sq),i)try{s.k_=await n.onListen(r)}catch(o){const a=Mw(o,`Initialization of query '${po(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,s),s.listeners.push(e),e.Q_(n.onlineState),s.k_&&e.K_(s.k_)&&Vw(n)}async function lq(t,e){const n=ie(t),r=e.query;let i=!1;const s=n.queries.get(r);if(s){const o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),i=s.listeners.length===0)}if(i)return n.queries.delete(r),n.onUnlisten(r)}function uq(t,e){const n=ie(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.listeners)a.K_(i)&&(r=!0);o.k_=i}}r&&Vw(n)}function cq(t,e,n){const r=ie(t),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(n);r.queries.delete(e)}function Vw(t){t.q_.forEach(e=>{e.next()})}class hq{constructor(e,n,r){this.query=e,this.U_=n,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=r||{}}K_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new ka(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.W_?this.z_(e)&&(this.U_.next(e),n=!0):this.j_(e,this.onlineState)&&(this.H_(e),n=!0),this.G_=e,n}onError(e){this.U_.error(e)}Q_(e){this.onlineState=e;let n=!1;return this.G_&&!this.W_&&this.j_(this.G_,e)&&(this.H_(this.G_),n=!0),n}j_(e,n){if(!e.fromCache)return!0;const r=n!=="Offline";return(!this.options.J_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}z_(e){if(e.docChanges.length>0)return!0;const n=this.G_&&this.G_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}H_(e){e=ka.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.W_=!0,this.U_.next(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E2{constructor(e){this.key=e}}class x2{constructor(e){this.key=e}}class fq{constructor(e,n){this.query=e,this.ia=n,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=ye(),this.mutatedKeys=ye(),this._a=BN(e),this.aa=new ea(this._a)}get ua(){return this.ia}ca(e,n){const r=n?n.la:new QA,i=n?n.aa:this.aa;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,f)=>{const d=i.get(h),p=Rp(this.query,f)?f:null,g=!!d&&this.mutatedKeys.has(d.key),v=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let E=!1;d&&p?d.data.isEqual(p.data)?g!==v&&(r.track({type:3,doc:p}),E=!0):this.ha(d,p)||(r.track({type:2,doc:p}),E=!0,(l&&this._a(p,l)>0||u&&this._a(p,u)<0)&&(a=!0)):!d&&p?(r.track({type:0,doc:p}),E=!0):d&&!p&&(r.track({type:1,doc:d}),E=!0,(l||u)&&(a=!0)),E&&(p?(o=o.add(p),s=v?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{aa:o,la:r,Zi:a,mutatedKeys:s}}ha(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r){const i=this.aa;this.aa=e.aa,this.mutatedKeys=e.mutatedKeys;const s=e.la.L_();s.sort((u,h)=>function(d,p){const g=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ee()}};return g(d)-g(p)}(u.type,h.type)||this._a(u.doc,h.doc)),this.Pa(r);const o=n?this.Ia():[],a=this.oa.size===0&&this.current?1:0,l=a!==this.sa;return this.sa=a,s.length!==0||l?{snapshot:new ka(this.query,e.aa,i,s,e.mutatedKeys,a===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ta:o}:{Ta:o}}Q_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({aa:this.aa,la:new QA,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(e){return!this.ia.has(e)&&!!this.aa.has(e)&&!this.aa.get(e).hasLocalMutations}Pa(e){e&&(e.addedDocuments.forEach(n=>this.ia=this.ia.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.ia=this.ia.delete(n)),this.current=e.current)}Ia(){if(!this.current)return[];const e=this.oa;this.oa=ye(),this.aa.forEach(r=>{this.Ea(r.key)&&(this.oa=this.oa.add(r.key))});const n=[];return e.forEach(r=>{this.oa.has(r)||n.push(new x2(r))}),this.oa.forEach(r=>{e.has(r)||n.push(new E2(r))}),n}da(e){this.ia=e.ls,this.oa=ye();const n=this.ca(e.documents);return this.applyChanges(n,!0)}Aa(){return ka.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,this.sa===0,this.hasCachedResults)}}class dq{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class pq{constructor(e){this.key=e,this.Ra=!1}}class yq{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Va={},this.ma=new Ha(a=>UN(a),Pp),this.fa=new Map,this.ga=new Set,this.pa=new He(Q.comparator),this.ya=new Map,this.wa=new kw,this.Sa={},this.ba=new Map,this.Da=Ra.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return this.Ca===!0}}async function gq(t,e){const n=Iq(t);let r,i;const s=n.ma.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Aa();else{const o=await F7(n.localStore,vr(e)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=await mq(n,e,r,a==="current",o.resumeToken),n.isPrimaryClient&&p2(n.remoteStore,o)}return i}async function mq(t,e,n,r,i){t.va=(f,d,p)=>async function(v,E,m,y){let _=E.view.ca(m);_.Zi&&(_=await GA(v.localStore,E.query,!1).then(({documents:T})=>E.view.ca(T,_)));const S=y&&y.targetChanges.get(E.targetId),A=E.view.applyChanges(_,v.isPrimaryClient,S);return XA(v,E.targetId,A.Ta),A.snapshot}(t,f,d,p);const s=await GA(t.localStore,e,!0),o=new fq(e,s.ls),a=o.ca(s.documents),l=Ic.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,l);XA(t,n,u.Ta);const h=new dq(e,n,o);return t.ma.set(e,h),t.fa.has(n)?t.fa.get(n).push(e):t.fa.set(n,[e]),u.snapshot}async function vq(t,e){const n=ie(t),r=n.ma.get(e),i=n.fa.get(r.targetId);if(i.length>1)return n.fa.set(r.targetId,i.filter(s=>!Pp(s,e))),void n.ma.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await Dv(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),y2(n.remoteStore,r.targetId),Ov(n,r.targetId)}).catch(Sc)):(Ov(n,r.targetId),await Dv(n.localStore,r.targetId,!0))}async function _q(t,e,n){const r=Cq(t);try{const i=await function(o,a){const l=ie(o),u=ft.now(),h=a.reduce((p,g)=>p.add(g.key),ye());let f,d;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let g=Hr(),v=ye();return l.ss.getEntries(p,h).next(E=>{g=E,g.forEach((m,y)=>{y.isValidDocument()||(v=v.add(m))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,g)).next(E=>{f=E;const m=[];for(const y of a){const _=BH(y,f.get(y.key).overlayedDocument);_!=null&&m.push(new Gs(y.key,_,DN(_.value.mapValue),Fr.exists(!0)))}return l.mutationQueue.addMutationBatch(p,u,m,a)}).next(E=>{d=E;const m=E.applyToLocalDocumentSet(f,v);return l.documentOverlayCache.saveOverlays(p,E.batchId,m)})}).then(()=>({batchId:d.batchId,changes:WN(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let u=o.Sa[o.currentUser.toKey()];u||(u=new He(Ae)),u=u.insert(a,l),o.Sa[o.currentUser.toKey()]=u}(r,i.batchId,n),await bc(r,i.changes),await $p(r.remoteStore)}catch(i){const s=Mw(i,"Failed to persist write");n.reject(s)}}async function S2(t,e){const n=ie(t);try{const r=await O7(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.ya.get(s);o&&(Me(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Ra=!0:i.modifiedDocuments.size>0?Me(o.Ra):i.removedDocuments.size>0&&(Me(o.Ra),o.Ra=!1))}),await bc(n,r,e)}catch(r){await Sc(r)}}function YA(t,e,n){const r=ie(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.ma.forEach((s,o)=>{const a=o.view.Q_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=ie(o);l.onlineState=a;let u=!1;l.queries.forEach((h,f)=>{for(const d of f.listeners)d.Q_(a)&&(u=!0)}),u&&Vw(l)}(r.eventManager,e),i.length&&r.Va.a_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function wq(t,e,n){const r=ie(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.ya.get(e),s=i&&i.key;if(s){let o=new He(Q.comparator);o=o.insert(s,Bt.newNoDocument(s,re.min()));const a=ye().add(s),l=new Dp(re.min(),new Map,new He(Ae),o,a);await S2(r,l),r.pa=r.pa.remove(s),r.ya.delete(e),Lw(r)}else await Dv(r.localStore,e,!1).then(()=>Ov(r,e,n)).catch(Sc)}async function Eq(t,e){const n=ie(t),r=e.batch.batchId;try{const i=await D7(n.localStore,e);T2(n,r,null),A2(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await bc(n,i)}catch(i){await Sc(i)}}async function xq(t,e,n){const r=ie(t);try{const i=await function(o,a){const l=ie(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return l.mutationQueue.lookupMutationBatch(u,a).next(f=>(Me(f!==null),h=f.keys(),l.mutationQueue.removeMutationBatch(u,f))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>l.localDocuments.getDocuments(u,h))})}(r.localStore,e);T2(r,e,n),A2(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await bc(r,i)}catch(i){await Sc(i)}}function A2(t,e){(t.ba.get(e)||[]).forEach(n=>{n.resolve()}),t.ba.delete(e)}function T2(t,e,n){const r=ie(t);let i=r.Sa[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Sa[r.currentUser.toKey()]=i}}function Ov(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.fa.get(e))t.ma.delete(r),n&&t.Va.Fa(r,n);t.fa.delete(e),t.isPrimaryClient&&t.wa.Rr(e).forEach(r=>{t.wa.containsKey(r)||I2(t,r)})}function I2(t,e){t.ga.delete(e.path.canonicalString());const n=t.pa.get(e);n!==null&&(y2(t.remoteStore,n),t.pa=t.pa.remove(e),t.ya.delete(n),Lw(t))}function XA(t,e,n){for(const r of n)r instanceof E2?(t.wa.addReference(r.key,e),Sq(t,r)):r instanceof x2?(z("SyncEngine","Document no longer in limbo: "+r.key),t.wa.removeReference(r.key,e),t.wa.containsKey(r.key)||I2(t,r.key)):ee()}function Sq(t,e){const n=e.key,r=n.path.canonicalString();t.pa.get(n)||t.ga.has(r)||(z("SyncEngine","New document in limbo: "+n),t.ga.add(r),Lw(t))}function Lw(t){for(;t.ga.size>0&&t.pa.size<t.maxConcurrentLimboResolutions;){const e=t.ga.values().next().value;t.ga.delete(e);const n=new Q(Ue.fromString(e)),r=t.Da.next();t.ya.set(r,new pq(n)),t.pa=t.pa.insert(n,r),p2(t.remoteStore,new pi(vr(LN(n.path)),r,"TargetPurposeLimboResolution",xw._e))}}async function bc(t,e,n){const r=ie(t),i=[],s=[],o=[];r.ma.isEmpty()||(r.ma.forEach((a,l)=>{o.push(r.va(l,e,n).then(u=>{if((u||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(l.targetId,u!=null&&u.fromCache?"not-current":"current"),u){i.push(u);const h=Dw.Qi(l.targetId,u);s.push(h)}}))}),await Promise.all(o),r.Va.a_(i),await async function(l,u){const h=ie(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>R.forEach(u,d=>R.forEach(d.ki,p=>h.persistence.referenceDelegate.addReference(f,d.targetId,p)).next(()=>R.forEach(d.qi,p=>h.persistence.referenceDelegate.removeReference(f,d.targetId,p)))))}catch(f){if(!Ac(f))throw f;z("LocalStore","Failed to update sequence numbers: "+f)}for(const f of u){const d=f.targetId;if(!f.fromCache){const p=h.ts.get(d),g=p.snapshotVersion,v=p.withLastLimboFreeSnapshotVersion(g);h.ts=h.ts.insert(d,v)}}}(r.localStore,s))}async function Aq(t,e){const n=ie(t);if(!n.currentUser.isEqual(e)){z("SyncEngine","User change. New user:",e.toKey());const r=await c2(n.localStore,e);n.currentUser=e,function(s,o){s.ba.forEach(a=>{a.forEach(l=>{l.reject(new K(k.CANCELLED,o))})}),s.ba.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await bc(n,r._s)}}function Tq(t,e){const n=ie(t),r=n.ya.get(e);if(r&&r.Ra)return ye().add(r.key);{let i=ye();const s=n.fa.get(e);if(!s)return i;for(const o of s){const a=n.ma.get(o);i=i.unionWith(a.view.ua)}return i}}function Iq(t){const e=ie(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=S2.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Tq.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=wq.bind(null,e),e.Va.a_=uq.bind(null,e.eventManager),e.Va.Fa=cq.bind(null,e.eventManager),e}function Cq(t){const e=ie(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Eq.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=xq.bind(null,e),e}class JA{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=Op(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return N7(this.persistence,new R7,e.initialUser,this.serializer)}createPersistence(e){return new C7(Nw.jr,this.serializer)}createSharedClientState(e){return new V7}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class bq{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>YA(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Aq.bind(null,this.syncEngine),await iq(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new oq}()}createDatastore(e){const n=Op(e.databaseInfo.databaseId),r=function(s){return new z7(s)}(e.databaseInfo);return function(s,o,a,l){return new H7(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new K7(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>YA(this.syncEngine,n,0),function(){return qA.D()?new qA:new L7}())}createSyncEngine(e,n){return function(i,s,o,a,l,u,h){const f=new yq(i,s,o,a,l,u);return h&&(f.Ca=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(n){const r=ie(n);z("RemoteStore","RemoteStore shutting down."),r.C_.add(5),await Cc(r),r.F_.shutdown(),r.M_.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pq{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Oa(this.observer.next,e)}error(e){this.observer.error?this.Oa(this.observer.error,e):Gr("Uncaught Error in snapshot listener:",e.toString())}Na(){this.muted=!0}Oa(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rq{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Lt.UNAUTHENTICATED,this.clientId=RN.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async s=>{z("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(r,s=>(z("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new K(k.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new bi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Mw(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Sg(t,e){t.asyncQueue.verifyOperationInProgress(),z("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await c2(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function ZA(t,e){t.asyncQueue.verifyOperationInProgress();const n=await Nq(t);z("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener(i=>KA(e.remoteStore,i)),t.setAppCheckTokenChangeListener((i,s)=>KA(e.remoteStore,s)),t._onlineComponents=e}function kq(t){return t.name==="FirebaseError"?t.code===k.FAILED_PRECONDITION||t.code===k.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}async function Nq(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){z("FirestoreClient","Using user provided OfflineComponentProvider");try{await Sg(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!kq(n))throw n;Ia("Error using user provided cache. Falling back to memory cache: "+n),await Sg(t,new JA)}}else z("FirestoreClient","Using default OfflineComponentProvider"),await Sg(t,new JA);return t._offlineComponents}async function C2(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(z("FirestoreClient","Using user provided OnlineComponentProvider"),await ZA(t,t._uninitializedComponentsProvider._online)):(z("FirestoreClient","Using default OnlineComponentProvider"),await ZA(t,new bq))),t._onlineComponents}function Dq(t){return C2(t).then(e=>e.syncEngine)}async function Oq(t){const e=await C2(t),n=e.eventManager;return n.onListen=gq.bind(null,e.syncEngine),n.onUnlisten=vq.bind(null,e.syncEngine),n}function jq(t,e,n={}){const r=new bi;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const h=new Pq({next:d=>{o.enqueueAndForget(()=>lq(s,f)),d.fromCache&&l.source==="server"?u.reject(new K(k.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(d)},error:d=>u.reject(d)}),f=new hq(a,h,{includeMetadataChanges:!0,J_:!0});return aq(s,f)}(await Oq(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b2(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eT=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P2(t,e,n){if(!n)throw new K(k.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function $q(t,e,n,r){if(e===!0&&r===!0)throw new K(k.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function tT(t){if(!Q.isDocumentKey(t))throw new K(k.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function nT(t){if(Q.isDocumentKey(t))throw new K(k.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Uw(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ee()}function Uu(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new K(k.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Uw(t);throw new K(k.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rT{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new K(k.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new K(k.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}$q("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=b2((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new K(k.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new K(k.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new K(k.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Fp{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new rT({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new K(k.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new K(k.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new rT(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new JG;switch(r.type){case"firstParty":return new nH(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new K(k.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=eT.get(n);r&&(z("ComponentProvider","Removing Datastore"),eT.delete(n),r.terminate())}(this),Promise.resolve()}}function Fq(t,e,n,r={}){var i;const s=(t=Uu(t,Fp))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Ia("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=Lt.MOCK_USER;else{a=j_(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new K(k.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Lt(u)}t._authCredentials=new ZG(new PN(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Mp(this.firestore,e,this._query)}}class Dn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Pi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Dn(this.firestore,e,this._key)}}class Pi extends Mp{constructor(e,n,r){super(e,n,LN(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Dn(this.firestore,null,new Q(e))}withConverter(e){return new Pi(this.firestore,e,this._path)}}function Mq(t,e,...n){if(t=Ot(t),P2("collection","path",e),t instanceof Fp){const r=Ue.fromString(e,...n);return nT(r),new Pi(t,null,r)}{if(!(t instanceof Dn||t instanceof Pi))throw new K(k.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ue.fromString(e,...n));return nT(r),new Pi(t.firestore,null,r)}}function Vq(t,e,...n){if(t=Ot(t),arguments.length===1&&(e=RN.newId()),P2("doc","path",e),t instanceof Fp){const r=Ue.fromString(e,...n);return tT(r),new Dn(t,null,new Q(r))}{if(!(t instanceof Dn||t instanceof Pi))throw new K(k.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ue.fromString(e,...n));return tT(r),new Dn(t.firestore,t instanceof Pi?t.converter:null,new Q(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lq{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new f2(this,"async_queue_retry"),this.iu=()=>{const n=xg();n&&z("AsyncQueue","Visibility state changed to "+n.visibilityState),this.zo.Qo()};const e=xg();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.su(),this.ou(e)}enterRestrictedMode(e){if(!this.Za){this.Za=!0,this.nu=e||!1;const n=xg();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.iu)}}enqueue(e){if(this.su(),this.Za)return new Promise(()=>{});const n=new bi;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ya.push(e),this._u()))}async _u(){if(this.Ya.length!==0){try{await this.Ya[0](),this.Ya.shift(),this.zo.reset()}catch(e){if(!Ac(e))throw e;z("AsyncQueue","Operation failed with retryable error: "+e)}this.Ya.length>0&&this.zo.ko(()=>this._u())}}ou(e){const n=this.Ja.then(()=>(this.tu=!0,e().catch(r=>{this.eu=r,this.tu=!1;const i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Gr("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.tu=!1,r))));return this.Ja=n,n}enqueueAfterDelay(e,n,r){this.su(),this.ru.indexOf(e)>-1&&(n=0);const i=Fw.createAndSchedule(this,e,n,r,s=>this.au(s));return this.Xa.push(i),i}su(){this.eu&&ee()}verifyOperationInProgress(){}async uu(){let e;do e=this.Ja,await e;while(e!==this.Ja)}cu(e){for(const n of this.Xa)if(n.timerId===e)return!0;return!1}lu(e){return this.uu().then(()=>{this.Xa.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Xa)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.uu()})}hu(e){this.ru.push(e)}au(e){const n=this.Xa.indexOf(e);this.Xa.splice(n,1)}}class Bw extends Fp{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new Lq}(),this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||k2(this),this._firestoreClient.terminate()}}function Uq(t,e){const n=typeof t=="object"?t:L_(),r=typeof t=="string"?t:e||"(default)",i=M_(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=O_("firestore");s&&Fq(i,...s)}return i}function R2(t){return t._firestoreClient||k2(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function k2(t){var e,n,r;const i=t._freezeSettings(),s=function(a,l,u,h){return new pH(a,l,u,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,b2(h.experimentalLongPollingOptions),h.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new Rq(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Na{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Na(qt.fromBase64String(e))}catch(n){throw new K(k.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Na(qt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zw{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new K(k.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Pt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N2{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ww{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new K(k.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new K(k.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ae(this._lat,e._lat)||Ae(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bq=/^__.*__$/;class zq{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Gs(e,this.data,this.fieldMask,n,this.fieldTransforms):new Tc(e,this.data,n,this.fieldTransforms)}}function D2(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ee()}}class Gw{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Pu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(e){return new Gw(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Tu({path:r,du:!1});return i.Au(e),i}Ru(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Tu({path:r,du:!1});return i.Pu(),i}Vu(e){return this.Tu({path:void 0,du:!0})}mu(e){return _d(e,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Au(this.path.get(e))}Au(e){if(e.length===0)throw this.mu("Document fields must not be empty");if(D2(this.Iu)&&Bq.test(e))throw this.mu('Document fields cannot begin and end with "__"')}}class Wq{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Op(e)}pu(e,n,r,i=!1){return new Gw({Iu:e,methodName:n,gu:r,path:Pt.emptyPath(),du:!1,fu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Gq(t){const e=t._freezeSettings(),n=Op(t._databaseId);return new Wq(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Hq(t,e,n,r,i,s={}){const o=t.pu(s.merge||s.mergeFields?2:0,e,n,i);F2("Data must be an object, but it was:",o,r);const a=j2(r,o);let l,u;if(s.merge)l=new Kn(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const f of s.mergeFields){const d=qq(e,f,n);if(!o.contains(d))throw new K(k.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);Qq(h,d)||h.push(d)}l=new Kn(h),u=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,u=o.fieldTransforms;return new zq(new Pn(a),l,u)}function O2(t,e){if($2(t=Ot(t)))return F2("Unsupported field value:",e,t),j2(t,e);if(t instanceof N2)return function(r,i){if(!D2(i.Iu))throw i.mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.mu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.du&&e.Iu!==4)throw e.mu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=O2(a,i.Vu(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Ot(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return $H(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=ft.fromDate(r);return{timestampValue:md(i.serializer,s)}}if(r instanceof ft){const s=new ft(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:md(i.serializer,s)}}if(r instanceof Ww)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Na)return{bytesValue:i2(i.serializer,r._byteString)};if(r instanceof Dn){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.mu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Rw(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.mu(`Unsupported field value: ${Uw(r)}`)}(t,e)}function j2(t,e){const n={};return kN(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ga(t,(r,i)=>{const s=O2(i,e.Eu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function $2(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ft||t instanceof Ww||t instanceof Na||t instanceof Dn||t instanceof N2)}function F2(t,e,n){if(!$2(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=Uw(n);throw r==="an object"?e.mu(t+" a custom object"):e.mu(t+" "+r)}}function qq(t,e,n){if((e=Ot(e))instanceof zw)return e._internalPath;if(typeof e=="string")return M2(t,e);throw _d("Field path arguments must be of type string or ",t,!1,void 0,n)}const Kq=new RegExp("[~\\*/\\[\\]]");function M2(t,e,n){if(e.search(Kq)>=0)throw _d(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new zw(...e.split("."))._internalPath}catch{throw _d(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function _d(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new K(k.INVALID_ARGUMENT,a+t+l)}function Qq(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V2{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Dn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Yq(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(L2("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class Yq extends V2{data(){return super.data()}}function L2(t,e){return typeof e=="string"?M2(t,e):e instanceof zw?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xq(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new K(k.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Jq{convertValue(e,n="none"){switch(Fs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return it(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes($s(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw ee()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Ga(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new Ww(it(e.latitude),it(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Aw(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp($u(e));default:return null}}convertTimestamp(e){const n=Fi(e);return new ft(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ue.fromString(e);Me(u2(r));const i=new Fu(r.get(1),r.get(3)),s=new Q(r.popFirst(5));return i.isEqual(n)||Gr(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zq(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fh{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class eK extends V2{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Uh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(L2("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Uh extends eK{data(e={}){return super.data(e)}}class tK{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new fh(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Uh(this._firestore,this._userDataWriter,r.key,r,new fh(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new K(k.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new Uh(i._firestore,i._userDataWriter,a.doc.key,a.doc,new fh(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new Uh(i._firestore,i._userDataWriter,a.doc.key,a.doc,new fh(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,h=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:nK(a.type),doc:l,oldIndex:u,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function nK(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ee()}}class rK extends Jq{constructor(e){super(),this.firestore=e}convertBytes(e){return new Na(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Dn(this.firestore,null,n)}}function iK(t){t=Uu(t,Mp);const e=Uu(t.firestore,Bw),n=R2(e),r=new rK(e);return Xq(t._query),jq(n,t._query).then(i=>new tK(e,r,t,i))}function sK(t,e,n){t=Uu(t,Dn);const r=Uu(t.firestore,Bw),i=Zq(t.converter,e,n);return oK(r,[Hq(Gq(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Fr.none())])}function oK(t,e){return function(r,i){const s=new bi;return r.asyncQueue.enqueueAndForget(async()=>_q(await Dq(r),i,s)),s.promise}(R2(t),e)}(function(e,n=!0){(function(i){Wa=i})(V_),ca(new bs("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new Bw(new eH(r.getProvider("auth-internal")),new iH(r.getProvider("app-check-internal")),function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new K(k.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Fu(u.options.projectId,h)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),mr(TA,"4.3.2",e),mr(TA,"4.3.2","esm2017")})();const U2=Uq(V0),aK=async()=>await iK(Mq(U2,"players")).then(e=>e.docs.map(n=>n.data())).catch(console.log),lK=async t=>{const e={...t,id:U0(),createdAt:new Date().getTime(),updatedAt:new Date().getTime()};return await sK(Vq(U2,"players",e.id),e),e};function uK({onSelect:t,...e}){const{value:n,loading:r}=S8(aK),i=w.useCallback(s=>{if(!n)return;const o=s.currentTarget.getAttribute("data-id");if(!o)return;const a=n.find(l=>l.id===o);a&&t(o,a)},[t,n]);return c.jsxs(wr,{title:"選擇玩家",...e,children:[r&&c.jsx("div",{className:"w-32 text-center mx-auto my-24",children:c.jsx("span",{className:"material-symbols-outlined animate-spin text-4xl",children:"progress_activity"})}),!r&&(n==null?void 0:n.length)===0&&c.jsxs("div",{className:"text-gray-500 text-center py-4",children:[c.jsx("p",{children:c.jsx("span",{className:"material-symbols-outlined text-[56px]",children:"search_off"})}),c.jsx("span",{children:"沒有已儲存的玩家"})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:!r&&(n==null?void 0:n.map(s=>c.jsx("div",{className:"text-left flex items-center gap-x-2",onClick:i,"data-id":s.id,children:c.jsx(ns,{player:s})},s.id)))})]})}const cK={0:{title:"",name:"玩家A",color:"#6700cf"},1:{title:"",name:"玩家B",color:"#00b5de"},2:{title:"",name:"玩家C",color:"#e3277b"},3:{title:"",name:"玩家D",color:"#03ada5"}},hK=`${new Date().toISOString().substring(0,10)} 對局`;function fK(){const t=Z9(),[,e]=Xj(),{getValues:n,control:r}=cp({defaultValues:{name:hK,startingScore:"25000",isManganRoundUp:"1",yakuMax:"12",yakumanMax:"13"}}),i=up({name:"startingScore",control:r}),[s,o]=w.useState(cK),[a,l]=w.useState(),[u,h]=Ci(!1),f=w.useCallback(T=>{const I=T.currentTarget.getAttribute("data-player-index");if(!I)return;const b=s[I];l({index:I,player:b}),h(!0)},[s,h]),d=w.useCallback(async T=>{a&&(o(I=>({...I,[a.index]:{...I[a.index],...T}})),h(!1))},[a,h]),p=w.useCallback(()=>{h(!1)},[h]),[g,v]=w.useState(),E=w.useCallback(T=>{T.preventDefault(),v("choose")},[]),m=w.useCallback(()=>{v(null)},[]),y=w.useCallback((T,I)=>{g==="choose"&&(l(b=>b?{...b,player:I}:void 0),v(null))},[g]),_=w.useCallback(T=>{const I=T.currentTarget;if(!I)return;const b=I.getAttribute("data-player-index");if(!b)return;const H=b==="0"?"1":b==="1"?"2":"3";o(M=>({...M,[b]:M[H],[H]:M[b]}))},[]),[{loading:S},A]=lp(async()=>{const{name:T,...I}=n(),b=await Promise.all(Object.values(s).map(U=>U.id||U.name==="玩家A"||U.name==="玩家B"||U.name==="玩家C"||U.name==="玩家D"?Promise.resolve(U):lK(U))),H={code:d8(),name:T,remark:"",createdAt:new Date().toISOString(),createdBy:"Dicky",updatedAt:new Date().toISOString(),updatedBy:"Dicky",setting:I,players:{0:b[0],1:b[1],2:b[2],3:b[3]},activeResultDetail:null},M=await t.push("matches",H),se=parseInt(I.startingScore),Z={matchId:M.key,code:ov(H.code,1,0),roundCount:1,extendedRoundCount:0,cumulatedThousands:0,nextRoundCumulatedThousands:0,resultType:0,nextRoundType:0,playerResults:{0:{beforeScore:se,afterScore:se,type:0,scoreChanges:[],prevScoreChanges:[]},1:{beforeScore:se,afterScore:se,type:0,scoreChanges:[],prevScoreChanges:[]},2:{beforeScore:se,afterScore:se,type:0,scoreChanges:[],prevScoreChanges:[]},3:{beforeScore:se,afterScore:se,type:0,scoreChanges:[],prevScoreChanges:[]}},doras:[]};await t.push("matchRounds",Z),e(`/match/${Z.matchId}/obs`)},[t,n,s,e]);return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"container mx-auto max-w-screen-sm",children:c.jsxs("div",{className:"min-h-screen flex flex-col py-16 gap-y-4",children:[c.jsx("div",{className:"shrink-0",children:c.jsx("a",{href:"/",className:"underline",children:"< 回上一頁"})}),c.jsx("div",{className:"flex-1",children:c.jsxs("div",{className:"space-y-12",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsx("h1",{className:"text-4xl",children:"對局"}),c.jsx(Cn,{label:"對局名稱",children:c.jsx(on,{name:"name",control:r,rules:{required:!0},render:({field:T})=>c.jsx("div",{className:"text-xl",children:c.jsx(fi,{...T})})})}),c.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[c.jsx(Cn,{label:"起始點數",children:c.jsx(on,{name:"startingScore",control:r,rules:{required:!0},render:({field:T})=>c.jsxs(ko,{...T,children:[c.jsx("option",{value:"25000",children:"25000"}),c.jsx("option",{value:"30000",children:"30000"}),c.jsx("option",{value:"35000",children:"35000"}),c.jsx("option",{value:"50000",children:"50000"}),c.jsx("option",{value:"100000",children:"100000"})]})})}),c.jsx(Cn,{label:"滿貫切上",children:c.jsx(on,{name:"isManganRoundUp",control:r,rules:{required:!0},render:({field:T})=>c.jsxs(ko,{...T,children:[c.jsx("option",{value:"0",children:"不切上"}),c.jsx("option",{value:"1",children:"切上 (3翻70符 & 4翻40符 = 滿貫)"})]})})}),c.jsx(Cn,{label:"累積翻數上限",children:c.jsx(on,{name:"yakuMax",control:r,rules:{required:!0},render:({field:T})=>c.jsxs(ko,{...T,children:[c.jsx("option",{value:"12",children:"三倍滿 (12翻)"}),c.jsx("option",{value:"13",children:"累計役滿 (13翻)"})]})})}),c.jsx(Cn,{label:"役滿上限",children:c.jsx(on,{name:"yakumanMax",control:r,rules:{required:!0},render:({field:T})=>c.jsxs(ko,{...T,children:[c.jsx("option",{value:"13",children:"單役滿"}),c.jsx("option",{value:"26",children:"兩倍役滿"}),c.jsx("option",{value:"39",children:"三倍役滿"}),c.jsx("option",{value:"130",children:"無上限"})]})})})]})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("h1",{className:"text-4xl",children:"玩家"}),c.jsx("div",{children:["0","1","2","3"].map(T=>c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex items-center gap-x-4",children:[c.jsx("div",{className:"shrink-0",children:c.jsx("div",{className:"h-14 w-14 border-4 rounded border-black text-[40px] flex items-center justify-center pb-1",children:c.jsx(WW,{playerIndex:T})})}),c.jsx("div",{className:"flex-1 text-[48px] cursor-pointer hover:scale-105","data-player-index":T,onClick:f,children:c.jsx(Ds,{player:s[T],score:i})})]},T),T!=="3"&&c.jsx("div",{className:"text-center",children:c.jsx(De,{variant:"icon",color:"secondary",type:"button","data-player-index":T,onClick:_,children:c.jsx("span",{className:"material-symbols-outlined",children:"swap_vert"})})})]}))})]})]})}),c.jsx("div",{className:"shrink-0 space-y-4",children:c.jsx(De,{size:"xlarge",className:"w-full",onClick:A,loading:S,type:"submit",children:"開始對局"})})]})}),c.jsx(wr,{title:c.jsxs("div",{className:"space-x-4",children:[c.jsx("span",{children:"修改玩家"}),c.jsxs("a",{href:"#",className:"text-xs underline font-normal text-teal-600 hover:text-teal-500 align-middle",onClick:E,children:[c.jsx("span",{className:"material-symbols-outlined text-xs",children:"search"})," ","搜尋玩家"]})]}),open:u,onClose:p,children:c.jsx("div",{className:"container space-y-6",children:c.jsx(Ik,{onSubmit:d,defaultValue:a==null?void 0:a.player})})}),c.jsx(uK,{open:g==="choose",onSelect:y,onClose:m})]})}function dK({team:t,onClickEdit:e,children:n,...r}){const i=w.useCallback(()=>{e==null||e(t)},[e,t]);return c.jsxs("div",{className:"flex-1 flex items-center gap-x-2 rounded p-2 text-white",style:{background:t.color??"#115e59"},...r,children:[c.jsx("div",{className:"flex-1",children:c.jsx("div",{className:"text-2xl",children:t.name??"(無名稱)"})}),e&&c.jsx("div",{className:"shrink-0",children:c.jsx(De,{variant:"icon",color:"inverted",type:"button",onClick:i,children:c.jsx("span",{className:"material-symbols-outlined",children:"edit"})})})]})}function pK(){const{data:t,update:e,push:n}=zr("teams"),r=w.useMemo(()=>Object.entries(t??{}).reverse().map(([m,y])=>({...y,_id:m})),[t]),[i,s]=Ci(!1),{register:o,reset:a,handleSubmit:l,control:u}=cp({defaultValues:{_id:void 0,name:"新的隊伍",color:"#000000"}}),h=up({control:u}),f=w.useMemo(()=>({name:"隊員名字",title:h.name??"",color:h.color??"#000000"}),[h.color,h.name]),d=w.useRef(null),p=w.useCallback(()=>s(!1),[s]),g=w.useCallback(()=>{a({_id:"",name:"新的隊伍",color:"#000000"}),s(!0)},[a,s]),v=w.useCallback(m=>{a({...m}),s(!0)},[a,s]),E=w.useMemo(()=>l(m=>{m._id?e({[m._id]:m}):n(m),s(!1)}),[l,n,s,e]);return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"container mx-auto max-w-screen-sm space-y-4 py-16",children:[c.jsx("div",{className:"shrink-0",children:c.jsx("a",{href:"/",className:"underline",children:"< 回上一頁"})}),c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("div",{children:c.jsx("h1",{className:"text-4xl",children:"隊伍"})}),c.jsx("div",{children:c.jsx(De,{onClick:g,children:"新增"})})]}),c.jsx("div",{className:"space-y-2",children:r.map(m=>c.jsx(dK,{team:m,onClickEdit:v},m._id))})]}),c.jsx(wr,{title:"新增／修改隊伍",open:i,onClose:p,children:c.jsx("div",{className:"container",children:c.jsxs("form",{ref:d,onSubmit:E,children:[c.jsx("input",{type:"hidden",...o("_id")}),c.jsxs("div",{children:[c.jsx(Cn,{className:"mb-6",label:"名字",children:c.jsx(on,{name:"name",control:u,rules:{required:!0},render:({field:m})=>c.jsx(fi,{...m})})}),c.jsx(Cn,{className:"mb-6",label:"顏色（務必選能看清楚白字的深色）",children:c.jsx(on,{name:"color",control:u,rules:{required:!0},render:({field:m})=>c.jsx(lk,{...m})})})]}),c.jsxs("div",{className:"mb-6",children:[c.jsx("div",{className:"mb-2",children:"預覽"}),c.jsx("div",{className:"text-[4rem] px-4 pt-6 pb-1 bg-gray-800 text-white relative",children:c.jsx(Ds,{player:f,score:25e3})})]}),c.jsxs("div",{className:"flex gap-x-2",children:[c.jsx("div",{className:"flex-1",children:c.jsx(De,{className:"w-full",color:"secondary",type:"button",onClick:p,children:"取消"})}),c.jsx("div",{className:"flex-1",children:c.jsx(De,{className:"w-full",type:"submit",children:"儲存"})})]})]})})})]})}function yK({params:{obsRoomId:t}}){const{data:e}=zr(`obs/${t}`),n=w.useMemo(()=>({matchId:e==null?void 0:e.matchId}),[e==null?void 0:e.matchId]);return console.log(e),!n||!n.matchId?c.jsx(c.Fragment,{children:"讀取中…"}):c.jsx(NR,{params:n})}function gK({params:{obsRoomId:t}}){const{data:e}=zr(`obs/${t}`),{match:n,matchRounds:r,matchCurrentRound:i}=Ua((e==null?void 0:e.matchId)??"");return!n||!i?c.jsx("div",{children:"對局讀取失敗。"}):c.jsx("div",{children:c.jsx("div",{className:"container mx-auto my-8 px-8 space-y-6",children:c.jsx(ap,{players:n.players,matchRounds:r,className:"w-full table-auto"})})})}function mK(){const{data:t}=zr("matches"),e=w.useMemo(()=>Object.entries(t??{}).reverse().map(([n,r])=>({...r,_id:n})),[t]);return c.jsxs("div",{className:"container mx-auto max-w-screen-sm space-y-4 py-16",children:[c.jsx("div",{className:"shrink-0",children:c.jsx("a",{href:"/",className:"underline",children:"< 回上一頁"})}),c.jsx("div",{className:"flex justify-between items-center",children:c.jsx("div",{children:c.jsx("h1",{className:"text-4xl",children:"玩家"})})}),c.jsx("div",{className:"space-y-2",children:e.map(()=>"123")})]})}function B2({players:t,matchRounds:e}){return w.useMemo(()=>{const n=Object.values(e??{}),r=n[n.length-1];return[...n.map(i=>({name:i.resultType===Zn.Hotfix?"分數調整":kR(i.roundCount,i.extendedRoundCount,8),p0:i.playerResults[0].beforeScore,p1:i.playerResults[1].beforeScore,p2:i.playerResults[2].beforeScore,p3:i.playerResults[3].beforeScore})),{name:"完結",p0:r.playerResults[0].afterScore,p1:r.playerResults[1].afterScore,p2:r.playerResults[2].afterScore,p3:r.playerResults[3].afterScore}]},[e]),c.jsx("div",{className:"bg-white"})}function vK({params:{obsRoomId:t}}){const{data:e}=zr(`obs/${t}`),{match:n,matchRounds:r,matchCurrentRound:i}=Ua((e==null?void 0:e.matchId)??"");return!n||!i?c.jsx("div",{children:"對局讀取失敗。"}):c.jsx("div",{children:c.jsx("div",{className:"container mx-auto my-8 px-8 space-y-6",children:c.jsx(B2,{players:n.players,matchRounds:r})})})}function _K({params:{obsRoomId:t}}){const{data:e}=zr(`obs/${t}`),{match:n,matchRounds:r,matchCurrentRound:i}=Ua((e==null?void 0:e.matchId)??""),[s,o]=w.useState(0);return w.useEffect(()=>{const l=setInterval(()=>{o(u=>1-u)},8e3);return()=>{clearInterval(l)}},[]),!n||!i?c.jsx("div",{children:"對局讀取失敗。"}):c.jsxs("div",{children:[c.jsx("div",{className:s===0?"block":"hidden",children:c.jsx(ap,{players:n.players,matchRounds:r,className:"w-full table-auto"})}),c.jsx("div",{className:s===1?"block":"hidden",children:c.jsx(B2,{players:n.players,matchRounds:r})})]})}Ag.createRoot(document.getElementById("root")).render(c.jsx(le.StrictMode,{children:c.jsx(J9,{children:c.jsx(w8,{children:c.jsxs(e$,{children:[c.jsx(Sn,{path:"/",component:n8}),c.jsx(Sn,{path:"/create-match",component:fK}),c.jsx(Sn,{path:"/match/:matchId",component:y8}),c.jsx(Sn,{path:"/match/:matchId/obs",component:NR}),c.jsx(Sn,{path:"/match/:matchId/control",component:Z8}),c.jsx(Sn,{path:"/obs/:obsRoomId",component:yK}),c.jsx(Sn,{path:"/obs/:obsRoomId/score",component:gK}),c.jsx(Sn,{path:"/obs/:obsRoomId/chart",component:vK}),c.jsx(Sn,{path:"/obs/:obsRoomId/carousel",component:_K}),c.jsx(Sn,{path:"/players",component:BW}),c.jsx(Sn,{path:"/teams",component:pK}),c.jsx(Sn,{path:"/matches",component:mK})]})})})}));i$();
