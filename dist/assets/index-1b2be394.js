var Mg=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var A=(t,e,n)=>(Mg(t,e,"read from private field"),n?n.call(t):e.get(t)),ee=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},H=(t,e,n,r)=>(Mg(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n);var $h=(t,e,n,r)=>({set _(s){H(t,e,s,n)},get _(){return A(t,e,r)}}),fe=(t,e,n)=>(Mg(t,e,"access private method"),n);function OM(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var iw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ow(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function DM(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var bk={exports:{}},pm={},Sk={exports:{}},be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zd=Symbol.for("react.element"),FM=Symbol.for("react.portal"),$M=Symbol.for("react.fragment"),MM=Symbol.for("react.strict_mode"),LM=Symbol.for("react.profiler"),VM=Symbol.for("react.provider"),UM=Symbol.for("react.context"),BM=Symbol.for("react.forward_ref"),zM=Symbol.for("react.suspense"),WM=Symbol.for("react.memo"),qM=Symbol.for("react.lazy"),Pb=Symbol.iterator;function HM(t){return t===null||typeof t!="object"?null:(t=Pb&&t[Pb]||t["@@iterator"],typeof t=="function"?t:null)}var Ck={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ak=Object.assign,Tk={};function hu(t,e,n){this.props=t,this.context=e,this.refs=Tk,this.updater=n||Ck}hu.prototype.isReactComponent={};hu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};hu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Ik(){}Ik.prototype=hu.prototype;function aw(t,e,n){this.props=t,this.context=e,this.refs=Tk,this.updater=n||Ck}var lw=aw.prototype=new Ik;lw.constructor=aw;Ak(lw,hu.prototype);lw.isPureReactComponent=!0;var Nb=Array.isArray,kk=Object.prototype.hasOwnProperty,uw={current:null},Rk={key:!0,ref:!0,__self:!0,__source:!0};function Pk(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)kk.call(e,r)&&!Rk.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:zd,type:t,key:i,ref:o,props:s,_owner:uw.current}}function GM(t,e){return{$$typeof:zd,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function cw(t){return typeof t=="object"&&t!==null&&t.$$typeof===zd}function QM(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var jb=/\/+/g;function Lg(t,e){return typeof t=="object"&&t!==null&&t.key!=null?QM(""+t.key):e.toString(36)}function Tf(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case zd:case FM:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Lg(o,0):r,Nb(s)?(n="",t!=null&&(n=t.replace(jb,"$&/")+"/"),Tf(s,e,n,"",function(c){return c})):s!=null&&(cw(s)&&(s=GM(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(jb,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Nb(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+Lg(i,a);o+=Tf(i,e,n,l,s)}else if(l=HM(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+Lg(i,a++),o+=Tf(i,e,n,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Mh(t,e,n){if(t==null)return t;var r=[],s=0;return Tf(t,r,"","",function(i){return e.call(n,i,s++)}),r}function KM(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var _n={current:null},If={transition:null},YM={ReactCurrentDispatcher:_n,ReactCurrentBatchConfig:If,ReactCurrentOwner:uw};be.Children={map:Mh,forEach:function(t,e,n){Mh(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Mh(t,function(){e++}),e},toArray:function(t){return Mh(t,function(e){return e})||[]},only:function(t){if(!cw(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};be.Component=hu;be.Fragment=$M;be.Profiler=LM;be.PureComponent=aw;be.StrictMode=MM;be.Suspense=zM;be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=YM;be.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Ak({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=uw.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)kk.call(e,l)&&!Rk.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:zd,type:t.type,key:s,ref:i,props:r,_owner:o}};be.createContext=function(t){return t={$$typeof:UM,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:VM,_context:t},t.Consumer=t};be.createElement=Pk;be.createFactory=function(t){var e=Pk.bind(null,t);return e.type=t,e};be.createRef=function(){return{current:null}};be.forwardRef=function(t){return{$$typeof:BM,render:t}};be.isValidElement=cw;be.lazy=function(t){return{$$typeof:qM,_payload:{_status:-1,_result:t},_init:KM}};be.memo=function(t,e){return{$$typeof:WM,type:t,compare:e===void 0?null:e}};be.startTransition=function(t){var e=If.transition;If.transition={};try{t()}finally{If.transition=e}};be.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};be.useCallback=function(t,e){return _n.current.useCallback(t,e)};be.useContext=function(t){return _n.current.useContext(t)};be.useDebugValue=function(){};be.useDeferredValue=function(t){return _n.current.useDeferredValue(t)};be.useEffect=function(t,e){return _n.current.useEffect(t,e)};be.useId=function(){return _n.current.useId()};be.useImperativeHandle=function(t,e,n){return _n.current.useImperativeHandle(t,e,n)};be.useInsertionEffect=function(t,e){return _n.current.useInsertionEffect(t,e)};be.useLayoutEffect=function(t,e){return _n.current.useLayoutEffect(t,e)};be.useMemo=function(t,e){return _n.current.useMemo(t,e)};be.useReducer=function(t,e,n){return _n.current.useReducer(t,e,n)};be.useRef=function(t){return _n.current.useRef(t)};be.useState=function(t){return _n.current.useState(t)};be.useSyncExternalStore=function(t,e,n){return _n.current.useSyncExternalStore(t,e,n)};be.useTransition=function(){return _n.current.useTransition()};be.version="18.2.0";Sk.exports=be;var x=Sk.exports;const me=ow(x),JM=OM({__proto__:null,default:me},[x]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var XM=x,ZM=Symbol.for("react.element"),e3=Symbol.for("react.fragment"),t3=Object.prototype.hasOwnProperty,n3=XM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,r3={key:!0,ref:!0,__self:!0,__source:!0};function Nk(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)t3.call(e,r)&&!r3.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:ZM,type:t,key:i,ref:o,props:s,_owner:n3.current}}pm.Fragment=e3;pm.jsx=Nk;pm.jsxs=Nk;bk.exports=pm;var u=bk.exports,R_={},jk={exports:{}},Vn={},Ok={exports:{}},Dk={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(z,Z){var K=z.length;z.push(Z);e:for(;0<K;){var de=K-1>>>1,Qe=z[de];if(0<s(Qe,Z))z[de]=Z,z[K]=Qe,K=de;else break e}}function n(z){return z.length===0?null:z[0]}function r(z){if(z.length===0)return null;var Z=z[0],K=z.pop();if(K!==Z){z[0]=K;e:for(var de=0,Qe=z.length,ss=Qe>>>1;de<ss;){var Bn=2*(de+1)-1,Rs=z[Bn],ar=Bn+1,kr=z[ar];if(0>s(Rs,K))ar<Qe&&0>s(kr,Rs)?(z[de]=kr,z[ar]=K,de=ar):(z[de]=Rs,z[Bn]=K,de=Bn);else if(ar<Qe&&0>s(kr,K))z[de]=kr,z[ar]=K,de=ar;else break e}}return Z}function s(z,Z){var K=z.sortIndex-Z.sortIndex;return K!==0?K:z.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],d=1,h=null,f=3,p=!1,y=!1,v=!1,_=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(z){for(var Z=n(c);Z!==null;){if(Z.callback===null)r(c);else if(Z.startTime<=z)r(c),Z.sortIndex=Z.expirationTime,e(l,Z);else break;Z=n(c)}}function E(z){if(v=!1,w(z),!y)if(n(l)!==null)y=!0,Ge(T);else{var Z=n(c);Z!==null&&ct(E,Z.startTime-z)}}function T(z,Z){y=!1,v&&(v=!1,g(k),k=-1),p=!0;var K=f;try{for(w(Z),h=n(l);h!==null&&(!(h.expirationTime>Z)||z&&!j());){var de=h.callback;if(typeof de=="function"){h.callback=null,f=h.priorityLevel;var Qe=de(h.expirationTime<=Z);Z=t.unstable_now(),typeof Qe=="function"?h.callback=Qe:h===n(l)&&r(l),w(Z)}else r(l);h=n(l)}if(h!==null)var ss=!0;else{var Bn=n(c);Bn!==null&&ct(E,Bn.startTime-Z),ss=!1}return ss}finally{h=null,f=K,p=!1}}var C=!1,I=null,k=-1,O=5,L=-1;function j(){return!(t.unstable_now()-L<O)}function P(){if(I!==null){var z=t.unstable_now();L=z;var Z=!0;try{Z=I(!0,z)}finally{Z?D():(C=!1,I=null)}}else C=!1}var D;if(typeof m=="function")D=function(){m(P)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,G=te.port2;te.port1.onmessage=P,D=function(){G.postMessage(null)}}else D=function(){_(P,0)};function Ge(z){I=z,C||(C=!0,D())}function ct(z,Z){k=_(function(){z(t.unstable_now())},Z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(z){z.callback=null},t.unstable_continueExecution=function(){y||p||(y=!0,Ge(T))},t.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<z?Math.floor(1e3/z):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(z){switch(f){case 1:case 2:case 3:var Z=3;break;default:Z=f}var K=f;f=Z;try{return z()}finally{f=K}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(z,Z){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var K=f;f=z;try{return Z()}finally{f=K}},t.unstable_scheduleCallback=function(z,Z,K){var de=t.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?de+K:de):K=de,z){case 1:var Qe=-1;break;case 2:Qe=250;break;case 5:Qe=1073741823;break;case 4:Qe=1e4;break;default:Qe=5e3}return Qe=K+Qe,z={id:d++,callback:Z,priorityLevel:z,startTime:K,expirationTime:Qe,sortIndex:-1},K>de?(z.sortIndex=K,e(c,z),n(l)===null&&z===n(c)&&(v?(g(k),k=-1):v=!0,ct(E,K-de))):(z.sortIndex=Qe,e(l,z),y||p||(y=!0,Ge(T))),z},t.unstable_shouldYield=j,t.unstable_wrapCallback=function(z){var Z=f;return function(){var K=f;f=Z;try{return z.apply(this,arguments)}finally{f=K}}}})(Dk);Ok.exports=Dk;var s3=Ok.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fk=x,$n=s3;function M(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var $k=new Set,Uc={};function Ko(t,e){Nl(t,e),Nl(t+"Capture",e)}function Nl(t,e){for(Uc[t]=e,t=0;t<e.length;t++)$k.add(e[t])}var vs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),P_=Object.prototype.hasOwnProperty,i3=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ob={},Db={};function o3(t){return P_.call(Db,t)?!0:P_.call(Ob,t)?!1:i3.test(t)?Db[t]=!0:(Ob[t]=!0,!1)}function a3(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function l3(t,e,n,r){if(e===null||typeof e>"u"||a3(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function xn(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Gt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Gt[t]=new xn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Gt[e]=new xn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Gt[t]=new xn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Gt[t]=new xn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Gt[t]=new xn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Gt[t]=new xn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Gt[t]=new xn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Gt[t]=new xn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Gt[t]=new xn(t,5,!1,t.toLowerCase(),null,!1,!1)});var dw=/[\-:]([a-z])/g;function hw(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(dw,hw);Gt[e]=new xn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(dw,hw);Gt[e]=new xn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(dw,hw);Gt[e]=new xn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Gt[t]=new xn(t,1,!1,t.toLowerCase(),null,!1,!1)});Gt.xlinkHref=new xn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Gt[t]=new xn(t,1,!1,t.toLowerCase(),null,!0,!0)});function fw(t,e,n,r){var s=Gt.hasOwnProperty(e)?Gt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(l3(e,n,s,r)&&(n=null),r||s===null?o3(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var As=Fk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Lh=Symbol.for("react.element"),Ra=Symbol.for("react.portal"),Pa=Symbol.for("react.fragment"),pw=Symbol.for("react.strict_mode"),N_=Symbol.for("react.profiler"),Mk=Symbol.for("react.provider"),Lk=Symbol.for("react.context"),yw=Symbol.for("react.forward_ref"),j_=Symbol.for("react.suspense"),O_=Symbol.for("react.suspense_list"),mw=Symbol.for("react.memo"),Ds=Symbol.for("react.lazy"),Vk=Symbol.for("react.offscreen"),Fb=Symbol.iterator;function Ru(t){return t===null||typeof t!="object"?null:(t=Fb&&t[Fb]||t["@@iterator"],typeof t=="function"?t:null)}var Xe=Object.assign,Vg;function Yu(t){if(Vg===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Vg=e&&e[1]||""}return`
`+Vg+t}var Ug=!1;function Bg(t,e){if(!t||Ug)return"";Ug=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Ug=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Yu(t):""}function u3(t){switch(t.tag){case 5:return Yu(t.type);case 16:return Yu("Lazy");case 13:return Yu("Suspense");case 19:return Yu("SuspenseList");case 0:case 2:case 15:return t=Bg(t.type,!1),t;case 11:return t=Bg(t.type.render,!1),t;case 1:return t=Bg(t.type,!0),t;default:return""}}function D_(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Pa:return"Fragment";case Ra:return"Portal";case N_:return"Profiler";case pw:return"StrictMode";case j_:return"Suspense";case O_:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Lk:return(t.displayName||"Context")+".Consumer";case Mk:return(t._context.displayName||"Context")+".Provider";case yw:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case mw:return e=t.displayName||null,e!==null?e:D_(t.type)||"Memo";case Ds:e=t._payload,t=t._init;try{return D_(t(e))}catch{}}return null}function c3(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return D_(e);case 8:return e===pw?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function wi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Uk(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function d3(t){var e=Uk(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Vh(t){t._valueTracker||(t._valueTracker=d3(t))}function Bk(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Uk(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function mp(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function F_(t,e){var n=e.checked;return Xe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function $b(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=wi(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function zk(t,e){e=e.checked,e!=null&&fw(t,"checked",e,!1)}function $_(t,e){zk(t,e);var n=wi(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?M_(t,e.type,n):e.hasOwnProperty("defaultValue")&&M_(t,e.type,wi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Mb(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function M_(t,e,n){(e!=="number"||mp(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ju=Array.isArray;function Ya(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+wi(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function L_(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(M(91));return Xe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Lb(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(M(92));if(Ju(n)){if(1<n.length)throw Error(M(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:wi(n)}}function Wk(t,e){var n=wi(e.value),r=wi(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Vb(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function qk(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function V_(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?qk(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Uh,Hk=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Uh=Uh||document.createElement("div"),Uh.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Uh.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Bc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var pc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},h3=["Webkit","ms","Moz","O"];Object.keys(pc).forEach(function(t){h3.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),pc[e]=pc[t]})});function Gk(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||pc.hasOwnProperty(t)&&pc[t]?(""+e).trim():e+"px"}function Qk(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Gk(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var f3=Xe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function U_(t,e){if(e){if(f3[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(M(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(M(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(M(61))}if(e.style!=null&&typeof e.style!="object")throw Error(M(62))}}function B_(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var z_=null;function gw(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var W_=null,Ja=null,Xa=null;function Ub(t){if(t=Hd(t)){if(typeof W_!="function")throw Error(M(280));var e=t.stateNode;e&&(e=_m(e),W_(t.stateNode,t.type,e))}}function Kk(t){Ja?Xa?Xa.push(t):Xa=[t]:Ja=t}function Yk(){if(Ja){var t=Ja,e=Xa;if(Xa=Ja=null,Ub(t),e)for(t=0;t<e.length;t++)Ub(e[t])}}function Jk(t,e){return t(e)}function Xk(){}var zg=!1;function Zk(t,e,n){if(zg)return t(e,n);zg=!0;try{return Jk(t,e,n)}finally{zg=!1,(Ja!==null||Xa!==null)&&(Xk(),Yk())}}function zc(t,e){var n=t.stateNode;if(n===null)return null;var r=_m(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(M(231,e,typeof n));return n}var q_=!1;if(vs)try{var Pu={};Object.defineProperty(Pu,"passive",{get:function(){q_=!0}}),window.addEventListener("test",Pu,Pu),window.removeEventListener("test",Pu,Pu)}catch{q_=!1}function p3(t,e,n,r,s,i,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(d){this.onError(d)}}var yc=!1,gp=null,vp=!1,H_=null,y3={onError:function(t){yc=!0,gp=t}};function m3(t,e,n,r,s,i,o,a,l){yc=!1,gp=null,p3.apply(y3,arguments)}function g3(t,e,n,r,s,i,o,a,l){if(m3.apply(this,arguments),yc){if(yc){var c=gp;yc=!1,gp=null}else throw Error(M(198));vp||(vp=!0,H_=c)}}function Yo(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function eR(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Bb(t){if(Yo(t)!==t)throw Error(M(188))}function v3(t){var e=t.alternate;if(!e){if(e=Yo(t),e===null)throw Error(M(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Bb(s),t;if(i===r)return Bb(s),e;i=i.sibling}throw Error(M(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(M(189))}}if(n.alternate!==r)throw Error(M(190))}if(n.tag!==3)throw Error(M(188));return n.stateNode.current===n?t:e}function tR(t){return t=v3(t),t!==null?nR(t):null}function nR(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=nR(t);if(e!==null)return e;t=t.sibling}return null}var rR=$n.unstable_scheduleCallback,zb=$n.unstable_cancelCallback,_3=$n.unstable_shouldYield,x3=$n.unstable_requestPaint,lt=$n.unstable_now,w3=$n.unstable_getCurrentPriorityLevel,vw=$n.unstable_ImmediatePriority,sR=$n.unstable_UserBlockingPriority,_p=$n.unstable_NormalPriority,E3=$n.unstable_LowPriority,iR=$n.unstable_IdlePriority,ym=null,Hr=null;function b3(t){if(Hr&&typeof Hr.onCommitFiberRoot=="function")try{Hr.onCommitFiberRoot(ym,t,void 0,(t.current.flags&128)===128)}catch{}}var wr=Math.clz32?Math.clz32:A3,S3=Math.log,C3=Math.LN2;function A3(t){return t>>>=0,t===0?32:31-(S3(t)/C3|0)|0}var Bh=64,zh=4194304;function Xu(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function xp(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=Xu(a):(i&=o,i!==0&&(r=Xu(i)))}else o=n&~s,o!==0?r=Xu(o):i!==0&&(r=Xu(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-wr(e),s=1<<n,r|=t[n],e&=~s;return r}function T3(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function I3(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-wr(i),a=1<<o,l=s[o];l===-1?(!(a&n)||a&r)&&(s[o]=T3(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function G_(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function oR(){var t=Bh;return Bh<<=1,!(Bh&4194240)&&(Bh=64),t}function Wg(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Wd(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-wr(e),t[e]=n}function k3(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-wr(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function _w(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-wr(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Ne=0;function aR(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var lR,xw,uR,cR,dR,Q_=!1,Wh=[],oi=null,ai=null,li=null,Wc=new Map,qc=new Map,Vs=[],R3="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Wb(t,e){switch(t){case"focusin":case"focusout":oi=null;break;case"dragenter":case"dragleave":ai=null;break;case"mouseover":case"mouseout":li=null;break;case"pointerover":case"pointerout":Wc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":qc.delete(e.pointerId)}}function Nu(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Hd(e),e!==null&&xw(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function P3(t,e,n,r,s){switch(e){case"focusin":return oi=Nu(oi,t,e,n,r,s),!0;case"dragenter":return ai=Nu(ai,t,e,n,r,s),!0;case"mouseover":return li=Nu(li,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Wc.set(i,Nu(Wc.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,qc.set(i,Nu(qc.get(i)||null,t,e,n,r,s)),!0}return!1}function hR(t){var e=eo(t.target);if(e!==null){var n=Yo(e);if(n!==null){if(e=n.tag,e===13){if(e=eR(n),e!==null){t.blockedOn=e,dR(t.priority,function(){uR(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function kf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=K_(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);z_=r,n.target.dispatchEvent(r),z_=null}else return e=Hd(n),e!==null&&xw(e),t.blockedOn=n,!1;e.shift()}return!0}function qb(t,e,n){kf(t)&&n.delete(e)}function N3(){Q_=!1,oi!==null&&kf(oi)&&(oi=null),ai!==null&&kf(ai)&&(ai=null),li!==null&&kf(li)&&(li=null),Wc.forEach(qb),qc.forEach(qb)}function ju(t,e){t.blockedOn===e&&(t.blockedOn=null,Q_||(Q_=!0,$n.unstable_scheduleCallback($n.unstable_NormalPriority,N3)))}function Hc(t){function e(s){return ju(s,t)}if(0<Wh.length){ju(Wh[0],t);for(var n=1;n<Wh.length;n++){var r=Wh[n];r.blockedOn===t&&(r.blockedOn=null)}}for(oi!==null&&ju(oi,t),ai!==null&&ju(ai,t),li!==null&&ju(li,t),Wc.forEach(e),qc.forEach(e),n=0;n<Vs.length;n++)r=Vs[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Vs.length&&(n=Vs[0],n.blockedOn===null);)hR(n),n.blockedOn===null&&Vs.shift()}var Za=As.ReactCurrentBatchConfig,wp=!0;function j3(t,e,n,r){var s=Ne,i=Za.transition;Za.transition=null;try{Ne=1,ww(t,e,n,r)}finally{Ne=s,Za.transition=i}}function O3(t,e,n,r){var s=Ne,i=Za.transition;Za.transition=null;try{Ne=4,ww(t,e,n,r)}finally{Ne=s,Za.transition=i}}function ww(t,e,n,r){if(wp){var s=K_(t,e,n,r);if(s===null)ev(t,e,r,Ep,n),Wb(t,r);else if(P3(s,t,e,n,r))r.stopPropagation();else if(Wb(t,r),e&4&&-1<R3.indexOf(t)){for(;s!==null;){var i=Hd(s);if(i!==null&&lR(i),i=K_(t,e,n,r),i===null&&ev(t,e,r,Ep,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else ev(t,e,r,null,n)}}var Ep=null;function K_(t,e,n,r){if(Ep=null,t=gw(r),t=eo(t),t!==null)if(e=Yo(t),e===null)t=null;else if(n=e.tag,n===13){if(t=eR(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ep=t,null}function fR(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(w3()){case vw:return 1;case sR:return 4;case _p:case E3:return 16;case iR:return 536870912;default:return 16}default:return 16}}var Ys=null,Ew=null,Rf=null;function pR(){if(Rf)return Rf;var t,e=Ew,n=e.length,r,s="value"in Ys?Ys.value:Ys.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Rf=s.slice(t,1<r?1-r:void 0)}function Pf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function qh(){return!0}function Hb(){return!1}function Un(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?qh:Hb,this.isPropagationStopped=Hb,this}return Xe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=qh)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=qh)},persist:function(){},isPersistent:qh}),e}var fu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bw=Un(fu),qd=Xe({},fu,{view:0,detail:0}),D3=Un(qd),qg,Hg,Ou,mm=Xe({},qd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sw,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ou&&(Ou&&t.type==="mousemove"?(qg=t.screenX-Ou.screenX,Hg=t.screenY-Ou.screenY):Hg=qg=0,Ou=t),qg)},movementY:function(t){return"movementY"in t?t.movementY:Hg}}),Gb=Un(mm),F3=Xe({},mm,{dataTransfer:0}),$3=Un(F3),M3=Xe({},qd,{relatedTarget:0}),Gg=Un(M3),L3=Xe({},fu,{animationName:0,elapsedTime:0,pseudoElement:0}),V3=Un(L3),U3=Xe({},fu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),B3=Un(U3),z3=Xe({},fu,{data:0}),Qb=Un(z3),W3={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},q3={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},H3={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function G3(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=H3[t])?!!e[t]:!1}function Sw(){return G3}var Q3=Xe({},qd,{key:function(t){if(t.key){var e=W3[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Pf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?q3[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sw,charCode:function(t){return t.type==="keypress"?Pf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Pf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),K3=Un(Q3),Y3=Xe({},mm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Kb=Un(Y3),J3=Xe({},qd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sw}),X3=Un(J3),Z3=Xe({},fu,{propertyName:0,elapsedTime:0,pseudoElement:0}),e4=Un(Z3),t4=Xe({},mm,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),n4=Un(t4),r4=[9,13,27,32],Cw=vs&&"CompositionEvent"in window,mc=null;vs&&"documentMode"in document&&(mc=document.documentMode);var s4=vs&&"TextEvent"in window&&!mc,yR=vs&&(!Cw||mc&&8<mc&&11>=mc),Yb=String.fromCharCode(32),Jb=!1;function mR(t,e){switch(t){case"keyup":return r4.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function gR(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Na=!1;function i4(t,e){switch(t){case"compositionend":return gR(e);case"keypress":return e.which!==32?null:(Jb=!0,Yb);case"textInput":return t=e.data,t===Yb&&Jb?null:t;default:return null}}function o4(t,e){if(Na)return t==="compositionend"||!Cw&&mR(t,e)?(t=pR(),Rf=Ew=Ys=null,Na=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return yR&&e.locale!=="ko"?null:e.data;default:return null}}var a4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xb(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!a4[t.type]:e==="textarea"}function vR(t,e,n,r){Kk(r),e=bp(e,"onChange"),0<e.length&&(n=new bw("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var gc=null,Gc=null;function l4(t){kR(t,0)}function gm(t){var e=Da(t);if(Bk(e))return t}function u4(t,e){if(t==="change")return e}var _R=!1;if(vs){var Qg;if(vs){var Kg="oninput"in document;if(!Kg){var Zb=document.createElement("div");Zb.setAttribute("oninput","return;"),Kg=typeof Zb.oninput=="function"}Qg=Kg}else Qg=!1;_R=Qg&&(!document.documentMode||9<document.documentMode)}function eS(){gc&&(gc.detachEvent("onpropertychange",xR),Gc=gc=null)}function xR(t){if(t.propertyName==="value"&&gm(Gc)){var e=[];vR(e,Gc,t,gw(t)),Zk(l4,e)}}function c4(t,e,n){t==="focusin"?(eS(),gc=e,Gc=n,gc.attachEvent("onpropertychange",xR)):t==="focusout"&&eS()}function d4(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return gm(Gc)}function h4(t,e){if(t==="click")return gm(e)}function f4(t,e){if(t==="input"||t==="change")return gm(e)}function p4(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Cr=typeof Object.is=="function"?Object.is:p4;function Qc(t,e){if(Cr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!P_.call(e,s)||!Cr(t[s],e[s]))return!1}return!0}function tS(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function nS(t,e){var n=tS(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=tS(n)}}function wR(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?wR(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function ER(){for(var t=window,e=mp();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=mp(t.document)}return e}function Aw(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function y4(t){var e=ER(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&wR(n.ownerDocument.documentElement,n)){if(r!==null&&Aw(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=nS(n,i);var o=nS(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var m4=vs&&"documentMode"in document&&11>=document.documentMode,ja=null,Y_=null,vc=null,J_=!1;function rS(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;J_||ja==null||ja!==mp(r)||(r=ja,"selectionStart"in r&&Aw(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),vc&&Qc(vc,r)||(vc=r,r=bp(Y_,"onSelect"),0<r.length&&(e=new bw("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ja)))}function Hh(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Oa={animationend:Hh("Animation","AnimationEnd"),animationiteration:Hh("Animation","AnimationIteration"),animationstart:Hh("Animation","AnimationStart"),transitionend:Hh("Transition","TransitionEnd")},Yg={},bR={};vs&&(bR=document.createElement("div").style,"AnimationEvent"in window||(delete Oa.animationend.animation,delete Oa.animationiteration.animation,delete Oa.animationstart.animation),"TransitionEvent"in window||delete Oa.transitionend.transition);function vm(t){if(Yg[t])return Yg[t];if(!Oa[t])return t;var e=Oa[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in bR)return Yg[t]=e[n];return t}var SR=vm("animationend"),CR=vm("animationiteration"),AR=vm("animationstart"),TR=vm("transitionend"),IR=new Map,sS="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pi(t,e){IR.set(t,e),Ko(e,[t])}for(var Jg=0;Jg<sS.length;Jg++){var Xg=sS[Jg],g4=Xg.toLowerCase(),v4=Xg[0].toUpperCase()+Xg.slice(1);Pi(g4,"on"+v4)}Pi(SR,"onAnimationEnd");Pi(CR,"onAnimationIteration");Pi(AR,"onAnimationStart");Pi("dblclick","onDoubleClick");Pi("focusin","onFocus");Pi("focusout","onBlur");Pi(TR,"onTransitionEnd");Nl("onMouseEnter",["mouseout","mouseover"]);Nl("onMouseLeave",["mouseout","mouseover"]);Nl("onPointerEnter",["pointerout","pointerover"]);Nl("onPointerLeave",["pointerout","pointerover"]);Ko("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ko("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ko("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ko("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ko("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ko("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_4=new Set("cancel close invalid load scroll toggle".split(" ").concat(Zu));function iS(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,g3(r,e,void 0,t),t.currentTarget=null}function kR(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;iS(s,a,c),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;iS(s,a,c),i=l}}}if(vp)throw t=H_,vp=!1,H_=null,t}function Ve(t,e){var n=e[n0];n===void 0&&(n=e[n0]=new Set);var r=t+"__bubble";n.has(r)||(RR(e,t,2,!1),n.add(r))}function Zg(t,e,n){var r=0;e&&(r|=4),RR(n,t,r,e)}var Gh="_reactListening"+Math.random().toString(36).slice(2);function Kc(t){if(!t[Gh]){t[Gh]=!0,$k.forEach(function(n){n!=="selectionchange"&&(_4.has(n)||Zg(n,!1,t),Zg(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Gh]||(e[Gh]=!0,Zg("selectionchange",!1,e))}}function RR(t,e,n,r){switch(fR(e)){case 1:var s=j3;break;case 4:s=O3;break;default:s=ww}n=s.bind(null,e,n,t),s=void 0,!q_||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function ev(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=eo(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}Zk(function(){var c=i,d=gw(n),h=[];e:{var f=IR.get(t);if(f!==void 0){var p=bw,y=t;switch(t){case"keypress":if(Pf(n)===0)break e;case"keydown":case"keyup":p=K3;break;case"focusin":y="focus",p=Gg;break;case"focusout":y="blur",p=Gg;break;case"beforeblur":case"afterblur":p=Gg;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Gb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=$3;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=X3;break;case SR:case CR:case AR:p=V3;break;case TR:p=e4;break;case"scroll":p=D3;break;case"wheel":p=n4;break;case"copy":case"cut":case"paste":p=B3;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Kb}var v=(e&4)!==0,_=!v&&t==="scroll",g=v?f!==null?f+"Capture":null:f;v=[];for(var m=c,w;m!==null;){w=m;var E=w.stateNode;if(w.tag===5&&E!==null&&(w=E,g!==null&&(E=zc(m,g),E!=null&&v.push(Yc(m,E,w)))),_)break;m=m.return}0<v.length&&(f=new p(f,y,null,n,d),h.push({event:f,listeners:v}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",f&&n!==z_&&(y=n.relatedTarget||n.fromElement)&&(eo(y)||y[_s]))break e;if((p||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,p?(y=n.relatedTarget||n.toElement,p=c,y=y?eo(y):null,y!==null&&(_=Yo(y),y!==_||y.tag!==5&&y.tag!==6)&&(y=null)):(p=null,y=c),p!==y)){if(v=Gb,E="onMouseLeave",g="onMouseEnter",m="mouse",(t==="pointerout"||t==="pointerover")&&(v=Kb,E="onPointerLeave",g="onPointerEnter",m="pointer"),_=p==null?f:Da(p),w=y==null?f:Da(y),f=new v(E,m+"leave",p,n,d),f.target=_,f.relatedTarget=w,E=null,eo(d)===c&&(v=new v(g,m+"enter",y,n,d),v.target=w,v.relatedTarget=_,E=v),_=E,p&&y)t:{for(v=p,g=y,m=0,w=v;w;w=ia(w))m++;for(w=0,E=g;E;E=ia(E))w++;for(;0<m-w;)v=ia(v),m--;for(;0<w-m;)g=ia(g),w--;for(;m--;){if(v===g||g!==null&&v===g.alternate)break t;v=ia(v),g=ia(g)}v=null}else v=null;p!==null&&oS(h,f,p,v,!1),y!==null&&_!==null&&oS(h,_,y,v,!0)}}e:{if(f=c?Da(c):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var T=u4;else if(Xb(f))if(_R)T=f4;else{T=d4;var C=c4}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(T=h4);if(T&&(T=T(t,c))){vR(h,T,n,d);break e}C&&C(t,f,c),t==="focusout"&&(C=f._wrapperState)&&C.controlled&&f.type==="number"&&M_(f,"number",f.value)}switch(C=c?Da(c):window,t){case"focusin":(Xb(C)||C.contentEditable==="true")&&(ja=C,Y_=c,vc=null);break;case"focusout":vc=Y_=ja=null;break;case"mousedown":J_=!0;break;case"contextmenu":case"mouseup":case"dragend":J_=!1,rS(h,n,d);break;case"selectionchange":if(m4)break;case"keydown":case"keyup":rS(h,n,d)}var I;if(Cw)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Na?mR(t,n)&&(k="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(yR&&n.locale!=="ko"&&(Na||k!=="onCompositionStart"?k==="onCompositionEnd"&&Na&&(I=pR()):(Ys=d,Ew="value"in Ys?Ys.value:Ys.textContent,Na=!0)),C=bp(c,k),0<C.length&&(k=new Qb(k,t,null,n,d),h.push({event:k,listeners:C}),I?k.data=I:(I=gR(n),I!==null&&(k.data=I)))),(I=s4?i4(t,n):o4(t,n))&&(c=bp(c,"onBeforeInput"),0<c.length&&(d=new Qb("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:c}),d.data=I))}kR(h,e)})}function Yc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function bp(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=zc(t,n),i!=null&&r.unshift(Yc(t,i,s)),i=zc(t,e),i!=null&&r.push(Yc(t,i,s))),t=t.return}return r}function ia(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function oS(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,s?(l=zc(n,i),l!=null&&o.unshift(Yc(n,l,a))):s||(l=zc(n,i),l!=null&&o.push(Yc(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var x4=/\r\n?/g,w4=/\u0000|\uFFFD/g;function aS(t){return(typeof t=="string"?t:""+t).replace(x4,`
`).replace(w4,"")}function Qh(t,e,n){if(e=aS(e),aS(t)!==e&&n)throw Error(M(425))}function Sp(){}var X_=null,Z_=null;function e0(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var t0=typeof setTimeout=="function"?setTimeout:void 0,E4=typeof clearTimeout=="function"?clearTimeout:void 0,lS=typeof Promise=="function"?Promise:void 0,b4=typeof queueMicrotask=="function"?queueMicrotask:typeof lS<"u"?function(t){return lS.resolve(null).then(t).catch(S4)}:t0;function S4(t){setTimeout(function(){throw t})}function tv(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Hc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Hc(e)}function ui(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function uS(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var pu=Math.random().toString(36).slice(2),$r="__reactFiber$"+pu,Jc="__reactProps$"+pu,_s="__reactContainer$"+pu,n0="__reactEvents$"+pu,C4="__reactListeners$"+pu,A4="__reactHandles$"+pu;function eo(t){var e=t[$r];if(e)return e;for(var n=t.parentNode;n;){if(e=n[_s]||n[$r]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=uS(t);t!==null;){if(n=t[$r])return n;t=uS(t)}return e}t=n,n=t.parentNode}return null}function Hd(t){return t=t[$r]||t[_s],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Da(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(M(33))}function _m(t){return t[Jc]||null}var r0=[],Fa=-1;function Ni(t){return{current:t}}function ze(t){0>Fa||(t.current=r0[Fa],r0[Fa]=null,Fa--)}function Le(t,e){Fa++,r0[Fa]=t.current,t.current=e}var Ei={},an=Ni(Ei),Tn=Ni(!1),Oo=Ei;function jl(t,e){var n=t.type.contextTypes;if(!n)return Ei;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function In(t){return t=t.childContextTypes,t!=null}function Cp(){ze(Tn),ze(an)}function cS(t,e,n){if(an.current!==Ei)throw Error(M(168));Le(an,e),Le(Tn,n)}function PR(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(M(108,c3(t)||"Unknown",s));return Xe({},n,r)}function Ap(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ei,Oo=an.current,Le(an,t),Le(Tn,Tn.current),!0}function dS(t,e,n){var r=t.stateNode;if(!r)throw Error(M(169));n?(t=PR(t,e,Oo),r.__reactInternalMemoizedMergedChildContext=t,ze(Tn),ze(an),Le(an,t)):ze(Tn),Le(Tn,n)}var us=null,xm=!1,nv=!1;function NR(t){us===null?us=[t]:us.push(t)}function T4(t){xm=!0,NR(t)}function ji(){if(!nv&&us!==null){nv=!0;var t=0,e=Ne;try{var n=us;for(Ne=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}us=null,xm=!1}catch(s){throw us!==null&&(us=us.slice(t+1)),rR(vw,ji),s}finally{Ne=e,nv=!1}}return null}var $a=[],Ma=0,Tp=null,Ip=0,Kn=[],Yn=0,Do=null,ds=1,hs="";function Bi(t,e){$a[Ma++]=Ip,$a[Ma++]=Tp,Tp=t,Ip=e}function jR(t,e,n){Kn[Yn++]=ds,Kn[Yn++]=hs,Kn[Yn++]=Do,Do=t;var r=ds;t=hs;var s=32-wr(r)-1;r&=~(1<<s),n+=1;var i=32-wr(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,ds=1<<32-wr(e)+s|n<<s|r,hs=i+t}else ds=1<<i|n<<s|r,hs=t}function Tw(t){t.return!==null&&(Bi(t,1),jR(t,1,0))}function Iw(t){for(;t===Tp;)Tp=$a[--Ma],$a[Ma]=null,Ip=$a[--Ma],$a[Ma]=null;for(;t===Do;)Do=Kn[--Yn],Kn[Yn]=null,hs=Kn[--Yn],Kn[Yn]=null,ds=Kn[--Yn],Kn[Yn]=null}var Fn=null,On=null,qe=!1,pr=null;function OR(t,e){var n=Zn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function hS(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Fn=t,On=ui(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Fn=t,On=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Do!==null?{id:ds,overflow:hs}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Zn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Fn=t,On=null,!0):!1;default:return!1}}function s0(t){return(t.mode&1)!==0&&(t.flags&128)===0}function i0(t){if(qe){var e=On;if(e){var n=e;if(!hS(t,e)){if(s0(t))throw Error(M(418));e=ui(n.nextSibling);var r=Fn;e&&hS(t,e)?OR(r,n):(t.flags=t.flags&-4097|2,qe=!1,Fn=t)}}else{if(s0(t))throw Error(M(418));t.flags=t.flags&-4097|2,qe=!1,Fn=t}}}function fS(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Fn=t}function Kh(t){if(t!==Fn)return!1;if(!qe)return fS(t),qe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!e0(t.type,t.memoizedProps)),e&&(e=On)){if(s0(t))throw DR(),Error(M(418));for(;e;)OR(t,e),e=ui(e.nextSibling)}if(fS(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(M(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){On=ui(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}On=null}}else On=Fn?ui(t.stateNode.nextSibling):null;return!0}function DR(){for(var t=On;t;)t=ui(t.nextSibling)}function Ol(){On=Fn=null,qe=!1}function kw(t){pr===null?pr=[t]:pr.push(t)}var I4=As.ReactCurrentBatchConfig;function cr(t,e){if(t&&t.defaultProps){e=Xe({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var kp=Ni(null),Rp=null,La=null,Rw=null;function Pw(){Rw=La=Rp=null}function Nw(t){var e=kp.current;ze(kp),t._currentValue=e}function o0(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function el(t,e){Rp=t,Rw=La=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Cn=!0),t.firstContext=null)}function sr(t){var e=t._currentValue;if(Rw!==t)if(t={context:t,memoizedValue:e,next:null},La===null){if(Rp===null)throw Error(M(308));La=t,Rp.dependencies={lanes:0,firstContext:t}}else La=La.next=t;return e}var to=null;function jw(t){to===null?to=[t]:to.push(t)}function FR(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,jw(e)):(n.next=s.next,s.next=n),e.interleaved=n,xs(t,r)}function xs(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Fs=!1;function Ow(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function $R(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ms(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ci(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ie&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,xs(t,n)}return s=r.interleaved,s===null?(e.next=e,jw(r)):(e.next=s.next,s.next=e),r.interleaved=e,xs(t,n)}function Nf(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,_w(t,n)}}function pS(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Pp(t,e,n,r){var s=t.updateQueue;Fs=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?i=c:o.next=c,o=l;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=l))}if(i!==null){var h=s.baseState;o=0,d=c=l=null,a=i;do{var f=a.lane,p=a.eventTime;if((r&f)===f){d!==null&&(d=d.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var y=t,v=a;switch(f=e,p=n,v.tag){case 1:if(y=v.payload,typeof y=="function"){h=y.call(p,h,f);break e}h=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=v.payload,f=typeof y=="function"?y.call(p,h,f):y,f==null)break e;h=Xe({},h,f);break e;case 2:Fs=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[a]:f.push(a))}else p={eventTime:p,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(c=d=p,l=h):d=d.next=p,o|=f;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;f=a,a=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(1);if(d===null&&(l=h),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);$o|=o,t.lanes=o,t.memoizedState=h}}function yS(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(M(191,s));s.call(r)}}}var MR=new Fk.Component().refs;function a0(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Xe({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var wm={isMounted:function(t){return(t=t._reactInternals)?Yo(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=gn(),s=hi(t),i=ms(r,s);i.payload=e,n!=null&&(i.callback=n),e=ci(t,i,s),e!==null&&(Er(e,t,s,r),Nf(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=gn(),s=hi(t),i=ms(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=ci(t,i,s),e!==null&&(Er(e,t,s,r),Nf(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=gn(),r=hi(t),s=ms(n,r);s.tag=2,e!=null&&(s.callback=e),e=ci(t,s,r),e!==null&&(Er(e,t,r,n),Nf(e,t,r))}};function mS(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Qc(n,r)||!Qc(s,i):!0}function LR(t,e,n){var r=!1,s=Ei,i=e.contextType;return typeof i=="object"&&i!==null?i=sr(i):(s=In(e)?Oo:an.current,r=e.contextTypes,i=(r=r!=null)?jl(t,s):Ei),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=wm,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function gS(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&wm.enqueueReplaceState(e,e.state,null)}function l0(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs=MR,Ow(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=sr(i):(i=In(e)?Oo:an.current,s.context=jl(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(a0(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&wm.enqueueReplaceState(s,s.state,null),Pp(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Du(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(M(309));var r=n.stateNode}if(!r)throw Error(M(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;a===MR&&(a=s.refs={}),o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(M(284));if(!n._owner)throw Error(M(290,t))}return t}function Yh(t,e){throw t=Object.prototype.toString.call(e),Error(M(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function vS(t){var e=t._init;return e(t._payload)}function VR(t){function e(g,m){if(t){var w=g.deletions;w===null?(g.deletions=[m],g.flags|=16):w.push(m)}}function n(g,m){if(!t)return null;for(;m!==null;)e(g,m),m=m.sibling;return null}function r(g,m){for(g=new Map;m!==null;)m.key!==null?g.set(m.key,m):g.set(m.index,m),m=m.sibling;return g}function s(g,m){return g=fi(g,m),g.index=0,g.sibling=null,g}function i(g,m,w){return g.index=w,t?(w=g.alternate,w!==null?(w=w.index,w<m?(g.flags|=2,m):w):(g.flags|=2,m)):(g.flags|=1048576,m)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function a(g,m,w,E){return m===null||m.tag!==6?(m=uv(w,g.mode,E),m.return=g,m):(m=s(m,w),m.return=g,m)}function l(g,m,w,E){var T=w.type;return T===Pa?d(g,m,w.props.children,E,w.key):m!==null&&(m.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Ds&&vS(T)===m.type)?(E=s(m,w.props),E.ref=Du(g,m,w),E.return=g,E):(E=Mf(w.type,w.key,w.props,null,g.mode,E),E.ref=Du(g,m,w),E.return=g,E)}function c(g,m,w,E){return m===null||m.tag!==4||m.stateNode.containerInfo!==w.containerInfo||m.stateNode.implementation!==w.implementation?(m=cv(w,g.mode,E),m.return=g,m):(m=s(m,w.children||[]),m.return=g,m)}function d(g,m,w,E,T){return m===null||m.tag!==7?(m=_o(w,g.mode,E,T),m.return=g,m):(m=s(m,w),m.return=g,m)}function h(g,m,w){if(typeof m=="string"&&m!==""||typeof m=="number")return m=uv(""+m,g.mode,w),m.return=g,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Lh:return w=Mf(m.type,m.key,m.props,null,g.mode,w),w.ref=Du(g,null,m),w.return=g,w;case Ra:return m=cv(m,g.mode,w),m.return=g,m;case Ds:var E=m._init;return h(g,E(m._payload),w)}if(Ju(m)||Ru(m))return m=_o(m,g.mode,w,null),m.return=g,m;Yh(g,m)}return null}function f(g,m,w,E){var T=m!==null?m.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return T!==null?null:a(g,m,""+w,E);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Lh:return w.key===T?l(g,m,w,E):null;case Ra:return w.key===T?c(g,m,w,E):null;case Ds:return T=w._init,f(g,m,T(w._payload),E)}if(Ju(w)||Ru(w))return T!==null?null:d(g,m,w,E,null);Yh(g,w)}return null}function p(g,m,w,E,T){if(typeof E=="string"&&E!==""||typeof E=="number")return g=g.get(w)||null,a(m,g,""+E,T);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Lh:return g=g.get(E.key===null?w:E.key)||null,l(m,g,E,T);case Ra:return g=g.get(E.key===null?w:E.key)||null,c(m,g,E,T);case Ds:var C=E._init;return p(g,m,w,C(E._payload),T)}if(Ju(E)||Ru(E))return g=g.get(w)||null,d(m,g,E,T,null);Yh(m,E)}return null}function y(g,m,w,E){for(var T=null,C=null,I=m,k=m=0,O=null;I!==null&&k<w.length;k++){I.index>k?(O=I,I=null):O=I.sibling;var L=f(g,I,w[k],E);if(L===null){I===null&&(I=O);break}t&&I&&L.alternate===null&&e(g,I),m=i(L,m,k),C===null?T=L:C.sibling=L,C=L,I=O}if(k===w.length)return n(g,I),qe&&Bi(g,k),T;if(I===null){for(;k<w.length;k++)I=h(g,w[k],E),I!==null&&(m=i(I,m,k),C===null?T=I:C.sibling=I,C=I);return qe&&Bi(g,k),T}for(I=r(g,I);k<w.length;k++)O=p(I,g,k,w[k],E),O!==null&&(t&&O.alternate!==null&&I.delete(O.key===null?k:O.key),m=i(O,m,k),C===null?T=O:C.sibling=O,C=O);return t&&I.forEach(function(j){return e(g,j)}),qe&&Bi(g,k),T}function v(g,m,w,E){var T=Ru(w);if(typeof T!="function")throw Error(M(150));if(w=T.call(w),w==null)throw Error(M(151));for(var C=T=null,I=m,k=m=0,O=null,L=w.next();I!==null&&!L.done;k++,L=w.next()){I.index>k?(O=I,I=null):O=I.sibling;var j=f(g,I,L.value,E);if(j===null){I===null&&(I=O);break}t&&I&&j.alternate===null&&e(g,I),m=i(j,m,k),C===null?T=j:C.sibling=j,C=j,I=O}if(L.done)return n(g,I),qe&&Bi(g,k),T;if(I===null){for(;!L.done;k++,L=w.next())L=h(g,L.value,E),L!==null&&(m=i(L,m,k),C===null?T=L:C.sibling=L,C=L);return qe&&Bi(g,k),T}for(I=r(g,I);!L.done;k++,L=w.next())L=p(I,g,k,L.value,E),L!==null&&(t&&L.alternate!==null&&I.delete(L.key===null?k:L.key),m=i(L,m,k),C===null?T=L:C.sibling=L,C=L);return t&&I.forEach(function(P){return e(g,P)}),qe&&Bi(g,k),T}function _(g,m,w,E){if(typeof w=="object"&&w!==null&&w.type===Pa&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Lh:e:{for(var T=w.key,C=m;C!==null;){if(C.key===T){if(T=w.type,T===Pa){if(C.tag===7){n(g,C.sibling),m=s(C,w.props.children),m.return=g,g=m;break e}}else if(C.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Ds&&vS(T)===C.type){n(g,C.sibling),m=s(C,w.props),m.ref=Du(g,C,w),m.return=g,g=m;break e}n(g,C);break}else e(g,C);C=C.sibling}w.type===Pa?(m=_o(w.props.children,g.mode,E,w.key),m.return=g,g=m):(E=Mf(w.type,w.key,w.props,null,g.mode,E),E.ref=Du(g,m,w),E.return=g,g=E)}return o(g);case Ra:e:{for(C=w.key;m!==null;){if(m.key===C)if(m.tag===4&&m.stateNode.containerInfo===w.containerInfo&&m.stateNode.implementation===w.implementation){n(g,m.sibling),m=s(m,w.children||[]),m.return=g,g=m;break e}else{n(g,m);break}else e(g,m);m=m.sibling}m=cv(w,g.mode,E),m.return=g,g=m}return o(g);case Ds:return C=w._init,_(g,m,C(w._payload),E)}if(Ju(w))return y(g,m,w,E);if(Ru(w))return v(g,m,w,E);Yh(g,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,m!==null&&m.tag===6?(n(g,m.sibling),m=s(m,w),m.return=g,g=m):(n(g,m),m=uv(w,g.mode,E),m.return=g,g=m),o(g)):n(g,m)}return _}var Dl=VR(!0),UR=VR(!1),Gd={},Gr=Ni(Gd),Xc=Ni(Gd),Zc=Ni(Gd);function no(t){if(t===Gd)throw Error(M(174));return t}function Dw(t,e){switch(Le(Zc,e),Le(Xc,t),Le(Gr,Gd),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:V_(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=V_(e,t)}ze(Gr),Le(Gr,e)}function Fl(){ze(Gr),ze(Xc),ze(Zc)}function BR(t){no(Zc.current);var e=no(Gr.current),n=V_(e,t.type);e!==n&&(Le(Xc,t),Le(Gr,n))}function Fw(t){Xc.current===t&&(ze(Gr),ze(Xc))}var Ke=Ni(0);function Np(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var rv=[];function $w(){for(var t=0;t<rv.length;t++)rv[t]._workInProgressVersionPrimary=null;rv.length=0}var jf=As.ReactCurrentDispatcher,sv=As.ReactCurrentBatchConfig,Fo=0,Je=null,gt=null,jt=null,jp=!1,_c=!1,ed=0,k4=0;function Yt(){throw Error(M(321))}function Mw(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Cr(t[n],e[n]))return!1;return!0}function Lw(t,e,n,r,s,i){if(Fo=i,Je=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,jf.current=t===null||t.memoizedState===null?j4:O4,t=n(r,s),_c){i=0;do{if(_c=!1,ed=0,25<=i)throw Error(M(301));i+=1,jt=gt=null,e.updateQueue=null,jf.current=D4,t=n(r,s)}while(_c)}if(jf.current=Op,e=gt!==null&&gt.next!==null,Fo=0,jt=gt=Je=null,jp=!1,e)throw Error(M(300));return t}function Vw(){var t=ed!==0;return ed=0,t}function Pr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jt===null?Je.memoizedState=jt=t:jt=jt.next=t,jt}function ir(){if(gt===null){var t=Je.alternate;t=t!==null?t.memoizedState:null}else t=gt.next;var e=jt===null?Je.memoizedState:jt.next;if(e!==null)jt=e,gt=t;else{if(t===null)throw Error(M(310));gt=t,t={memoizedState:gt.memoizedState,baseState:gt.baseState,baseQueue:gt.baseQueue,queue:gt.queue,next:null},jt===null?Je.memoizedState=jt=t:jt=jt.next=t}return jt}function td(t,e){return typeof e=="function"?e(t):e}function iv(t){var e=ir(),n=e.queue;if(n===null)throw Error(M(311));n.lastRenderedReducer=t;var r=gt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,c=i;do{var d=c.lane;if((Fo&d)===d)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=h,o=r):l=l.next=h,Je.lanes|=d,$o|=d}c=c.next}while(c!==null&&c!==i);l===null?o=r:l.next=a,Cr(r,e.memoizedState)||(Cn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Je.lanes|=i,$o|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ov(t){var e=ir(),n=e.queue;if(n===null)throw Error(M(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Cr(i,e.memoizedState)||(Cn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function zR(){}function WR(t,e){var n=Je,r=ir(),s=e(),i=!Cr(r.memoizedState,s);if(i&&(r.memoizedState=s,Cn=!0),r=r.queue,Uw(GR.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||jt!==null&&jt.memoizedState.tag&1){if(n.flags|=2048,nd(9,HR.bind(null,n,r,s,e),void 0,null),Ot===null)throw Error(M(349));Fo&30||qR(n,e,s)}return s}function qR(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Je.updateQueue,e===null?(e={lastEffect:null,stores:null},Je.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function HR(t,e,n,r){e.value=n,e.getSnapshot=r,QR(e)&&KR(t)}function GR(t,e,n){return n(function(){QR(e)&&KR(t)})}function QR(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Cr(t,n)}catch{return!0}}function KR(t){var e=xs(t,1);e!==null&&Er(e,t,1,-1)}function _S(t){var e=Pr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:td,lastRenderedState:t},e.queue=t,t=t.dispatch=N4.bind(null,Je,t),[e.memoizedState,t]}function nd(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Je.updateQueue,e===null?(e={lastEffect:null,stores:null},Je.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function YR(){return ir().memoizedState}function Of(t,e,n,r){var s=Pr();Je.flags|=t,s.memoizedState=nd(1|e,n,void 0,r===void 0?null:r)}function Em(t,e,n,r){var s=ir();r=r===void 0?null:r;var i=void 0;if(gt!==null){var o=gt.memoizedState;if(i=o.destroy,r!==null&&Mw(r,o.deps)){s.memoizedState=nd(e,n,i,r);return}}Je.flags|=t,s.memoizedState=nd(1|e,n,i,r)}function xS(t,e){return Of(8390656,8,t,e)}function Uw(t,e){return Em(2048,8,t,e)}function JR(t,e){return Em(4,2,t,e)}function XR(t,e){return Em(4,4,t,e)}function ZR(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function eP(t,e,n){return n=n!=null?n.concat([t]):null,Em(4,4,ZR.bind(null,e,t),n)}function Bw(){}function tP(t,e){var n=ir();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Mw(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function nP(t,e){var n=ir();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Mw(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function rP(t,e,n){return Fo&21?(Cr(n,e)||(n=oR(),Je.lanes|=n,$o|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Cn=!0),t.memoizedState=n)}function R4(t,e){var n=Ne;Ne=n!==0&&4>n?n:4,t(!0);var r=sv.transition;sv.transition={};try{t(!1),e()}finally{Ne=n,sv.transition=r}}function sP(){return ir().memoizedState}function P4(t,e,n){var r=hi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},iP(t))oP(e,n);else if(n=FR(t,e,n,r),n!==null){var s=gn();Er(n,t,r,s),aP(n,e,r)}}function N4(t,e,n){var r=hi(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(iP(t))oP(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,Cr(a,o)){var l=e.interleaved;l===null?(s.next=s,jw(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=FR(t,e,s,r),n!==null&&(s=gn(),Er(n,t,r,s),aP(n,e,r))}}function iP(t){var e=t.alternate;return t===Je||e!==null&&e===Je}function oP(t,e){_c=jp=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function aP(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,_w(t,n)}}var Op={readContext:sr,useCallback:Yt,useContext:Yt,useEffect:Yt,useImperativeHandle:Yt,useInsertionEffect:Yt,useLayoutEffect:Yt,useMemo:Yt,useReducer:Yt,useRef:Yt,useState:Yt,useDebugValue:Yt,useDeferredValue:Yt,useTransition:Yt,useMutableSource:Yt,useSyncExternalStore:Yt,useId:Yt,unstable_isNewReconciler:!1},j4={readContext:sr,useCallback:function(t,e){return Pr().memoizedState=[t,e===void 0?null:e],t},useContext:sr,useEffect:xS,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Of(4194308,4,ZR.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Of(4194308,4,t,e)},useInsertionEffect:function(t,e){return Of(4,2,t,e)},useMemo:function(t,e){var n=Pr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Pr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=P4.bind(null,Je,t),[r.memoizedState,t]},useRef:function(t){var e=Pr();return t={current:t},e.memoizedState=t},useState:_S,useDebugValue:Bw,useDeferredValue:function(t){return Pr().memoizedState=t},useTransition:function(){var t=_S(!1),e=t[0];return t=R4.bind(null,t[1]),Pr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Je,s=Pr();if(qe){if(n===void 0)throw Error(M(407));n=n()}else{if(n=e(),Ot===null)throw Error(M(349));Fo&30||qR(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,xS(GR.bind(null,r,i,t),[t]),r.flags|=2048,nd(9,HR.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Pr(),e=Ot.identifierPrefix;if(qe){var n=hs,r=ds;n=(r&~(1<<32-wr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=ed++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=k4++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},O4={readContext:sr,useCallback:tP,useContext:sr,useEffect:Uw,useImperativeHandle:eP,useInsertionEffect:JR,useLayoutEffect:XR,useMemo:nP,useReducer:iv,useRef:YR,useState:function(){return iv(td)},useDebugValue:Bw,useDeferredValue:function(t){var e=ir();return rP(e,gt.memoizedState,t)},useTransition:function(){var t=iv(td)[0],e=ir().memoizedState;return[t,e]},useMutableSource:zR,useSyncExternalStore:WR,useId:sP,unstable_isNewReconciler:!1},D4={readContext:sr,useCallback:tP,useContext:sr,useEffect:Uw,useImperativeHandle:eP,useInsertionEffect:JR,useLayoutEffect:XR,useMemo:nP,useReducer:ov,useRef:YR,useState:function(){return ov(td)},useDebugValue:Bw,useDeferredValue:function(t){var e=ir();return gt===null?e.memoizedState=t:rP(e,gt.memoizedState,t)},useTransition:function(){var t=ov(td)[0],e=ir().memoizedState;return[t,e]},useMutableSource:zR,useSyncExternalStore:WR,useId:sP,unstable_isNewReconciler:!1};function $l(t,e){try{var n="",r=e;do n+=u3(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function av(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function u0(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var F4=typeof WeakMap=="function"?WeakMap:Map;function lP(t,e,n){n=ms(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Fp||(Fp=!0,_0=r),u0(t,e)},n}function uP(t,e,n){n=ms(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){u0(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){u0(t,e),typeof r!="function"&&(di===null?di=new Set([this]):di.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function wS(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new F4;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=Y4.bind(null,t,e,n),e.then(t,t))}function ES(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function bS(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ms(-1,1),e.tag=2,ci(n,e,1))),n.lanes|=1),t)}var $4=As.ReactCurrentOwner,Cn=!1;function hn(t,e,n,r){e.child=t===null?UR(e,null,n,r):Dl(e,t.child,n,r)}function SS(t,e,n,r,s){n=n.render;var i=e.ref;return el(e,s),r=Lw(t,e,n,r,i,s),n=Vw(),t!==null&&!Cn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ws(t,e,s)):(qe&&n&&Tw(e),e.flags|=1,hn(t,e,r,s),e.child)}function CS(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Yw(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,cP(t,e,i,r,s)):(t=Mf(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Qc,n(o,r)&&t.ref===e.ref)return ws(t,e,s)}return e.flags|=1,t=fi(i,r),t.ref=e.ref,t.return=e,e.child=t}function cP(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Qc(i,r)&&t.ref===e.ref)if(Cn=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Cn=!0);else return e.lanes=t.lanes,ws(t,e,s)}return c0(t,e,n,r,s)}function dP(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Le(Ua,Nn),Nn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Le(Ua,Nn),Nn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Le(Ua,Nn),Nn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Le(Ua,Nn),Nn|=r;return hn(t,e,s,n),e.child}function hP(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function c0(t,e,n,r,s){var i=In(n)?Oo:an.current;return i=jl(e,i),el(e,s),n=Lw(t,e,n,r,i,s),r=Vw(),t!==null&&!Cn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ws(t,e,s)):(qe&&r&&Tw(e),e.flags|=1,hn(t,e,n,s),e.child)}function AS(t,e,n,r,s){if(In(n)){var i=!0;Ap(e)}else i=!1;if(el(e,s),e.stateNode===null)Df(t,e),LR(e,n,r),l0(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=sr(c):(c=In(n)?Oo:an.current,c=jl(e,c));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&gS(e,o,r,c),Fs=!1;var f=e.memoizedState;o.state=f,Pp(e,r,o,s),l=e.memoizedState,a!==r||f!==l||Tn.current||Fs?(typeof d=="function"&&(a0(e,n,d,r),l=e.memoizedState),(a=Fs||mS(e,n,a,r,f,l,c))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,$R(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:cr(e.type,a),o.props=c,h=e.pendingProps,f=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=sr(l):(l=In(n)?Oo:an.current,l=jl(e,l));var p=n.getDerivedStateFromProps;(d=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||f!==l)&&gS(e,o,r,l),Fs=!1,f=e.memoizedState,o.state=f,Pp(e,r,o,s);var y=e.memoizedState;a!==h||f!==y||Tn.current||Fs?(typeof p=="function"&&(a0(e,n,p,r),y=e.memoizedState),(c=Fs||mS(e,n,c,r,f,y,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,y,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,y,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=y),o.props=r,o.state=y,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return d0(t,e,n,r,i,s)}function d0(t,e,n,r,s,i){hP(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&dS(e,n,!1),ws(t,e,i);r=e.stateNode,$4.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Dl(e,t.child,null,i),e.child=Dl(e,null,a,i)):hn(t,e,a,i),e.memoizedState=r.state,s&&dS(e,n,!0),e.child}function fP(t){var e=t.stateNode;e.pendingContext?cS(t,e.pendingContext,e.pendingContext!==e.context):e.context&&cS(t,e.context,!1),Dw(t,e.containerInfo)}function TS(t,e,n,r,s){return Ol(),kw(s),e.flags|=256,hn(t,e,n,r),e.child}var h0={dehydrated:null,treeContext:null,retryLane:0};function f0(t){return{baseLanes:t,cachePool:null,transitions:null}}function pP(t,e,n){var r=e.pendingProps,s=Ke.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Le(Ke,s&1),t===null)return i0(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Cm(o,r,0,null),t=_o(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=f0(n),e.memoizedState=h0,t):zw(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return M4(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=fi(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=fi(a,i):(i=_o(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?f0(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=h0,r}return i=t.child,t=i.sibling,r=fi(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function zw(t,e){return e=Cm({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Jh(t,e,n,r){return r!==null&&kw(r),Dl(e,t.child,null,n),t=zw(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function M4(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=av(Error(M(422))),Jh(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Cm({mode:"visible",children:r.children},s,0,null),i=_o(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Dl(e,t.child,null,o),e.child.memoizedState=f0(o),e.memoizedState=h0,i);if(!(e.mode&1))return Jh(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(M(419)),r=av(i,r,void 0),Jh(t,e,o,r)}if(a=(o&t.childLanes)!==0,Cn||a){if(r=Ot,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,xs(t,s),Er(r,t,s,-1))}return Kw(),r=av(Error(M(421))),Jh(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=J4.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,On=ui(s.nextSibling),Fn=e,qe=!0,pr=null,t!==null&&(Kn[Yn++]=ds,Kn[Yn++]=hs,Kn[Yn++]=Do,ds=t.id,hs=t.overflow,Do=e),e=zw(e,r.children),e.flags|=4096,e)}function IS(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),o0(t.return,e,n)}function lv(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function yP(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(hn(t,e,r.children,n),r=Ke.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&IS(t,n,e);else if(t.tag===19)IS(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Le(Ke,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Np(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),lv(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Np(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}lv(e,!0,n,null,i);break;case"together":lv(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Df(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ws(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),$o|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(M(153));if(e.child!==null){for(t=e.child,n=fi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=fi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function L4(t,e,n){switch(e.tag){case 3:fP(e),Ol();break;case 5:BR(e);break;case 1:In(e.type)&&Ap(e);break;case 4:Dw(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Le(kp,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Le(Ke,Ke.current&1),e.flags|=128,null):n&e.child.childLanes?pP(t,e,n):(Le(Ke,Ke.current&1),t=ws(t,e,n),t!==null?t.sibling:null);Le(Ke,Ke.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return yP(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Le(Ke,Ke.current),r)break;return null;case 22:case 23:return e.lanes=0,dP(t,e,n)}return ws(t,e,n)}var mP,p0,gP,vP;mP=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};p0=function(){};gP=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,no(Gr.current);var i=null;switch(n){case"input":s=F_(t,s),r=F_(t,r),i=[];break;case"select":s=Xe({},s,{value:void 0}),r=Xe({},r,{value:void 0}),i=[];break;case"textarea":s=L_(t,s),r=L_(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Sp)}U_(n,r);var o;n=null;for(c in s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var a=s[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Uc.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var l=r[c];if(a=s!=null?s[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Uc.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Ve("scroll",t),i||a===l||(i=[])):(i=i||[]).push(c,l))}n&&(i=i||[]).push("style",n);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};vP=function(t,e,n,r){n!==r&&(e.flags|=4)};function Fu(t,e){if(!qe)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Jt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function V4(t,e,n){var r=e.pendingProps;switch(Iw(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jt(e),null;case 1:return In(e.type)&&Cp(),Jt(e),null;case 3:return r=e.stateNode,Fl(),ze(Tn),ze(an),$w(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Kh(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,pr!==null&&(E0(pr),pr=null))),p0(t,e),Jt(e),null;case 5:Fw(e);var s=no(Zc.current);if(n=e.type,t!==null&&e.stateNode!=null)gP(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(M(166));return Jt(e),null}if(t=no(Gr.current),Kh(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[$r]=e,r[Jc]=i,t=(e.mode&1)!==0,n){case"dialog":Ve("cancel",r),Ve("close",r);break;case"iframe":case"object":case"embed":Ve("load",r);break;case"video":case"audio":for(s=0;s<Zu.length;s++)Ve(Zu[s],r);break;case"source":Ve("error",r);break;case"img":case"image":case"link":Ve("error",r),Ve("load",r);break;case"details":Ve("toggle",r);break;case"input":$b(r,i),Ve("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ve("invalid",r);break;case"textarea":Lb(r,i),Ve("invalid",r)}U_(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&Qh(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Qh(r.textContent,a,t),s=["children",""+a]):Uc.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ve("scroll",r)}switch(n){case"input":Vh(r),Mb(r,i,!0);break;case"textarea":Vh(r),Vb(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Sp)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=qk(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[$r]=e,t[Jc]=r,mP(t,e,!1,!1),e.stateNode=t;e:{switch(o=B_(n,r),n){case"dialog":Ve("cancel",t),Ve("close",t),s=r;break;case"iframe":case"object":case"embed":Ve("load",t),s=r;break;case"video":case"audio":for(s=0;s<Zu.length;s++)Ve(Zu[s],t);s=r;break;case"source":Ve("error",t),s=r;break;case"img":case"image":case"link":Ve("error",t),Ve("load",t),s=r;break;case"details":Ve("toggle",t),s=r;break;case"input":$b(t,r),s=F_(t,r),Ve("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Xe({},r,{value:void 0}),Ve("invalid",t);break;case"textarea":Lb(t,r),s=L_(t,r),Ve("invalid",t);break;default:s=r}U_(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?Qk(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Hk(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Bc(t,l):typeof l=="number"&&Bc(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Uc.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Ve("scroll",t):l!=null&&fw(t,i,l,o))}switch(n){case"input":Vh(t),Mb(t,r,!1);break;case"textarea":Vh(t),Vb(t);break;case"option":r.value!=null&&t.setAttribute("value",""+wi(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Ya(t,!!r.multiple,i,!1):r.defaultValue!=null&&Ya(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Sp)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Jt(e),null;case 6:if(t&&e.stateNode!=null)vP(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(M(166));if(n=no(Zc.current),no(Gr.current),Kh(e)){if(r=e.stateNode,n=e.memoizedProps,r[$r]=e,(i=r.nodeValue!==n)&&(t=Fn,t!==null))switch(t.tag){case 3:Qh(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Qh(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[$r]=e,e.stateNode=r}return Jt(e),null;case 13:if(ze(Ke),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(qe&&On!==null&&e.mode&1&&!(e.flags&128))DR(),Ol(),e.flags|=98560,i=!1;else if(i=Kh(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(M(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(M(317));i[$r]=e}else Ol(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Jt(e),i=!1}else pr!==null&&(E0(pr),pr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ke.current&1?wt===0&&(wt=3):Kw())),e.updateQueue!==null&&(e.flags|=4),Jt(e),null);case 4:return Fl(),p0(t,e),t===null&&Kc(e.stateNode.containerInfo),Jt(e),null;case 10:return Nw(e.type._context),Jt(e),null;case 17:return In(e.type)&&Cp(),Jt(e),null;case 19:if(ze(Ke),i=e.memoizedState,i===null)return Jt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Fu(i,!1);else{if(wt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Np(t),o!==null){for(e.flags|=128,Fu(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Le(Ke,Ke.current&1|2),e.child}t=t.sibling}i.tail!==null&&lt()>Ml&&(e.flags|=128,r=!0,Fu(i,!1),e.lanes=4194304)}else{if(!r)if(t=Np(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Fu(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!qe)return Jt(e),null}else 2*lt()-i.renderingStartTime>Ml&&n!==1073741824&&(e.flags|=128,r=!0,Fu(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=lt(),e.sibling=null,n=Ke.current,Le(Ke,r?n&1|2:n&1),e):(Jt(e),null);case 22:case 23:return Qw(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Nn&1073741824&&(Jt(e),e.subtreeFlags&6&&(e.flags|=8192)):Jt(e),null;case 24:return null;case 25:return null}throw Error(M(156,e.tag))}function U4(t,e){switch(Iw(e),e.tag){case 1:return In(e.type)&&Cp(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Fl(),ze(Tn),ze(an),$w(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Fw(e),null;case 13:if(ze(Ke),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(M(340));Ol()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ze(Ke),null;case 4:return Fl(),null;case 10:return Nw(e.type._context),null;case 22:case 23:return Qw(),null;case 24:return null;default:return null}}var Xh=!1,nn=!1,B4=typeof WeakSet=="function"?WeakSet:Set,Y=null;function Va(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){et(t,e,r)}else n.current=null}function y0(t,e,n){try{n()}catch(r){et(t,e,r)}}var kS=!1;function z4(t,e){if(X_=wp,t=ER(),Aw(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,d=0,h=t,f=null;t:for(;;){for(var p;h!==n||s!==0&&h.nodeType!==3||(a=o+s),h!==i||r!==0&&h.nodeType!==3||(l=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===t)break t;if(f===n&&++c===s&&(a=o),f===i&&++d===r&&(l=o),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Z_={focusedElem:t,selectionRange:n},wp=!1,Y=e;Y!==null;)if(e=Y,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Y=t;else for(;Y!==null;){e=Y;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var v=y.memoizedProps,_=y.memoizedState,g=e.stateNode,m=g.getSnapshotBeforeUpdate(e.elementType===e.type?v:cr(e.type,v),_);g.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(M(163))}}catch(E){et(e,e.return,E)}if(t=e.sibling,t!==null){t.return=e.return,Y=t;break}Y=e.return}return y=kS,kS=!1,y}function xc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&y0(e,n,i)}s=s.next}while(s!==r)}}function bm(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function m0(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function _P(t){var e=t.alternate;e!==null&&(t.alternate=null,_P(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[$r],delete e[Jc],delete e[n0],delete e[C4],delete e[A4])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function xP(t){return t.tag===5||t.tag===3||t.tag===4}function RS(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||xP(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function g0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Sp));else if(r!==4&&(t=t.child,t!==null))for(g0(t,e,n),t=t.sibling;t!==null;)g0(t,e,n),t=t.sibling}function v0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(v0(t,e,n),t=t.sibling;t!==null;)v0(t,e,n),t=t.sibling}var Mt=null,fr=!1;function Ps(t,e,n){for(n=n.child;n!==null;)wP(t,e,n),n=n.sibling}function wP(t,e,n){if(Hr&&typeof Hr.onCommitFiberUnmount=="function")try{Hr.onCommitFiberUnmount(ym,n)}catch{}switch(n.tag){case 5:nn||Va(n,e);case 6:var r=Mt,s=fr;Mt=null,Ps(t,e,n),Mt=r,fr=s,Mt!==null&&(fr?(t=Mt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Mt.removeChild(n.stateNode));break;case 18:Mt!==null&&(fr?(t=Mt,n=n.stateNode,t.nodeType===8?tv(t.parentNode,n):t.nodeType===1&&tv(t,n),Hc(t)):tv(Mt,n.stateNode));break;case 4:r=Mt,s=fr,Mt=n.stateNode.containerInfo,fr=!0,Ps(t,e,n),Mt=r,fr=s;break;case 0:case 11:case 14:case 15:if(!nn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&y0(n,e,o),s=s.next}while(s!==r)}Ps(t,e,n);break;case 1:if(!nn&&(Va(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){et(n,e,a)}Ps(t,e,n);break;case 21:Ps(t,e,n);break;case 22:n.mode&1?(nn=(r=nn)||n.memoizedState!==null,Ps(t,e,n),nn=r):Ps(t,e,n);break;default:Ps(t,e,n)}}function PS(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new B4),e.forEach(function(r){var s=X4.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function lr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Mt=a.stateNode,fr=!1;break e;case 3:Mt=a.stateNode.containerInfo,fr=!0;break e;case 4:Mt=a.stateNode.containerInfo,fr=!0;break e}a=a.return}if(Mt===null)throw Error(M(160));wP(i,o,s),Mt=null,fr=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){et(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)EP(e,t),e=e.sibling}function EP(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(lr(e,t),Rr(t),r&4){try{xc(3,t,t.return),bm(3,t)}catch(v){et(t,t.return,v)}try{xc(5,t,t.return)}catch(v){et(t,t.return,v)}}break;case 1:lr(e,t),Rr(t),r&512&&n!==null&&Va(n,n.return);break;case 5:if(lr(e,t),Rr(t),r&512&&n!==null&&Va(n,n.return),t.flags&32){var s=t.stateNode;try{Bc(s,"")}catch(v){et(t,t.return,v)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&zk(s,i),B_(a,o);var c=B_(a,i);for(o=0;o<l.length;o+=2){var d=l[o],h=l[o+1];d==="style"?Qk(s,h):d==="dangerouslySetInnerHTML"?Hk(s,h):d==="children"?Bc(s,h):fw(s,d,h,c)}switch(a){case"input":$_(s,i);break;case"textarea":Wk(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?Ya(s,!!i.multiple,p,!1):f!==!!i.multiple&&(i.defaultValue!=null?Ya(s,!!i.multiple,i.defaultValue,!0):Ya(s,!!i.multiple,i.multiple?[]:"",!1))}s[Jc]=i}catch(v){et(t,t.return,v)}}break;case 6:if(lr(e,t),Rr(t),r&4){if(t.stateNode===null)throw Error(M(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(v){et(t,t.return,v)}}break;case 3:if(lr(e,t),Rr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Hc(e.containerInfo)}catch(v){et(t,t.return,v)}break;case 4:lr(e,t),Rr(t);break;case 13:lr(e,t),Rr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Hw=lt())),r&4&&PS(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(nn=(c=nn)||d,lr(e,t),nn=c):lr(e,t),Rr(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(Y=t,d=t.child;d!==null;){for(h=Y=d;Y!==null;){switch(f=Y,p=f.child,f.tag){case 0:case 11:case 14:case 15:xc(4,f,f.return);break;case 1:Va(f,f.return);var y=f.stateNode;if(typeof y.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(v){et(r,n,v)}}break;case 5:Va(f,f.return);break;case 22:if(f.memoizedState!==null){jS(h);continue}}p!==null?(p.return=f,Y=p):jS(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=Gk("display",o))}catch(v){et(t,t.return,v)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(v){et(t,t.return,v)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:lr(e,t),Rr(t),r&4&&PS(t);break;case 21:break;default:lr(e,t),Rr(t)}}function Rr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(xP(n)){var r=n;break e}n=n.return}throw Error(M(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Bc(s,""),r.flags&=-33);var i=RS(t);v0(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=RS(t);g0(t,a,o);break;default:throw Error(M(161))}}catch(l){et(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function W4(t,e,n){Y=t,bP(t)}function bP(t,e,n){for(var r=(t.mode&1)!==0;Y!==null;){var s=Y,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Xh;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||nn;a=Xh;var c=nn;if(Xh=o,(nn=l)&&!c)for(Y=s;Y!==null;)o=Y,l=o.child,o.tag===22&&o.memoizedState!==null?OS(s):l!==null?(l.return=o,Y=l):OS(s);for(;i!==null;)Y=i,bP(i),i=i.sibling;Y=s,Xh=a,nn=c}NS(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Y=i):NS(t)}}function NS(t){for(;Y!==null;){var e=Y;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:nn||bm(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!nn)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:cr(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&yS(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}yS(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Hc(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(M(163))}nn||e.flags&512&&m0(e)}catch(f){et(e,e.return,f)}}if(e===t){Y=null;break}if(n=e.sibling,n!==null){n.return=e.return,Y=n;break}Y=e.return}}function jS(t){for(;Y!==null;){var e=Y;if(e===t){Y=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Y=n;break}Y=e.return}}function OS(t){for(;Y!==null;){var e=Y;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{bm(4,e)}catch(l){et(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){et(e,s,l)}}var i=e.return;try{m0(e)}catch(l){et(e,i,l)}break;case 5:var o=e.return;try{m0(e)}catch(l){et(e,o,l)}}}catch(l){et(e,e.return,l)}if(e===t){Y=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Y=a;break}Y=e.return}}var q4=Math.ceil,Dp=As.ReactCurrentDispatcher,Ww=As.ReactCurrentOwner,tr=As.ReactCurrentBatchConfig,Ie=0,Ot=null,pt=null,Wt=0,Nn=0,Ua=Ni(0),wt=0,rd=null,$o=0,Sm=0,qw=0,wc=null,bn=null,Hw=0,Ml=1/0,ls=null,Fp=!1,_0=null,di=null,Zh=!1,Js=null,$p=0,Ec=0,x0=null,Ff=-1,$f=0;function gn(){return Ie&6?lt():Ff!==-1?Ff:Ff=lt()}function hi(t){return t.mode&1?Ie&2&&Wt!==0?Wt&-Wt:I4.transition!==null?($f===0&&($f=oR()),$f):(t=Ne,t!==0||(t=window.event,t=t===void 0?16:fR(t.type)),t):1}function Er(t,e,n,r){if(50<Ec)throw Ec=0,x0=null,Error(M(185));Wd(t,n,r),(!(Ie&2)||t!==Ot)&&(t===Ot&&(!(Ie&2)&&(Sm|=n),wt===4&&Us(t,Wt)),kn(t,r),n===1&&Ie===0&&!(e.mode&1)&&(Ml=lt()+500,xm&&ji()))}function kn(t,e){var n=t.callbackNode;I3(t,e);var r=xp(t,t===Ot?Wt:0);if(r===0)n!==null&&zb(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&zb(n),e===1)t.tag===0?T4(DS.bind(null,t)):NR(DS.bind(null,t)),b4(function(){!(Ie&6)&&ji()}),n=null;else{switch(aR(r)){case 1:n=vw;break;case 4:n=sR;break;case 16:n=_p;break;case 536870912:n=iR;break;default:n=_p}n=PP(n,SP.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function SP(t,e){if(Ff=-1,$f=0,Ie&6)throw Error(M(327));var n=t.callbackNode;if(tl()&&t.callbackNode!==n)return null;var r=xp(t,t===Ot?Wt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Mp(t,r);else{e=r;var s=Ie;Ie|=2;var i=AP();(Ot!==t||Wt!==e)&&(ls=null,Ml=lt()+500,vo(t,e));do try{Q4();break}catch(a){CP(t,a)}while(1);Pw(),Dp.current=i,Ie=s,pt!==null?e=0:(Ot=null,Wt=0,e=wt)}if(e!==0){if(e===2&&(s=G_(t),s!==0&&(r=s,e=w0(t,s))),e===1)throw n=rd,vo(t,0),Us(t,r),kn(t,lt()),n;if(e===6)Us(t,r);else{if(s=t.current.alternate,!(r&30)&&!H4(s)&&(e=Mp(t,r),e===2&&(i=G_(t),i!==0&&(r=i,e=w0(t,i))),e===1))throw n=rd,vo(t,0),Us(t,r),kn(t,lt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(M(345));case 2:zi(t,bn,ls);break;case 3:if(Us(t,r),(r&130023424)===r&&(e=Hw+500-lt(),10<e)){if(xp(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){gn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=t0(zi.bind(null,t,bn,ls),e);break}zi(t,bn,ls);break;case 4:if(Us(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-wr(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=lt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*q4(r/1960))-r,10<r){t.timeoutHandle=t0(zi.bind(null,t,bn,ls),r);break}zi(t,bn,ls);break;case 5:zi(t,bn,ls);break;default:throw Error(M(329))}}}return kn(t,lt()),t.callbackNode===n?SP.bind(null,t):null}function w0(t,e){var n=wc;return t.current.memoizedState.isDehydrated&&(vo(t,e).flags|=256),t=Mp(t,e),t!==2&&(e=bn,bn=n,e!==null&&E0(e)),t}function E0(t){bn===null?bn=t:bn.push.apply(bn,t)}function H4(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Cr(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Us(t,e){for(e&=~qw,e&=~Sm,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-wr(e),r=1<<n;t[n]=-1,e&=~r}}function DS(t){if(Ie&6)throw Error(M(327));tl();var e=xp(t,0);if(!(e&1))return kn(t,lt()),null;var n=Mp(t,e);if(t.tag!==0&&n===2){var r=G_(t);r!==0&&(e=r,n=w0(t,r))}if(n===1)throw n=rd,vo(t,0),Us(t,e),kn(t,lt()),n;if(n===6)throw Error(M(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,zi(t,bn,ls),kn(t,lt()),null}function Gw(t,e){var n=Ie;Ie|=1;try{return t(e)}finally{Ie=n,Ie===0&&(Ml=lt()+500,xm&&ji())}}function Mo(t){Js!==null&&Js.tag===0&&!(Ie&6)&&tl();var e=Ie;Ie|=1;var n=tr.transition,r=Ne;try{if(tr.transition=null,Ne=1,t)return t()}finally{Ne=r,tr.transition=n,Ie=e,!(Ie&6)&&ji()}}function Qw(){Nn=Ua.current,ze(Ua)}function vo(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,E4(n)),pt!==null)for(n=pt.return;n!==null;){var r=n;switch(Iw(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Cp();break;case 3:Fl(),ze(Tn),ze(an),$w();break;case 5:Fw(r);break;case 4:Fl();break;case 13:ze(Ke);break;case 19:ze(Ke);break;case 10:Nw(r.type._context);break;case 22:case 23:Qw()}n=n.return}if(Ot=t,pt=t=fi(t.current,null),Wt=Nn=e,wt=0,rd=null,qw=Sm=$o=0,bn=wc=null,to!==null){for(e=0;e<to.length;e++)if(n=to[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}to=null}return t}function CP(t,e){do{var n=pt;try{if(Pw(),jf.current=Op,jp){for(var r=Je.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}jp=!1}if(Fo=0,jt=gt=Je=null,_c=!1,ed=0,Ww.current=null,n===null||n.return===null){wt=1,rd=e,pt=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=Wt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,d=a,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=ES(o);if(p!==null){p.flags&=-257,bS(p,o,a,i,e),p.mode&1&&wS(i,c,e),e=p,l=c;var y=e.updateQueue;if(y===null){var v=new Set;v.add(l),e.updateQueue=v}else y.add(l);break e}else{if(!(e&1)){wS(i,c,e),Kw();break e}l=Error(M(426))}}else if(qe&&a.mode&1){var _=ES(o);if(_!==null){!(_.flags&65536)&&(_.flags|=256),bS(_,o,a,i,e),kw($l(l,a));break e}}i=l=$l(l,a),wt!==4&&(wt=2),wc===null?wc=[i]:wc.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var g=lP(i,l,e);pS(i,g);break e;case 1:a=l;var m=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof m.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(di===null||!di.has(w)))){i.flags|=65536,e&=-e,i.lanes|=e;var E=uP(i,a,e);pS(i,E);break e}}i=i.return}while(i!==null)}IP(n)}catch(T){e=T,pt===n&&n!==null&&(pt=n=n.return);continue}break}while(1)}function AP(){var t=Dp.current;return Dp.current=Op,t===null?Op:t}function Kw(){(wt===0||wt===3||wt===2)&&(wt=4),Ot===null||!($o&268435455)&&!(Sm&268435455)||Us(Ot,Wt)}function Mp(t,e){var n=Ie;Ie|=2;var r=AP();(Ot!==t||Wt!==e)&&(ls=null,vo(t,e));do try{G4();break}catch(s){CP(t,s)}while(1);if(Pw(),Ie=n,Dp.current=r,pt!==null)throw Error(M(261));return Ot=null,Wt=0,wt}function G4(){for(;pt!==null;)TP(pt)}function Q4(){for(;pt!==null&&!_3();)TP(pt)}function TP(t){var e=RP(t.alternate,t,Nn);t.memoizedProps=t.pendingProps,e===null?IP(t):pt=e,Ww.current=null}function IP(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=U4(n,e),n!==null){n.flags&=32767,pt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{wt=6,pt=null;return}}else if(n=V4(n,e,Nn),n!==null){pt=n;return}if(e=e.sibling,e!==null){pt=e;return}pt=e=t}while(e!==null);wt===0&&(wt=5)}function zi(t,e,n){var r=Ne,s=tr.transition;try{tr.transition=null,Ne=1,K4(t,e,n,r)}finally{tr.transition=s,Ne=r}return null}function K4(t,e,n,r){do tl();while(Js!==null);if(Ie&6)throw Error(M(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(M(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(k3(t,i),t===Ot&&(pt=Ot=null,Wt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Zh||(Zh=!0,PP(_p,function(){return tl(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=tr.transition,tr.transition=null;var o=Ne;Ne=1;var a=Ie;Ie|=4,Ww.current=null,z4(t,n),EP(n,t),y4(Z_),wp=!!X_,Z_=X_=null,t.current=n,W4(n),x3(),Ie=a,Ne=o,tr.transition=i}else t.current=n;if(Zh&&(Zh=!1,Js=t,$p=s),i=t.pendingLanes,i===0&&(di=null),b3(n.stateNode),kn(t,lt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Fp)throw Fp=!1,t=_0,_0=null,t;return $p&1&&t.tag!==0&&tl(),i=t.pendingLanes,i&1?t===x0?Ec++:(Ec=0,x0=t):Ec=0,ji(),null}function tl(){if(Js!==null){var t=aR($p),e=tr.transition,n=Ne;try{if(tr.transition=null,Ne=16>t?16:t,Js===null)var r=!1;else{if(t=Js,Js=null,$p=0,Ie&6)throw Error(M(331));var s=Ie;for(Ie|=4,Y=t.current;Y!==null;){var i=Y,o=i.child;if(Y.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(Y=c;Y!==null;){var d=Y;switch(d.tag){case 0:case 11:case 15:xc(8,d,i)}var h=d.child;if(h!==null)h.return=d,Y=h;else for(;Y!==null;){d=Y;var f=d.sibling,p=d.return;if(_P(d),d===c){Y=null;break}if(f!==null){f.return=p,Y=f;break}Y=p}}}var y=i.alternate;if(y!==null){var v=y.child;if(v!==null){y.child=null;do{var _=v.sibling;v.sibling=null,v=_}while(v!==null)}}Y=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Y=o;else e:for(;Y!==null;){if(i=Y,i.flags&2048)switch(i.tag){case 0:case 11:case 15:xc(9,i,i.return)}var g=i.sibling;if(g!==null){g.return=i.return,Y=g;break e}Y=i.return}}var m=t.current;for(Y=m;Y!==null;){o=Y;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,Y=w;else e:for(o=m;Y!==null;){if(a=Y,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:bm(9,a)}}catch(T){et(a,a.return,T)}if(a===o){Y=null;break e}var E=a.sibling;if(E!==null){E.return=a.return,Y=E;break e}Y=a.return}}if(Ie=s,ji(),Hr&&typeof Hr.onPostCommitFiberRoot=="function")try{Hr.onPostCommitFiberRoot(ym,t)}catch{}r=!0}return r}finally{Ne=n,tr.transition=e}}return!1}function FS(t,e,n){e=$l(n,e),e=lP(t,e,1),t=ci(t,e,1),e=gn(),t!==null&&(Wd(t,1,e),kn(t,e))}function et(t,e,n){if(t.tag===3)FS(t,t,n);else for(;e!==null;){if(e.tag===3){FS(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(di===null||!di.has(r))){t=$l(n,t),t=uP(e,t,1),e=ci(e,t,1),t=gn(),e!==null&&(Wd(e,1,t),kn(e,t));break}}e=e.return}}function Y4(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=gn(),t.pingedLanes|=t.suspendedLanes&n,Ot===t&&(Wt&n)===n&&(wt===4||wt===3&&(Wt&130023424)===Wt&&500>lt()-Hw?vo(t,0):qw|=n),kn(t,e)}function kP(t,e){e===0&&(t.mode&1?(e=zh,zh<<=1,!(zh&130023424)&&(zh=4194304)):e=1);var n=gn();t=xs(t,e),t!==null&&(Wd(t,e,n),kn(t,n))}function J4(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),kP(t,n)}function X4(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(M(314))}r!==null&&r.delete(e),kP(t,n)}var RP;RP=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Tn.current)Cn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Cn=!1,L4(t,e,n);Cn=!!(t.flags&131072)}else Cn=!1,qe&&e.flags&1048576&&jR(e,Ip,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Df(t,e),t=e.pendingProps;var s=jl(e,an.current);el(e,n),s=Lw(null,e,r,t,s,n);var i=Vw();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,In(r)?(i=!0,Ap(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Ow(e),s.updater=wm,e.stateNode=s,s._reactInternals=e,l0(e,r,t,n),e=d0(null,e,r,!0,i,n)):(e.tag=0,qe&&i&&Tw(e),hn(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Df(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=eL(r),t=cr(r,t),s){case 0:e=c0(null,e,r,t,n);break e;case 1:e=AS(null,e,r,t,n);break e;case 11:e=SS(null,e,r,t,n);break e;case 14:e=CS(null,e,r,cr(r.type,t),n);break e}throw Error(M(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:cr(r,s),c0(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:cr(r,s),AS(t,e,r,s,n);case 3:e:{if(fP(e),t===null)throw Error(M(387));r=e.pendingProps,i=e.memoizedState,s=i.element,$R(t,e),Pp(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=$l(Error(M(423)),e),e=TS(t,e,r,n,s);break e}else if(r!==s){s=$l(Error(M(424)),e),e=TS(t,e,r,n,s);break e}else for(On=ui(e.stateNode.containerInfo.firstChild),Fn=e,qe=!0,pr=null,n=UR(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ol(),r===s){e=ws(t,e,n);break e}hn(t,e,r,n)}e=e.child}return e;case 5:return BR(e),t===null&&i0(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,e0(r,s)?o=null:i!==null&&e0(r,i)&&(e.flags|=32),hP(t,e),hn(t,e,o,n),e.child;case 6:return t===null&&i0(e),null;case 13:return pP(t,e,n);case 4:return Dw(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Dl(e,null,r,n):hn(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:cr(r,s),SS(t,e,r,s,n);case 7:return hn(t,e,e.pendingProps,n),e.child;case 8:return hn(t,e,e.pendingProps.children,n),e.child;case 12:return hn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Le(kp,r._currentValue),r._currentValue=o,i!==null)if(Cr(i.value,o)){if(i.children===s.children&&!Tn.current){e=ws(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=ms(-1,n&-n),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),o0(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(M(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),o0(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}hn(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,el(e,n),s=sr(s),r=r(s),e.flags|=1,hn(t,e,r,n),e.child;case 14:return r=e.type,s=cr(r,e.pendingProps),s=cr(r.type,s),CS(t,e,r,s,n);case 15:return cP(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:cr(r,s),Df(t,e),e.tag=1,In(r)?(t=!0,Ap(e)):t=!1,el(e,n),LR(e,r,s),l0(e,r,s,n),d0(null,e,r,!0,t,n);case 19:return yP(t,e,n);case 22:return dP(t,e,n)}throw Error(M(156,e.tag))};function PP(t,e){return rR(t,e)}function Z4(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zn(t,e,n,r){return new Z4(t,e,n,r)}function Yw(t){return t=t.prototype,!(!t||!t.isReactComponent)}function eL(t){if(typeof t=="function")return Yw(t)?1:0;if(t!=null){if(t=t.$$typeof,t===yw)return 11;if(t===mw)return 14}return 2}function fi(t,e){var n=t.alternate;return n===null?(n=Zn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Mf(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")Yw(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Pa:return _o(n.children,s,i,e);case pw:o=8,s|=8;break;case N_:return t=Zn(12,n,e,s|2),t.elementType=N_,t.lanes=i,t;case j_:return t=Zn(13,n,e,s),t.elementType=j_,t.lanes=i,t;case O_:return t=Zn(19,n,e,s),t.elementType=O_,t.lanes=i,t;case Vk:return Cm(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Mk:o=10;break e;case Lk:o=9;break e;case yw:o=11;break e;case mw:o=14;break e;case Ds:o=16,r=null;break e}throw Error(M(130,t==null?t:typeof t,""))}return e=Zn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function _o(t,e,n,r){return t=Zn(7,t,r,e),t.lanes=n,t}function Cm(t,e,n,r){return t=Zn(22,t,r,e),t.elementType=Vk,t.lanes=n,t.stateNode={isHidden:!1},t}function uv(t,e,n){return t=Zn(6,t,null,e),t.lanes=n,t}function cv(t,e,n){return e=Zn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function tL(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Wg(0),this.expirationTimes=Wg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Wg(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Jw(t,e,n,r,s,i,o,a,l){return t=new tL(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Zn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ow(i),t}function nL(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ra,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function NP(t){if(!t)return Ei;t=t._reactInternals;e:{if(Yo(t)!==t||t.tag!==1)throw Error(M(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(In(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(M(171))}if(t.tag===1){var n=t.type;if(In(n))return PR(t,n,e)}return e}function jP(t,e,n,r,s,i,o,a,l){return t=Jw(n,r,!0,t,s,i,o,a,l),t.context=NP(null),n=t.current,r=gn(),s=hi(n),i=ms(r,s),i.callback=e??null,ci(n,i,s),t.current.lanes=s,Wd(t,s,r),kn(t,r),t}function Am(t,e,n,r){var s=e.current,i=gn(),o=hi(s);return n=NP(n),e.context===null?e.context=n:e.pendingContext=n,e=ms(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ci(s,e,o),t!==null&&(Er(t,s,o,i),Nf(t,s,o)),o}function Lp(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function $S(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Xw(t,e){$S(t,e),(t=t.alternate)&&$S(t,e)}function rL(){return null}var OP=typeof reportError=="function"?reportError:function(t){console.error(t)};function Zw(t){this._internalRoot=t}Tm.prototype.render=Zw.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(M(409));Am(t,e,null,null)};Tm.prototype.unmount=Zw.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Mo(function(){Am(null,t,null,null)}),e[_s]=null}};function Tm(t){this._internalRoot=t}Tm.prototype.unstable_scheduleHydration=function(t){if(t){var e=cR();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Vs.length&&e!==0&&e<Vs[n].priority;n++);Vs.splice(n,0,t),n===0&&hR(t)}};function e1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Im(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function MS(){}function sL(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var c=Lp(o);i.call(c)}}var o=jP(e,r,t,0,null,!1,!1,"",MS);return t._reactRootContainer=o,t[_s]=o.current,Kc(t.nodeType===8?t.parentNode:t),Mo(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var c=Lp(l);a.call(c)}}var l=Jw(t,0,!1,null,null,!1,!1,"",MS);return t._reactRootContainer=l,t[_s]=l.current,Kc(t.nodeType===8?t.parentNode:t),Mo(function(){Am(e,l,n,r)}),l}function km(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=Lp(o);a.call(l)}}Am(e,o,t,s)}else o=sL(n,e,t,s,r);return Lp(o)}lR=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Xu(e.pendingLanes);n!==0&&(_w(e,n|1),kn(e,lt()),!(Ie&6)&&(Ml=lt()+500,ji()))}break;case 13:Mo(function(){var r=xs(t,1);if(r!==null){var s=gn();Er(r,t,1,s)}}),Xw(t,1)}};xw=function(t){if(t.tag===13){var e=xs(t,134217728);if(e!==null){var n=gn();Er(e,t,134217728,n)}Xw(t,134217728)}};uR=function(t){if(t.tag===13){var e=hi(t),n=xs(t,e);if(n!==null){var r=gn();Er(n,t,e,r)}Xw(t,e)}};cR=function(){return Ne};dR=function(t,e){var n=Ne;try{return Ne=t,e()}finally{Ne=n}};W_=function(t,e,n){switch(e){case"input":if($_(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=_m(r);if(!s)throw Error(M(90));Bk(r),$_(r,s)}}}break;case"textarea":Wk(t,n);break;case"select":e=n.value,e!=null&&Ya(t,!!n.multiple,e,!1)}};Jk=Gw;Xk=Mo;var iL={usingClientEntryPoint:!1,Events:[Hd,Da,_m,Kk,Yk,Gw]},$u={findFiberByHostInstance:eo,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},oL={bundleType:$u.bundleType,version:$u.version,rendererPackageName:$u.rendererPackageName,rendererConfig:$u.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:As.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=tR(t),t===null?null:t.stateNode},findFiberByHostInstance:$u.findFiberByHostInstance||rL,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ef=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ef.isDisabled&&ef.supportsFiber)try{ym=ef.inject(oL),Hr=ef}catch{}}Vn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=iL;Vn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!e1(e))throw Error(M(200));return nL(t,e,null,n)};Vn.createRoot=function(t,e){if(!e1(t))throw Error(M(299));var n=!1,r="",s=OP;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Jw(t,1,!1,null,null,n,!1,r,s),t[_s]=e.current,Kc(t.nodeType===8?t.parentNode:t),new Zw(e)};Vn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(M(188)):(t=Object.keys(t).join(","),Error(M(268,t)));return t=tR(e),t=t===null?null:t.stateNode,t};Vn.flushSync=function(t){return Mo(t)};Vn.hydrate=function(t,e,n){if(!Im(e))throw Error(M(200));return km(null,t,e,!0,n)};Vn.hydrateRoot=function(t,e,n){if(!e1(t))throw Error(M(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=OP;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=jP(e,null,t,1,n??null,s,!1,i,o),t[_s]=e.current,Kc(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Tm(e)};Vn.render=function(t,e,n){if(!Im(e))throw Error(M(200));return km(null,t,e,!1,n)};Vn.unmountComponentAtNode=function(t){if(!Im(t))throw Error(M(40));return t._reactRootContainer?(Mo(function(){km(null,null,t,!1,function(){t._reactRootContainer=null,t[_s]=null})}),!0):!1};Vn.unstable_batchedUpdates=Gw;Vn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Im(n))throw Error(M(200));if(t==null||t._reactInternals===void 0)throw Error(M(38));return km(t,e,n,!1,r)};Vn.version="18.2.0-next-9e3b772b8-20220608";function DP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(DP)}catch(t){console.error(t)}}DP(),jk.exports=Vn;var aL=jk.exports,LS=aL;R_.createRoot=LS.createRoot,R_.hydrateRoot=LS.hydrateRoot;var FP={exports:{}},$P={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ll=x;function lL(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var uL=typeof Object.is=="function"?Object.is:lL,cL=Ll.useState,dL=Ll.useEffect,hL=Ll.useLayoutEffect,fL=Ll.useDebugValue;function pL(t,e){var n=e(),r=cL({inst:{value:n,getSnapshot:e}}),s=r[0].inst,i=r[1];return hL(function(){s.value=n,s.getSnapshot=e,dv(s)&&i({inst:s})},[t,n,e]),dL(function(){return dv(s)&&i({inst:s}),t(function(){dv(s)&&i({inst:s})})},[t]),fL(n),n}function dv(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!uL(t,n)}catch{return!0}}function yL(t,e){return e()}var mL=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?yL:pL;$P.useSyncExternalStore=Ll.useSyncExternalStore!==void 0?Ll.useSyncExternalStore:mL;FP.exports=$P;var gL=FP.exports;const{useEffect:vL,useLayoutEffect:_L,useRef:xL,useInsertionEffect:wL}=JM,EL=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",bL=EL?_L:vL,SL=wL||bL,MP=t=>{const e=xL([t,(...n)=>e[0](...n)]).current;return SL(()=>{e[0]=t}),e[1]},CL=(t="",e=location.pathname)=>e.toLowerCase().indexOf(t.toLowerCase())?"~"+e:e.slice(t.length)||"/",AL=(t,e="")=>t[0]==="~"?t.slice(1):e+t,TL="popstate",t1="pushState",n1="replaceState",IL="hashchange",VS=[TL,t1,n1,IL],kL=t=>{for(const e of VS)addEventListener(e,t);return()=>{for(const e of VS)removeEventListener(e,t)}},RL=(t,e)=>gL.useSyncExternalStore(kL,t,e),US=()=>location.pathname,PL=({ssrPath:t}={})=>RL(US,t?()=>t:US),NL=(t,{replace:e=!1}={})=>history[e?n1:t1](null,"",t),jL=(t={})=>[CL(t.base,PL(t)),MP((e,n)=>NL(AL(e,t.base),n))];if(typeof history<"u")for(const t of[t1,n1]){const e=history[t];history[t]=function(){const n=e.apply(this,arguments),r=new Event(t);return r.arguments=arguments,dispatchEvent(r),n}}function OL(t=FL){let e={};const n=r=>e[r]||(e[r]=t(r));return(r,s)=>{const{regexp:i,keys:o}=n(r||""),a=i.exec(s);return a?[!0,o.reduce((c,d,h)=>(c[d.name]=a[h+1],c),{})]:[!1,null]}}const BS=t=>t.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"),DL=(t,e,n)=>{let r=t?"((?:[^\\/]+?)(?:\\/(?:[^\\/]+?))*)":"([^\\/]+?)";return e&&n&&(r="(?:\\/"+r+")"),r+(e?"?":"")},FL=t=>{const e=/:([A-Za-z0-9_]+)([?+*]?)/g;let n=null,r=0,s=[],i="";for(;(n=e.exec(t))!==null;){const[o,a,l]=n,c=l==="+"||l==="*",d=l==="?"||l==="*",h=d&&t[n.index-1]==="/"?1:0,f=t.substring(r,n.index-h);s.push({name:a}),r=e.lastIndex,i+=BS(f)+DL(c,d,h)}return i+=BS(t.substring(r)),{keys:s,regexp:new RegExp("^"+i+"(?:\\/)?$","i")}},$L={hook:jL,matcher:OL(),base:""},ML=x.createContext($L),Rm=()=>x.useContext(ML),Pm=t=>t.hook(t),LL=()=>Pm(Rm()),VL=t=>{const e=Rm(),[n]=Pm(e);return e.matcher(t,n)},LP=x.createContext({params:{}}),UL=()=>x.useContext(LP).params,zS=(t,e)=>x.createElement(LP.Provider,{value:{params:t},children:e}),dt=({path:t,match:e,component:n,children:r})=>{const s=VL(t),[i,o]=e||s;return i?n?zS(o,x.createElement(n,{params:o})):zS(o,typeof r=="function"?r(o):r):null};x.forwardRef((t,e)=>{const n=Rm(),[,r]=Pm(n),{to:s,href:i=s,children:o,onClick:a}=t,l=MP(h=>{h.ctrlKey||h.metaKey||h.altKey||h.shiftKey||h.button!==0||(a&&a(h),h.defaultPrevented||(h.preventDefault(),r(s||i,t)))}),c={href:i[0]==="~"?i.slice(1):n.base+i,onClick:l,to:null,ref:e},d=x.isValidElement(o)?o:x.createElement("a",t);return x.cloneElement(d,c)});const b0=t=>Array.isArray(t)?[].concat(...t.map(e=>e&&e.type===x.Fragment?b0(e.props.children):b0(e))):[t],BL=({children:t,location:e})=>{const n=Rm(),r=n.matcher,[s]=Pm(n);for(const i of b0(t)){let o=0;if(x.isValidElement(i)&&(o=i.props.path?r(i.props.path,e||s):[!0,{}])[0])return x.cloneElement(i,{match:o})}return null};const zL="modulepreload",WL=function(t){return"/"+t},WS={},VP=function(e,n,r){if(!n||n.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(n.map(i=>{if(i=WL(i),i in WS)return;WS[i]=!0;const o=i.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let d=s.length-1;d>=0;d--){const h=s[d];if(h.href===i&&(!o||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${a}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":zL,o||(c.as="script",c.crossOrigin=""),c.href=i,document.head.appendChild(c),o)return new Promise((d,h)=>{c.addEventListener("load",d),c.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})},qL=t=>{t&&t instanceof Function&&VP(()=>import("./web-vitals-9f4c2f45.js"),[]).then(({getCLS:e,getFID:n,getFCP:r,getLCP:s,getTTFB:i})=>{e(t),n(t),r(t),s(t),i(t)})};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UP={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V=function(t,e){if(!t)throw yu(e)},yu=function(t){return new Error("Firebase Database ("+UP.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BP=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},HL=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},r1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,l=s+2<t.length,c=l?t[s+2]:0,d=i>>2,h=(i&3)<<4|a>>4;let f=(a&15)<<2|c>>6,p=c&63;l||(p=64,o||(f=64)),r.push(n[d],n[h],n[f],n[p])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(BP(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):HL(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const c=s<t.length?n[t.charAt(s)]:64;++s;const h=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||c==null||h==null)throw new GL;const f=i<<2|a>>4;if(r.push(f),c!==64){const p=a<<4&240|c>>2;if(r.push(p),h!==64){const y=c<<6&192|h;r.push(y)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class GL extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const zP=function(t){const e=BP(t);return r1.encodeByteArray(e,!0)},Vp=function(t){return zP(t).replace(/\./g,"")},S0=function(t){try{return r1.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QL(t){return WP(void 0,t)}function WP(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!KL(n)||(t[n]=WP(t[n],e[n]));return t}function KL(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YL(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JL=()=>YL().__FIREBASE_DEFAULTS__,XL=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},ZL=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&S0(t[1]);return e&&JSON.parse(e)},s1=()=>{try{return JL()||XL()||ZL()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},eV=t=>{var e,n;return(n=(e=s1())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},i1=t=>{const e=eV(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},qP=()=>{var t;return(t=s1())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qd{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o1(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[Vp(JSON.stringify(n)),Vp(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tV(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function HP(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(tV())}function nV(){var t;const e=(t=s1())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function rV(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function GP(){return UP.NODE_ADMIN===!0}function sV(){try{return typeof indexedDB=="object"}catch{return!1}}function iV(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oV="FirebaseError";class Jo extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=oV,Object.setPrototypeOf(this,Jo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,QP.prototype.create)}}class QP{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?aV(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Jo(s,a,r)}}function aV(t,e){return t.replace(lV,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const lV=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sd(t){return JSON.parse(t)}function _t(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KP=function(t){let e={},n={},r={},s="";try{const i=t.split(".");e=sd(S0(i[0])||""),n=sd(S0(i[1])||""),s=i[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:s}},uV=function(t){const e=KP(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},cV=function(t){const e=KP(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ts(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Vl(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function qS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Up(t,e,n){const r={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=e.call(n,t[s],s,t));return r}function C0(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(HS(i)&&HS(o)){if(!C0(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function HS(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dV(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hV{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const r=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)r[h]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let h=0;h<16;h++)r[h]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let h=16;h<80;h++){const f=r[h-3]^r[h-8]^r[h-14]^r[h-16];r[h]=(f<<1|f>>>31)&4294967295}let s=this.chain_[0],i=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],c,d;for(let h=0;h<80;h++){h<40?h<20?(c=a^i&(o^a),d=1518500249):(c=i^o^a,d=1859775393):h<60?(c=i&o|a&(i|o),d=2400959708):(c=i^o^a,d=3395469782);const f=(s<<5|s>>>27)+c+l+d+r[h]&4294967295;l=a,a=o,o=(i<<30|i>>>2)&4294967295,i=s,s=f}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const r=n-this.blockSize;let s=0;const i=this.buf_;let o=this.inbuf_;for(;s<n;){if(o===0)for(;s<=r;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<n;)if(i[o]=e.charCodeAt(s),++o,++s,o===this.blockSize){this.compress_(i),o=0;break}}else for(;s<n;)if(i[o]=e[s],++o,++s,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let s=0;s<5;s++)for(let i=24;i>=0;i-=8)e[r]=this.chain_[s]>>i&255,++r;return e}}function Kd(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fV=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);if(s>=55296&&s<=56319){const i=s-55296;r++,V(r<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(r)-56320;s=65536+(i<<10)+o}s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):s<65536?(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},Nm=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qt(t){return t&&t._delegate?t._delegate:t}class Lo{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pV{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Qd;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(mV(e))try{this.getOrInitializeService({instanceIdentifier:Wi})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Wi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Wi){return this.instances.has(e)}getOptions(e=Wi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:yV(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Wi){return this.component?this.component.multipleInstances?e:Wi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function yV(t){return t===Wi?void 0:t}function mV(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gV{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new pV(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Te;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Te||(Te={}));const vV={debug:Te.DEBUG,verbose:Te.VERBOSE,info:Te.INFO,warn:Te.WARN,error:Te.ERROR,silent:Te.SILENT},_V=Te.INFO,xV={[Te.DEBUG]:"log",[Te.VERBOSE]:"log",[Te.INFO]:"info",[Te.WARN]:"warn",[Te.ERROR]:"error"},wV=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=xV[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class a1{constructor(e){this.name=e,this._logLevel=_V,this._logHandler=wV,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Te))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?vV[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Te.DEBUG,...e),this._logHandler(this,Te.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Te.VERBOSE,...e),this._logHandler(this,Te.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Te.INFO,...e),this._logHandler(this,Te.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Te.WARN,...e),this._logHandler(this,Te.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Te.ERROR,...e),this._logHandler(this,Te.ERROR,...e)}}const EV=(t,e)=>e.some(n=>t instanceof n);let GS,QS;function bV(){return GS||(GS=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function SV(){return QS||(QS=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const YP=new WeakMap,A0=new WeakMap,JP=new WeakMap,hv=new WeakMap,l1=new WeakMap;function CV(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(pi(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&YP.set(n,t)}).catch(()=>{}),l1.set(e,t),e}function AV(t){if(A0.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});A0.set(t,e)}let T0={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return A0.get(t);if(e==="objectStoreNames")return t.objectStoreNames||JP.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return pi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function TV(t){T0=t(T0)}function IV(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(fv(this),e,...n);return JP.set(r,e.sort?e.sort():[e]),pi(r)}:SV().includes(t)?function(...e){return t.apply(fv(this),e),pi(YP.get(this))}:function(...e){return pi(t.apply(fv(this),e))}}function kV(t){return typeof t=="function"?IV(t):(t instanceof IDBTransaction&&AV(t),EV(t,bV())?new Proxy(t,T0):t)}function pi(t){if(t instanceof IDBRequest)return CV(t);if(hv.has(t))return hv.get(t);const e=kV(t);return e!==t&&(hv.set(t,e),l1.set(e,t)),e}const fv=t=>l1.get(t);function RV(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=pi(o);return r&&o.addEventListener("upgradeneeded",l=>{r(pi(o.result),l.oldVersion,l.newVersion,pi(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const PV=["get","getKey","getAll","getAllKeys","count"],NV=["put","add","delete","clear"],pv=new Map;function KS(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(pv.get(e))return pv.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=NV.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||PV.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),s&&l.done]))[0]};return pv.set(e,i),i}TV(t=>({...t,get:(e,n,r)=>KS(e,n)||t.get(e,n,r),has:(e,n)=>!!KS(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jV{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(OV(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function OV(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const I0="@firebase/app",YS="0.9.22";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vo=new a1("@firebase/app"),DV="@firebase/app-compat",FV="@firebase/analytics-compat",$V="@firebase/analytics",MV="@firebase/app-check-compat",LV="@firebase/app-check",VV="@firebase/auth",UV="@firebase/auth-compat",BV="@firebase/database",zV="@firebase/database-compat",WV="@firebase/functions",qV="@firebase/functions-compat",HV="@firebase/installations",GV="@firebase/installations-compat",QV="@firebase/messaging",KV="@firebase/messaging-compat",YV="@firebase/performance",JV="@firebase/performance-compat",XV="@firebase/remote-config",ZV="@firebase/remote-config-compat",eU="@firebase/storage",tU="@firebase/storage-compat",nU="@firebase/firestore",rU="@firebase/firestore-compat",sU="firebase",iU="10.5.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k0="[DEFAULT]",oU={[I0]:"fire-core",[DV]:"fire-core-compat",[$V]:"fire-analytics",[FV]:"fire-analytics-compat",[LV]:"fire-app-check",[MV]:"fire-app-check-compat",[VV]:"fire-auth",[UV]:"fire-auth-compat",[BV]:"fire-rtdb",[zV]:"fire-rtdb-compat",[WV]:"fire-fn",[qV]:"fire-fn-compat",[HV]:"fire-iid",[GV]:"fire-iid-compat",[QV]:"fire-fcm",[KV]:"fire-fcm-compat",[YV]:"fire-perf",[JV]:"fire-perf-compat",[XV]:"fire-rc",[ZV]:"fire-rc-compat",[eU]:"fire-gcs",[tU]:"fire-gcs-compat",[nU]:"fire-fst",[rU]:"fire-fst-compat","fire-js":"fire-js",[sU]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bp=new Map,R0=new Map;function aU(t,e){try{t.container.addComponent(e)}catch(n){Vo.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ul(t){const e=t.name;if(R0.has(e))return Vo.debug(`There were multiple attempts to register component ${e}.`),!1;R0.set(e,t);for(const n of Bp.values())aU(n,t);return!0}function u1(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lU={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},yi=new QP("app","Firebase",lU);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uU{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Lo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw yi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c1=iU;function XP(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:k0,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw yi.create("bad-app-name",{appName:String(s)});if(n||(n=qP()),!n)throw yi.create("no-options");const i=Bp.get(s);if(i){if(C0(n,i.options)&&C0(r,i.config))return i;throw yi.create("duplicate-app",{appName:s})}const o=new gV(s);for(const l of R0.values())o.addComponent(l);const a=new uU(n,r,o);return Bp.set(s,a),a}function d1(t=k0){const e=Bp.get(t);if(!e&&t===k0&&qP())return XP();if(!e)throw yi.create("no-app",{appName:t});return e}function Qr(t,e,n){var r;let s=(r=oU[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Vo.warn(a.join(" "));return}Ul(new Lo(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cU="firebase-heartbeat-database",dU=1,id="firebase-heartbeat-store";let yv=null;function ZP(){return yv||(yv=RV(cU,dU,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(id)}}}).catch(t=>{throw yi.create("idb-open",{originalErrorMessage:t.message})})),yv}async function hU(t){try{return await(await ZP()).transaction(id).objectStore(id).get(eN(t))}catch(e){if(e instanceof Jo)Vo.warn(e.message);else{const n=yi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Vo.warn(n.message)}}}async function JS(t,e){try{const r=(await ZP()).transaction(id,"readwrite");await r.objectStore(id).put(e,eN(t)),await r.done}catch(n){if(n instanceof Jo)Vo.warn(n.message);else{const r=yi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Vo.warn(r.message)}}}function eN(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fU=1024,pU=30*24*60*60*1e3;class yU{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new gU(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=XS();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const i=new Date(s.date).valueOf();return Date.now()-i<=pU}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=XS(),{heartbeatsToSend:n,unsentEntries:r}=mU(this._heartbeatsCache.heartbeats),s=Vp(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function XS(){return new Date().toISOString().substring(0,10)}function mU(t,e=fU){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),ZS(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),ZS(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class gU{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return sV()?iV().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await hU(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return JS(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return JS(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function ZS(t){return Vp(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vU(t){Ul(new Lo("platform-logger",e=>new jV(e),"PRIVATE")),Ul(new Lo("heartbeat",e=>new yU(e),"PRIVATE")),Qr(I0,YS,t),Qr(I0,YS,"esm2017"),Qr("fire-js","")}vU("");const eC="@firebase/database",tC="1.0.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tN="";function _U(t){tN=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xU{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),_t(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:sd(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wU{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return ts(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nN=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new xU(e)}}catch{}return new wU},ro=nN("localStorage"),P0=nN("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nl=new a1("@firebase/database"),EU=function(){let t=1;return function(){return t++}}(),rN=function(t){const e=fV(t),n=new hV;n.update(e);const r=n.digest();return r1.encodeByteArray(r)},Yd=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Yd.apply(null,r):typeof r=="object"?e+=_t(r):e+=r,e+=" "}return e};let xo=null,nC=!0;const bU=function(t,e){V(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(nl.logLevel=Te.VERBOSE,xo=nl.log.bind(nl),e&&P0.set("logging_enabled",!0)):typeof t=="function"?xo=t:(xo=null,P0.remove("logging_enabled"))},Vt=function(...t){if(nC===!0&&(nC=!1,xo===null&&P0.get("logging_enabled")===!0&&bU(!0)),xo){const e=Yd.apply(null,t);xo(e)}},Jd=function(t){return function(...e){Vt(t,...e)}},N0=function(...t){const e="FIREBASE INTERNAL ERROR: "+Yd(...t);nl.error(e)},Es=function(...t){const e=`FIREBASE FATAL ERROR: ${Yd(...t)}`;throw nl.error(e),new Error(e)},vn=function(...t){const e="FIREBASE WARNING: "+Yd(...t);nl.warn(e)},SU=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&vn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},h1=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},CU=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Uo="[MIN_NAME]",bi="[MAX_NAME]",Xo=function(t,e){if(t===e)return 0;if(t===Uo||e===bi)return-1;if(e===Uo||t===bi)return 1;{const n=rC(t),r=rC(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},AU=function(t,e){return t===e?0:t<e?-1:1},Mu=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+_t(e))},f1=function(t){if(typeof t!="object"||t===null)return _t(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=_t(e[r]),n+=":",n+=f1(t[e[r]]);return n+="}",n},sN=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let s=0;s<n;s+=e)s+e>n?r.push(t.substring(s,n)):r.push(t.substring(s,s+e));return r};function Kt(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const iN=function(t){V(!h1(t),"Invalid JSON number");const e=11,n=52,r=(1<<e-1)-1;let s,i,o,a,l;t===0?(i=0,o=0,s=1/t===-1/0?1:0):(s=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),i=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(i=0,o=Math.round(t/Math.pow(2,1-r-n))));const c=[];for(l=n;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)c.push(i%2?1:0),i=Math.floor(i/2);c.push(s?1:0),c.reverse();const d=c.join("");let h="";for(l=0;l<64;l+=8){let f=parseInt(d.substr(l,8),2).toString(16);f.length===1&&(f="0"+f),h=h+f}return h.toLowerCase()},TU=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},IU=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function kU(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}const RU=new RegExp("^-?(0*)\\d{1,10}$"),PU=-2147483648,NU=2147483647,rC=function(t){if(RU.test(t)){const e=Number(t);if(e>=PU&&e<=NU)return e}return null},mu=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw vn("Exception was thrown by user callback.",n),e},Math.floor(0))}},jU=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},bc=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OU{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){vn(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DU{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Vt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',vn(e)}}class rl{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}rl.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p1="5",oN="v",aN="s",lN="r",uN="f",cN=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,dN="ls",hN="p",j0="ac",fN="websocket",pN="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yN{constructor(e,n,r,s,i=!1,o="",a=!1,l=!1){this.secure=n,this.namespace=r,this.webSocketOnly=s,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=ro.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&ro.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function FU(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function mN(t,e,n){V(typeof e=="string","typeof type must == string"),V(typeof n=="object","typeof params must == object");let r;if(e===fN)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===pN)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);FU(t)&&(n.ns=t.namespace);const s=[];return Kt(n,(i,o)=>{s.push(i+"="+o)}),r+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $U{constructor(){this.counters_={}}incrementCounter(e,n=1){ts(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return QL(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mv={},gv={};function y1(t){const e=t.toString();return mv[e]||(mv[e]=new $U),mv[e]}function MU(t,e){const n=t.toString();return gv[n]||(gv[n]=e()),gv[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LU{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<r.length;++s)r[s]&&mu(()=>{this.onMessage_(r[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sC="start",VU="close",UU="pLPCommand",BU="pRTLPCB",gN="id",vN="pw",_N="ser",zU="cb",WU="seg",qU="ts",HU="d",GU="dframe",xN=1870,wN=30,QU=xN-wN,KU=25e3,YU=3e4;class Ba{constructor(e,n,r,s,i,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Jd(e),this.stats_=y1(n),this.urlFn=l=>(this.appCheckToken&&(l[j0]=this.appCheckToken),mN(n,pN,l))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new LU(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(YU)),CU(()=>{if(this.isClosed_)return;this.scriptTagHolder=new m1((...i)=>{const[o,a,l,c,d]=i;if(this.incrementIncomingBytes_(i),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===sC)this.id=a,this.password=l;else if(o===VU)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...i)=>{const[o,a]=i;this.incrementIncomingBytes_(i),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const r={};r[sC]="t",r[_N]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[zU]=this.scriptTagHolder.uniqueCallbackIdentifier),r[oN]=p1,this.transportSessionId&&(r[aN]=this.transportSessionId),this.lastSessionId&&(r[dN]=this.lastSessionId),this.applicationId&&(r[hN]=this.applicationId),this.appCheckToken&&(r[j0]=this.appCheckToken),typeof location<"u"&&location.hostname&&cN.test(location.hostname)&&(r[lN]=uN);const s=this.urlFn(r);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Ba.forceAllow_=!0}static forceDisallow(){Ba.forceDisallow_=!0}static isAvailable(){return Ba.forceAllow_?!0:!Ba.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!TU()&&!IU()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=_t(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=zP(n),s=sN(r,QU);for(let i=0;i<s.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[i]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const r={};r[GU]="t",r[gN]=e,r[vN]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=_t(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class m1{constructor(e,n,r,s){this.onDisconnect=r,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=EU(),window[UU+this.uniqueCallbackIdentifier]=e,window[BU+this.uniqueCallbackIdentifier]=n,this.myIFrame=m1.createIFrame_();let i="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(i='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Vt("frame writing exception"),a.stack&&Vt(a.stack),Vt(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Vt("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[gN]=this.myID,e[vN]=this.myPW,e[_N]=this.currentSerial;let n=this.urlFn(e),r="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+wN+r.length<=xN;){const o=this.pendingSegs.shift();r=r+"&"+WU+s+"="+o.seg+"&"+qU+s+"="+o.ts+"&"+HU+s+"="+o.d,s++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},s=setTimeout(r,Math.floor(KU)),i=()=>{clearTimeout(s),r()};this.addTag(e,i)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const s=r.readyState;(!s||s==="loaded"||s==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{Vt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JU=16384,XU=45e3;let zp=null;typeof MozWebSocket<"u"?zp=MozWebSocket:typeof WebSocket<"u"&&(zp=WebSocket);class yr{constructor(e,n,r,s,i,o,a){this.connId=e,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Jd(this.connId),this.stats_=y1(n),this.connURL=yr.connectionURL_(n,o,a,s,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,r,s,i){const o={};return o[oN]=p1,typeof location<"u"&&location.hostname&&cN.test(location.hostname)&&(o[lN]=uN),n&&(o[aN]=n),r&&(o[dN]=r),s&&(o[j0]=s),i&&(o[hN]=i),mN(e,fN,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,ro.set("previous_websocket_failure",!0);try{let r;GP(),this.mySock=new zp(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){yr.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&zp!==null&&!yr.forceDisallow_}static previouslyFailed(){return ro.isInMemoryStorage||ro.get("previous_websocket_failure")===!0}markConnectionHealthy(){ro.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const r=sd(n);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(V(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const n=_t(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=sN(n,JU);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(XU))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}yr.responsesRequiredToBeHealthy=2;yr.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Ba,yr]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const n=yr&&yr.isAvailable();let r=n&&!yr.previouslyFailed();if(e.webSocketOnly&&(n||vn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[yr];else{const s=this.transports_=[];for(const i of od.ALL_TRANSPORTS)i&&i.isAvailable()&&s.push(i);od.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}od.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZU=6e4,e6=5e3,t6=10*1024,n6=100*1024,vv="t",iC="d",r6="s",oC="r",s6="e",aC="o",lC="a",uC="n",cC="p",i6="h";class o6{constructor(e,n,r,s,i,o,a,l,c,d){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=s,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Jd("c:"+this.id+":"),this.transportManager_=new od(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=bc(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>n6?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>t6?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(vv in e){const n=e[vv];n===lC?this.upgradeIfSecondaryHealthy_():n===oC?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===aC&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=Mu("t",e),r=Mu("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:cC,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:lC,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:uC,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=Mu("t",e),r=Mu("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=Mu(vv,e);if(iC in e){const r=e[iC];if(n===i6){const s=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(n===uC){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===r6?this.onConnectionShutdown_(r):n===oC?this.onReset_(r):n===s6?N0("Server Error: "+r):n===aC?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):N0("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),p1!==r&&vn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),bc(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(ZU))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):bc(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(e6))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:cC,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(ro.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EN{put(e,n,r,s){}merge(e,n,r,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bN{constructor(e){this.allowedEvents_=e,this.listeners_={},V(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let s=0;s<r.length;s++)r[s].callback.apply(r[s].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const s=this.getInitialEvent(e);s&&n.apply(r,s)}off(e,n,r){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let i=0;i<s.length;i++)if(s[i].callback===n&&(!r||r===s[i].context)){s.splice(i,1);return}}validateEventType_(e){V(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wp extends bN{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!HP()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Wp}getInitialEvent(e){return V(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dC=32,hC=768;class je{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[r]=this.pieces_[s],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function Re(){return new je("")}function pe(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Si(t){return t.pieces_.length-t.pieceNum_}function Me(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new je(t.pieces_,e)}function g1(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function a6(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function ad(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function SN(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new je(e,0)}function nt(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof je)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let s=0;s<r.length;s++)r[s].length>0&&n.push(r[s])}return new je(n,0)}function ye(t){return t.pieceNum_>=t.pieces_.length}function yn(t,e){const n=pe(t),r=pe(e);if(n===null)return e;if(n===r)return yn(Me(t),Me(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function l6(t,e){const n=ad(t,0),r=ad(e,0);for(let s=0;s<n.length&&s<r.length;s++){const i=Xo(n[s],r[s]);if(i!==0)return i}return n.length===r.length?0:n.length<r.length?-1:1}function v1(t,e){if(Si(t)!==Si(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function er(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(Si(t)>Si(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class u6{constructor(e,n){this.errorPrefix_=n,this.parts_=ad(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Nm(this.parts_[r]);CN(this)}}function c6(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Nm(e),CN(t)}function d6(t){const e=t.parts_.pop();t.byteLength_-=Nm(e),t.parts_.length>0&&(t.byteLength_-=1)}function CN(t){if(t.byteLength_>hC)throw new Error(t.errorPrefix_+"has a key path longer than "+hC+" bytes ("+t.byteLength_+").");if(t.parts_.length>dC)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+dC+") or object contains a cycle "+qi(t))}function qi(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _1 extends bN{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new _1}getInitialEvent(e){return V(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lu=1e3,h6=60*5*1e3,fC=30*1e3,f6=1.3,p6=3e4,y6="server_kill",pC=3;class gs extends EN{constructor(e,n,r,s,i,o,a,l){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=i,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=gs.nextPersistentConnectionId_++,this.log_=Jd("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Lu,this.maxReconnectDelay_=h6,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!GP())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");_1.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Wp.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,r){const s=++this.requestNumber_,i={r:s,a:e,b:n};this.log_(_t(i)),V(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),r&&(this.requestCBHash_[s]=r)}get(e){this.initConnection_();const n=new Qd,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),n.promise}listen(e,n,r,s){this.initConnection_();const i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),V(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),V(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");const a={onComplete:s,hashFn:n,query:e,tag:r};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(e){const n=e.query,r=n._path.toString(),s=n._queryIdentifier;this.log_("Listen on "+r+" for "+s);const i={p:r},o="q";e.tag&&(i.q=n._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest(o,i,a=>{const l=a.d,c=a.s;gs.warnOnListenWarnings_(l,n),(this.listens.get(r)&&this.listens.get(r).get(s))===e&&(this.log_("listen response",a),c!=="ok"&&this.removeListen_(r,s),e.onComplete&&e.onComplete(c,l))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&ts(e,"w")){const r=Vl(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const s='".indexOn": "'+n._queryParams.getIndex().toString()+'"',i=n._path.toString();vn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${i} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||cV(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=fC)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=uV(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,s=>{const i=s.s,o=s.d||"error";this.authToken_===e&&(i==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(i,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,r=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(e,n){const r=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),V(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,e._queryObject,n)}sendUnlisten_(e,n,r,s){this.log_("Unlisten on "+e+" for "+n);const i={p:e},o="n";s&&(i.q=r,i.t=s),this.sendRequest(o,i)}onDisconnectPut(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:r})}onDisconnectMerge(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:r})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,r,s){const i={p:n,d:r};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,o=>{s&&setTimeout(()=>{s(o.s,o.d)},Math.floor(0))})}put(e,n,r,s){this.putInternal("p",e,n,r,s)}merge(e,n,r,s){this.putInternal("m",e,n,r,s)}putInternal(e,n,r,s,i){this.initConnection_();const o={p:n,d:r};i!==void 0&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:s}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,i=>{this.log_(n+" response",i),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(i.s,i.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){const i=r.d;this.log_("reportStats","Error sending stats: "+i)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+_t(e));const n=e.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):N0("Unrecognized action received from server: "+_t(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){V(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Lu,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Lu,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>p6&&(this.reconnectDelay_=Lu),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*f6)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+gs.nextConnectionId_++,i=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,r())},c=function(h){V(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(h)};this.realtime_={close:l,sendRequest:c};const d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[h,f]=await Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);o?Vt("getToken() completed but was canceled"):(Vt("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=f&&f.token,a=new o6(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,p=>{vn(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(y6)},i))}catch(h){this.log_("Failed to get token: "+h),o||(this.repoInfo_.nodeAdmin&&vn(h),l())}}}interrupt(e){Vt("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Vt("Resuming connection for reason: "+e),delete this.interruptReasons_[e],qS(this.interruptReasons_)&&(this.reconnectDelay_=Lu,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let r;n?r=n.map(i=>f1(i)).join("$"):r="default";const s=this.removeListen_(e,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,n){const r=new je(e).toString();let s;if(this.listens.has(r)){const i=this.listens.get(r);s=i.get(n),i.delete(n),i.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(e,n){Vt("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=pC&&(this.reconnectDelay_=fC,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){Vt("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=pC&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+tN.replace(/\./g,"-")]=1,HP()?e["framework.cordova"]=1:rV()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Wp.getInstance().currentlyOnline();return qS(this.interruptReasons_)&&e}}gs.nextPersistentConnectionId_=0;gs.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ge{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new ge(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new ge(Uo,e),s=new ge(Uo,n);return this.compare(r,s)!==0}minPost(){return ge.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tf;class AN extends jm{static get __EMPTY_NODE(){return tf}static set __EMPTY_NODE(e){tf=e}compare(e,n){return Xo(e.name,n.name)}isDefinedOn(e){throw yu("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return ge.MIN}maxPost(){return new ge(bi,tf)}makePost(e,n){return V(typeof e=="string","KeyIndex indexValue must always be a string."),new ge(e,tf)}toString(){return".key"}}const wo=new AN;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nf=class{constructor(e,n,r,s,i=null){this.isReverse_=s,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,s&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},jn=class ec{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??ec.RED,this.left=s??Vr.EMPTY_NODE,this.right=i??Vr.EMPTY_NODE}copy(e,n,r,s,i){return new ec(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return i<0?s=s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s=s.copy(null,n,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Vr.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let r,s;if(r=this,n(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(e,r.key)===0){if(r.right.isEmpty())return Vr.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,ec.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,ec.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}};jn.RED=!0;jn.BLACK=!1;class m6{copy(e,n,r,s,i){return this}insert(e,n,r){return new jn(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}let Vr=class Lf{constructor(e,n=Lf.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new Lf(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,jn.BLACK,null,null))}remove(e){return new Lf(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,jn.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,s=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return s?s.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(s=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new nf(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new nf(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new nf(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new nf(this.root_,null,this.comparator_,!0,e)}};Vr.EMPTY_NODE=new m6;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g6(t,e){return Xo(t.name,e.name)}function x1(t,e){return Xo(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let O0;function v6(t){O0=t}const TN=function(t){return typeof t=="number"?"number:"+iN(t):"string:"+t},IN=function(t){if(t.isLeafNode()){const e=t.val();V(typeof e=="string"||typeof e=="number"||typeof e=="object"&&ts(e,".sv"),"Priority must be a string or number.")}else V(t===O0||t.isEmpty(),"priority of unexpected type.");V(t===O0||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yC;class Rt{constructor(e,n=Rt.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,V(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),IN(this.priorityNode_)}static set __childrenNodeConstructor(e){yC=e}static get __childrenNodeConstructor(){return yC}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Rt(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Rt.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return ye(e)?this:pe(e)===".priority"?this.priorityNode_:Rt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:Rt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const r=pe(e);return r===null?n:n.isEmpty()&&r!==".priority"?this:(V(r!==".priority"||Si(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,Rt.__childrenNodeConstructor.EMPTY_NODE.updateChild(Me(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+TN(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=iN(this.value_):e+=this.value_,this.lazyHash_=rN(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Rt.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Rt.__childrenNodeConstructor?-1:(V(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,r=typeof this.value_,s=Rt.VALUE_TYPE_ORDER.indexOf(n),i=Rt.VALUE_TYPE_ORDER.indexOf(r);return V(s>=0,"Unknown leaf type: "+n),V(i>=0,"Unknown leaf type: "+r),s===i?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}Rt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kN,RN;function _6(t){kN=t}function x6(t){RN=t}class w6 extends jm{compare(e,n){const r=e.node.getPriority(),s=n.node.getPriority(),i=r.compareTo(s);return i===0?Xo(e.name,n.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return ge.MIN}maxPost(){return new ge(bi,new Rt("[PRIORITY-POST]",RN))}makePost(e,n){const r=kN(e);return new ge(n,new Rt("[PRIORITY-POST]",r))}toString(){return".priority"}}const Ye=new w6;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E6=Math.log(2);class b6{constructor(e){const n=i=>parseInt(Math.log(i)/E6,10),r=i=>parseInt(Array(i+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const s=r(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const qp=function(t,e,n,r){t.sort(e);const s=function(l,c){const d=c-l;let h,f;if(d===0)return null;if(d===1)return h=t[l],f=n?n(h):h,new jn(f,h.node,jn.BLACK,null,null);{const p=parseInt(d/2,10)+l,y=s(l,p),v=s(p+1,c);return h=t[p],f=n?n(h):h,new jn(f,h.node,jn.BLACK,y,v)}},i=function(l){let c=null,d=null,h=t.length;const f=function(y,v){const _=h-y,g=h;h-=y;const m=s(_+1,g),w=t[_],E=n?n(w):w;p(new jn(E,w.node,v,null,m))},p=function(y){c?(c.left=y,c=y):(d=y,c=y)};for(let y=0;y<l.count;++y){const v=l.nextBitIsOne(),_=Math.pow(2,l.count-(y+1));v?f(_,jn.BLACK):(f(_,jn.BLACK),f(_,jn.RED))}return d},o=new b6(t.length),a=i(o);return new Vr(r||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _v;const oa={};class fs{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return V(oa&&Ye,"ChildrenNode.ts has not been loaded"),_v=_v||new fs({".priority":oa},{".priority":Ye}),_v}get(e){const n=Vl(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Vr?n:null}hasIndex(e){return ts(this.indexSet_,e.toString())}addIndex(e,n){V(e!==wo,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let s=!1;const i=n.getIterator(ge.Wrap);let o=i.getNext();for(;o;)s=s||e.isDefinedOn(o.node),r.push(o),o=i.getNext();let a;s?a=qp(r,e.getCompare()):a=oa;const l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;const d=Object.assign({},this.indexes_);return d[l]=a,new fs(d,c)}addToIndexes(e,n){const r=Up(this.indexes_,(s,i)=>{const o=Vl(this.indexSet_,i);if(V(o,"Missing index implementation for "+i),s===oa)if(o.isDefinedOn(e.node)){const a=[],l=n.getIterator(ge.Wrap);let c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),qp(a,o.getCompare())}else return oa;else{const a=n.get(e.name);let l=s;return a&&(l=l.remove(new ge(e.name,a))),l.insert(e,e.node)}});return new fs(r,this.indexSet_)}removeFromIndexes(e,n){const r=Up(this.indexes_,s=>{if(s===oa)return s;{const i=n.get(e.name);return i?s.remove(new ge(e.name,i)):s}});return new fs(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vu;class oe{constructor(e,n,r){this.children_=e,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&IN(this.priorityNode_),this.children_.isEmpty()&&V(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Vu||(Vu=new oe(new Vr(x1),null,fs.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Vu}updatePriority(e){return this.children_.isEmpty()?this:new oe(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?Vu:n}}getChild(e){const n=pe(e);return n===null?this:this.getImmediateChild(n).getChild(Me(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(V(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const r=new ge(e,n);let s,i;n.isEmpty()?(s=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(e,n),i=this.indexMap_.addToIndexes(r,this.children_));const o=s.isEmpty()?Vu:this.priorityNode_;return new oe(s,o,i)}}updateChild(e,n){const r=pe(e);if(r===null)return n;{V(pe(e)!==".priority"||Si(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(r).updateChild(Me(e),n);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let r=0,s=0,i=!0;if(this.forEachChild(Ye,(o,a)=>{n[o]=a.val(e),r++,i&&oe.INTEGER_REGEXP_.test(o)?s=Math.max(s,Number(o)):i=!1}),!e&&i&&s<2*r){const o=[];for(const a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+TN(this.getPriority().val())+":"),this.forEachChild(Ye,(n,r)=>{const s=r.hash();s!==""&&(e+=":"+n+":"+s)}),this.lazyHash_=e===""?"":rN(e)}return this.lazyHash_}getPredecessorChildName(e,n,r){const s=this.resolveIndex_(r);if(s){const i=s.getPredecessorKey(new ge(e,n));return i?i.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new ge(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new ge(n,this.children_.get(n)):null}forEachChild(e,n){const r=this.resolveIndex_(e);return r?r.inorderTraversal(s=>n(s.name,s.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,ge.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,e)<0;)s.getNext(),i=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,ge.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,e)>0;)s.getNext(),i=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Xd?-1:0}withIndex(e){if(e===wo||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new oe(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===wo||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const r=this.getIterator(Ye),s=n.getIterator(Ye);let i=r.getNext(),o=s.getNext();for(;i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=r.getNext(),o=s.getNext()}return i===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===wo?null:this.indexMap_.get(e.toString())}}oe.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class S6 extends oe{constructor(){super(new Vr(x1),oe.EMPTY_NODE,fs.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return oe.EMPTY_NODE}isEmpty(){return!1}}const Xd=new S6;Object.defineProperties(ge,{MIN:{value:new ge(Uo,oe.EMPTY_NODE)},MAX:{value:new ge(bi,Xd)}});AN.__EMPTY_NODE=oe.EMPTY_NODE;Rt.__childrenNodeConstructor=oe;v6(Xd);x6(Xd);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C6=!0;function vt(t,e=null){if(t===null)return oe.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),V(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new Rt(n,vt(e))}if(!(t instanceof Array)&&C6){const n=[];let r=!1;if(Kt(t,(o,a)=>{if(o.substring(0,1)!=="."){const l=vt(a);l.isEmpty()||(r=r||!l.getPriority().isEmpty(),n.push(new ge(o,l)))}}),n.length===0)return oe.EMPTY_NODE;const i=qp(n,g6,o=>o.name,x1);if(r){const o=qp(n,Ye.getCompare());return new oe(i,vt(e),new fs({".priority":o},{".priority":Ye}))}else return new oe(i,vt(e),fs.Default)}else{let n=oe.EMPTY_NODE;return Kt(t,(r,s)=>{if(ts(t,r)&&r.substring(0,1)!=="."){const i=vt(s);(i.isLeafNode()||!i.isEmpty())&&(n=n.updateImmediateChild(r,i))}}),n.updatePriority(vt(e))}}_6(vt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w1 extends jm{constructor(e){super(),this.indexPath_=e,V(!ye(e)&&pe(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),s=this.extractChild(n.node),i=r.compareTo(s);return i===0?Xo(e.name,n.name):i}makePost(e,n){const r=vt(e),s=oe.EMPTY_NODE.updateChild(this.indexPath_,r);return new ge(n,s)}maxPost(){const e=oe.EMPTY_NODE.updateChild(this.indexPath_,Xd);return new ge(bi,e)}toString(){return ad(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A6 extends jm{compare(e,n){const r=e.node.compareTo(n.node);return r===0?Xo(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return ge.MIN}maxPost(){return ge.MAX}makePost(e,n){const r=vt(e);return new ge(n,r)}toString(){return".value"}}const PN=new A6;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NN(t){return{type:"value",snapshotNode:t}}function Bl(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function ld(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function ud(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function T6(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E1{constructor(e){this.index_=e}updateChild(e,n,r,s,i,o){V(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(s).equals(r.getChild(s))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(ld(n,a)):V(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Bl(n,r)):o.trackChildChange(ud(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Ye,(s,i)=>{n.hasChild(s)||r.trackChildChange(ld(s,i))}),n.isLeafNode()||n.forEachChild(Ye,(s,i)=>{if(e.hasChild(s)){const o=e.getImmediateChild(s);o.equals(i)||r.trackChildChange(ud(s,i,o))}else r.trackChildChange(Bl(s,i))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?oe.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd{constructor(e){this.indexedFilter_=new E1(e.getIndex()),this.index_=e.getIndex(),this.startPost_=cd.getStartPost_(e),this.endPost_=cd.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,s,i,o){return this.matches(new ge(n,r))||(r=oe.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,s,i,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=oe.EMPTY_NODE);let s=n.withIndex(this.index_);s=s.updatePriority(oe.EMPTY_NODE);const i=this;return n.forEachChild(Ye,(o,a)=>{i.matches(new ge(o,a))||(s=s.updateImmediateChild(o,oe.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I6{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{const r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new cd(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,s,i,o){return this.rangedFilter_.matches(new ge(n,r))||(r=oe.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,s,i,o):this.fullLimitUpdateChild_(e,n,r,i,o)}updateFullNode(e,n,r){let s;if(n.isLeafNode()||n.isEmpty())s=oe.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){s=oe.EMPTY_NODE.withIndex(this.index_);let i;this.reverse_?i=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):i=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;i.hasNext()&&o<this.limit_;){const a=i.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))s=s.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{s=n.withIndex(this.index_),s=s.updatePriority(oe.EMPTY_NODE);let i;this.reverse_?i=s.getReverseIterator(this.index_):i=s.getIterator(this.index_);let o=0;for(;i.hasNext();){const a=i.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:s=s.updateImmediateChild(a.name,oe.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,s,i){let o;if(this.reverse_){const h=this.index_.getCompare();o=(f,p)=>h(p,f)}else o=this.index_.getCompare();const a=e;V(a.numChildren()===this.limit_,"");const l=new ge(n,r),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),d=this.rangedFilter_.matches(l);if(a.hasChild(n)){const h=a.getImmediateChild(n);let f=s.getChildAfterChild(this.index_,c,this.reverse_);for(;f!=null&&(f.name===n||a.hasChild(f.name));)f=s.getChildAfterChild(this.index_,f,this.reverse_);const p=f==null?1:o(f,l);if(d&&!r.isEmpty()&&p>=0)return i!=null&&i.trackChildChange(ud(n,r,h)),a.updateImmediateChild(n,r);{i!=null&&i.trackChildChange(ld(n,h));const v=a.updateImmediateChild(n,oe.EMPTY_NODE);return f!=null&&this.rangedFilter_.matches(f)?(i!=null&&i.trackChildChange(Bl(f.name,f.node)),v.updateImmediateChild(f.name,f.node)):v}}else return r.isEmpty()?e:d&&o(c,l)>=0?(i!=null&&(i.trackChildChange(ld(c.name,c.node)),i.trackChildChange(Bl(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(c.name,oe.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b1{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ye}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return V(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return V(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Uo}hasEnd(){return this.endSet_}getIndexEndValue(){return V(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return V(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:bi}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return V(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ye}copy(){const e=new b1;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function k6(t){return t.loadsAllData()?new E1(t.getIndex()):t.hasLimit()?new I6(t):new cd(t)}function R6(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function P6(t,e,n){const r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function N6(t,e,n){const r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function j6(t,e){const n=t.copy();return n.index_=e,n}function mC(t){const e={};if(t.isDefault())return e;let n;if(t.index_===Ye?n="$priority":t.index_===PN?n="$value":t.index_===wo?n="$key":(V(t.index_ instanceof w1,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=_t(n),t.startSet_){const r=t.startAfterSet_?"startAfter":"startAt";e[r]=_t(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+_t(t.indexStartName_))}if(t.endSet_){const r=t.endBeforeSet_?"endBefore":"endAt";e[r]=_t(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+_t(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function gC(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Ye&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hp extends EN{constructor(e,n,r,s){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=s,this.log_=Jd("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(V(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,s){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const o=Hp.getListenId_(e,r),a={};this.listens_[o]=a;const l=mC(e._queryParams);this.restRequest_(i+".json",l,(c,d)=>{let h=d;if(c===404&&(h=null,c=null),c===null&&this.onDataUpdate_(i,h,!1,r),Vl(this.listens_,o)===a){let f;c?c===401?f="permission_denied":f="rest_error:"+c:f="ok",s(f,null)}})}unlisten(e,n){const r=Hp.getListenId_(e,n);delete this.listens_[r]}get(e){const n=mC(e._queryParams),r=e._path.toString(),s=new Qd;return this.restRequest_(r+".json",n,(i,o)=>{let a=o;i===404&&(a=null,i=null),i===null?(this.onDataUpdate_(r,a,!1,null),s.resolve(a)):s.reject(new Error(a))}),s.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,i])=>{s&&s.accessToken&&(n.auth=s.accessToken),i&&i.token&&(n.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+dV(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=sd(a.responseText)}catch{vn("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,l)}else a.status!==401&&a.status!==404&&vn("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O6{constructor(){this.rootNode_=oe.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gp(){return{value:null,children:new Map}}function jN(t,e,n){if(ye(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const r=pe(e);t.children.has(r)||t.children.set(r,Gp());const s=t.children.get(r);e=Me(e),jN(s,e,n)}}function D0(t,e,n){t.value!==null?n(e,t.value):D6(t,(r,s)=>{const i=new je(e.toString()+"/"+r);D0(s,i,n)})}function D6(t,e){t.children.forEach((n,r)=>{e(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F6{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&Kt(this.last_,(r,s)=>{n[r]=n[r]-s}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vC=10*1e3,$6=30*1e3,M6=5*60*1e3;class L6{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new F6(e);const r=vC+($6-vC)*Math.random();bc(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;Kt(e,(s,i)=>{i>0&&ts(this.statsToReport_,s)&&(n[s]=i,r=!0)}),r&&this.server_.reportStats(n),bc(this.reportStats_.bind(this),Math.floor(Math.random()*2*M6))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gr;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(gr||(gr={}));function S1(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function C1(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function A1(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qp{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=gr.ACK_USER_WRITE,this.source=S1()}operationForChild(e){if(ye(this.path)){if(this.affectedTree.value!=null)return V(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new je(e));return new Qp(Re(),n,this.revert)}}else return V(pe(this.path)===e,"operationForChild called for unrelated child."),new Qp(Me(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{constructor(e,n){this.source=e,this.path=n,this.type=gr.LISTEN_COMPLETE}operationForChild(e){return ye(this.path)?new dd(this.source,Re()):new dd(this.source,Me(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=gr.OVERWRITE}operationForChild(e){return ye(this.path)?new Bo(this.source,Re(),this.snap.getImmediateChild(e)):new Bo(this.source,Me(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zl{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=gr.MERGE}operationForChild(e){if(ye(this.path)){const n=this.children.subtree(new je(e));return n.isEmpty()?null:n.value?new Bo(this.source,Re(),n.value):new zl(this.source,Re(),n)}else return V(pe(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new zl(this.source,Me(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ye(e))return this.isFullyInitialized()&&!this.filtered_;const n=pe(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V6{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function U6(t,e,n,r){const s=[],i=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&i.push(T6(o.childName,o.snapshotNode))}),Uu(t,s,"child_removed",e,r,n),Uu(t,s,"child_added",e,r,n),Uu(t,s,"child_moved",i,r,n),Uu(t,s,"child_changed",e,r,n),Uu(t,s,"value",e,r,n),s}function Uu(t,e,n,r,s,i){const o=r.filter(a=>a.type===n);o.sort((a,l)=>z6(t,a,l)),o.forEach(a=>{const l=B6(t,a,i);s.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,t.query_))})})}function B6(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function z6(t,e,n){if(e.childName==null||n.childName==null)throw yu("Should only compare child_ events.");const r=new ge(e.childName,e.snapshotNode),s=new ge(n.childName,n.snapshotNode);return t.index_.compare(r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Om(t,e){return{eventCache:t,serverCache:e}}function Sc(t,e,n,r){return Om(new Ci(e,n,r),t.serverCache)}function ON(t,e,n,r){return Om(t.eventCache,new Ci(e,n,r))}function Kp(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function zo(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xv;const W6=()=>(xv||(xv=new Vr(AU)),xv);class $e{constructor(e,n=W6()){this.value=e,this.children=n}static fromObject(e){let n=new $e(null);return Kt(e,(r,s)=>{n=n.set(new je(r),s)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:Re(),value:this.value};if(ye(e))return null;{const r=pe(e),s=this.children.get(r);if(s!==null){const i=s.findRootMostMatchingPathAndValue(Me(e),n);return i!=null?{path:nt(new je(r),i.path),value:i.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ye(e))return this;{const n=pe(e),r=this.children.get(n);return r!==null?r.subtree(Me(e)):new $e(null)}}set(e,n){if(ye(e))return new $e(n,this.children);{const r=pe(e),i=(this.children.get(r)||new $e(null)).set(Me(e),n),o=this.children.insert(r,i);return new $e(this.value,o)}}remove(e){if(ye(e))return this.children.isEmpty()?new $e(null):new $e(null,this.children);{const n=pe(e),r=this.children.get(n);if(r){const s=r.remove(Me(e));let i;return s.isEmpty()?i=this.children.remove(n):i=this.children.insert(n,s),this.value===null&&i.isEmpty()?new $e(null):new $e(this.value,i)}else return this}}get(e){if(ye(e))return this.value;{const n=pe(e),r=this.children.get(n);return r?r.get(Me(e)):null}}setTree(e,n){if(ye(e))return n;{const r=pe(e),i=(this.children.get(r)||new $e(null)).setTree(Me(e),n);let o;return i.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,i),new $e(this.value,o)}}fold(e){return this.fold_(Re(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((s,i)=>{r[s]=i.fold_(nt(e,s),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,Re(),n)}findOnPath_(e,n,r){const s=this.value?r(n,this.value):!1;if(s)return s;if(ye(e))return null;{const i=pe(e),o=this.children.get(i);return o?o.findOnPath_(Me(e),nt(n,i),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,Re(),n)}foreachOnPath_(e,n,r){if(ye(e))return this;{this.value&&r(n,this.value);const s=pe(e),i=this.children.get(s);return i?i.foreachOnPath_(Me(e),nt(n,s),r):new $e(null)}}foreach(e){this.foreach_(Re(),e)}foreach_(e,n){this.children.inorderTraversal((r,s)=>{s.foreach_(nt(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(e){this.writeTree_=e}static empty(){return new br(new $e(null))}}function Cc(t,e,n){if(ye(e))return new br(new $e(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){const s=r.path;let i=r.value;const o=yn(s,e);return i=i.updateChild(o,n),new br(t.writeTree_.set(s,i))}else{const s=new $e(n),i=t.writeTree_.setTree(e,s);return new br(i)}}}function F0(t,e,n){let r=t;return Kt(n,(s,i)=>{r=Cc(r,nt(e,s),i)}),r}function _C(t,e){if(ye(e))return br.empty();{const n=t.writeTree_.setTree(e,new $e(null));return new br(n)}}function $0(t,e){return Zo(t,e)!=null}function Zo(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(yn(n.path,e)):null}function xC(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Ye,(r,s)=>{e.push(new ge(r,s))}):t.writeTree_.children.inorderTraversal((r,s)=>{s.value!=null&&e.push(new ge(r,s.value))}),e}function mi(t,e){if(ye(e))return t;{const n=Zo(t,e);return n!=null?new br(new $e(n)):new br(t.writeTree_.subtree(e))}}function M0(t){return t.writeTree_.isEmpty()}function Wl(t,e){return DN(Re(),t.writeTree_,e)}function DN(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((s,i)=>{s===".priority"?(V(i.value!==null,"Priority writes must always be leaf nodes"),r=i.value):n=DN(nt(t,s),i,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(nt(t,".priority"),r)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dm(t,e){return LN(e,t)}function q6(t,e,n,r,s){V(r>t.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:s}),s&&(t.visibleWrites=Cc(t.visibleWrites,e,n)),t.lastWriteId=r}function H6(t,e,n,r){V(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=F0(t.visibleWrites,e,n),t.lastWriteId=r}function G6(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}function Q6(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);V(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let s=r.visible,i=!1,o=t.allWrites.length-1;for(;s&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&K6(a,r.path)?s=!1:er(r.path,a.path)&&(i=!0)),o--}if(s){if(i)return Y6(t),!0;if(r.snap)t.visibleWrites=_C(t.visibleWrites,r.path);else{const a=r.children;Kt(a,l=>{t.visibleWrites=_C(t.visibleWrites,nt(r.path,l))})}return!0}else return!1}function K6(t,e){if(t.snap)return er(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&er(nt(t.path,n),e))return!0;return!1}function Y6(t){t.visibleWrites=FN(t.allWrites,J6,Re()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function J6(t){return t.visible}function FN(t,e,n){let r=br.empty();for(let s=0;s<t.length;++s){const i=t[s];if(e(i)){const o=i.path;let a;if(i.snap)er(n,o)?(a=yn(n,o),r=Cc(r,a,i.snap)):er(o,n)&&(a=yn(o,n),r=Cc(r,Re(),i.snap.getChild(a)));else if(i.children){if(er(n,o))a=yn(n,o),r=F0(r,a,i.children);else if(er(o,n))if(a=yn(o,n),ye(a))r=F0(r,Re(),i.children);else{const l=Vl(i.children,pe(a));if(l){const c=l.getChild(Me(a));r=Cc(r,Re(),c)}}}else throw yu("WriteRecord should have .snap or .children")}}return r}function $N(t,e,n,r,s){if(!r&&!s){const i=Zo(t.visibleWrites,e);if(i!=null)return i;{const o=mi(t.visibleWrites,e);if(M0(o))return n;if(n==null&&!$0(o,Re()))return null;{const a=n||oe.EMPTY_NODE;return Wl(o,a)}}}else{const i=mi(t.visibleWrites,e);if(!s&&M0(i))return n;if(!s&&n==null&&!$0(i,Re()))return null;{const o=function(c){return(c.visible||s)&&(!r||!~r.indexOf(c.writeId))&&(er(c.path,e)||er(e,c.path))},a=FN(t.allWrites,o,e),l=n||oe.EMPTY_NODE;return Wl(a,l)}}}function X6(t,e,n){let r=oe.EMPTY_NODE;const s=Zo(t.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(Ye,(i,o)=>{r=r.updateImmediateChild(i,o)}),r;if(n){const i=mi(t.visibleWrites,e);return n.forEachChild(Ye,(o,a)=>{const l=Wl(mi(i,new je(o)),a);r=r.updateImmediateChild(o,l)}),xC(i).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const i=mi(t.visibleWrites,e);return xC(i).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function Z6(t,e,n,r,s){V(r||s,"Either existingEventSnap or existingServerSnap must exist");const i=nt(e,n);if($0(t.visibleWrites,i))return null;{const o=mi(t.visibleWrites,i);return M0(o)?s.getChild(n):Wl(o,s.getChild(n))}}function eB(t,e,n,r){const s=nt(e,n),i=Zo(t.visibleWrites,s);if(i!=null)return i;if(r.isCompleteForChild(n)){const o=mi(t.visibleWrites,s);return Wl(o,r.getNode().getImmediateChild(n))}else return null}function tB(t,e){return Zo(t.visibleWrites,e)}function nB(t,e,n,r,s,i,o){let a;const l=mi(t.visibleWrites,e),c=Zo(l,Re());if(c!=null)a=c;else if(n!=null)a=Wl(l,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const d=[],h=o.getCompare(),f=i?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let p=f.getNext();for(;p&&d.length<s;)h(p,r)!==0&&d.push(p),p=f.getNext();return d}else return[]}function rB(){return{visibleWrites:br.empty(),allWrites:[],lastWriteId:-1}}function Yp(t,e,n,r){return $N(t.writeTree,t.treePath,e,n,r)}function T1(t,e){return X6(t.writeTree,t.treePath,e)}function wC(t,e,n,r){return Z6(t.writeTree,t.treePath,e,n,r)}function Jp(t,e){return tB(t.writeTree,nt(t.treePath,e))}function sB(t,e,n,r,s,i){return nB(t.writeTree,t.treePath,e,n,r,s,i)}function I1(t,e,n){return eB(t.writeTree,t.treePath,e,n)}function MN(t,e){return LN(nt(t.treePath,e),t.writeTree)}function LN(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iB{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;V(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),V(r!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(r);if(s){const i=s.type;if(n==="child_added"&&i==="child_removed")this.changeMap.set(r,ud(r,e.snapshotNode,s.snapshotNode));else if(n==="child_removed"&&i==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&i==="child_changed")this.changeMap.set(r,ld(r,s.oldSnap));else if(n==="child_changed"&&i==="child_added")this.changeMap.set(r,Bl(r,e.snapshotNode));else if(n==="child_changed"&&i==="child_changed")this.changeMap.set(r,ud(r,e.snapshotNode,s.oldSnap));else throw yu("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oB{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}}const VN=new oB;class k1{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new Ci(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return I1(this.writes_,e,r)}}getChildAfterChild(e,n,r){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:zo(this.viewCache_),i=sB(this.writes_,s,n,1,r,e);return i.length===0?null:i[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aB(t){return{filter:t}}function lB(t,e){V(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),V(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function uB(t,e,n,r,s){const i=new iB;let o,a;if(n.type===gr.OVERWRITE){const c=n;c.source.fromUser?o=L0(t,e,c.path,c.snap,r,s,i):(V(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!ye(c.path),o=Xp(t,e,c.path,c.snap,r,s,a,i))}else if(n.type===gr.MERGE){const c=n;c.source.fromUser?o=dB(t,e,c.path,c.children,r,s,i):(V(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=V0(t,e,c.path,c.children,r,s,a,i))}else if(n.type===gr.ACK_USER_WRITE){const c=n;c.revert?o=pB(t,e,c.path,r,s,i):o=hB(t,e,c.path,c.affectedTree,r,s,i)}else if(n.type===gr.LISTEN_COMPLETE)o=fB(t,e,n.path,r,i);else throw yu("Unknown operation type: "+n.type);const l=i.getChanges();return cB(e,o,l),{viewCache:o,changes:l}}function cB(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const s=r.getNode().isLeafNode()||r.getNode().isEmpty(),i=Kp(t);(n.length>0||!t.eventCache.isFullyInitialized()||s&&!r.getNode().equals(i)||!r.getNode().getPriority().equals(i.getPriority()))&&n.push(NN(Kp(e)))}}function UN(t,e,n,r,s,i){const o=e.eventCache;if(Jp(r,n)!=null)return e;{let a,l;if(ye(n))if(V(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const c=zo(e),d=c instanceof oe?c:oe.EMPTY_NODE,h=T1(r,d);a=t.filter.updateFullNode(e.eventCache.getNode(),h,i)}else{const c=Yp(r,zo(e));a=t.filter.updateFullNode(e.eventCache.getNode(),c,i)}else{const c=pe(n);if(c===".priority"){V(Si(n)===1,"Can't have a priority with additional path components");const d=o.getNode();l=e.serverCache.getNode();const h=wC(r,n,d,l);h!=null?a=t.filter.updatePriority(d,h):a=o.getNode()}else{const d=Me(n);let h;if(o.isCompleteForChild(c)){l=e.serverCache.getNode();const f=wC(r,n,o.getNode(),l);f!=null?h=o.getNode().getImmediateChild(c).updateChild(d,f):h=o.getNode().getImmediateChild(c)}else h=I1(r,c,e.serverCache);h!=null?a=t.filter.updateChild(o.getNode(),c,h,d,s,i):a=o.getNode()}}return Sc(e,a,o.isFullyInitialized()||ye(n),t.filter.filtersNodes())}}function Xp(t,e,n,r,s,i,o,a){const l=e.serverCache;let c;const d=o?t.filter:t.filter.getIndexedFilter();if(ye(n))c=d.updateFullNode(l.getNode(),r,null);else if(d.filtersNodes()&&!l.isFiltered()){const p=l.getNode().updateChild(n,r);c=d.updateFullNode(l.getNode(),p,null)}else{const p=pe(n);if(!l.isCompleteForPath(n)&&Si(n)>1)return e;const y=Me(n),_=l.getNode().getImmediateChild(p).updateChild(y,r);p===".priority"?c=d.updatePriority(l.getNode(),_):c=d.updateChild(l.getNode(),p,_,y,VN,null)}const h=ON(e,c,l.isFullyInitialized()||ye(n),d.filtersNodes()),f=new k1(s,h,i);return UN(t,h,n,s,f,a)}function L0(t,e,n,r,s,i,o){const a=e.eventCache;let l,c;const d=new k1(s,e,i);if(ye(n))c=t.filter.updateFullNode(e.eventCache.getNode(),r,o),l=Sc(e,c,!0,t.filter.filtersNodes());else{const h=pe(n);if(h===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),r),l=Sc(e,c,a.isFullyInitialized(),a.isFiltered());else{const f=Me(n),p=a.getNode().getImmediateChild(h);let y;if(ye(f))y=r;else{const v=d.getCompleteChild(h);v!=null?g1(f)===".priority"&&v.getChild(SN(f)).isEmpty()?y=v:y=v.updateChild(f,r):y=oe.EMPTY_NODE}if(p.equals(y))l=e;else{const v=t.filter.updateChild(a.getNode(),h,y,f,d,o);l=Sc(e,v,a.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function EC(t,e){return t.eventCache.isCompleteForChild(e)}function dB(t,e,n,r,s,i,o){let a=e;return r.foreach((l,c)=>{const d=nt(n,l);EC(e,pe(d))&&(a=L0(t,a,d,c,s,i,o))}),r.foreach((l,c)=>{const d=nt(n,l);EC(e,pe(d))||(a=L0(t,a,d,c,s,i,o))}),a}function bC(t,e,n){return n.foreach((r,s)=>{e=e.updateChild(r,s)}),e}function V0(t,e,n,r,s,i,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;ye(n)?c=r:c=new $e(null).setTree(n,r);const d=e.serverCache.getNode();return c.children.inorderTraversal((h,f)=>{if(d.hasChild(h)){const p=e.serverCache.getNode().getImmediateChild(h),y=bC(t,p,f);l=Xp(t,l,new je(h),y,s,i,o,a)}}),c.children.inorderTraversal((h,f)=>{const p=!e.serverCache.isCompleteForChild(h)&&f.value===null;if(!d.hasChild(h)&&!p){const y=e.serverCache.getNode().getImmediateChild(h),v=bC(t,y,f);l=Xp(t,l,new je(h),v,s,i,o,a)}}),l}function hB(t,e,n,r,s,i,o){if(Jp(s,n)!=null)return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(r.value!=null){if(ye(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return Xp(t,e,n,l.getNode().getChild(n),s,i,a,o);if(ye(n)){let c=new $e(null);return l.getNode().forEachChild(wo,(d,h)=>{c=c.set(new je(d),h)}),V0(t,e,n,c,s,i,a,o)}else return e}else{let c=new $e(null);return r.foreach((d,h)=>{const f=nt(n,d);l.isCompleteForPath(f)&&(c=c.set(d,l.getNode().getChild(f)))}),V0(t,e,n,c,s,i,a,o)}}function fB(t,e,n,r,s){const i=e.serverCache,o=ON(e,i.getNode(),i.isFullyInitialized()||ye(n),i.isFiltered());return UN(t,o,n,r,VN,s)}function pB(t,e,n,r,s,i){let o;if(Jp(r,n)!=null)return e;{const a=new k1(r,e,s),l=e.eventCache.getNode();let c;if(ye(n)||pe(n)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=Yp(r,zo(e));else{const h=e.serverCache.getNode();V(h instanceof oe,"serverChildren would be complete if leaf node"),d=T1(r,h)}d=d,c=t.filter.updateFullNode(l,d,i)}else{const d=pe(n);let h=I1(r,d,e.serverCache);h==null&&e.serverCache.isCompleteForChild(d)&&(h=l.getImmediateChild(d)),h!=null?c=t.filter.updateChild(l,d,h,Me(n),a,i):e.eventCache.getNode().hasChild(d)?c=t.filter.updateChild(l,d,oe.EMPTY_NODE,Me(n),a,i):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Yp(r,zo(e)),o.isLeafNode()&&(c=t.filter.updateFullNode(c,o,i)))}return o=e.serverCache.isFullyInitialized()||Jp(r,Re())!=null,Sc(e,c,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yB{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,s=new E1(r.getIndex()),i=k6(r);this.processor_=aB(i);const o=n.serverCache,a=n.eventCache,l=s.updateFullNode(oe.EMPTY_NODE,o.getNode(),null),c=i.updateFullNode(oe.EMPTY_NODE,a.getNode(),null),d=new Ci(l,o.isFullyInitialized(),s.filtersNodes()),h=new Ci(c,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=Om(h,d),this.eventGenerator_=new V6(this.query_)}get query(){return this.query_}}function mB(t){return t.viewCache_.serverCache.getNode()}function gB(t){return Kp(t.viewCache_)}function vB(t,e){const n=zo(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!ye(e)&&!n.getImmediateChild(pe(e)).isEmpty())?n.getChild(e):null}function SC(t){return t.eventRegistrations_.length===0}function _B(t,e){t.eventRegistrations_.push(e)}function CC(t,e,n){const r=[];if(n){V(e==null,"A cancel should cancel all event registrations.");const s=t.query._path;t.eventRegistrations_.forEach(i=>{const o=i.createCancelEvent(n,s);o&&r.push(o)})}if(e){let s=[];for(let i=0;i<t.eventRegistrations_.length;++i){const o=t.eventRegistrations_[i];if(!o.matches(e))s.push(o);else if(e.hasAnyCallback()){s=s.concat(t.eventRegistrations_.slice(i+1));break}}t.eventRegistrations_=s}else t.eventRegistrations_=[];return r}function AC(t,e,n,r){e.type===gr.MERGE&&e.source.queryId!==null&&(V(zo(t.viewCache_),"We should always have a full cache before handling merges"),V(Kp(t.viewCache_),"Missing event cache, even though we have a server cache"));const s=t.viewCache_,i=uB(t.processor_,s,e,n,r);return lB(t.processor_,i.viewCache),V(i.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=i.viewCache,BN(t,i.changes,i.viewCache.eventCache.getNode(),null)}function xB(t,e){const n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Ye,(i,o)=>{r.push(Bl(i,o))}),n.isFullyInitialized()&&r.push(NN(n.getNode())),BN(t,r,n.getNode(),e)}function BN(t,e,n,r){const s=r?[r]:t.eventRegistrations_;return U6(t.eventGenerator_,e,n,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zp;class zN{constructor(){this.views=new Map}}function wB(t){V(!Zp,"__referenceConstructor has already been defined"),Zp=t}function EB(){return V(Zp,"Reference.ts has not been loaded"),Zp}function bB(t){return t.views.size===0}function R1(t,e,n,r){const s=e.source.queryId;if(s!==null){const i=t.views.get(s);return V(i!=null,"SyncTree gave us an op for an invalid query."),AC(i,e,n,r)}else{let i=[];for(const o of t.views.values())i=i.concat(AC(o,e,n,r));return i}}function WN(t,e,n,r,s){const i=e._queryIdentifier,o=t.views.get(i);if(!o){let a=Yp(n,s?r:null),l=!1;a?l=!0:r instanceof oe?(a=T1(n,r),l=!1):(a=oe.EMPTY_NODE,l=!1);const c=Om(new Ci(a,l,!1),new Ci(r,s,!1));return new yB(e,c)}return o}function SB(t,e,n,r,s,i){const o=WN(t,e,r,s,i);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),_B(o,n),xB(o,n)}function CB(t,e,n,r){const s=e._queryIdentifier,i=[];let o=[];const a=Ai(t);if(s==="default")for(const[l,c]of t.views.entries())o=o.concat(CC(c,n,r)),SC(c)&&(t.views.delete(l),c.query._queryParams.loadsAllData()||i.push(c.query));else{const l=t.views.get(s);l&&(o=o.concat(CC(l,n,r)),SC(l)&&(t.views.delete(s),l.query._queryParams.loadsAllData()||i.push(l.query)))}return a&&!Ai(t)&&i.push(new(EB())(e._repo,e._path)),{removed:i,events:o}}function qN(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function gi(t,e){let n=null;for(const r of t.views.values())n=n||vB(r,e);return n}function HN(t,e){if(e._queryParams.loadsAllData())return Fm(t);{const r=e._queryIdentifier;return t.views.get(r)}}function GN(t,e){return HN(t,e)!=null}function Ai(t){return Fm(t)!=null}function Fm(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ey;function AB(t){V(!ey,"__referenceConstructor has already been defined"),ey=t}function TB(){return V(ey,"Reference.ts has not been loaded"),ey}let IB=1;class TC{constructor(e){this.listenProvider_=e,this.syncPointTree_=new $e(null),this.pendingWriteTree_=rB(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function QN(t,e,n,r,s){return q6(t.pendingWriteTree_,e,n,r,s),s?gu(t,new Bo(S1(),e,n)):[]}function kB(t,e,n,r){H6(t.pendingWriteTree_,e,n,r);const s=$e.fromObject(n);return gu(t,new zl(S1(),e,s))}function Xs(t,e,n=!1){const r=G6(t.pendingWriteTree_,e);if(Q6(t.pendingWriteTree_,e)){let i=new $e(null);return r.snap!=null?i=i.set(Re(),!0):Kt(r.children,o=>{i=i.set(new je(o),!0)}),gu(t,new Qp(r.path,i,n))}else return[]}function Zd(t,e,n){return gu(t,new Bo(C1(),e,n))}function RB(t,e,n){const r=$e.fromObject(n);return gu(t,new zl(C1(),e,r))}function PB(t,e){return gu(t,new dd(C1(),e))}function NB(t,e,n){const r=N1(t,n);if(r){const s=j1(r),i=s.path,o=s.queryId,a=yn(i,e),l=new dd(A1(o),a);return O1(t,i,l)}else return[]}function ty(t,e,n,r,s=!1){const i=e._path,o=t.syncPointTree_.get(i);let a=[];if(o&&(e._queryIdentifier==="default"||GN(o,e))){const l=CB(o,e,n,r);bB(o)&&(t.syncPointTree_=t.syncPointTree_.remove(i));const c=l.removed;if(a=l.events,!s){const d=c.findIndex(f=>f._queryParams.loadsAllData())!==-1,h=t.syncPointTree_.findOnPath(i,(f,p)=>Ai(p));if(d&&!h){const f=t.syncPointTree_.subtree(i);if(!f.isEmpty()){const p=DB(f);for(let y=0;y<p.length;++y){const v=p[y],_=v.query,g=XN(t,v);t.listenProvider_.startListening(Ac(_),hd(t,_),g.hashFn,g.onComplete)}}}!h&&c.length>0&&!r&&(d?t.listenProvider_.stopListening(Ac(e),null):c.forEach(f=>{const p=t.queryToTagMap.get($m(f));t.listenProvider_.stopListening(Ac(f),p)}))}FB(t,c)}return a}function KN(t,e,n,r){const s=N1(t,r);if(s!=null){const i=j1(s),o=i.path,a=i.queryId,l=yn(o,e),c=new Bo(A1(a),l,n);return O1(t,o,c)}else return[]}function jB(t,e,n,r){const s=N1(t,r);if(s){const i=j1(s),o=i.path,a=i.queryId,l=yn(o,e),c=$e.fromObject(n),d=new zl(A1(a),l,c);return O1(t,o,d)}else return[]}function U0(t,e,n,r=!1){const s=e._path;let i=null,o=!1;t.syncPointTree_.foreachOnPath(s,(f,p)=>{const y=yn(f,s);i=i||gi(p,y),o=o||Ai(p)});let a=t.syncPointTree_.get(s);a?(o=o||Ai(a),i=i||gi(a,Re())):(a=new zN,t.syncPointTree_=t.syncPointTree_.set(s,a));let l;i!=null?l=!0:(l=!1,i=oe.EMPTY_NODE,t.syncPointTree_.subtree(s).foreachChild((p,y)=>{const v=gi(y,Re());v&&(i=i.updateImmediateChild(p,v))}));const c=GN(a,e);if(!c&&!e._queryParams.loadsAllData()){const f=$m(e);V(!t.queryToTagMap.has(f),"View does not exist, but we have a tag");const p=$B();t.queryToTagMap.set(f,p),t.tagToQueryMap.set(p,f)}const d=Dm(t.pendingWriteTree_,s);let h=SB(a,e,n,d,i,l);if(!c&&!o&&!r){const f=HN(a,e);h=h.concat(MB(t,e,f))}return h}function P1(t,e,n){const s=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(o,a)=>{const l=yn(o,e),c=gi(a,l);if(c)return c});return $N(s,e,i,n,!0)}function OB(t,e){const n=e._path;let r=null;t.syncPointTree_.foreachOnPath(n,(c,d)=>{const h=yn(c,n);r=r||gi(d,h)});let s=t.syncPointTree_.get(n);s?r=r||gi(s,Re()):(s=new zN,t.syncPointTree_=t.syncPointTree_.set(n,s));const i=r!=null,o=i?new Ci(r,!0,!1):null,a=Dm(t.pendingWriteTree_,e._path),l=WN(s,e,a,i?o.getNode():oe.EMPTY_NODE,i);return gB(l)}function gu(t,e){return YN(e,t.syncPointTree_,null,Dm(t.pendingWriteTree_,Re()))}function YN(t,e,n,r){if(ye(t.path))return JN(t,e,n,r);{const s=e.get(Re());n==null&&s!=null&&(n=gi(s,Re()));let i=[];const o=pe(t.path),a=t.operationForChild(o),l=e.children.get(o);if(l&&a){const c=n?n.getImmediateChild(o):null,d=MN(r,o);i=i.concat(YN(a,l,c,d))}return s&&(i=i.concat(R1(s,t,r,n))),i}}function JN(t,e,n,r){const s=e.get(Re());n==null&&s!=null&&(n=gi(s,Re()));let i=[];return e.children.inorderTraversal((o,a)=>{const l=n?n.getImmediateChild(o):null,c=MN(r,o),d=t.operationForChild(o);d&&(i=i.concat(JN(d,a,l,c)))}),s&&(i=i.concat(R1(s,t,r,n))),i}function XN(t,e){const n=e.query,r=hd(t,n);return{hashFn:()=>(mB(e)||oe.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return r?NB(t,n._path,r):PB(t,n._path);{const i=kU(s,n);return ty(t,n,null,i)}}}}function hd(t,e){const n=$m(e);return t.queryToTagMap.get(n)}function $m(t){return t._path.toString()+"$"+t._queryIdentifier}function N1(t,e){return t.tagToQueryMap.get(e)}function j1(t){const e=t.indexOf("$");return V(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new je(t.substr(0,e))}}function O1(t,e,n){const r=t.syncPointTree_.get(e);V(r,"Missing sync point for query tag that we're tracking");const s=Dm(t.pendingWriteTree_,e);return R1(r,n,s,null)}function DB(t){return t.fold((e,n,r)=>{if(n&&Ai(n))return[Fm(n)];{let s=[];return n&&(s=qN(n)),Kt(r,(i,o)=>{s=s.concat(o)}),s}})}function Ac(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(TB())(t._repo,t._path):t}function FB(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const s=$m(r),i=t.queryToTagMap.get(s);t.queryToTagMap.delete(s),t.tagToQueryMap.delete(i)}}}function $B(){return IB++}function MB(t,e,n){const r=e._path,s=hd(t,e),i=XN(t,n),o=t.listenProvider_.startListening(Ac(e),s,i.hashFn,i.onComplete),a=t.syncPointTree_.subtree(r);if(s)V(!Ai(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((c,d,h)=>{if(!ye(c)&&d&&Ai(d))return[Fm(d).query];{let f=[];return d&&(f=f.concat(qN(d).map(p=>p.query))),Kt(h,(p,y)=>{f=f.concat(y)}),f}});for(let c=0;c<l.length;++c){const d=l[c];t.listenProvider_.stopListening(Ac(d),hd(t,d))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D1{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new D1(n)}node(){return this.node_}}class F1{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=nt(this.path_,e);return new F1(this.syncTree_,n)}node(){return P1(this.syncTree_,this.path_)}}const LB=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},IC=function(t,e,n){if(!t||typeof t!="object")return t;if(V(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return VB(t[".sv"],e,n);if(typeof t[".sv"]=="object")return UB(t[".sv"],e);V(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},VB=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:V(!1,"Unexpected server value: "+t)}},UB=function(t,e,n){t.hasOwnProperty("increment")||V(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;typeof r!="number"&&V(!1,"Unexpected increment value: "+r);const s=e.node();if(V(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return r;const o=s.getValue();return typeof o!="number"?r:o+r},ZN=function(t,e,n,r){return $1(e,new F1(n,t),r)},e2=function(t,e,n){return $1(t,new D1(e),n)};function $1(t,e,n){const r=t.getPriority().val(),s=IC(r,e.getImmediateChild(".priority"),n);let i;if(t.isLeafNode()){const o=t,a=IC(o.getValue(),e,n);return a!==o.getValue()||s!==o.getPriority().val()?new Rt(a,vt(s)):t}else{const o=t;return i=o,s!==o.getPriority().val()&&(i=i.updatePriority(new Rt(s))),o.forEachChild(Ye,(a,l)=>{const c=$1(l,e.getImmediateChild(a),n);c!==l&&(i=i.updateImmediateChild(a,c))}),i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M1{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}}function L1(t,e){let n=e instanceof je?e:new je(e),r=t,s=pe(n);for(;s!==null;){const i=Vl(r.node.children,s)||{children:{},childCount:0};r=new M1(s,r,i),n=Me(n),s=pe(n)}return r}function vu(t){return t.node.value}function t2(t,e){t.node.value=e,B0(t)}function n2(t){return t.node.childCount>0}function BB(t){return vu(t)===void 0&&!n2(t)}function Mm(t,e){Kt(t.node.children,(n,r)=>{e(new M1(n,t,r))})}function r2(t,e,n,r){n&&!r&&e(t),Mm(t,s=>{r2(s,e,!0,r)}),n&&r&&e(t)}function zB(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function eh(t){return new je(t.parent===null?t.name:eh(t.parent)+"/"+t.name)}function B0(t){t.parent!==null&&WB(t.parent,t.name,t)}function WB(t,e,n){const r=BB(n),s=ts(t.node.children,e);r&&s?(delete t.node.children[e],t.node.childCount--,B0(t)):!r&&!s&&(t.node.children[e]=n.node,t.node.childCount++,B0(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qB=/[\[\].#$\/\u0000-\u001F\u007F]/,HB=/[\[\].#$\u0000-\u001F\u007F]/,wv=10*1024*1024,Lm=function(t){return typeof t=="string"&&t.length!==0&&!qB.test(t)},s2=function(t){return typeof t=="string"&&t.length!==0&&!HB.test(t)},GB=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),s2(t)},z0=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!h1(t)||t&&typeof t=="object"&&ts(t,".sv")},th=function(t,e,n,r){r&&e===void 0||Vm(Kd(t,"value"),e,n)},Vm=function(t,e,n){const r=n instanceof je?new u6(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+qi(r));if(typeof e=="function")throw new Error(t+"contains a function "+qi(r)+" with contents = "+e.toString());if(h1(e))throw new Error(t+"contains "+e.toString()+" "+qi(r));if(typeof e=="string"&&e.length>wv/3&&Nm(e)>wv)throw new Error(t+"contains a string greater than "+wv+" utf8 bytes "+qi(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,i=!1;if(Kt(e,(o,a)=>{if(o===".value")s=!0;else if(o!==".priority"&&o!==".sv"&&(i=!0,!Lm(o)))throw new Error(t+" contains an invalid key ("+o+") "+qi(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);c6(r,o),Vm(t,a,r),d6(r)}),s&&i)throw new Error(t+' contains ".value" child '+qi(r)+" in addition to actual children.")}},QB=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];const i=ad(r);for(let o=0;o<i.length;o++)if(!(i[o]===".priority"&&o===i.length-1)){if(!Lm(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(l6);let s=null;for(n=0;n<e.length;n++){if(r=e[n],s!==null&&er(s,r))throw new Error(t+"contains a path "+s.toString()+" that is ancestor of another path "+r.toString());s=r}},KB=function(t,e,n,r){if(r&&e===void 0)return;const s=Kd(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(s+" must be an object containing the children to replace.");const i=[];Kt(e,(o,a)=>{const l=new je(o);if(Vm(s,a,nt(n,l)),g1(l)===".priority"&&!z0(a))throw new Error(s+"contains an invalid value for '"+l.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");i.push(l)}),QB(s,i)},YB=function(t,e,n,r){if(!(r&&n===void 0)&&!Lm(n))throw new Error(Kd(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},V1=function(t,e,n,r){if(!(r&&n===void 0)&&!s2(n))throw new Error(Kd(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},JB=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),V1(t,e,n,r)},i2=function(t,e){if(pe(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},XB=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Lm(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!GB(n))throw new Error(Kd(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZB{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Um(t,e){let n=null;for(let r=0;r<e.length;r++){const s=e[r],i=s.getPath();n!==null&&!v1(i,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:i}),n.events.push(s)}n&&t.eventLists_.push(n)}function o2(t,e,n){Um(t,n),a2(t,r=>v1(r,e))}function or(t,e,n){Um(t,n),a2(t,r=>er(r,e)||er(e,r))}function a2(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const s=t.eventLists_[r];if(s){const i=s.path;e(i)?(e5(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function e5(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const r=n.getEventRunner();xo&&Vt("event: "+n.toString()),mu(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t5="repo_interrupt",n5=25;class r5{constructor(e,n,r,s){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new ZB,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Gp(),this.transactionQueueTree_=new M1,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function s5(t,e,n){if(t.stats_=y1(t.repoInfo_),t.forceRestClient_||jU())t.server_=new Hp(t.repoInfo_,(r,s,i,o)=>{kC(t,r,s,i,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>RC(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{_t(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new gs(t.repoInfo_,e,(r,s,i,o)=>{kC(t,r,s,i,o)},r=>{RC(t,r)},r=>{i5(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=MU(t.repoInfo_,()=>new L6(t.stats_,t.server_)),t.infoData_=new O6,t.infoSyncTree_=new TC({startListening:(r,s,i,o)=>{let a=[];const l=t.infoData_.getNode(r._path);return l.isEmpty()||(a=Zd(t.infoSyncTree_,r._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),U1(t,"connected",!1),t.serverSyncTree_=new TC({startListening:(r,s,i,o)=>(t.server_.listen(r,i,s,(a,l)=>{const c=o(a,l);or(t.eventQueue_,r._path,c)}),[]),stopListening:(r,s)=>{t.server_.unlisten(r,s)}})}function l2(t){const n=t.infoData_.getNode(new je(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Bm(t){return LB({timestamp:l2(t)})}function kC(t,e,n,r,s){t.dataUpdateCount++;const i=new je(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(s)if(r){const l=Up(n,c=>vt(c));o=jB(t.serverSyncTree_,i,l,s)}else{const l=vt(n);o=KN(t.serverSyncTree_,i,l,s)}else if(r){const l=Up(n,c=>vt(c));o=RB(t.serverSyncTree_,i,l)}else{const l=vt(n);o=Zd(t.serverSyncTree_,i,l)}let a=i;o.length>0&&(a=ql(t,i)),or(t.eventQueue_,a,o)}function RC(t,e){U1(t,"connected",e),e===!1&&u5(t)}function i5(t,e){Kt(e,(n,r)=>{U1(t,n,r)})}function U1(t,e,n){const r=new je("/.info/"+e),s=vt(n);t.infoData_.updateSnapshot(r,s);const i=Zd(t.infoSyncTree_,r,s);or(t.eventQueue_,r,i)}function B1(t){return t.nextWriteId_++}function o5(t,e,n){const r=OB(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(s=>{const i=vt(s).withIndex(e._queryParams.getIndex());U0(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=Zd(t.serverSyncTree_,e._path,i);else{const a=hd(t.serverSyncTree_,e);o=KN(t.serverSyncTree_,e._path,i,a)}return or(t.eventQueue_,e._path,o),ty(t.serverSyncTree_,e,n,null,!0),i},s=>(nh(t,"get for query "+_t(e)+" failed: "+s),Promise.reject(new Error(s))))}function a5(t,e,n,r,s){nh(t,"set",{path:e.toString(),value:n,priority:r});const i=Bm(t),o=vt(n,r),a=P1(t.serverSyncTree_,e),l=e2(o,a,i),c=B1(t),d=QN(t.serverSyncTree_,e,l,c,!0);Um(t.eventQueue_,d),t.server_.put(e.toString(),o.val(!0),(f,p)=>{const y=f==="ok";y||vn("set at "+e+" failed: "+f);const v=Xs(t.serverSyncTree_,c,!y);or(t.eventQueue_,e,v),W0(t,s,f,p)});const h=W1(t,e);ql(t,h),or(t.eventQueue_,h,[])}function l5(t,e,n,r){nh(t,"update",{path:e.toString(),value:n});let s=!0;const i=Bm(t),o={};if(Kt(n,(a,l)=>{s=!1,o[a]=ZN(nt(e,a),vt(l),t.serverSyncTree_,i)}),s)Vt("update() called with empty data.  Don't do anything."),W0(t,r,"ok",void 0);else{const a=B1(t),l=kB(t.serverSyncTree_,e,o,a);Um(t.eventQueue_,l),t.server_.merge(e.toString(),n,(c,d)=>{const h=c==="ok";h||vn("update at "+e+" failed: "+c);const f=Xs(t.serverSyncTree_,a,!h),p=f.length>0?ql(t,e):e;or(t.eventQueue_,p,f),W0(t,r,c,d)}),Kt(n,c=>{const d=W1(t,nt(e,c));ql(t,d)}),or(t.eventQueue_,e,[])}}function u5(t){nh(t,"onDisconnectEvents");const e=Bm(t),n=Gp();D0(t.onDisconnect_,Re(),(s,i)=>{const o=ZN(s,i,t.serverSyncTree_,e);jN(n,s,o)});let r=[];D0(n,Re(),(s,i)=>{r=r.concat(Zd(t.serverSyncTree_,s,i));const o=W1(t,s);ql(t,o)}),t.onDisconnect_=Gp(),or(t.eventQueue_,Re(),r)}function c5(t,e,n){let r;pe(e._path)===".info"?r=U0(t.infoSyncTree_,e,n):r=U0(t.serverSyncTree_,e,n),o2(t.eventQueue_,e._path,r)}function PC(t,e,n){let r;pe(e._path)===".info"?r=ty(t.infoSyncTree_,e,n):r=ty(t.serverSyncTree_,e,n),o2(t.eventQueue_,e._path,r)}function d5(t){t.persistentConnection_&&t.persistentConnection_.interrupt(t5)}function nh(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Vt(n,...e)}function W0(t,e,n,r){e&&mu(()=>{if(n==="ok")e(null);else{const s=(n||"error").toUpperCase();let i=s;r&&(i+=": "+r);const o=new Error(i);o.code=s,e(o)}})}function u2(t,e,n){return P1(t.serverSyncTree_,e,n)||oe.EMPTY_NODE}function z1(t,e=t.transactionQueueTree_){if(e||zm(t,e),vu(e)){const n=d2(t,e);V(n.length>0,"Sending zero length transaction queue"),n.every(s=>s.status===0)&&h5(t,eh(e),n)}else n2(e)&&Mm(e,n=>{z1(t,n)})}function h5(t,e,n){const r=n.map(c=>c.currentWriteId),s=u2(t,e,r);let i=s;const o=s.hash();for(let c=0;c<n.length;c++){const d=n[c];V(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;const h=yn(e,d.path);i=i.updateChild(h,d.currentOutputSnapshotRaw)}const a=i.val(!0),l=e;t.server_.put(l.toString(),a,c=>{nh(t,"transaction put response",{path:l.toString(),status:c});let d=[];if(c==="ok"){const h=[];for(let f=0;f<n.length;f++)n[f].status=2,d=d.concat(Xs(t.serverSyncTree_,n[f].currentWriteId)),n[f].onComplete&&h.push(()=>n[f].onComplete(null,!0,n[f].currentOutputSnapshotResolved)),n[f].unwatcher();zm(t,L1(t.transactionQueueTree_,e)),z1(t,t.transactionQueueTree_),or(t.eventQueue_,e,d);for(let f=0;f<h.length;f++)mu(h[f])}else{if(c==="datastale")for(let h=0;h<n.length;h++)n[h].status===3?n[h].status=4:n[h].status=0;else{vn("transaction at "+l.toString()+" failed: "+c);for(let h=0;h<n.length;h++)n[h].status=4,n[h].abortReason=c}ql(t,e)}},o)}function ql(t,e){const n=c2(t,e),r=eh(n),s=d2(t,n);return f5(t,s,r),r}function f5(t,e,n){if(e.length===0)return;const r=[];let s=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],c=yn(n,l.path);let d=!1,h;if(V(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)d=!0,h=l.abortReason,s=s.concat(Xs(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=n5)d=!0,h="maxretry",s=s.concat(Xs(t.serverSyncTree_,l.currentWriteId,!0));else{const f=u2(t,l.path,o);l.currentInputSnapshot=f;const p=e[a].update(f.val());if(p!==void 0){Vm("transaction failed: Data returned ",p,l.path);let y=vt(p);typeof p=="object"&&p!=null&&ts(p,".priority")||(y=y.updatePriority(f.getPriority()));const _=l.currentWriteId,g=Bm(t),m=e2(y,f,g);l.currentOutputSnapshotRaw=y,l.currentOutputSnapshotResolved=m,l.currentWriteId=B1(t),o.splice(o.indexOf(_),1),s=s.concat(QN(t.serverSyncTree_,l.path,m,l.currentWriteId,l.applyLocally)),s=s.concat(Xs(t.serverSyncTree_,_,!0))}else d=!0,h="nodata",s=s.concat(Xs(t.serverSyncTree_,l.currentWriteId,!0))}or(t.eventQueue_,n,s),s=[],d&&(e[a].status=2,function(f){setTimeout(f,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(h),!1,null))))}zm(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)mu(r[a]);z1(t,t.transactionQueueTree_)}function c2(t,e){let n,r=t.transactionQueueTree_;for(n=pe(e);n!==null&&vu(r)===void 0;)r=L1(r,n),e=Me(e),n=pe(e);return r}function d2(t,e){const n=[];return h2(t,e,n),n.sort((r,s)=>r.order-s.order),n}function h2(t,e,n){const r=vu(e);if(r)for(let s=0;s<r.length;s++)n.push(r[s]);Mm(e,s=>{h2(t,s,n)})}function zm(t,e){const n=vu(e);if(n){let r=0;for(let s=0;s<n.length;s++)n[s].status!==2&&(n[r]=n[s],r++);n.length=r,t2(e,n.length>0?n:void 0)}Mm(e,r=>{zm(t,r)})}function W1(t,e){const n=eh(c2(t,e)),r=L1(t.transactionQueueTree_,e);return zB(r,s=>{Ev(t,s)}),Ev(t,r),r2(r,s=>{Ev(t,s)}),n}function Ev(t,e){const n=vu(e);if(n){const r=[];let s=[],i=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(V(i===o-1,"All SENT items should be at beginning of queue."),i=o,n[o].status=3,n[o].abortReason="set"):(V(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),s=s.concat(Xs(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));i===-1?t2(e,void 0):n.length=i+1,or(t.eventQueue_,eh(e),s);for(let o=0;o<r.length;o++)mu(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p5(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let s=n[r];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function y5(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):vn(`Invalid query segment '${n}' in query '${t}'`)}return e}const NC=function(t,e){const n=m5(t),r=n.namespace;n.domain==="firebase.com"&&Es(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Es("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||SU();const s=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new yN(n.host,n.secure,r,s,e,"",r!==n.subdomain),path:new je(n.pathString)}},m5=function(t){let e="",n="",r="",s="",i="",o=!0,a="https",l=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));let d=t.indexOf("/");d===-1&&(d=t.length);let h=t.indexOf("?");h===-1&&(h=t.length),e=t.substring(0,Math.min(d,h)),d<h&&(s=p5(t.substring(d,h)));const f=y5(t.substring(Math.min(t.length,h)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;const p=e.slice(0,c);if(p.toLowerCase()==="localhost")n="localhost";else if(p.split(".").length<=2)n=p;else{const y=e.indexOf(".");r=e.substring(0,y).toLowerCase(),n=e.substring(y+1),i=r}"ns"in f&&(i=f.ns)}return{host:e,port:l,domain:n,subdomain:r,secure:o,scheme:a,pathString:s,namespace:i}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jC="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",g5=function(){let t=0;const e=[];return function(n){const r=n===t;t=n;let s;const i=new Array(8);for(s=7;s>=0;s--)i[s]=jC.charAt(n%64),n=Math.floor(n/64);V(n===0,"Cannot push at time == 0");let o=i.join("");if(r){for(s=11;s>=0&&e[s]===63;s--)e[s]=0;e[s]++}else for(s=0;s<12;s++)e[s]=Math.floor(Math.random()*64);for(s=0;s<12;s++)o+=jC.charAt(e[s]);return V(o.length===20,"nextPushId: Length should be 20."),o}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f2{constructor(e,n,r,s){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+_t(this.snapshot.exportVal())}}class p2{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y2{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return V(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ea{constructor(e,n,r,s){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=s}get key(){return ye(this._path)?null:g1(this._path)}get ref(){return new ns(this._repo,this._path)}get _queryIdentifier(){const e=gC(this._queryParams),n=f1(e);return n==="{}"?"default":n}get _queryObject(){return gC(this._queryParams)}isEqual(e){if(e=Qt(e),!(e instanceof ea))return!1;const n=this._repo===e._repo,r=v1(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return n&&r&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+a6(this._path)}}function v5(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function q1(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===wo){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",s="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==Uo)throw new Error(r);if(typeof e!="string")throw new Error(s)}if(t.hasEnd()){if(t.getIndexEndName()!==bi)throw new Error(r);if(typeof n!="string")throw new Error(s)}}else if(t.getIndex()===Ye){if(e!=null&&!z0(e)||n!=null&&!z0(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(V(t.getIndex()instanceof w1||t.getIndex()===PN,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function m2(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class ns extends ea{constructor(e,n){super(e,n,new b1,!1)}get parent(){const e=SN(this._path);return e===null?null:new ns(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class Hl{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new je(e),r=Gl(this.ref,e);return new Hl(this._node.getChild(n),r,Ye)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,s)=>e(new Hl(s,Gl(this.ref,r),Ye)))}hasChild(e){const n=new je(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function tc(t,e){return t=Qt(t),t._checkNotDeleted("ref"),e!==void 0?Gl(t._root,e):t._root}function Gl(t,e){return t=Qt(t),pe(t._path)===null?JB("child","path",e,!1):V1("child","path",e,!1),new ns(t._repo,nt(t._path,e))}function g2(t,e){t=Qt(t),i2("push",t._path),th("push",e,t._path,!0);const n=l2(t._repo),r=g5(n),s=Gl(t,r),i=Gl(t,r);let o;return e!=null?o=H1(i,e).then(()=>i):o=Promise.resolve(i),s.then=o.then.bind(o),s.catch=o.then.bind(o,void 0),s}function H1(t,e){t=Qt(t),i2("set",t._path),th("set",e,t._path,!1);const n=new Qd;return a5(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function v2(t,e){KB("update",e,t._path,!1);const n=new Qd;return l5(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function _2(t){t=Qt(t);const e=new y2(()=>{}),n=new Wm(e);return o5(t._repo,t,n).then(r=>new Hl(r,new ns(t._repo,t._path),t._queryParams.getIndex()))}class Wm{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const r=n._queryParams.getIndex();return new f2("value",this,new Hl(e.snapshotNode,new ns(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new p2(this,e,n):null}matches(e){return e instanceof Wm?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class G1{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new p2(this,e,n):null}createEvent(e,n){V(e.childName!=null,"Child events should have a childName.");const r=Gl(new ns(n._repo,n._path),e.childName),s=n._queryParams.getIndex();return new f2(e.type,this,new Hl(e.snapshotNode,r,s),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof G1?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function _5(t,e,n,r,s){let i;if(typeof r=="object"&&(i=void 0,s=r),typeof r=="function"&&(i=r),s&&s.onlyOnce){const l=n,c=(d,h)=>{PC(t._repo,t,a),l(d,h)};c.userCallback=n.userCallback,c.context=n.context,n=c}const o=new y2(n,i||void 0),a=e==="value"?new Wm(o):new G1(e,o);return c5(t._repo,t,a),()=>PC(t._repo,t,a)}function x5(t,e,n,r){return _5(t,"value",e,n,r)}class rh{}class w5 extends rh{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){th("endAt",this._value,e._path,!0);const n=N6(e._queryParams,this._value,this._key);if(m2(n),q1(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new ea(e._repo,e._path,n,e._orderByCalled)}}class E5 extends rh{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){th("startAt",this._value,e._path,!0);const n=P6(e._queryParams,this._value,this._key);if(m2(n),q1(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new ea(e._repo,e._path,n,e._orderByCalled)}}class b5 extends rh{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new ea(e._repo,e._path,R6(e._queryParams,this._limit),e._orderByCalled)}}function S5(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new b5(t)}class C5 extends rh{constructor(e){super(),this._path=e}_apply(e){v5(e,"orderByChild");const n=new je(this._path);if(ye(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new w1(n),s=j6(e._queryParams,r);return q1(s),new ea(e._repo,e._path,s,!0)}}function A5(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return V1("orderByChild","path",t,!1),new C5(t)}class T5 extends rh{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){if(th("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new w5(this._value,this._key)._apply(new E5(this._value,this._key)._apply(e))}}function I5(t,e){return YB("equalTo","key",e,!0),new T5(t,e)}function k5(t,...e){let n=Qt(t);for(const r of e)n=r._apply(n);return n}wB(ns);AB(ns);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R5="FIREBASE_DATABASE_EMULATOR_HOST",q0={};let P5=!1;function N5(t,e,n,r){t.repoInfo_=new yN(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function j5(t,e,n,r,s){let i=r||t.options.databaseURL;i===void 0&&(t.options.projectId||Es("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Vt("Using default host for project ",t.options.projectId),i=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=NC(i,s),a=o.repoInfo,l,c;typeof process<"u"&&process.env&&(c=process.env[R5]),c?(l=!0,i=`http://${c}?ns=${a.namespace}`,o=NC(i,s),a=o.repoInfo):l=!o.repoInfo.secure;const d=s&&l?new rl(rl.OWNER):new DU(t.name,t.options,e);XB("Invalid Firebase Database URL",o),ye(o.path)||Es("Database URL must point to the root of a Firebase Database (not including a child path).");const h=D5(a,t,d,new OU(t.name,n));return new F5(h,t)}function O5(t,e){const n=q0[e];(!n||n[t.key]!==t)&&Es(`Database ${e}(${t.repoInfo_}) has already been deleted.`),d5(t),delete n[t.key]}function D5(t,e,n,r){let s=q0[e.name];s||(s={},q0[e.name]=s);let i=s[t.toURLString()];return i&&Es("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new r5(t,P5,n,r),s[t.toURLString()]=i,i}class F5{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(s5(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ns(this._repo,Re())),this._rootInternal}_delete(){return this._rootInternal!==null&&(O5(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Es("Cannot call "+e+" on a deleted database.")}}function $5(t=d1(),e){const n=u1(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const r=i1("database");r&&x2(n,...r)}return n}function x2(t,e,n,r={}){t=Qt(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Es("Cannot call useEmulator() after instance has already been initialized.");const s=t._repoInternal;let i;if(s.repoInfo_.nodeAdmin)r.mockUserToken&&Es('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),i=new rl(rl.OWNER);else if(r.mockUserToken){const o=typeof r.mockUserToken=="string"?r.mockUserToken:o1(r.mockUserToken,t.app.options.projectId);i=new rl(o)}N5(s,e,n,i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M5(t){_U(c1),Ul(new Lo("database",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return j5(r,s,i,n)},"PUBLIC").setMultipleInstances(!0)),Qr(eC,tC,t),Qr(eC,tC,"esm2017")}gs.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};gs.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};M5();var OC=Object.prototype.toString,w2=function(e){var n=OC.call(e),r=n==="[object Arguments]";return r||(r=n!=="[object Array]"&&e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&OC.call(e.callee)==="[object Function]"),r},bv,DC;function L5(){if(DC)return bv;DC=1;var t;if(!Object.keys){var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,r=w2,s=Object.prototype.propertyIsEnumerable,i=!s.call({toString:null},"toString"),o=s.call(function(){},"prototype"),a=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],l=function(f){var p=f.constructor;return p&&p.prototype===f},c={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},d=function(){if(typeof window>"u")return!1;for(var f in window)try{if(!c["$"+f]&&e.call(window,f)&&window[f]!==null&&typeof window[f]=="object")try{l(window[f])}catch{return!0}}catch{return!0}return!1}(),h=function(f){if(typeof window>"u"||!d)return l(f);try{return l(f)}catch{return!1}};t=function(p){var y=p!==null&&typeof p=="object",v=n.call(p)==="[object Function]",_=r(p),g=y&&n.call(p)==="[object String]",m=[];if(!y&&!v&&!_)throw new TypeError("Object.keys called on a non-object");var w=o&&v;if(g&&p.length>0&&!e.call(p,0))for(var E=0;E<p.length;++E)m.push(String(E));if(_&&p.length>0)for(var T=0;T<p.length;++T)m.push(String(T));else for(var C in p)!(w&&C==="prototype")&&e.call(p,C)&&m.push(String(C));if(i)for(var I=h(p),k=0;k<a.length;++k)!(I&&a[k]==="constructor")&&e.call(p,a[k])&&m.push(a[k]);return m}}return bv=t,bv}var V5=Array.prototype.slice,U5=w2,FC=Object.keys,Vf=FC?function(e){return FC(e)}:L5(),$C=Object.keys;Vf.shim=function(){if(Object.keys){var e=function(){var n=Object.keys(arguments);return n&&n.length===arguments.length}(1,2);e||(Object.keys=function(r){return U5(r)?$C(V5.call(r)):$C(r)})}else Object.keys=Vf;return Object.keys||Vf};var qm=Vf,Hm=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},n=Symbol("test"),r=Object(n);if(typeof n=="string"||Object.prototype.toString.call(n)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var s=42;e[n]=s;for(n in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var i=Object.getOwnPropertySymbols(e);if(i.length!==1||i[0]!==n||!Object.prototype.propertyIsEnumerable.call(e,n))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,n);if(o.value!==s||o.enumerable!==!0)return!1}return!0},MC=typeof Symbol<"u"&&Symbol,B5=Hm,Oi=function(){return typeof MC!="function"||typeof Symbol!="function"||typeof MC("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:B5()},z5="Function.prototype.bind called on incompatible ",Sv=Array.prototype.slice,W5=Object.prototype.toString,q5="[object Function]",H5=function(e){var n=this;if(typeof n!="function"||W5.call(n)!==q5)throw new TypeError(z5+n);for(var r=Sv.call(arguments,1),s,i=function(){if(this instanceof s){var d=n.apply(this,r.concat(Sv.call(arguments)));return Object(d)===d?d:this}else return n.apply(e,r.concat(Sv.call(arguments)))},o=Math.max(0,n.length-r.length),a=[],l=0;l<o;l++)a.push("$"+l);if(s=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(i),n.prototype){var c=function(){};c.prototype=n.prototype,s.prototype=new c,c.prototype=null}return s},G5=H5,Q1=Function.prototype.bind||G5,Q5=Q1,K1=Q5.call(Function.call,Object.prototype.hasOwnProperty),Ce,Ql=SyntaxError,E2=Function,sl=TypeError,Cv=function(t){try{return E2('"use strict"; return ('+t+").constructor;")()}catch{}},Eo=Object.getOwnPropertyDescriptor;if(Eo)try{Eo({},"")}catch{Eo=null}var Av=function(){throw new sl},K5=Eo?function(){try{return arguments.callee,Av}catch{try{return Eo(arguments,"callee").get}catch{return Av}}}():Av,aa=Oi(),$s=Object.getPrototypeOf||function(t){return t.__proto__},ga={},Y5=typeof Uint8Array>"u"?Ce:$s(Uint8Array),il={"%AggregateError%":typeof AggregateError>"u"?Ce:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?Ce:ArrayBuffer,"%ArrayIteratorPrototype%":aa?$s([][Symbol.iterator]()):Ce,"%AsyncFromSyncIteratorPrototype%":Ce,"%AsyncFunction%":ga,"%AsyncGenerator%":ga,"%AsyncGeneratorFunction%":ga,"%AsyncIteratorPrototype%":ga,"%Atomics%":typeof Atomics>"u"?Ce:Atomics,"%BigInt%":typeof BigInt>"u"?Ce:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?Ce:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?Ce:Float32Array,"%Float64Array%":typeof Float64Array>"u"?Ce:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?Ce:FinalizationRegistry,"%Function%":E2,"%GeneratorFunction%":ga,"%Int8Array%":typeof Int8Array>"u"?Ce:Int8Array,"%Int16Array%":typeof Int16Array>"u"?Ce:Int16Array,"%Int32Array%":typeof Int32Array>"u"?Ce:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":aa?$s($s([][Symbol.iterator]())):Ce,"%JSON%":typeof JSON=="object"?JSON:Ce,"%Map%":typeof Map>"u"?Ce:Map,"%MapIteratorPrototype%":typeof Map>"u"||!aa?Ce:$s(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?Ce:Promise,"%Proxy%":typeof Proxy>"u"?Ce:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?Ce:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?Ce:Set,"%SetIteratorPrototype%":typeof Set>"u"||!aa?Ce:$s(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?Ce:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":aa?$s(""[Symbol.iterator]()):Ce,"%Symbol%":aa?Symbol:Ce,"%SyntaxError%":Ql,"%ThrowTypeError%":K5,"%TypedArray%":Y5,"%TypeError%":sl,"%Uint8Array%":typeof Uint8Array>"u"?Ce:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?Ce:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?Ce:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?Ce:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?Ce:WeakMap,"%WeakRef%":typeof WeakRef>"u"?Ce:WeakRef,"%WeakSet%":typeof WeakSet>"u"?Ce:WeakSet},J5=function t(e){var n;if(e==="%AsyncFunction%")n=Cv("async function () {}");else if(e==="%GeneratorFunction%")n=Cv("function* () {}");else if(e==="%AsyncGeneratorFunction%")n=Cv("async function* () {}");else if(e==="%AsyncGenerator%"){var r=t("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if(e==="%AsyncIteratorPrototype%"){var s=t("%AsyncGenerator%");s&&(n=$s(s.prototype))}return il[e]=n,n},LC={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},sh=Q1,ny=K1,X5=sh.call(Function.call,Array.prototype.concat),Z5=sh.call(Function.apply,Array.prototype.splice),VC=sh.call(Function.call,String.prototype.replace),ry=sh.call(Function.call,String.prototype.slice),e9=sh.call(Function.call,RegExp.prototype.exec),t9=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,n9=/\\(\\)?/g,r9=function(e){var n=ry(e,0,1),r=ry(e,-1);if(n==="%"&&r!=="%")throw new Ql("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&n!=="%")throw new Ql("invalid intrinsic syntax, expected opening `%`");var s=[];return VC(e,t9,function(i,o,a,l){s[s.length]=a?VC(l,n9,"$1"):o||i}),s},s9=function(e,n){var r=e,s;if(ny(LC,r)&&(s=LC[r],r="%"+s[0]+"%"),ny(il,r)){var i=il[r];if(i===ga&&(i=J5(r)),typeof i>"u"&&!n)throw new sl("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:s,name:r,value:i}}throw new Ql("intrinsic "+e+" does not exist!")},Ts=function(e,n){if(typeof e!="string"||e.length===0)throw new sl("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof n!="boolean")throw new sl('"allowMissing" argument must be a boolean');if(e9(/^%?[^%]*%?$/,e)===null)throw new Ql("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=r9(e),s=r.length>0?r[0]:"",i=s9("%"+s+"%",n),o=i.name,a=i.value,l=!1,c=i.alias;c&&(s=c[0],Z5(r,X5([0,1],c)));for(var d=1,h=!0;d<r.length;d+=1){var f=r[d],p=ry(f,0,1),y=ry(f,-1);if((p==='"'||p==="'"||p==="`"||y==='"'||y==="'"||y==="`")&&p!==y)throw new Ql("property names with quotes must have matching quotes");if((f==="constructor"||!h)&&(l=!0),s+="."+f,o="%"+s+"%",ny(il,o))a=il[o];else if(a!=null){if(!(f in a)){if(!n)throw new sl("base intrinsic for "+e+" exists, but the property is not available.");return}if(Eo&&d+1>=r.length){var v=Eo(a,f);h=!!v,h&&"get"in v&&!("originalValue"in v.get)?a=v.get:a=a[f]}else h=ny(a,f),a=a[f];h&&!l&&(il[o]=a)}}return a},i9=Ts,H0=i9("%Object.defineProperty%",!0),G0=function(){if(H0)try{return H0({},"a",{value:1}),!0}catch{return!1}return!1};G0.hasArrayLengthDefineBug=function(){if(!G0())return null;try{return H0([],"length",{value:1}).length!==1}catch{return!0}};var ih=G0,o9=qm,a9=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",l9=Object.prototype.toString,u9=Array.prototype.concat,b2=Object.defineProperty,c9=function(t){return typeof t=="function"&&l9.call(t)==="[object Function]"},d9=ih(),S2=b2&&d9,h9=function(t,e,n,r){e in t&&(!c9(r)||!r())||(S2?b2(t,e,{configurable:!0,enumerable:!1,value:n,writable:!0}):t[e]=n)},C2=function(t,e){var n=arguments.length>2?arguments[2]:{},r=o9(e);a9&&(r=u9.call(r,Object.getOwnPropertySymbols(e)));for(var s=0;s<r.length;s+=1)h9(t,r[s],e[r[s]],n[r[s]])};C2.supportsDescriptors=!!S2;var Gm=C2,A2={exports:{}};(function(t){var e=Q1,n=Ts,r=n("%Function.prototype.apply%"),s=n("%Function.prototype.call%"),i=n("%Reflect.apply%",!0)||e.call(s,r),o=n("%Object.getOwnPropertyDescriptor%",!0),a=n("%Object.defineProperty%",!0),l=n("%Math.max%");if(a)try{a({},"a",{value:1})}catch{a=null}t.exports=function(h){var f=i(e,s,arguments);if(o&&a){var p=o(f,"length");p.configurable&&a(f,"length",{value:1+l(0,h.length-(arguments.length-1))})}return f};var c=function(){return i(e,r,arguments)};a?a(t.exports,"apply",{value:c}):t.exports.apply=c})(A2);var oh=A2.exports,T2=Ts,I2=oh,f9=I2(T2("String.prototype.indexOf")),Ir=function(e,n){var r=T2(e,!!n);return typeof r=="function"&&f9(e,".prototype.")>-1?I2(r):r},p9=qm,k2=Hm(),R2=Ir,UC=Object,y9=R2("Array.prototype.push"),BC=R2("Object.prototype.propertyIsEnumerable"),m9=k2?Object.getOwnPropertySymbols:null,P2=function(e,n){if(e==null)throw new TypeError("target must be an object");var r=UC(e);if(arguments.length===1)return r;for(var s=1;s<arguments.length;++s){var i=UC(arguments[s]),o=p9(i),a=k2&&(Object.getOwnPropertySymbols||m9);if(a)for(var l=a(i),c=0;c<l.length;++c){var d=l[c];BC(i,d)&&y9(o,d)}for(var h=0;h<o.length;++h){var f=o[h];if(BC(i,f)){var p=i[f];r[f]=p}}}return r},Tv=P2,g9=function(){if(!Object.assign)return!1;for(var t="abcdefghijklmnopqrst",e=t.split(""),n={},r=0;r<e.length;++r)n[e[r]]=e[r];var s=Object.assign({},n),i="";for(var o in s)i+=o;return t!==i},v9=function(){if(!Object.assign||!Object.preventExtensions)return!1;var t=Object.preventExtensions({1:2});try{Object.assign(t,"xy")}catch{return t[1]==="y"}return!1},N2=function(){return!Object.assign||g9()||v9()?Tv:Object.assign},_9=Gm,x9=N2,w9=function(){var e=x9();return _9(Object,{assign:e},{assign:function(){return Object.assign!==e}}),e},E9=Gm,b9=oh,S9=P2,j2=N2,C9=w9,A9=b9.apply(j2()),O2=function(e,n){return A9(Object,arguments)};E9(O2,{getPolyfill:j2,implementation:S9,shim:C9});var T9=O2,zC={foo:{}},I9=Object,Qm=function(){return{__proto__:zC}.foo===zC.foo&&!({__proto__:null}instanceof I9)},k9="Function.prototype.bind called on incompatible ",R9=Object.prototype.toString,P9=Math.max,N9="[object Function]",WC=function(e,n){for(var r=[],s=0;s<e.length;s+=1)r[s]=e[s];for(var i=0;i<n.length;i+=1)r[i+e.length]=n[i];return r},j9=function(e,n){for(var r=[],s=n||0,i=0;s<e.length;s+=1,i+=1)r[i]=e[s];return r},O9=function(t,e){for(var n="",r=0;r<t.length;r+=1)n+=t[r],r+1<t.length&&(n+=e);return n},D9=function(e){var n=this;if(typeof n!="function"||R9.apply(n)!==N9)throw new TypeError(k9+n);for(var r=j9(arguments,1),s,i=function(){if(this instanceof s){var d=n.apply(this,WC(r,arguments));return Object(d)===d?d:this}return n.apply(e,WC(r,arguments))},o=P9(0,n.length-r.length),a=[],l=0;l<o;l++)a[l]="$"+l;if(s=Function("binder","return function ("+O9(a,",")+"){ return binder.apply(this,arguments); }")(i),n.prototype){var c=function(){};c.prototype=n.prototype,s.prototype=new c,c.prototype=null}return s},F9=D9,D2=Function.prototype.bind||F9,$9="Function.prototype.bind called on incompatible ",M9=Object.prototype.toString,L9=Math.max,V9="[object Function]",qC=function(e,n){for(var r=[],s=0;s<e.length;s+=1)r[s]=e[s];for(var i=0;i<n.length;i+=1)r[i+e.length]=n[i];return r},U9=function(e,n){for(var r=[],s=n||0,i=0;s<e.length;s+=1,i+=1)r[i]=e[s];return r},B9=function(t,e){for(var n="",r=0;r<t.length;r+=1)n+=t[r],r+1<t.length&&(n+=e);return n},z9=function(e){var n=this;if(typeof n!="function"||M9.apply(n)!==V9)throw new TypeError($9+n);for(var r=U9(arguments,1),s,i=function(){if(this instanceof s){var d=n.apply(this,qC(r,arguments));return Object(d)===d?d:this}return n.apply(e,qC(r,arguments))},o=L9(0,n.length-r.length),a=[],l=0;l<o;l++)a[l]="$"+l;if(s=Function("binder","return function ("+B9(a,",")+"){ return binder.apply(this,arguments); }")(i),n.prototype){var c=function(){};c.prototype=n.prototype,s.prototype=new c,c.prototype=null}return s},W9=z9,q9=Function.prototype.bind||W9,H9=Function.prototype.call,G9=Object.prototype.hasOwnProperty,Q9=q9,Km=Q9.call(H9,G9),ve,Kl=SyntaxError,F2=Function,ol=TypeError,Iv=function(t){try{return F2('"use strict"; return ('+t+").constructor;")()}catch{}},bo=Object.getOwnPropertyDescriptor;if(bo)try{bo({},"")}catch{bo=null}var kv=function(){throw new ol},K9=bo?function(){try{return arguments.callee,kv}catch{try{return bo(arguments,"callee").get}catch{return kv}}}():kv,la=Oi(),Y9=Qm(),At=Object.getPrototypeOf||(Y9?function(t){return t.__proto__}:null),va={},J9=typeof Uint8Array>"u"||!At?ve:At(Uint8Array),So={"%AggregateError%":typeof AggregateError>"u"?ve:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?ve:ArrayBuffer,"%ArrayIteratorPrototype%":la&&At?At([][Symbol.iterator]()):ve,"%AsyncFromSyncIteratorPrototype%":ve,"%AsyncFunction%":va,"%AsyncGenerator%":va,"%AsyncGeneratorFunction%":va,"%AsyncIteratorPrototype%":va,"%Atomics%":typeof Atomics>"u"?ve:Atomics,"%BigInt%":typeof BigInt>"u"?ve:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?ve:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?ve:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?ve:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?ve:Float32Array,"%Float64Array%":typeof Float64Array>"u"?ve:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?ve:FinalizationRegistry,"%Function%":F2,"%GeneratorFunction%":va,"%Int8Array%":typeof Int8Array>"u"?ve:Int8Array,"%Int16Array%":typeof Int16Array>"u"?ve:Int16Array,"%Int32Array%":typeof Int32Array>"u"?ve:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":la&&At?At(At([][Symbol.iterator]())):ve,"%JSON%":typeof JSON=="object"?JSON:ve,"%Map%":typeof Map>"u"?ve:Map,"%MapIteratorPrototype%":typeof Map>"u"||!la||!At?ve:At(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?ve:Promise,"%Proxy%":typeof Proxy>"u"?ve:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?ve:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?ve:Set,"%SetIteratorPrototype%":typeof Set>"u"||!la||!At?ve:At(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?ve:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":la&&At?At(""[Symbol.iterator]()):ve,"%Symbol%":la?Symbol:ve,"%SyntaxError%":Kl,"%ThrowTypeError%":K9,"%TypedArray%":J9,"%TypeError%":ol,"%Uint8Array%":typeof Uint8Array>"u"?ve:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?ve:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?ve:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?ve:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?ve:WeakMap,"%WeakRef%":typeof WeakRef>"u"?ve:WeakRef,"%WeakSet%":typeof WeakSet>"u"?ve:WeakSet};if(At)try{null.error}catch(t){var X9=At(At(t));So["%Error.prototype%"]=X9}var Z9=function t(e){var n;if(e==="%AsyncFunction%")n=Iv("async function () {}");else if(e==="%GeneratorFunction%")n=Iv("function* () {}");else if(e==="%AsyncGeneratorFunction%")n=Iv("async function* () {}");else if(e==="%AsyncGenerator%"){var r=t("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if(e==="%AsyncIteratorPrototype%"){var s=t("%AsyncGenerator%");s&&At&&(n=At(s.prototype))}return So[e]=n,n},HC={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ah=D2,sy=Km,e8=ah.call(Function.call,Array.prototype.concat),t8=ah.call(Function.apply,Array.prototype.splice),GC=ah.call(Function.call,String.prototype.replace),iy=ah.call(Function.call,String.prototype.slice),n8=ah.call(Function.call,RegExp.prototype.exec),r8=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,s8=/\\(\\)?/g,i8=function(e){var n=iy(e,0,1),r=iy(e,-1);if(n==="%"&&r!=="%")throw new Kl("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&n!=="%")throw new Kl("invalid intrinsic syntax, expected opening `%`");var s=[];return GC(e,r8,function(i,o,a,l){s[s.length]=a?GC(l,s8,"$1"):o||i}),s},o8=function(e,n){var r=e,s;if(sy(HC,r)&&(s=HC[r],r="%"+s[0]+"%"),sy(So,r)){var i=So[r];if(i===va&&(i=Z9(r)),typeof i>"u"&&!n)throw new ol("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:s,name:r,value:i}}throw new Kl("intrinsic "+e+" does not exist!")},Ym=function(e,n){if(typeof e!="string"||e.length===0)throw new ol("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof n!="boolean")throw new ol('"allowMissing" argument must be a boolean');if(n8(/^%?[^%]*%?$/,e)===null)throw new Kl("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=i8(e),s=r.length>0?r[0]:"",i=o8("%"+s+"%",n),o=i.name,a=i.value,l=!1,c=i.alias;c&&(s=c[0],t8(r,e8([0,1],c)));for(var d=1,h=!0;d<r.length;d+=1){var f=r[d],p=iy(f,0,1),y=iy(f,-1);if((p==='"'||p==="'"||p==="`"||y==='"'||y==="'"||y==="`")&&p!==y)throw new Kl("property names with quotes must have matching quotes");if((f==="constructor"||!h)&&(l=!0),s+="."+f,o="%"+s+"%",sy(So,o))a=So[o];else if(a!=null){if(!(f in a)){if(!n)throw new ol("base intrinsic for "+e+" exists, but the property is not available.");return}if(bo&&d+1>=r.length){var v=bo(a,f);h=!!v,h&&"get"in v&&!("originalValue"in v.get)?a=v.get:a=a[f]}else h=sy(a,f),a=a[f];h&&!l&&(So[o]=a)}}return a},$2={exports:{}},a8="Function.prototype.bind called on incompatible ",l8=Object.prototype.toString,u8=Math.max,c8="[object Function]",QC=function(e,n){for(var r=[],s=0;s<e.length;s+=1)r[s]=e[s];for(var i=0;i<n.length;i+=1)r[i+e.length]=n[i];return r},d8=function(e,n){for(var r=[],s=n||0,i=0;s<e.length;s+=1,i+=1)r[i]=e[s];return r},h8=function(t,e){for(var n="",r=0;r<t.length;r+=1)n+=t[r],r+1<t.length&&(n+=e);return n},f8=function(e){var n=this;if(typeof n!="function"||l8.apply(n)!==c8)throw new TypeError(a8+n);for(var r=d8(arguments,1),s,i=function(){if(this instanceof s){var d=n.apply(this,QC(r,arguments));return Object(d)===d?d:this}return n.apply(e,QC(r,arguments))},o=u8(0,n.length-r.length),a=[],l=0;l<o;l++)a[l]="$"+l;if(s=Function("binder","return function ("+h8(a,",")+"){ return binder.apply(this,arguments); }")(i),n.prototype){var c=function(){};c.prototype=n.prototype,s.prototype=new c,c.prototype=null}return s},p8=f8,y8=Function.prototype.bind||p8,_e,Yl=SyntaxError,M2=Function,al=TypeError,Rv=function(t){try{return M2('"use strict"; return ('+t+").constructor;")()}catch{}},Co=Object.getOwnPropertyDescriptor;if(Co)try{Co({},"")}catch{Co=null}var Pv=function(){throw new al},m8=Co?function(){try{return arguments.callee,Pv}catch{try{return Co(arguments,"callee").get}catch{return Pv}}}():Pv,ua=Oi(),g8=Qm(),Tt=Object.getPrototypeOf||(g8?function(t){return t.__proto__}:null),_a={},v8=typeof Uint8Array>"u"||!Tt?_e:Tt(Uint8Array),Ao={"%AggregateError%":typeof AggregateError>"u"?_e:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?_e:ArrayBuffer,"%ArrayIteratorPrototype%":ua&&Tt?Tt([][Symbol.iterator]()):_e,"%AsyncFromSyncIteratorPrototype%":_e,"%AsyncFunction%":_a,"%AsyncGenerator%":_a,"%AsyncGeneratorFunction%":_a,"%AsyncIteratorPrototype%":_a,"%Atomics%":typeof Atomics>"u"?_e:Atomics,"%BigInt%":typeof BigInt>"u"?_e:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?_e:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?_e:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?_e:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?_e:Float32Array,"%Float64Array%":typeof Float64Array>"u"?_e:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?_e:FinalizationRegistry,"%Function%":M2,"%GeneratorFunction%":_a,"%Int8Array%":typeof Int8Array>"u"?_e:Int8Array,"%Int16Array%":typeof Int16Array>"u"?_e:Int16Array,"%Int32Array%":typeof Int32Array>"u"?_e:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":ua&&Tt?Tt(Tt([][Symbol.iterator]())):_e,"%JSON%":typeof JSON=="object"?JSON:_e,"%Map%":typeof Map>"u"?_e:Map,"%MapIteratorPrototype%":typeof Map>"u"||!ua||!Tt?_e:Tt(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?_e:Promise,"%Proxy%":typeof Proxy>"u"?_e:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?_e:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?_e:Set,"%SetIteratorPrototype%":typeof Set>"u"||!ua||!Tt?_e:Tt(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?_e:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":ua&&Tt?Tt(""[Symbol.iterator]()):_e,"%Symbol%":ua?Symbol:_e,"%SyntaxError%":Yl,"%ThrowTypeError%":m8,"%TypedArray%":v8,"%TypeError%":al,"%Uint8Array%":typeof Uint8Array>"u"?_e:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?_e:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?_e:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?_e:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?_e:WeakMap,"%WeakRef%":typeof WeakRef>"u"?_e:WeakRef,"%WeakSet%":typeof WeakSet>"u"?_e:WeakSet};if(Tt)try{null.error}catch(t){var _8=Tt(Tt(t));Ao["%Error.prototype%"]=_8}var x8=function t(e){var n;if(e==="%AsyncFunction%")n=Rv("async function () {}");else if(e==="%GeneratorFunction%")n=Rv("function* () {}");else if(e==="%AsyncGeneratorFunction%")n=Rv("async function* () {}");else if(e==="%AsyncGenerator%"){var r=t("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if(e==="%AsyncIteratorPrototype%"){var s=t("%AsyncGenerator%");s&&Tt&&(n=Tt(s.prototype))}return Ao[e]=n,n},KC={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},lh=y8,oy=Km,w8=lh.call(Function.call,Array.prototype.concat),E8=lh.call(Function.apply,Array.prototype.splice),YC=lh.call(Function.call,String.prototype.replace),ay=lh.call(Function.call,String.prototype.slice),b8=lh.call(Function.call,RegExp.prototype.exec),S8=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,C8=/\\(\\)?/g,A8=function(e){var n=ay(e,0,1),r=ay(e,-1);if(n==="%"&&r!=="%")throw new Yl("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&n!=="%")throw new Yl("invalid intrinsic syntax, expected opening `%`");var s=[];return YC(e,S8,function(i,o,a,l){s[s.length]=a?YC(l,C8,"$1"):o||i}),s},T8=function(e,n){var r=e,s;if(oy(KC,r)&&(s=KC[r],r="%"+s[0]+"%"),oy(Ao,r)){var i=Ao[r];if(i===_a&&(i=x8(r)),typeof i>"u"&&!n)throw new al("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:s,name:r,value:i}}throw new Yl("intrinsic "+e+" does not exist!")},I8=function(e,n){if(typeof e!="string"||e.length===0)throw new al("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof n!="boolean")throw new al('"allowMissing" argument must be a boolean');if(b8(/^%?[^%]*%?$/,e)===null)throw new Yl("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=A8(e),s=r.length>0?r[0]:"",i=T8("%"+s+"%",n),o=i.name,a=i.value,l=!1,c=i.alias;c&&(s=c[0],E8(r,w8([0,1],c)));for(var d=1,h=!0;d<r.length;d+=1){var f=r[d],p=ay(f,0,1),y=ay(f,-1);if((p==='"'||p==="'"||p==="`"||y==='"'||y==="'"||y==="`")&&p!==y)throw new Yl("property names with quotes must have matching quotes");if((f==="constructor"||!h)&&(l=!0),s+="."+f,o="%"+s+"%",oy(Ao,o))a=Ao[o];else if(a!=null){if(!(f in a)){if(!n)throw new al("base intrinsic for "+e+" exists, but the property is not available.");return}if(Co&&d+1>=r.length){var v=Co(a,f);h=!!v,h&&"get"in v&&!("originalValue"in v.get)?a=v.get:a=a[f]}else h=oy(a,f),a=a[f];h&&!l&&(Ao[o]=a)}}return a},k8="Function.prototype.bind called on incompatible ",R8=Object.prototype.toString,P8=Math.max,N8="[object Function]",JC=function(e,n){for(var r=[],s=0;s<e.length;s+=1)r[s]=e[s];for(var i=0;i<n.length;i+=1)r[i+e.length]=n[i];return r},j8=function(e,n){for(var r=[],s=n||0,i=0;s<e.length;s+=1,i+=1)r[i]=e[s];return r},O8=function(t,e){for(var n="",r=0;r<t.length;r+=1)n+=t[r],r+1<t.length&&(n+=e);return n},D8=function(e){var n=this;if(typeof n!="function"||R8.apply(n)!==N8)throw new TypeError(k8+n);for(var r=j8(arguments,1),s,i=function(){if(this instanceof s){var d=n.apply(this,JC(r,arguments));return Object(d)===d?d:this}return n.apply(e,JC(r,arguments))},o=P8(0,n.length-r.length),a=[],l=0;l<o;l++)a[l]="$"+l;if(s=Function("binder","return function ("+O8(a,",")+"){ return binder.apply(this,arguments); }")(i),n.prototype){var c=function(){};c.prototype=n.prototype,s.prototype=new c,c.prototype=null}return s},F8=D8,$8=Function.prototype.bind||F8,xe,Jl=SyntaxError,L2=Function,ll=TypeError,Nv=function(t){try{return L2('"use strict"; return ('+t+").constructor;")()}catch{}},To=Object.getOwnPropertyDescriptor;if(To)try{To({},"")}catch{To=null}var jv=function(){throw new ll},M8=To?function(){try{return arguments.callee,jv}catch{try{return To(arguments,"callee").get}catch{return jv}}}():jv,ca=Oi(),L8=Qm(),It=Object.getPrototypeOf||(L8?function(t){return t.__proto__}:null),xa={},V8=typeof Uint8Array>"u"||!It?xe:It(Uint8Array),Io={"%AggregateError%":typeof AggregateError>"u"?xe:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?xe:ArrayBuffer,"%ArrayIteratorPrototype%":ca&&It?It([][Symbol.iterator]()):xe,"%AsyncFromSyncIteratorPrototype%":xe,"%AsyncFunction%":xa,"%AsyncGenerator%":xa,"%AsyncGeneratorFunction%":xa,"%AsyncIteratorPrototype%":xa,"%Atomics%":typeof Atomics>"u"?xe:Atomics,"%BigInt%":typeof BigInt>"u"?xe:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?xe:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?xe:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?xe:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?xe:Float32Array,"%Float64Array%":typeof Float64Array>"u"?xe:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?xe:FinalizationRegistry,"%Function%":L2,"%GeneratorFunction%":xa,"%Int8Array%":typeof Int8Array>"u"?xe:Int8Array,"%Int16Array%":typeof Int16Array>"u"?xe:Int16Array,"%Int32Array%":typeof Int32Array>"u"?xe:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":ca&&It?It(It([][Symbol.iterator]())):xe,"%JSON%":typeof JSON=="object"?JSON:xe,"%Map%":typeof Map>"u"?xe:Map,"%MapIteratorPrototype%":typeof Map>"u"||!ca||!It?xe:It(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?xe:Promise,"%Proxy%":typeof Proxy>"u"?xe:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?xe:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?xe:Set,"%SetIteratorPrototype%":typeof Set>"u"||!ca||!It?xe:It(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?xe:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":ca&&It?It(""[Symbol.iterator]()):xe,"%Symbol%":ca?Symbol:xe,"%SyntaxError%":Jl,"%ThrowTypeError%":M8,"%TypedArray%":V8,"%TypeError%":ll,"%Uint8Array%":typeof Uint8Array>"u"?xe:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?xe:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?xe:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?xe:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?xe:WeakMap,"%WeakRef%":typeof WeakRef>"u"?xe:WeakRef,"%WeakSet%":typeof WeakSet>"u"?xe:WeakSet};if(It)try{null.error}catch(t){var U8=It(It(t));Io["%Error.prototype%"]=U8}var B8=function t(e){var n;if(e==="%AsyncFunction%")n=Nv("async function () {}");else if(e==="%GeneratorFunction%")n=Nv("function* () {}");else if(e==="%AsyncGeneratorFunction%")n=Nv("async function* () {}");else if(e==="%AsyncGenerator%"){var r=t("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if(e==="%AsyncIteratorPrototype%"){var s=t("%AsyncGenerator%");s&&It&&(n=It(s.prototype))}return Io[e]=n,n},XC={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},uh=$8,ly=Km,z8=uh.call(Function.call,Array.prototype.concat),W8=uh.call(Function.apply,Array.prototype.splice),ZC=uh.call(Function.call,String.prototype.replace),uy=uh.call(Function.call,String.prototype.slice),q8=uh.call(Function.call,RegExp.prototype.exec),H8=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,G8=/\\(\\)?/g,Q8=function(e){var n=uy(e,0,1),r=uy(e,-1);if(n==="%"&&r!=="%")throw new Jl("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&n!=="%")throw new Jl("invalid intrinsic syntax, expected opening `%`");var s=[];return ZC(e,H8,function(i,o,a,l){s[s.length]=a?ZC(l,G8,"$1"):o||i}),s},K8=function(e,n){var r=e,s;if(ly(XC,r)&&(s=XC[r],r="%"+s[0]+"%"),ly(Io,r)){var i=Io[r];if(i===xa&&(i=B8(r)),typeof i>"u"&&!n)throw new ll("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:s,name:r,value:i}}throw new Jl("intrinsic "+e+" does not exist!")},Y8=function(e,n){if(typeof e!="string"||e.length===0)throw new ll("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof n!="boolean")throw new ll('"allowMissing" argument must be a boolean');if(q8(/^%?[^%]*%?$/,e)===null)throw new Jl("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=Q8(e),s=r.length>0?r[0]:"",i=K8("%"+s+"%",n),o=i.name,a=i.value,l=!1,c=i.alias;c&&(s=c[0],W8(r,z8([0,1],c)));for(var d=1,h=!0;d<r.length;d+=1){var f=r[d],p=uy(f,0,1),y=uy(f,-1);if((p==='"'||p==="'"||p==="`"||y==='"'||y==="'"||y==="`")&&p!==y)throw new Jl("property names with quotes must have matching quotes");if((f==="constructor"||!h)&&(l=!0),s+="."+f,o="%"+s+"%",ly(Io,o))a=Io[o];else if(a!=null){if(!(f in a)){if(!n)throw new ll("base intrinsic for "+e+" exists, but the property is not available.");return}if(To&&d+1>=r.length){var v=To(a,f);h=!!v,h&&"get"in v&&!("originalValue"in v.get)?a=v.get:a=a[f]}else h=ly(a,f),a=a[f];h&&!l&&(Io[o]=a)}}return a},J8=Ts,Uf=J8("%Object.getOwnPropertyDescriptor%",!0);if(Uf)try{Uf([],"length")}catch{Uf=null}var Jm=Uf,X8=ih(),Y1=Y8,Tc=X8&&Y1("%Object.defineProperty%",!0);if(Tc)try{Tc({},"a",{value:1})}catch{Tc=!1}var Z8=Y1("%SyntaxError%"),da=Y1("%TypeError%"),eA=Jm,J1=function(e,n,r){if(!e||typeof e!="object"&&typeof e!="function")throw new da("`obj` must be an object or a function`");if(typeof n!="string"&&typeof n!="symbol")throw new da("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new da("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new da("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new da("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new da("`loose`, if provided, must be a boolean");var s=arguments.length>3?arguments[3]:null,i=arguments.length>4?arguments[4]:null,o=arguments.length>5?arguments[5]:null,a=arguments.length>6?arguments[6]:!1,l=!!eA&&eA(e,n);if(Tc)Tc(e,n,{configurable:o===null&&l?l.configurable:!o,enumerable:s===null&&l?l.enumerable:!s,value:r,writable:i===null&&l?l.writable:!i});else if(a||!s&&!i&&!o)e[n]=r;else throw new Z8("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},V2=I8,tA=J1,ez=ih(),nA=Jm,rA=V2("%TypeError%"),tz=V2("%Math.floor%"),U2=function(e,n){if(typeof e!="function")throw new rA("`fn` is not a function");if(typeof n!="number"||n<0||n>4294967295||tz(n)!==n)throw new rA("`length` must be a positive 32-bit integer");var r=arguments.length>2&&!!arguments[2],s=!0,i=!0;if("length"in e&&nA){var o=nA(e,"length");o&&!o.configurable&&(s=!1),o&&!o.writable&&(i=!1)}return(s||i||!r)&&(ez?tA(e,"length",n,!0,!0):tA(e,"length",n)),e};(function(t){var e=D2,n=Ym,r=U2,s=n("%TypeError%"),i=n("%Function.prototype.apply%"),o=n("%Function.prototype.call%"),a=n("%Reflect.apply%",!0)||e.call(o,i),l=n("%Object.defineProperty%",!0),c=n("%Math.max%");if(l)try{l({},"a",{value:1})}catch{l=null}t.exports=function(f){if(typeof f!="function")throw new s("a function is required");var p=a(e,o,arguments);return r(p,1+c(0,f.length-(arguments.length-1)),!0)};var d=function(){return a(e,i,arguments)};l?l(t.exports,"apply",{value:d}):t.exports.apply=d})($2);var nz=$2.exports,B2=Ym,z2=nz,rz=z2(B2("String.prototype.indexOf")),sz=function(e,n){var r=B2(e,!!n);return typeof r=="function"&&rz(e,".prototype.")>-1?z2(r):r},iz=qm,oz=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",az=Object.prototype.toString,lz=Array.prototype.concat,sA=J1,uz=function(t){return typeof t=="function"&&az.call(t)==="[object Function]"},W2=ih(),cz=function(t,e,n,r){if(e in t){if(r===!0){if(t[e]===n)return}else if(!uz(r)||!r())return}W2?sA(t,e,n,!0):sA(t,e,n)},q2=function(t,e){var n=arguments.length>2?arguments[2]:{},r=iz(e);oz&&(r=lz.call(r,Object.getOwnPropertySymbols(e)));for(var s=0;s<r.length;s+=1)cz(t,r[s],e[r[s]],n[r[s]])};q2.supportsDescriptors=!!W2;var X1=q2,fd=function(){return typeof(function(){}).name=="string"},Ic=Object.getOwnPropertyDescriptor;if(Ic)try{Ic([],"length")}catch{Ic=null}fd.functionsHaveConfigurableNames=function(){if(!fd()||!Ic)return!1;var e=Ic(function(){},"name");return!!e&&!!e.configurable};var dz=Function.prototype.bind;fd.boundFunctionsHaveNames=function(){return fd()&&typeof dz=="function"&&(function(){}).bind().name!==""};var hz=fd,iA=J1,fz=ih(),pz=hz.functionsHaveConfigurableNames(),yz=TypeError,mz=function(e,n){if(typeof e!="function")throw new yz("`fn` is not a function");var r=arguments.length>2&&!!arguments[2];return(!r||pz)&&(fz?iA(e,"name",n,!0,!0):iA(e,"name",n)),e},gz=mz,vz=Object,_z=TypeError,H2=gz(function(){if(this!=null&&this!==vz(this))throw new _z("RegExp.prototype.flags getter called on non-object");var e="";return this.hasIndices&&(e+="d"),this.global&&(e+="g"),this.ignoreCase&&(e+="i"),this.multiline&&(e+="m"),this.dotAll&&(e+="s"),this.unicode&&(e+="u"),this.unicodeSets&&(e+="v"),this.sticky&&(e+="y"),e},"get flags",!0),xz=H2,wz=X1.supportsDescriptors,Ez=Object.getOwnPropertyDescriptor,G2=function(){if(wz&&/a/mig.flags==="gim"){var e=Ez(RegExp.prototype,"flags");if(e&&typeof e.get=="function"&&typeof RegExp.prototype.dotAll=="boolean"&&typeof RegExp.prototype.hasIndices=="boolean"){var n="",r={};if(Object.defineProperty(r,"hasIndices",{get:function(){n+="d"}}),Object.defineProperty(r,"sticky",{get:function(){n+="y"}}),n==="dy")return e.get}}return xz},bz=X1.supportsDescriptors,Sz=G2,Cz=Object.getOwnPropertyDescriptor,Az=Object.defineProperty,Tz=TypeError,oA=Object.getPrototypeOf,Iz=/a/,kz=function(){if(!bz||!oA)throw new Tz("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var e=Sz(),n=oA(Iz),r=Cz(n,"flags");return(!r||r.get!==e)&&Az(n,"flags",{configurable:!0,enumerable:!1,get:e}),e},Rz=X1,Pz=oh,Nz=H2,Q2=G2,jz=kz,K2=Pz(Q2());Rz(K2,{getPolyfill:Q2,implementation:Nz,shim:jz});var Oz=K2,Bf={exports:{}},Dz=Hm,Di=function(){return Dz()&&!!Symbol.toStringTag},Fz=Di(),$z=Ir,Q0=$z("Object.prototype.toString"),Xm=function(e){return Fz&&e&&typeof e=="object"&&Symbol.toStringTag in e?!1:Q0(e)==="[object Arguments]"},Y2=function(e){return Xm(e)?!0:e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&Q0(e)!=="[object Array]"&&Q0(e.callee)==="[object Function]"},Mz=function(){return Xm(arguments)}();Xm.isLegacyArguments=Y2;var J2=Mz?Xm:Y2;const Lz={},Vz=Object.freeze(Object.defineProperty({__proto__:null,default:Lz},Symbol.toStringTag,{value:"Module"})),Uz=DM(Vz);var Z1=typeof Map=="function"&&Map.prototype,Ov=Object.getOwnPropertyDescriptor&&Z1?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,cy=Z1&&Ov&&typeof Ov.get=="function"?Ov.get:null,Bz=Z1&&Map.prototype.forEach,eE=typeof Set=="function"&&Set.prototype,Dv=Object.getOwnPropertyDescriptor&&eE?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,dy=eE&&Dv&&typeof Dv.get=="function"?Dv.get:null,zz=eE&&Set.prototype.forEach,Wz=typeof WeakMap=="function"&&WeakMap.prototype,kc=Wz?WeakMap.prototype.has:null,qz=typeof WeakSet=="function"&&WeakSet.prototype,Rc=qz?WeakSet.prototype.has:null,Hz=typeof WeakRef=="function"&&WeakRef.prototype,aA=Hz?WeakRef.prototype.deref:null,Gz=Boolean.prototype.valueOf,Qz=Object.prototype.toString,Kz=Function.prototype.toString,Yz=String.prototype.match,tE=String.prototype.slice,Zs=String.prototype.replace,Jz=String.prototype.toUpperCase,lA=String.prototype.toLowerCase,X2=RegExp.prototype.test,uA=Array.prototype.concat,Fr=Array.prototype.join,Xz=Array.prototype.slice,cA=Math.floor,K0=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Fv=Object.getOwnPropertySymbols,Y0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Xl=typeof Symbol=="function"&&typeof Symbol.iterator=="object",ln=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Xl||"symbol")?Symbol.toStringTag:null,Z2=Object.prototype.propertyIsEnumerable,dA=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function hA(t,e){if(t===1/0||t===-1/0||t!==t||t&&t>-1e3&&t<1e3||X2.call(/e/,e))return e;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof t=="number"){var r=t<0?-cA(-t):cA(t);if(r!==t){var s=String(r),i=tE.call(e,s.length+1);return Zs.call(s,n,"$&_")+"."+Zs.call(Zs.call(i,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Zs.call(e,n,"$&_")}var J0=Uz,fA=J0.custom,pA=tj(fA)?fA:null,Zz=function t(e,n,r,s){var i=n||{};if(Ms(i,"quoteStyle")&&i.quoteStyle!=="single"&&i.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Ms(i,"maxStringLength")&&(typeof i.maxStringLength=="number"?i.maxStringLength<0&&i.maxStringLength!==1/0:i.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=Ms(i,"customInspect")?i.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Ms(i,"indent")&&i.indent!==null&&i.indent!=="	"&&!(parseInt(i.indent,10)===i.indent&&i.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Ms(i,"numericSeparator")&&typeof i.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=i.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return rj(e,i);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var l=String(e);return a?hA(e,l):l}if(typeof e=="bigint"){var c=String(e)+"n";return a?hA(e,c):c}var d=typeof i.depth>"u"?5:i.depth;if(typeof r>"u"&&(r=0),r>=d&&d>0&&typeof e=="object")return X0(e)?"[Array]":"[Object]";var h=gW(i,r);if(typeof s>"u")s=[];else if(nj(s,e)>=0)return"[Circular]";function f(D,te,G){if(te&&(s=Xz.call(s),s.push(te)),G){var Ge={depth:i.depth};return Ms(i,"quoteStyle")&&(Ge.quoteStyle=i.quoteStyle),t(D,Ge,r+1,s)}return t(D,i,r+1,s)}if(typeof e=="function"&&!yA(e)){var p=lW(e),y=rf(e,f);return"[Function"+(p?": "+p:" (anonymous)")+"]"+(y.length>0?" { "+Fr.call(y,", ")+" }":"")}if(tj(e)){var v=Xl?Zs.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):Y0.call(e);return typeof e=="object"&&!Xl?Bu(v):v}if(pW(e)){for(var _="<"+lA.call(String(e.nodeName)),g=e.attributes||[],m=0;m<g.length;m++)_+=" "+g[m].name+"="+ej(eW(g[m].value),"double",i);return _+=">",e.childNodes&&e.childNodes.length&&(_+="..."),_+="</"+lA.call(String(e.nodeName))+">",_}if(X0(e)){if(e.length===0)return"[]";var w=rf(e,f);return h&&!mW(w)?"["+Z0(w,h)+"]":"[ "+Fr.call(w,", ")+" ]"}if(nW(e)){var E=rf(e,f);return!("cause"in Error.prototype)&&"cause"in e&&!Z2.call(e,"cause")?"{ ["+String(e)+"] "+Fr.call(uA.call("[cause]: "+f(e.cause),E),", ")+" }":E.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+Fr.call(E,", ")+" }"}if(typeof e=="object"&&o){if(pA&&typeof e[pA]=="function"&&J0)return J0(e,{depth:d-r});if(o!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(uW(e)){var T=[];return Bz.call(e,function(D,te){T.push(f(te,e,!0)+" => "+f(D,e))}),mA("Map",cy.call(e),T,h)}if(hW(e)){var C=[];return zz.call(e,function(D){C.push(f(D,e))}),mA("Set",dy.call(e),C,h)}if(cW(e))return $v("WeakMap");if(fW(e))return $v("WeakSet");if(dW(e))return $v("WeakRef");if(sW(e))return Bu(f(Number(e)));if(oW(e))return Bu(f(K0.call(e)));if(iW(e))return Bu(Gz.call(e));if(rW(e))return Bu(f(String(e)));if(!tW(e)&&!yA(e)){var I=rf(e,f),k=dA?dA(e)===Object.prototype:e instanceof Object||e.constructor===Object,O=e instanceof Object?"":"null prototype",L=!k&&ln&&Object(e)===e&&ln in e?tE.call(Fi(e),8,-1):O?"Object":"",j=k||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",P=j+(L||O?"["+Fr.call(uA.call([],L||[],O||[]),": ")+"] ":"");return I.length===0?P+"{}":h?P+"{"+Z0(I,h)+"}":P+"{ "+Fr.call(I,", ")+" }"}return String(e)};function ej(t,e,n){var r=(n.quoteStyle||e)==="double"?'"':"'";return r+t+r}function eW(t){return Zs.call(String(t),/"/g,"&quot;")}function X0(t){return Fi(t)==="[object Array]"&&(!ln||!(typeof t=="object"&&ln in t))}function tW(t){return Fi(t)==="[object Date]"&&(!ln||!(typeof t=="object"&&ln in t))}function yA(t){return Fi(t)==="[object RegExp]"&&(!ln||!(typeof t=="object"&&ln in t))}function nW(t){return Fi(t)==="[object Error]"&&(!ln||!(typeof t=="object"&&ln in t))}function rW(t){return Fi(t)==="[object String]"&&(!ln||!(typeof t=="object"&&ln in t))}function sW(t){return Fi(t)==="[object Number]"&&(!ln||!(typeof t=="object"&&ln in t))}function iW(t){return Fi(t)==="[object Boolean]"&&(!ln||!(typeof t=="object"&&ln in t))}function tj(t){if(Xl)return t&&typeof t=="object"&&t instanceof Symbol;if(typeof t=="symbol")return!0;if(!t||typeof t!="object"||!Y0)return!1;try{return Y0.call(t),!0}catch{}return!1}function oW(t){if(!t||typeof t!="object"||!K0)return!1;try{return K0.call(t),!0}catch{}return!1}var aW=Object.prototype.hasOwnProperty||function(t){return t in this};function Ms(t,e){return aW.call(t,e)}function Fi(t){return Qz.call(t)}function lW(t){if(t.name)return t.name;var e=Yz.call(Kz.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}function nj(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}function uW(t){if(!cy||!t||typeof t!="object")return!1;try{cy.call(t);try{dy.call(t)}catch{return!0}return t instanceof Map}catch{}return!1}function cW(t){if(!kc||!t||typeof t!="object")return!1;try{kc.call(t,kc);try{Rc.call(t,Rc)}catch{return!0}return t instanceof WeakMap}catch{}return!1}function dW(t){if(!aA||!t||typeof t!="object")return!1;try{return aA.call(t),!0}catch{}return!1}function hW(t){if(!dy||!t||typeof t!="object")return!1;try{dy.call(t);try{cy.call(t)}catch{return!0}return t instanceof Set}catch{}return!1}function fW(t){if(!Rc||!t||typeof t!="object")return!1;try{Rc.call(t,Rc);try{kc.call(t,kc)}catch{return!0}return t instanceof WeakSet}catch{}return!1}function pW(t){return!t||typeof t!="object"?!1:typeof HTMLElement<"u"&&t instanceof HTMLElement?!0:typeof t.nodeName=="string"&&typeof t.getAttribute=="function"}function rj(t,e){if(t.length>e.maxStringLength){var n=t.length-e.maxStringLength,r="... "+n+" more character"+(n>1?"s":"");return rj(tE.call(t,0,e.maxStringLength),e)+r}var s=Zs.call(Zs.call(t,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,yW);return ej(s,"single",e)}function yW(t){var e=t.charCodeAt(0),n={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return n?"\\"+n:"\\x"+(e<16?"0":"")+Jz.call(e.toString(16))}function Bu(t){return"Object("+t+")"}function $v(t){return t+" { ? }"}function mA(t,e,n,r){var s=r?Z0(n,r):Fr.call(n,", ");return t+" ("+e+") {"+s+"}"}function mW(t){for(var e=0;e<t.length;e++)if(nj(t[e],`
`)>=0)return!1;return!0}function gW(t,e){var n;if(t.indent==="	")n="	";else if(typeof t.indent=="number"&&t.indent>0)n=Fr.call(Array(t.indent+1)," ");else return null;return{base:n,prev:Fr.call(Array(e+1),n)}}function Z0(t,e){if(t.length===0)return"";var n=`
`+e.prev+e.base;return n+Fr.call(t,","+n)+`
`+e.prev}function rf(t,e){var n=X0(t),r=[];if(n){r.length=t.length;for(var s=0;s<t.length;s++)r[s]=Ms(t,s)?e(t[s],t):""}var i=typeof Fv=="function"?Fv(t):[],o;if(Xl){o={};for(var a=0;a<i.length;a++)o["$"+i[a]]=i[a]}for(var l in t)Ms(t,l)&&(n&&String(Number(l))===l&&l<t.length||Xl&&o["$"+l]instanceof Symbol||(X2.call(/[^\w$]/,l)?r.push(e(l,t)+": "+e(t[l],t)):r.push(l+": "+e(t[l],t))));if(typeof Fv=="function")for(var c=0;c<i.length;c++)Z2.call(t,i[c])&&r.push("["+e(i[c])+"]: "+e(t[i[c]],t));return r}var nE=Ts,_u=Ir,vW=Zz,_W=nE("%TypeError%"),sf=nE("%WeakMap%",!0),of=nE("%Map%",!0),xW=_u("WeakMap.prototype.get",!0),wW=_u("WeakMap.prototype.set",!0),EW=_u("WeakMap.prototype.has",!0),bW=_u("Map.prototype.get",!0),SW=_u("Map.prototype.set",!0),CW=_u("Map.prototype.has",!0),rE=function(t,e){for(var n=t,r;(r=n.next)!==null;n=r)if(r.key===e)return n.next=r.next,r.next=t.next,t.next=r,r},AW=function(t,e){var n=rE(t,e);return n&&n.value},TW=function(t,e,n){var r=rE(t,e);r?r.value=n:t.next={key:e,next:t.next,value:n}},IW=function(t,e){return!!rE(t,e)},sj=function(){var e,n,r,s={assert:function(i){if(!s.has(i))throw new _W("Side channel does not contain "+vW(i))},get:function(i){if(sf&&i&&(typeof i=="object"||typeof i=="function")){if(e)return xW(e,i)}else if(of){if(n)return bW(n,i)}else if(r)return AW(r,i)},has:function(i){if(sf&&i&&(typeof i=="object"||typeof i=="function")){if(e)return EW(e,i)}else if(of){if(n)return CW(n,i)}else if(r)return IW(r,i);return!1},set:function(i,o){sf&&i&&(typeof i=="object"||typeof i=="function")?(e||(e=new sf),wW(e,i,o)):of?(n||(n=new of),SW(n,i,o)):(r||(r={key:{},next:null}),TW(r,i,o))}};return s},kW=Ts,RW=K1,zu=sj(),is=kW("%TypeError%"),sE={assert:function(t,e){if(!t||typeof t!="object"&&typeof t!="function")throw new is("`O` is not an object");if(typeof e!="string")throw new is("`slot` must be a string");if(zu.assert(t),!sE.has(t,e))throw new is("`slot` is not present on `O`")},get:function(t,e){if(!t||typeof t!="object"&&typeof t!="function")throw new is("`O` is not an object");if(typeof e!="string")throw new is("`slot` must be a string");var n=zu.get(t);return n&&n["$"+e]},has:function(t,e){if(!t||typeof t!="object"&&typeof t!="function")throw new is("`O` is not an object");if(typeof e!="string")throw new is("`slot` must be a string");var n=zu.get(t);return!!n&&RW(n,"$"+e)},set:function(t,e,n){if(!t||typeof t!="object"&&typeof t!="function")throw new is("`O` is not an object");if(typeof e!="string")throw new is("`slot` must be a string");var r=zu.get(t);r||(r={},zu.set(t,r)),r["$"+e]=n}};Object.freeze&&Object.freeze(sE);var PW=sE,Wu=PW,NW=SyntaxError,gA=typeof StopIteration=="object"?StopIteration:null,jW=function(e){if(!gA)throw new NW("this environment lacks StopIteration");Wu.set(e,"[[Done]]",!1);var n={next:function(){var s=Wu.get(this,"[[Iterator]]"),i=Wu.get(s,"[[Done]]");try{return{done:i,value:i?void 0:s.next()}}catch(o){if(Wu.set(s,"[[Done]]",!0),o!==gA)throw o;return{done:!0,value:void 0}}}};return Wu.set(n,"[[Iterator]]",e),n},OW={}.toString,ij=Array.isArray||function(t){return OW.call(t)=="[object Array]"},DW=String.prototype.valueOf,FW=function(e){try{return DW.call(e),!0}catch{return!1}},$W=Object.prototype.toString,MW="[object String]",LW=Di(),oj=function(e){return typeof e=="string"?!0:typeof e!="object"?!1:LW?FW(e):$W.call(e)===MW},iE=typeof Map=="function"&&Map.prototype?Map:null,VW=typeof Set=="function"&&Set.prototype?Set:null,hy;iE||(hy=function(e){return!1});var aj=iE?Map.prototype.has:null,vA=VW?Set.prototype.has:null;!hy&&!aj&&(hy=function(e){return!1});var lj=hy||function(e){if(!e||typeof e!="object")return!1;try{if(aj.call(e),vA)try{vA.call(e)}catch{return!0}return e instanceof iE}catch{}return!1},UW=typeof Map=="function"&&Map.prototype?Map:null,oE=typeof Set=="function"&&Set.prototype?Set:null,fy;oE||(fy=function(e){return!1});var _A=UW?Map.prototype.has:null,uj=oE?Set.prototype.has:null;!fy&&!uj&&(fy=function(e){return!1});var cj=fy||function(e){if(!e||typeof e!="object")return!1;try{if(uj.call(e),_A)try{_A.call(e)}catch{return!0}return e instanceof oE}catch{}return!1},xA=J2,wA=jW;if(Oi()||Hm()){var Mv=Symbol.iterator;Bf.exports=function(e){if(e!=null&&typeof e[Mv]<"u")return e[Mv]();if(xA(e))return Array.prototype[Mv].call(e)}}else{var BW=ij,zW=oj,EA=Ts,WW=EA("%Map%",!0),qW=EA("%Set%",!0),ur=Ir,bA=ur("Array.prototype.push"),SA=ur("String.prototype.charCodeAt"),HW=ur("String.prototype.slice"),GW=function(e,n){var r=e.length;if(n+1>=r)return n+1;var s=SA(e,n);if(s<55296||s>56319)return n+1;var i=SA(e,n+1);return i<56320||i>57343?n+1:n+2},Lv=function(e){var n=0;return{next:function(){var s=n>=e.length,i;return s||(i=e[n],n+=1),{done:s,value:i}}}},CA=function(e,n){if(BW(e)||xA(e))return Lv(e);if(zW(e)){var r=0;return{next:function(){var i=GW(e,r),o=HW(e,r,i);return r=i,{done:i>e.length,value:o}}}}if(n&&typeof e["_es6-shim iterator_"]<"u")return e["_es6-shim iterator_"]()};if(!WW&&!qW)Bf.exports=function(e){if(e!=null)return CA(e,!0)};else{var QW=lj,KW=cj,AA=ur("Map.prototype.forEach",!0),TA=ur("Set.prototype.forEach",!0);if(typeof process>"u"||!process.versions||!process.versions.node)var IA=ur("Map.prototype.iterator",!0),kA=ur("Set.prototype.iterator",!0);var RA=ur("Map.prototype.@@iterator",!0)||ur("Map.prototype._es6-shim iterator_",!0),PA=ur("Set.prototype.@@iterator",!0)||ur("Set.prototype._es6-shim iterator_",!0),YW=function(e){if(QW(e)){if(IA)return wA(IA(e));if(RA)return RA(e);if(AA){var n=[];return AA(e,function(s,i){bA(n,[i,s])}),Lv(n)}}if(KW(e)){if(kA)return wA(kA(e));if(PA)return PA(e);if(TA){var r=[];return TA(e,function(s){bA(r,s)}),Lv(r)}}};Bf.exports=function(e){return YW(e)||CA(e)}}}var JW=Bf.exports,NA=function(t){return t!==t},dj=function(e,n){return e===0&&n===0?1/e===1/n:!!(e===n||NA(e)&&NA(n))},XW=dj,hj=function(){return typeof Object.is=="function"?Object.is:XW},ZW=hj,eq=Gm,tq=function(){var e=ZW();return eq(Object,{is:e},{is:function(){return Object.is!==e}}),e},nq=Gm,rq=oh,sq=dj,fj=hj,iq=tq,pj=rq(fj(),Object);nq(pj,{getPolyfill:fj,implementation:sq,shim:iq});var oq=pj,yj={exports:{}},aq="Function.prototype.bind called on incompatible ",Vv=Array.prototype.slice,lq=Object.prototype.toString,uq="[object Function]",cq=function(e){var n=this;if(typeof n!="function"||lq.call(n)!==uq)throw new TypeError(aq+n);for(var r=Vv.call(arguments,1),s,i=function(){if(this instanceof s){var d=n.apply(this,r.concat(Vv.call(arguments)));return Object(d)===d?d:this}else return n.apply(e,r.concat(Vv.call(arguments)))},o=Math.max(0,n.length-r.length),a=[],l=0;l<o;l++)a.push("$"+l);if(s=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(i),n.prototype){var c=function(){};c.prototype=n.prototype,s.prototype=new c,c.prototype=null}return s},dq=cq,mj=Function.prototype.bind||dq,Ae,Zl=SyntaxError,gj=Function,ul=TypeError,Uv=function(t){try{return gj('"use strict"; return ('+t+").constructor;")()}catch{}},ko=Object.getOwnPropertyDescriptor;if(ko)try{ko({},"")}catch{ko=null}var Bv=function(){throw new ul},hq=ko?function(){try{return arguments.callee,Bv}catch{try{return ko(arguments,"callee").get}catch{return Bv}}}():Bv,ha=Oi(),Ls=Object.getPrototypeOf||function(t){return t.__proto__},wa={},fq=typeof Uint8Array>"u"?Ae:Ls(Uint8Array),cl={"%AggregateError%":typeof AggregateError>"u"?Ae:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?Ae:ArrayBuffer,"%ArrayIteratorPrototype%":ha?Ls([][Symbol.iterator]()):Ae,"%AsyncFromSyncIteratorPrototype%":Ae,"%AsyncFunction%":wa,"%AsyncGenerator%":wa,"%AsyncGeneratorFunction%":wa,"%AsyncIteratorPrototype%":wa,"%Atomics%":typeof Atomics>"u"?Ae:Atomics,"%BigInt%":typeof BigInt>"u"?Ae:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?Ae:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?Ae:Float32Array,"%Float64Array%":typeof Float64Array>"u"?Ae:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?Ae:FinalizationRegistry,"%Function%":gj,"%GeneratorFunction%":wa,"%Int8Array%":typeof Int8Array>"u"?Ae:Int8Array,"%Int16Array%":typeof Int16Array>"u"?Ae:Int16Array,"%Int32Array%":typeof Int32Array>"u"?Ae:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":ha?Ls(Ls([][Symbol.iterator]())):Ae,"%JSON%":typeof JSON=="object"?JSON:Ae,"%Map%":typeof Map>"u"?Ae:Map,"%MapIteratorPrototype%":typeof Map>"u"||!ha?Ae:Ls(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?Ae:Promise,"%Proxy%":typeof Proxy>"u"?Ae:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?Ae:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?Ae:Set,"%SetIteratorPrototype%":typeof Set>"u"||!ha?Ae:Ls(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?Ae:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":ha?Ls(""[Symbol.iterator]()):Ae,"%Symbol%":ha?Symbol:Ae,"%SyntaxError%":Zl,"%ThrowTypeError%":hq,"%TypedArray%":fq,"%TypeError%":ul,"%Uint8Array%":typeof Uint8Array>"u"?Ae:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?Ae:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?Ae:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?Ae:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?Ae:WeakMap,"%WeakRef%":typeof WeakRef>"u"?Ae:WeakRef,"%WeakSet%":typeof WeakSet>"u"?Ae:WeakSet},pq=function t(e){var n;if(e==="%AsyncFunction%")n=Uv("async function () {}");else if(e==="%GeneratorFunction%")n=Uv("function* () {}");else if(e==="%AsyncGeneratorFunction%")n=Uv("async function* () {}");else if(e==="%AsyncGenerator%"){var r=t("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if(e==="%AsyncIteratorPrototype%"){var s=t("%AsyncGenerator%");s&&(n=Ls(s.prototype))}return cl[e]=n,n},jA={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ch=mj,py=K1,yq=ch.call(Function.call,Array.prototype.concat),mq=ch.call(Function.apply,Array.prototype.splice),OA=ch.call(Function.call,String.prototype.replace),yy=ch.call(Function.call,String.prototype.slice),gq=ch.call(Function.call,RegExp.prototype.exec),vq=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,_q=/\\(\\)?/g,xq=function(e){var n=yy(e,0,1),r=yy(e,-1);if(n==="%"&&r!=="%")throw new Zl("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&n!=="%")throw new Zl("invalid intrinsic syntax, expected opening `%`");var s=[];return OA(e,vq,function(i,o,a,l){s[s.length]=a?OA(l,_q,"$1"):o||i}),s},wq=function(e,n){var r=e,s;if(py(jA,r)&&(s=jA[r],r="%"+s[0]+"%"),py(cl,r)){var i=cl[r];if(i===wa&&(i=pq(r)),typeof i>"u"&&!n)throw new ul("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:s,name:r,value:i}}throw new Zl("intrinsic "+e+" does not exist!")},vj=function(e,n){if(typeof e!="string"||e.length===0)throw new ul("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof n!="boolean")throw new ul('"allowMissing" argument must be a boolean');if(gq(/^%?[^%]*%?$/,e)===null)throw new Zl("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=xq(e),s=r.length>0?r[0]:"",i=wq("%"+s+"%",n),o=i.name,a=i.value,l=!1,c=i.alias;c&&(s=c[0],mq(r,yq([0,1],c)));for(var d=1,h=!0;d<r.length;d+=1){var f=r[d],p=yy(f,0,1),y=yy(f,-1);if((p==='"'||p==="'"||p==="`"||y==='"'||y==="'"||y==="`")&&p!==y)throw new Zl("property names with quotes must have matching quotes");if((f==="constructor"||!h)&&(l=!0),s+="."+f,o="%"+s+"%",py(cl,o))a=cl[o];else if(a!=null){if(!(f in a)){if(!n)throw new ul("base intrinsic for "+e+" exists, but the property is not available.");return}if(ko&&d+1>=r.length){var v=ko(a,f);h=!!v,h&&"get"in v&&!("originalValue"in v.get)?a=v.get:a=a[f]}else h=py(a,f),a=a[f];h&&!l&&(cl[o]=a)}}return a};(function(t){var e=mj,n=vj,r=n("%Function.prototype.apply%"),s=n("%Function.prototype.call%"),i=n("%Reflect.apply%",!0)||e.call(s,r),o=n("%Object.getOwnPropertyDescriptor%",!0),a=n("%Object.defineProperty%",!0),l=n("%Math.max%");if(a)try{a({},"a",{value:1})}catch{a=null}t.exports=function(h){var f=i(e,s,arguments);if(o&&a){var p=o(f,"length");p.configurable&&a(f,"length",{value:1+l(0,h.length-(arguments.length-1))})}return f};var c=function(){return i(e,r,arguments)};a?a(t.exports,"apply",{value:c}):t.exports.apply=c})(yj);var _j=yj.exports,xj=vj,wj=_j,Eq=wj(xj("String.prototype.indexOf")),bq=function(e,n){var r=xj(e,!!n);return typeof r=="function"&&Eq(e,".prototype.")>-1?wj(r):r},Ej=Function.prototype.toString,za=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,ex,zf;if(typeof za=="function"&&typeof Object.defineProperty=="function")try{ex=Object.defineProperty({},"length",{get:function(){throw zf}}),zf={},za(function(){throw 42},null,ex)}catch(t){t!==zf&&(za=null)}else za=null;var Sq=/^\s*class\b/,tx=function(e){try{var n=Ej.call(e);return Sq.test(n)}catch{return!1}},zv=function(e){try{return tx(e)?!1:(Ej.call(e),!0)}catch{return!1}},Wf=Object.prototype.toString,Cq="[object Object]",Aq="[object Function]",Tq="[object GeneratorFunction]",Iq="[object HTMLAllCollection]",kq="[object HTML document.all class]",Rq="[object HTMLCollection]",Pq=typeof Symbol=="function"&&!!Symbol.toStringTag,Nq=!(0 in[,]),nx=function(){return!1};if(typeof document=="object"){var jq=document.all;Wf.call(jq)===Wf.call(document.all)&&(nx=function(e){if((Nq||!e)&&(typeof e>"u"||typeof e=="object"))try{var n=Wf.call(e);return(n===Iq||n===kq||n===Rq||n===Cq)&&e("")==null}catch{}return!1})}var Oq=za?function(e){if(nx(e))return!0;if(!e||typeof e!="function"&&typeof e!="object")return!1;try{za(e,null,ex)}catch(n){if(n!==zf)return!1}return!tx(e)&&zv(e)}:function(e){if(nx(e))return!0;if(!e||typeof e!="function"&&typeof e!="object")return!1;if(Pq)return zv(e);if(tx(e))return!1;var n=Wf.call(e);return n!==Aq&&n!==Tq&&!/^\[object HTML/.test(n)?!1:zv(e)},Dq=Oq,Fq=Object.prototype.toString,bj=Object.prototype.hasOwnProperty,$q=function(e,n,r){for(var s=0,i=e.length;s<i;s++)bj.call(e,s)&&(r==null?n(e[s],s,e):n.call(r,e[s],s,e))},Mq=function(e,n,r){for(var s=0,i=e.length;s<i;s++)r==null?n(e.charAt(s),s,e):n.call(r,e.charAt(s),s,e)},Lq=function(e,n,r){for(var s in e)bj.call(e,s)&&(r==null?n(e[s],s,e):n.call(r,e[s],s,e))},Vq=function(e,n,r){if(!Dq(n))throw new TypeError("iterator must be a function");var s;arguments.length>=3&&(s=r),Fq.call(e)==="[object Array]"?$q(e,n,s):typeof e=="string"?Mq(e,n,s):Lq(e,n,s)},Sj=Vq,Wv=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],Uq=typeof globalThis>"u"?iw:globalThis,Cj=function(){for(var e=[],n=0;n<Wv.length;n++)typeof Uq[Wv[n]]=="function"&&(e[e.length]=Wv[n]);return e},Aj=Sj,Bq=Cj,aE=Ir,zq=aE("Object.prototype.toString"),Tj=Di(),qf=Jm,Wq=typeof globalThis>"u"?iw:globalThis,Ij=Bq(),qq=aE("Array.prototype.indexOf",!0)||function(e,n){for(var r=0;r<e.length;r+=1)if(e[r]===n)return r;return-1},Hq=aE("String.prototype.slice"),kj={},qv=Object.getPrototypeOf;Tj&&qf&&qv&&Aj(Ij,function(t){var e=new Wq[t];if(Symbol.toStringTag in e){var n=qv(e),r=qf(n,Symbol.toStringTag);if(!r){var s=qv(n);r=qf(s,Symbol.toStringTag)}kj[t]=r.get}});var Gq=function(e){var n=!1;return Aj(kj,function(r,s){if(!n)try{n=r.call(e)===s}catch{}}),n},Rj=function(e){if(!e||typeof e!="object")return!1;if(!Tj||!(Symbol.toStringTag in e)){var n=Hq(zq(e),8,-1);return qq(Ij,n)>-1}return qf?Gq(e):!1},Qq=_j,Kq=bq,Pj=Ym,Yq=Rj,DA=Pj("ArrayBuffer",!0),FA=Pj("Float32Array",!0),Hf=Kq("ArrayBuffer.prototype.byteLength",!0),$A=DA&&!Hf&&new DA().slice,MA=$A&&Qq($A),Jq=Hf||MA?function(e){if(!e||typeof e!="object")return!1;try{return Hf?Hf(e):MA(e,0),!0}catch{return!1}}:FA?function(e){try{return new FA(e).buffer===e&&!Yq(e)}catch(n){return typeof e=="object"&&n.name==="RangeError"}}:function(e){return!1},Xq=Date.prototype.getDay,Zq=function(e){try{return Xq.call(e),!0}catch{return!1}},eH=Object.prototype.toString,tH="[object Date]",nH=Di(),rH=function(e){return typeof e!="object"||e===null?!1:nH?Zq(e):eH.call(e)===tH},rx=Ir,Nj=Di(),jj,Oj,sx,ix;if(Nj){jj=rx("Object.prototype.hasOwnProperty"),Oj=rx("RegExp.prototype.exec"),sx={};var Hv=function(){throw sx};ix={toString:Hv,valueOf:Hv},typeof Symbol.toPrimitive=="symbol"&&(ix[Symbol.toPrimitive]=Hv)}var sH=rx("Object.prototype.toString"),iH=Object.getOwnPropertyDescriptor,oH="[object RegExp]",aH=Nj?function(e){if(!e||typeof e!="object")return!1;var n=iH(e,"lastIndex"),r=n&&jj(n,"value");if(!r)return!1;try{Oj(e,ix)}catch(s){return s===sx}}:function(e){return!e||typeof e!="object"&&typeof e!="function"?!1:sH(e)===oH},lH=Ir,LA=lH("SharedArrayBuffer.prototype.byteLength",!0),uH=LA?function(e){if(!e||typeof e!="object")return!1;try{return LA(e),!0}catch{return!1}}:function(e){return!1},cH=Number.prototype.toString,dH=function(e){try{return cH.call(e),!0}catch{return!1}},hH=Object.prototype.toString,fH="[object Number]",pH=Di(),yH=function(e){return typeof e=="number"?!0:typeof e!="object"?!1:pH?dH(e):hH.call(e)===fH},Dj=Ir,mH=Dj("Boolean.prototype.toString"),gH=Dj("Object.prototype.toString"),vH=function(e){try{return mH(e),!0}catch{return!1}},_H="[object Boolean]",xH=Di(),wH=function(e){return typeof e=="boolean"?!0:e===null||typeof e!="object"?!1:xH&&Symbol.toStringTag in e?vH(e):gH(e)===_H},ox={exports:{}},EH=Object.prototype.toString,bH=Oi();if(bH){var SH=Symbol.prototype.toString,CH=/^Symbol\(.*\)$/,AH=function(e){return typeof e.valueOf()!="symbol"?!1:CH.test(SH.call(e))};ox.exports=function(e){if(typeof e=="symbol")return!0;if(EH.call(e)!=="[object Symbol]")return!1;try{return AH(e)}catch{return!1}}}else ox.exports=function(e){return!1};var TH=ox.exports,ax={exports:{}},VA=typeof BigInt<"u"&&BigInt,IH=function(){return typeof VA=="function"&&typeof BigInt=="function"&&typeof VA(42)=="bigint"&&typeof BigInt(42)=="bigint"},kH=IH();if(kH){var RH=BigInt.prototype.valueOf,PH=function(e){try{return RH.call(e),!0}catch{}return!1};ax.exports=function(e){return e===null||typeof e>"u"||typeof e=="boolean"||typeof e=="string"||typeof e=="number"||typeof e=="symbol"||typeof e=="function"?!1:typeof e=="bigint"?!0:PH(e)}}else ax.exports=function(e){return!1};var NH=ax.exports,jH=oj,OH=yH,DH=wH,FH=TH,$H=NH,MH=function(e){if(e==null||typeof e!="object"&&typeof e!="function")return null;if(jH(e))return"String";if(OH(e))return"Number";if(DH(e))return"Boolean";if(FH(e))return"Symbol";if($H(e))return"BigInt"},my=typeof WeakMap=="function"&&WeakMap.prototype?WeakMap:null,UA=typeof WeakSet=="function"&&WeakSet.prototype?WeakSet:null,gy;my||(gy=function(e){return!1});var lx=my?my.prototype.has:null,Gv=UA?UA.prototype.has:null;!gy&&!lx&&(gy=function(e){return!1});var LH=gy||function(e){if(!e||typeof e!="object")return!1;try{if(lx.call(e,lx),Gv)try{Gv.call(e,Gv)}catch{return!0}return e instanceof my}catch{}return!1},ux={exports:{}},VH=Ts,Fj=Ir,UH=VH("%WeakSet%",!0),Qv=Fj("WeakSet.prototype.has",!0);if(Qv){var Kv=Fj("WeakMap.prototype.has",!0);ux.exports=function(e){if(!e||typeof e!="object")return!1;try{if(Qv(e,Qv),Kv)try{Kv(e,Kv)}catch{return!0}return e instanceof UH}catch{}return!1}}else ux.exports=function(e){return!1};var BH=ux.exports,zH=lj,WH=cj,qH=LH,HH=BH,GH=function(e){if(e&&typeof e=="object"){if(zH(e))return"Map";if(WH(e))return"Set";if(qH(e))return"WeakMap";if(HH(e))return"WeakSet"}return!1},$j={exports:{}},QH="Function.prototype.bind called on incompatible ",KH=Object.prototype.toString,YH=Math.max,JH="[object Function]",BA=function(e,n){for(var r=[],s=0;s<e.length;s+=1)r[s]=e[s];for(var i=0;i<n.length;i+=1)r[i+e.length]=n[i];return r},XH=function(e,n){for(var r=[],s=n||0,i=0;s<e.length;s+=1,i+=1)r[i]=e[s];return r},ZH=function(t,e){for(var n="",r=0;r<t.length;r+=1)n+=t[r],r+1<t.length&&(n+=e);return n},e7=function(e){var n=this;if(typeof n!="function"||KH.apply(n)!==JH)throw new TypeError(QH+n);for(var r=XH(arguments,1),s,i=function(){if(this instanceof s){var d=n.apply(this,BA(r,arguments));return Object(d)===d?d:this}return n.apply(e,BA(r,arguments))},o=YH(0,n.length-r.length),a=[],l=0;l<o;l++)a[l]="$"+l;if(s=Function("binder","return function ("+ZH(a,",")+"){ return binder.apply(this,arguments); }")(i),n.prototype){var c=function(){};c.prototype=n.prototype,s.prototype=new c,c.prototype=null}return s},t7=e7,Mj=Function.prototype.bind||t7,we,eu=SyntaxError,Lj=Function,dl=TypeError,Yv=function(t){try{return Lj('"use strict"; return ('+t+").constructor;")()}catch{}},Ro=Object.getOwnPropertyDescriptor;if(Ro)try{Ro({},"")}catch{Ro=null}var Jv=function(){throw new dl},n7=Ro?function(){try{return arguments.callee,Jv}catch{try{return Ro(arguments,"callee").get}catch{return Jv}}}():Jv,fa=Oi(),r7=Qm(),kt=Object.getPrototypeOf||(r7?function(t){return t.__proto__}:null),Ea={},s7=typeof Uint8Array>"u"||!kt?we:kt(Uint8Array),Po={"%AggregateError%":typeof AggregateError>"u"?we:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?we:ArrayBuffer,"%ArrayIteratorPrototype%":fa&&kt?kt([][Symbol.iterator]()):we,"%AsyncFromSyncIteratorPrototype%":we,"%AsyncFunction%":Ea,"%AsyncGenerator%":Ea,"%AsyncGeneratorFunction%":Ea,"%AsyncIteratorPrototype%":Ea,"%Atomics%":typeof Atomics>"u"?we:Atomics,"%BigInt%":typeof BigInt>"u"?we:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?we:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?we:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?we:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?we:Float32Array,"%Float64Array%":typeof Float64Array>"u"?we:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?we:FinalizationRegistry,"%Function%":Lj,"%GeneratorFunction%":Ea,"%Int8Array%":typeof Int8Array>"u"?we:Int8Array,"%Int16Array%":typeof Int16Array>"u"?we:Int16Array,"%Int32Array%":typeof Int32Array>"u"?we:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":fa&&kt?kt(kt([][Symbol.iterator]())):we,"%JSON%":typeof JSON=="object"?JSON:we,"%Map%":typeof Map>"u"?we:Map,"%MapIteratorPrototype%":typeof Map>"u"||!fa||!kt?we:kt(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?we:Promise,"%Proxy%":typeof Proxy>"u"?we:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?we:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?we:Set,"%SetIteratorPrototype%":typeof Set>"u"||!fa||!kt?we:kt(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?we:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":fa&&kt?kt(""[Symbol.iterator]()):we,"%Symbol%":fa?Symbol:we,"%SyntaxError%":eu,"%ThrowTypeError%":n7,"%TypedArray%":s7,"%TypeError%":dl,"%Uint8Array%":typeof Uint8Array>"u"?we:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?we:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?we:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?we:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?we:WeakMap,"%WeakRef%":typeof WeakRef>"u"?we:WeakRef,"%WeakSet%":typeof WeakSet>"u"?we:WeakSet};if(kt)try{null.error}catch(t){var i7=kt(kt(t));Po["%Error.prototype%"]=i7}var o7=function t(e){var n;if(e==="%AsyncFunction%")n=Yv("async function () {}");else if(e==="%GeneratorFunction%")n=Yv("function* () {}");else if(e==="%AsyncGeneratorFunction%")n=Yv("async function* () {}");else if(e==="%AsyncGenerator%"){var r=t("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if(e==="%AsyncIteratorPrototype%"){var s=t("%AsyncGenerator%");s&&kt&&(n=kt(s.prototype))}return Po[e]=n,n},zA={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},dh=Mj,vy=Km,a7=dh.call(Function.call,Array.prototype.concat),l7=dh.call(Function.apply,Array.prototype.splice),WA=dh.call(Function.call,String.prototype.replace),_y=dh.call(Function.call,String.prototype.slice),u7=dh.call(Function.call,RegExp.prototype.exec),c7=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,d7=/\\(\\)?/g,h7=function(e){var n=_y(e,0,1),r=_y(e,-1);if(n==="%"&&r!=="%")throw new eu("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&n!=="%")throw new eu("invalid intrinsic syntax, expected opening `%`");var s=[];return WA(e,c7,function(i,o,a,l){s[s.length]=a?WA(l,d7,"$1"):o||i}),s},f7=function(e,n){var r=e,s;if(vy(zA,r)&&(s=zA[r],r="%"+s[0]+"%"),vy(Po,r)){var i=Po[r];if(i===Ea&&(i=o7(r)),typeof i>"u"&&!n)throw new dl("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:s,name:r,value:i}}throw new eu("intrinsic "+e+" does not exist!")},Vj=function(e,n){if(typeof e!="string"||e.length===0)throw new dl("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof n!="boolean")throw new dl('"allowMissing" argument must be a boolean');if(u7(/^%?[^%]*%?$/,e)===null)throw new eu("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=h7(e),s=r.length>0?r[0]:"",i=f7("%"+s+"%",n),o=i.name,a=i.value,l=!1,c=i.alias;c&&(s=c[0],l7(r,a7([0,1],c)));for(var d=1,h=!0;d<r.length;d+=1){var f=r[d],p=_y(f,0,1),y=_y(f,-1);if((p==='"'||p==="'"||p==="`"||y==='"'||y==="'"||y==="`")&&p!==y)throw new eu("property names with quotes must have matching quotes");if((f==="constructor"||!h)&&(l=!0),s+="."+f,o="%"+s+"%",vy(Po,o))a=Po[o];else if(a!=null){if(!(f in a)){if(!n)throw new dl("base intrinsic for "+e+" exists, but the property is not available.");return}if(Ro&&d+1>=r.length){var v=Ro(a,f);h=!!v,h&&"get"in v&&!("originalValue"in v.get)?a=v.get:a=a[f]}else h=vy(a,f),a=a[f];h&&!l&&(Po[o]=a)}}return a};(function(t){var e=Mj,n=Vj,r=U2,s=n("%TypeError%"),i=n("%Function.prototype.apply%"),o=n("%Function.prototype.call%"),a=n("%Reflect.apply%",!0)||e.call(o,i),l=n("%Object.defineProperty%",!0),c=n("%Math.max%");if(l)try{l({},"a",{value:1})}catch{l=null}t.exports=function(f){if(typeof f!="function")throw new s("a function is required");var p=a(e,o,arguments);return r(p,1+c(0,f.length-(arguments.length-1)),!0)};var d=function(){return a(e,i,arguments)};l?l(t.exports,"apply",{value:d}):t.exports.apply=d})($j);var Uj=$j.exports,Bj=Vj,zj=Uj,p7=zj(Bj("String.prototype.indexOf")),y7=function(e,n){var r=Bj(e,!!n);return typeof r=="function"&&p7(e,".prototype.")>-1?zj(r):r},xy=Sj,m7=Cj,qA=Uj,lE=y7,Gf=Jm,g7=lE("Object.prototype.toString"),Wj=Di(),HA=typeof globalThis>"u"?iw:globalThis,cx=m7(),uE=lE("String.prototype.slice"),Xv=Object.getPrototypeOf,v7=lE("Array.prototype.indexOf",!0)||function(e,n){for(var r=0;r<e.length;r+=1)if(e[r]===n)return r;return-1},wy={__proto__:null};Wj&&Gf&&Xv?xy(cx,function(t){var e=new HA[t];if(Symbol.toStringTag in e){var n=Xv(e),r=Gf(n,Symbol.toStringTag);if(!r){var s=Xv(n);r=Gf(s,Symbol.toStringTag)}wy["$"+t]=qA(r.get)}}):xy(cx,function(t){var e=new HA[t],n=e.slice||e.set;n&&(wy["$"+t]=qA(n))});var _7=function(e){var n=!1;return xy(wy,function(r,s){if(!n)try{"$"+r(e)===s&&(n=uE(s,1))}catch{}}),n},x7=function(e){var n=!1;return xy(wy,function(r,s){if(!n)try{r(e),n=uE(s,1)}catch{}}),n},w7=function(e){if(!e||typeof e!="object")return!1;if(!Wj){var n=uE(g7(e),8,-1);return v7(cx,n)>-1?n:n!=="Object"?!1:x7(e)}return Gf?_7(e):null},Zv,GA;function E7(){if(GA)return Zv;GA=1;var t=oh,e=Ir,n=Ts,r=Rj,s=n("ArrayBuffer",!0),i=n("Float32Array",!0),o=e("ArrayBuffer.prototype.byteLength",!0),a=s&&!o&&new s().slice,l=a&&t(a);return Zv=o||l?function(d){if(!d||typeof d!="object")return!1;try{return o?o(d):l(d,0),!0}catch{return!1}}:i?function(d){try{return new i(d).buffer===d&&!r(d)}catch{return!1}}:function(d){return!1},Zv}var b7=Ir,QA=b7("ArrayBuffer.prototype.byteLength",!0),S7=E7(),C7=function(e){return S7(e)?QA?QA(e):e.byteLength:NaN},qj=T9,rs=sz,KA=Oz,A7=Ym,tu=JW,T7=sj,YA=oq,JA=J2,XA=ij,ZA=Jq,eT=rH,tT=aH,nT=uH,rT=qm,sT=MH,iT=GH,oT=w7,aT=C7,lT=rs("SharedArrayBuffer.prototype.byteLength",!0),uT=rs("Date.prototype.getTime"),e_=Object.getPrototypeOf,cT=rs("Object.prototype.toString"),Ey=A7("%Set%",!0),dx=rs("Map.prototype.has",!0),by=rs("Map.prototype.get",!0),dT=rs("Map.prototype.size",!0),Sy=rs("Set.prototype.add",!0),Hj=rs("Set.prototype.delete",!0),Cy=rs("Set.prototype.has",!0),Qf=rs("Set.prototype.size",!0);function hT(t,e,n,r){for(var s=tu(t),i;(i=s.next())&&!i.done;)if(Sr(e,i.value,n,r))return Hj(t,i.value),!0;return!1}function Gj(t){if(typeof t>"u")return null;if(typeof t!="object")return typeof t=="symbol"?!1:typeof t=="string"||typeof t=="number"?+t==+t:!0}function I7(t,e,n,r,s,i){var o=Gj(n);if(o!=null)return o;var a=by(e,o),l=qj({},s,{strict:!1});return typeof a>"u"&&!dx(e,o)||!Sr(r,a,l,i)?!1:!dx(t,o)&&Sr(r,a,l,i)}function k7(t,e,n){var r=Gj(n);return r??(Cy(e,r)&&!Cy(t,r))}function fT(t,e,n,r,s,i){for(var o=tu(t),a,l;(a=o.next())&&!a.done;)if(l=a.value,Sr(n,l,s,i)&&Sr(r,by(e,l),s,i))return Hj(t,l),!0;return!1}function Sr(t,e,n,r){var s=n||{};if(s.strict?YA(t,e):t===e)return!0;var i=sT(t),o=sT(e);if(i!==o)return!1;if(!t||!e||typeof t!="object"&&typeof e!="object")return s.strict?YA(t,e):t==e;var a=r.has(t),l=r.has(e),c;if(a&&l){if(r.get(t)===r.get(e))return!0}else c={};return a||r.set(t,c),l||r.set(e,c),N7(t,e,s,r)}function pT(t){return!t||typeof t!="object"||typeof t.length!="number"||typeof t.copy!="function"||typeof t.slice!="function"||t.length>0&&typeof t[0]!="number"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}function R7(t,e,n,r){if(Qf(t)!==Qf(e))return!1;for(var s=tu(t),i=tu(e),o,a,l;(o=s.next())&&!o.done;)if(o.value&&typeof o.value=="object")l||(l=new Ey),Sy(l,o.value);else if(!Cy(e,o.value)){if(n.strict||!k7(t,e,o.value))return!1;l||(l=new Ey),Sy(l,o.value)}if(l){for(;(a=i.next())&&!a.done;)if(a.value&&typeof a.value=="object"){if(!hT(l,a.value,n.strict,r))return!1}else if(!n.strict&&!Cy(t,a.value)&&!hT(l,a.value,n.strict,r))return!1;return Qf(l)===0}return!0}function P7(t,e,n,r){if(dT(t)!==dT(e))return!1;for(var s=tu(t),i=tu(e),o,a,l,c,d,h;(o=s.next())&&!o.done;)if(c=o.value[0],d=o.value[1],c&&typeof c=="object")l||(l=new Ey),Sy(l,c);else if(h=by(e,c),typeof h>"u"&&!dx(e,c)||!Sr(d,h,n,r)){if(n.strict||!I7(t,e,c,d,n,r))return!1;l||(l=new Ey),Sy(l,c)}if(l){for(;(a=i.next())&&!a.done;)if(c=a.value[0],h=a.value[1],c&&typeof c=="object"){if(!fT(l,t,c,h,n,r))return!1}else if(!n.strict&&(!t.has(c)||!Sr(by(t,c),h,n,r))&&!fT(l,t,c,h,qj({},n,{strict:!1}),r))return!1;return Qf(l)===0}return!0}function N7(t,e,n,r){var s,i;if(typeof t!=typeof e||t==null||e==null||cT(t)!==cT(e)||JA(t)!==JA(e))return!1;var o=XA(t),a=XA(e);if(o!==a)return!1;var l=t instanceof Error,c=e instanceof Error;if(l!==c||(l||c)&&(t.name!==e.name||t.message!==e.message))return!1;var d=tT(t),h=tT(e);if(d!==h||(d||h)&&(t.source!==e.source||KA(t)!==KA(e)))return!1;var f=eT(t),p=eT(e);if(f!==p||(f||p)&&uT(t)!==uT(e)||n.strict&&e_&&e_(t)!==e_(e))return!1;var y=oT(t),v=oT(e);if(y!==v)return!1;if(y||v){if(t.length!==e.length)return!1;for(s=0;s<t.length;s++)if(t[s]!==e[s])return!1;return!0}var _=pT(t),g=pT(e);if(_!==g)return!1;if(_||g){if(t.length!==e.length)return!1;for(s=0;s<t.length;s++)if(t[s]!==e[s])return!1;return!0}var m=ZA(t),w=ZA(e);if(m!==w)return!1;if(m||w)return aT(t)!==aT(e)?!1:typeof Uint8Array=="function"&&Sr(new Uint8Array(t),new Uint8Array(e),n,r);var E=nT(t),T=nT(e);if(E!==T)return!1;if(E||T)return lT(t)!==lT(e)?!1:typeof Uint8Array=="function"&&Sr(new Uint8Array(t),new Uint8Array(e),n,r);if(typeof t!=typeof e)return!1;var C=rT(t),I=rT(e);if(C.length!==I.length)return!1;for(C.sort(),I.sort(),s=C.length-1;s>=0;s--)if(C[s]!=I[s])return!1;for(s=C.length-1;s>=0;s--)if(i=C[s],!Sr(t[i],e[i],n,r))return!1;var k=iT(t),O=iT(e);return k!==O?!1:k==="Set"||O==="Set"?R7(t,e,n,r):k==="Map"?P7(t,e,n,r):!0}var j7=function(e,n,r){return Sr(e,n,r,T7())};const O7=ow(j7),D7=(t,e)=>O7(t,e);var F7="firebase",$7="10.5.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Qr(F7,$7,"app");const M7={apiKey:"AIzaSyCa4jaiAOgH5H8B6hSo4DU49WnkpGPeavA",authDomain:"hkmjbs-streaming.firebaseapp.com",databaseURL:"https://hkmjbs-streaming-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"hkmjbs-streaming",storageBucket:"hkmjbs-streaming.appspot.com",messagingSenderId:"537815456325",appId:"1:537815456325:web:c387796326f9db2726a12c"},cE=XP(M7),ba=$5(cE);window.location.hostname==="localhost"&&x2(ba,"localhost",9e3);const Qj={database:ba,get:t=>{const e=tc(ba,t);return _2(e).then(n=>{if(n.exists())return n.val()}).catch(n=>{throw console.error(n),n})},set:(t,e)=>{const n=tc(ba,t);return H1(n,e).catch(r=>{throw console.error(r),r})},update:(t,e)=>{const n=tc(ba,t);return v2(n,e).catch(r=>{throw console.error(r),r})},push:(t,e)=>{const n=tc(ba,t);return g2(n,e).catch(r=>{throw console.error(r),r})}},dE=x.createContext(Qj);function L7({children:t}){return u.jsx(dE.Provider,{value:Qj,children:t})}const Kj=()=>x.useContext(dE),Mn=(t,e)=>{const{database:n}=x.useContext(dE),r=x.useMemo(()=>tc(n,t),[n,t]),[s,i]=x.useState(),[o,a]=x.useState(e),l=x.useCallback(f=>H1(r,f),[r]),c=x.useCallback(f=>v2(r,f),[r]),d=x.useCallback(f=>g2(r,f),[r]);return x.useEffect(()=>{D7(e,o)||a(e)},[o,e]),x.useEffect(()=>{const f=[];o!=null&&o.order&&o.order.byChild&&f.push(A5(o.order.byChild)),o!=null&&o.filter&&(typeof o.filter.equalTo<"u"&&f.push(I5(o.filter.equalTo)),typeof o.filter.limitToLast<"u"&&f.push(S5(o.filter.limitToLast)));const p=f.length>0?k5(r,...f):r;o!=null&&o.onlyOnce?_2(p).then(y=>{y.exists()&&i(y.val())}):x5(p,y=>{i(y.val())},o??{})},[o,r]),{data:x.useMemo(()=>s,[s]),set:l,update:c,push:d}};var hh=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},nu=typeof window>"u"||"Deno"in window;function Gn(){}function V7(t,e){return typeof t=="function"?t(e):t}function hx(t){return typeof t=="number"&&t>=0&&t!==1/0}function Yj(t,e){return Math.max(t+(e||0)-Date.now(),0)}function yT(t,e){const{type:n="all",exact:r,fetchStatus:s,predicate:i,queryKey:o,stale:a}=t;if(o){if(r){if(e.queryHash!==hE(o,e.options))return!1}else if(!yd(e.queryKey,o))return!1}if(n!=="all"){const l=e.isActive();if(n==="active"&&!l||n==="inactive"&&l)return!1}return!(typeof a=="boolean"&&e.isStale()!==a||typeof s<"u"&&s!==e.state.fetchStatus||i&&!i(e))}function mT(t,e){const{exact:n,status:r,predicate:s,mutationKey:i}=t;if(i){if(!e.options.mutationKey)return!1;if(n){if(pd(e.options.mutationKey)!==pd(i))return!1}else if(!yd(e.options.mutationKey,i))return!1}return!(r&&e.state.status!==r||s&&!s(e))}function hE(t,e){return((e==null?void 0:e.queryKeyHashFn)||pd)(t)}function pd(t){return JSON.stringify(t,(e,n)=>px(n)?Object.keys(n).sort().reduce((r,s)=>(r[s]=n[s],r),{}):n)}function yd(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?!Object.keys(e).some(n=>!yd(t[n],e[n])):!1}function Jj(t,e){if(t===e)return t;const n=gT(t)&&gT(e);if(n||px(t)&&px(e)){const r=n?t.length:Object.keys(t).length,s=n?e:Object.keys(e),i=s.length,o=n?[]:{};let a=0;for(let l=0;l<i;l++){const c=n?l:s[l];o[c]=Jj(t[c],e[c]),o[c]===t[c]&&a++}return r===i&&a===r?t:o}return e}function fx(t,e){if(t&&!e||e&&!t)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function gT(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function px(t){if(!vT(t))return!1;const e=t.constructor;if(typeof e>"u")return!0;const n=e.prototype;return!(!vT(n)||!n.hasOwnProperty("isPrototypeOf"))}function vT(t){return Object.prototype.toString.call(t)==="[object Object]"}function Xj(t){return new Promise(e=>{setTimeout(e,t)})}function _T(t){Xj(0).then(t)}function yx(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?Jj(t,e):e}function U7(t,e,n=0){const r=[...t,e];return n&&r.length>n?r.slice(1):r}function B7(t,e,n=0){const r=[e,...t];return n&&r.length>n?r.slice(0,-1):r}var lo,zs,gl,pk,z7=(pk=class extends hh{constructor(){super();ee(this,lo,void 0);ee(this,zs,void 0);ee(this,gl,void 0);H(this,gl,e=>{if(!nu&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){A(this,zs)||this.setEventListener(A(this,gl))}onUnsubscribe(){var e;this.hasListeners()||((e=A(this,zs))==null||e.call(this),H(this,zs,void 0))}setEventListener(e){var n;H(this,gl,e),(n=A(this,zs))==null||n.call(this),H(this,zs,e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(e){A(this,lo)!==e&&(H(this,lo,e),this.onFocus())}onFocus(){this.listeners.forEach(e=>{e()})}isFocused(){var e;return typeof A(this,lo)=="boolean"?A(this,lo):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},lo=new WeakMap,zs=new WeakMap,gl=new WeakMap,pk),Ay=new z7,vl,Ws,_l,yk,W7=(yk=class extends hh{constructor(){super();ee(this,vl,!0);ee(this,Ws,void 0);ee(this,_l,void 0);H(this,_l,e=>{if(!nu&&window.addEventListener){const n=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){A(this,Ws)||this.setEventListener(A(this,_l))}onUnsubscribe(){var e;this.hasListeners()||((e=A(this,Ws))==null||e.call(this),H(this,Ws,void 0))}setEventListener(e){var n;H(this,_l,e),(n=A(this,Ws))==null||n.call(this),H(this,Ws,e(this.setOnline.bind(this)))}setOnline(e){A(this,vl)!==e&&(H(this,vl,e),this.listeners.forEach(r=>{r(e)}))}isOnline(){return A(this,vl)}},vl=new WeakMap,Ws=new WeakMap,_l=new WeakMap,yk),Ty=new W7;function q7(t){return Math.min(1e3*2**t,3e4)}function Zm(t){return(t??"online")==="online"?Ty.isOnline():!0}var Zj=class{constructor(t){this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function t_(t){return t instanceof Zj}function eO(t){let e=!1,n=0,r=!1,s,i,o;const a=new Promise((_,g)=>{i=_,o=g}),l=_=>{var g;r||(p(new Zj(_)),(g=t.abort)==null||g.call(t))},c=()=>{e=!0},d=()=>{e=!1},h=()=>!Ay.isFocused()||t.networkMode!=="always"&&!Ty.isOnline(),f=_=>{var g;r||(r=!0,(g=t.onSuccess)==null||g.call(t,_),s==null||s(),i(_))},p=_=>{var g;r||(r=!0,(g=t.onError)==null||g.call(t,_),s==null||s(),o(_))},y=()=>new Promise(_=>{var g;s=m=>{const w=r||!h();return w&&_(m),w},(g=t.onPause)==null||g.call(t)}).then(()=>{var _;s=void 0,r||(_=t.onContinue)==null||_.call(t)}),v=()=>{if(r)return;let _;try{_=t.fn()}catch(g){_=Promise.reject(g)}Promise.resolve(_).then(f).catch(g=>{var C;if(r)return;const m=t.retry??(nu?0:3),w=t.retryDelay??q7,E=typeof w=="function"?w(n,g):w,T=m===!0||typeof m=="number"&&n<m||typeof m=="function"&&m(n,g);if(e||!T){p(g);return}n++,(C=t.onFail)==null||C.call(t,n,g),Xj(E).then(()=>{if(h())return y()}).then(()=>{e?p(g):v()})})};return Zm(t.networkMode)?v():y().then(v),{promise:a,cancel:l,continue:()=>(s==null?void 0:s())?a:Promise.resolve(),cancelRetry:c,continueRetry:d}}function H7(){let t=[],e=0,n=d=>{d()},r=d=>{d()};const s=d=>{let h;e++;try{h=d()}finally{e--,e||a()}return h},i=d=>{e?t.push(d):_T(()=>{n(d)})},o=d=>(...h)=>{i(()=>{d(...h)})},a=()=>{const d=t;t=[],d.length&&_T(()=>{r(()=>{d.forEach(h=>{n(h)})})})};return{batch:s,batchCalls:o,schedule:i,setNotifyFunction:d=>{n=d},setBatchNotifyFunction:d=>{r=d}}}var Ut=H7(),uo,mk,tO=(mk=class{constructor(){ee(this,uo,void 0)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),hx(this.gcTime)&&H(this,uo,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(nu?1/0:5*60*1e3))}clearGcTimeout(){A(this,uo)&&(clearTimeout(A(this,uo)),H(this,uo,void 0))}},uo=new WeakMap,mk),xl,wl,Wn,qs,qn,Ct,Nd,co,El,Kf,hr,as,gk,G7=(gk=class extends tO{constructor(n){super();ee(this,El);ee(this,hr);ee(this,xl,void 0);ee(this,wl,void 0);ee(this,Wn,void 0);ee(this,qs,void 0);ee(this,qn,void 0);ee(this,Ct,void 0);ee(this,Nd,void 0);ee(this,co,void 0);H(this,co,!1),H(this,Nd,n.defaultOptions),fe(this,El,Kf).call(this,n.options),H(this,Ct,[]),H(this,Wn,n.cache),this.queryKey=n.queryKey,this.queryHash=n.queryHash,H(this,xl,n.state||Q7(this.options)),this.state=A(this,xl),this.scheduleGc()}get meta(){return this.options.meta}optionalRemove(){!A(this,Ct).length&&this.state.fetchStatus==="idle"&&A(this,Wn).remove(this)}setData(n,r){const s=yx(this.state.data,n,this.options);return fe(this,hr,as).call(this,{data:s,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),s}setState(n,r){fe(this,hr,as).call(this,{type:"setState",state:n,setStateOptions:r})}cancel(n){var s;const r=A(this,qs);return(s=A(this,qn))==null||s.cancel(n),r?r.then(Gn).catch(Gn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(A(this,xl))}isActive(){return A(this,Ct).some(n=>n.options.enabled!==!1)}isDisabled(){return this.getObserversCount()>0&&!this.isActive()}isStale(){return this.state.isInvalidated||!this.state.dataUpdatedAt||A(this,Ct).some(n=>n.getCurrentResult().isStale)}isStaleByTime(n=0){return this.state.isInvalidated||!this.state.dataUpdatedAt||!Yj(this.state.dataUpdatedAt,n)}onFocus(){var r;const n=A(this,Ct).find(s=>s.shouldFetchOnWindowFocus());n==null||n.refetch({cancelRefetch:!1}),(r=A(this,qn))==null||r.continue()}onOnline(){var r;const n=A(this,Ct).find(s=>s.shouldFetchOnReconnect());n==null||n.refetch({cancelRefetch:!1}),(r=A(this,qn))==null||r.continue()}addObserver(n){A(this,Ct).includes(n)||(A(this,Ct).push(n),this.clearGcTimeout(),A(this,Wn).notify({type:"observerAdded",query:this,observer:n}))}removeObserver(n){A(this,Ct).includes(n)&&(H(this,Ct,A(this,Ct).filter(r=>r!==n)),A(this,Ct).length||(A(this,qn)&&(A(this,co)?A(this,qn).cancel({revert:!0}):A(this,qn).cancelRetry()),this.scheduleGc()),A(this,Wn).notify({type:"observerRemoved",query:this,observer:n}))}getObserversCount(){return A(this,Ct).length}invalidate(){this.state.isInvalidated||fe(this,hr,as).call(this,{type:"invalidate"})}fetch(n,r){var d,h,f,p;if(this.state.fetchStatus!=="idle"){if(this.state.dataUpdatedAt&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(A(this,qs))return(d=A(this,qn))==null||d.continueRetry(),A(this,qs)}if(n&&fe(this,El,Kf).call(this,n),!this.options.queryFn){const y=A(this,Ct).find(v=>v.options.queryFn);y&&fe(this,El,Kf).call(this,y.options)}const s=new AbortController,i={queryKey:this.queryKey,meta:this.meta},o=y=>{Object.defineProperty(y,"signal",{enumerable:!0,get:()=>(H(this,co,!0),s.signal)})};o(i);const a=()=>this.options.queryFn?(H(this,co,!1),this.options.persister?this.options.persister(this.options.queryFn,i,this):this.options.queryFn(i)):Promise.reject(new Error(`Missing queryFn: '${this.options.queryHash}'`)),l={fetchOptions:r,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:a};o(l),(h=this.options.behavior)==null||h.onFetch(l,this),H(this,wl,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((f=l.fetchOptions)==null?void 0:f.meta))&&fe(this,hr,as).call(this,{type:"fetch",meta:(p=l.fetchOptions)==null?void 0:p.meta});const c=y=>{var v,_,g,m;t_(y)&&y.silent||fe(this,hr,as).call(this,{type:"error",error:y}),t_(y)||((_=(v=A(this,Wn).config).onError)==null||_.call(v,y,this),(m=(g=A(this,Wn).config).onSettled)==null||m.call(g,this.state.data,y,this)),this.isFetchingOptimistic||this.scheduleGc(),this.isFetchingOptimistic=!1};return H(this,qn,eO({fn:l.fetchFn,abort:s.abort.bind(s),onSuccess:y=>{var v,_,g,m;if(typeof y>"u"){c(new Error(`${this.queryHash} data is undefined`));return}this.setData(y),(_=(v=A(this,Wn).config).onSuccess)==null||_.call(v,y,this),(m=(g=A(this,Wn).config).onSettled)==null||m.call(g,y,this.state.error,this),this.isFetchingOptimistic||this.scheduleGc(),this.isFetchingOptimistic=!1},onError:c,onFail:(y,v)=>{fe(this,hr,as).call(this,{type:"failed",failureCount:y,error:v})},onPause:()=>{fe(this,hr,as).call(this,{type:"pause"})},onContinue:()=>{fe(this,hr,as).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode})),H(this,qs,A(this,qn).promise),A(this,qs)}},xl=new WeakMap,wl=new WeakMap,Wn=new WeakMap,qs=new WeakMap,qn=new WeakMap,Ct=new WeakMap,Nd=new WeakMap,co=new WeakMap,El=new WeakSet,Kf=function(n){this.options={...A(this,Nd),...n},this.updateGcTime(this.options.gcTime)},hr=new WeakSet,as=function(n){const r=s=>{switch(n.type){case"failed":return{...s,fetchFailureCount:n.failureCount,fetchFailureReason:n.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:n.meta??null,fetchStatus:Zm(this.options.networkMode)?"fetching":"paused",...!s.dataUpdatedAt&&{error:null,status:"pending"}};case"success":return{...s,data:n.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:n.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!n.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const i=n.error;return t_(i)&&i.revert&&A(this,wl)?{...A(this,wl),fetchStatus:"idle"}:{...s,error:i,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...n.state}}};this.state=r(this.state),Ut.batch(()=>{A(this,Ct).forEach(s=>{s.onQueryUpdate()}),A(this,Wn).notify({query:this,type:"updated",action:n})})},gk);function Q7(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=typeof e<"u",r=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Nr,vk,K7=(vk=class extends hh{constructor(e={}){super();ee(this,Nr,void 0);this.config=e,H(this,Nr,new Map)}build(e,n,r){const s=n.queryKey,i=n.queryHash??hE(s,n);let o=this.get(i);return o||(o=new G7({cache:this,queryKey:s,queryHash:i,options:e.defaultQueryOptions(n),state:r,defaultOptions:e.getQueryDefaults(s)}),this.add(o)),o}add(e){A(this,Nr).has(e.queryHash)||(A(this,Nr).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=A(this,Nr).get(e.queryHash);n&&(e.destroy(),n===e&&A(this,Nr).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Ut.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return A(this,Nr).get(e)}getAll(){return[...A(this,Nr).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(r=>yT(n,r))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(r=>yT(e,r)):n}notify(e){Ut.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){Ut.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Ut.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Nr=new WeakMap,vk),jr,jd,Pn,bl,Or,js,_k,Y7=(_k=class extends tO{constructor(n){super();ee(this,Or);ee(this,jr,void 0);ee(this,jd,void 0);ee(this,Pn,void 0);ee(this,bl,void 0);this.mutationId=n.mutationId,H(this,jd,n.defaultOptions),H(this,Pn,n.mutationCache),H(this,jr,[]),this.state=n.state||J7(),this.setOptions(n.options),this.scheduleGc()}setOptions(n){this.options={...A(this,jd),...n},this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(n){A(this,jr).includes(n)||(A(this,jr).push(n),this.clearGcTimeout(),A(this,Pn).notify({type:"observerAdded",mutation:this,observer:n}))}removeObserver(n){H(this,jr,A(this,jr).filter(r=>r!==n)),this.scheduleGc(),A(this,Pn).notify({type:"observerRemoved",mutation:this,observer:n})}optionalRemove(){A(this,jr).length||(this.state.status==="pending"?this.scheduleGc():A(this,Pn).remove(this))}continue(){var n;return((n=A(this,bl))==null?void 0:n.continue())??this.execute(this.state.variables)}async execute(n){var i,o,a,l,c,d,h,f,p,y,v,_,g,m,w,E,T,C,I,k;const r=()=>(H(this,bl,eO({fn:()=>this.options.mutationFn?this.options.mutationFn(n):Promise.reject(new Error("No mutationFn found")),onFail:(O,L)=>{fe(this,Or,js).call(this,{type:"failed",failureCount:O,error:L})},onPause:()=>{fe(this,Or,js).call(this,{type:"pause"})},onContinue:()=>{fe(this,Or,js).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode})),A(this,bl).promise),s=this.state.status==="pending";try{if(!s){fe(this,Or,js).call(this,{type:"pending",variables:n}),await((o=(i=A(this,Pn).config).onMutate)==null?void 0:o.call(i,n,this));const L=await((l=(a=this.options).onMutate)==null?void 0:l.call(a,n));L!==this.state.context&&fe(this,Or,js).call(this,{type:"pending",context:L,variables:n})}const O=await r();return await((d=(c=A(this,Pn).config).onSuccess)==null?void 0:d.call(c,O,n,this.state.context,this)),await((f=(h=this.options).onSuccess)==null?void 0:f.call(h,O,n,this.state.context)),await((y=(p=A(this,Pn).config).onSettled)==null?void 0:y.call(p,O,null,this.state.variables,this.state.context,this)),await((_=(v=this.options).onSettled)==null?void 0:_.call(v,O,null,n,this.state.context)),fe(this,Or,js).call(this,{type:"success",data:O}),O}catch(O){try{throw await((m=(g=A(this,Pn).config).onError)==null?void 0:m.call(g,O,n,this.state.context,this)),await((E=(w=this.options).onError)==null?void 0:E.call(w,O,n,this.state.context)),await((C=(T=A(this,Pn).config).onSettled)==null?void 0:C.call(T,void 0,O,this.state.variables,this.state.context,this)),await((k=(I=this.options).onSettled)==null?void 0:k.call(I,void 0,O,n,this.state.context)),O}finally{fe(this,Or,js).call(this,{type:"error",error:O})}}}},jr=new WeakMap,jd=new WeakMap,Pn=new WeakMap,bl=new WeakMap,Or=new WeakSet,js=function(n){const r=s=>{switch(n.type){case"failed":return{...s,failureCount:n.failureCount,failureReason:n.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:n.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:!Zm(this.options.networkMode),status:"pending",variables:n.variables,submittedAt:Date.now()};case"success":return{...s,data:n.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:n.error,failureCount:s.failureCount+1,failureReason:n.error,isPaused:!1,status:"error"}}};this.state=r(this.state),Ut.batch(()=>{A(this,jr).forEach(s=>{s.onMutationUpdate(n)}),A(this,Pn).notify({mutation:this,type:"updated",action:n})})},_k);function J7(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Hn,Od,ho,xk,X7=(xk=class extends hh{constructor(e={}){super();ee(this,Hn,void 0);ee(this,Od,void 0);ee(this,ho,void 0);this.config=e,H(this,Hn,[]),H(this,Od,0)}build(e,n,r){const s=new Y7({mutationCache:this,mutationId:++$h(this,Od)._,options:e.defaultMutationOptions(n),state:r});return this.add(s),s}add(e){A(this,Hn).push(e),this.notify({type:"added",mutation:e})}remove(e){H(this,Hn,A(this,Hn).filter(n=>n!==e)),this.notify({type:"removed",mutation:e})}clear(){Ut.batch(()=>{A(this,Hn).forEach(e=>{this.remove(e)})})}getAll(){return A(this,Hn)}find(e){const n={exact:!0,...e};return A(this,Hn).find(r=>mT(n,r))}findAll(e={}){return A(this,Hn).filter(n=>mT(e,n))}notify(e){Ut.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){return H(this,ho,(A(this,ho)??Promise.resolve()).then(()=>{const e=A(this,Hn).filter(n=>n.state.isPaused);return Ut.batch(()=>e.reduce((n,r)=>n.then(()=>r.continue().catch(Gn)),Promise.resolve()))}).then(()=>{H(this,ho,void 0)})),A(this,ho)}},Hn=new WeakMap,Od=new WeakMap,ho=new WeakMap,xk);function Z7(t){return{onFetch:(e,n)=>{const r=async()=>{var y,v,_,g,m;const s=e.options,i=(_=(v=(y=e.fetchOptions)==null?void 0:y.meta)==null?void 0:v.fetchMore)==null?void 0:_.direction,o=((g=e.state.data)==null?void 0:g.pages)||[],a=((m=e.state.data)==null?void 0:m.pageParams)||[],l={pages:[],pageParams:[]};let c=!1;const d=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(e.signal.aborted?c=!0:e.signal.addEventListener("abort",()=>{c=!0}),e.signal)})},h=e.options.queryFn||(()=>Promise.reject(new Error(`Missing queryFn: '${e.options.queryHash}'`))),f=async(w,E,T)=>{if(c)return Promise.reject();if(E==null&&w.pages.length)return Promise.resolve(w);const C={queryKey:e.queryKey,pageParam:E,direction:T?"backward":"forward",meta:e.options.meta};d(C);const I=await h(C),{maxPages:k}=e.options,O=T?B7:U7;return{pages:O(w.pages,I,k),pageParams:O(w.pageParams,E,k)}};let p;if(i&&o.length){const w=i==="backward",E=w?eG:xT,T={pages:o,pageParams:a},C=E(s,T);p=await f(T,C,w)}else{p=await f(l,a[0]??s.initialPageParam);const w=t??o.length;for(let E=1;E<w;E++){const T=xT(s,p);p=await f(p,T)}}return p};e.options.persister?e.fetchFn=()=>{var s,i;return(i=(s=e.options).persister)==null?void 0:i.call(s,r,{queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=r}}}function xT(t,{pages:e,pageParams:n}){const r=e.length-1;return t.getNextPageParam(e[r],e,n[r],n)}function eG(t,{pages:e,pageParams:n}){var r;return(r=t.getPreviousPageParam)==null?void 0:r.call(t,e[0],e,n[0],n)}var mt,Hs,Gs,Sl,Cl,Qs,Al,Tl,wk,tG=(wk=class{constructor(t={}){ee(this,mt,void 0);ee(this,Hs,void 0);ee(this,Gs,void 0);ee(this,Sl,void 0);ee(this,Cl,void 0);ee(this,Qs,void 0);ee(this,Al,void 0);ee(this,Tl,void 0);H(this,mt,t.queryCache||new K7),H(this,Hs,t.mutationCache||new X7),H(this,Gs,t.defaultOptions||{}),H(this,Sl,new Map),H(this,Cl,new Map),H(this,Qs,0)}mount(){$h(this,Qs)._++,A(this,Qs)===1&&(H(this,Al,Ay.subscribe(()=>{Ay.isFocused()&&(this.resumePausedMutations(),A(this,mt).onFocus())})),H(this,Tl,Ty.subscribe(()=>{Ty.isOnline()&&(this.resumePausedMutations(),A(this,mt).onOnline())})))}unmount(){var t,e;$h(this,Qs)._--,A(this,Qs)===0&&((t=A(this,Al))==null||t.call(this),H(this,Al,void 0),(e=A(this,Tl))==null||e.call(this),H(this,Tl,void 0))}isFetching(t){return A(this,mt).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return A(this,Hs).findAll({...t,status:"pending"}).length}getQueryData(t){var e;return(e=A(this,mt).find({queryKey:t}))==null?void 0:e.state.data}ensureQueryData(t){const e=this.getQueryData(t.queryKey);return e!==void 0?Promise.resolve(e):this.fetchQuery(t)}getQueriesData(t){return this.getQueryCache().findAll(t).map(({queryKey:e,state:n})=>{const r=n.data;return[e,r]})}setQueryData(t,e,n){const r=A(this,mt).find({queryKey:t}),s=r==null?void 0:r.state.data,i=V7(e,s);if(typeof i>"u")return;const o=this.defaultQueryOptions({queryKey:t});return A(this,mt).build(this,o).setData(i,{...n,manual:!0})}setQueriesData(t,e,n){return Ut.batch(()=>this.getQueryCache().findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,n)]))}getQueryState(t){var e;return(e=A(this,mt).find({queryKey:t}))==null?void 0:e.state}removeQueries(t){const e=A(this,mt);Ut.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=A(this,mt),r={type:"active",...t};return Ut.batch(()=>(n.findAll(t).forEach(s=>{s.reset()}),this.refetchQueries(r,e)))}cancelQueries(t={},e={}){const n={revert:!0,...e},r=Ut.batch(()=>A(this,mt).findAll(t).map(s=>s.cancel(n)));return Promise.all(r).then(Gn).catch(Gn)}invalidateQueries(t={},e={}){return Ut.batch(()=>{if(A(this,mt).findAll(t).forEach(r=>{r.invalidate()}),t.refetchType==="none")return Promise.resolve();const n={...t,type:t.refetchType??t.type??"active"};return this.refetchQueries(n,e)})}refetchQueries(t={},e){const n={...e,cancelRefetch:(e==null?void 0:e.cancelRefetch)??!0},r=Ut.batch(()=>A(this,mt).findAll(t).filter(s=>!s.isDisabled()).map(s=>{let i=s.fetch(void 0,n);return n.throwOnError||(i=i.catch(Gn)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(Gn)}fetchQuery(t){const e=this.defaultQueryOptions(t);typeof e.retry>"u"&&(e.retry=!1);const n=A(this,mt).build(this,e);return n.isStaleByTime(e.staleTime)?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Gn).catch(Gn)}fetchInfiniteQuery(t){return t.behavior=Z7(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Gn).catch(Gn)}resumePausedMutations(){return A(this,Hs).resumePausedMutations()}getQueryCache(){return A(this,mt)}getMutationCache(){return A(this,Hs)}getDefaultOptions(){return A(this,Gs)}setDefaultOptions(t){H(this,Gs,t)}setQueryDefaults(t,e){A(this,Sl).set(pd(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...A(this,Sl).values()];let n={};return e.forEach(r=>{yd(t,r.queryKey)&&(n={...n,...r.defaultOptions})}),n}setMutationDefaults(t,e){A(this,Cl).set(pd(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...A(this,Cl).values()];let n={};return e.forEach(r=>{yd(t,r.mutationKey)&&(n={...n,...r.defaultOptions})}),n}defaultQueryOptions(t){if(t!=null&&t._defaulted)return t;const e={...A(this,Gs).queries,...(t==null?void 0:t.queryKey)&&this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=hE(e.queryKey,e)),typeof e.refetchOnReconnect>"u"&&(e.refetchOnReconnect=e.networkMode!=="always"),typeof e.throwOnError>"u"&&(e.throwOnError=!!e.suspense),typeof e.networkMode>"u"&&e.persister&&(e.networkMode="offlineFirst"),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...A(this,Gs).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){A(this,mt).clear(),A(this,Hs).clear()}},mt=new WeakMap,Hs=new WeakMap,Gs=new WeakMap,Sl=new WeakMap,Cl=new WeakMap,Qs=new WeakMap,Al=new WeakMap,Tl=new WeakMap,wk),wn,De,Il,Zt,fo,kl,Dr,Dd,Rl,Pl,po,yo,Ks,mo,go,nc,Fd,mx,$d,gx,Md,vx,Ld,_x,Vd,xx,Ud,wx,Bd,Ex,fm,nO,Ek,nG=(Ek=class extends hh{constructor(e,n){super();ee(this,go);ee(this,Fd);ee(this,$d);ee(this,Md);ee(this,Ld);ee(this,Vd);ee(this,Ud);ee(this,Bd);ee(this,fm);ee(this,wn,void 0);ee(this,De,void 0);ee(this,Il,void 0);ee(this,Zt,void 0);ee(this,fo,void 0);ee(this,kl,void 0);ee(this,Dr,void 0);ee(this,Dd,void 0);ee(this,Rl,void 0);ee(this,Pl,void 0);ee(this,po,void 0);ee(this,yo,void 0);ee(this,Ks,void 0);ee(this,mo,void 0);H(this,De,void 0),H(this,Il,void 0),H(this,Zt,void 0),H(this,mo,new Set),H(this,wn,e),this.options=n,H(this,Dr,null),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(A(this,De).addObserver(this),wT(A(this,De),this.options)?fe(this,go,nc).call(this):this.updateResult(),fe(this,Ld,_x).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return bx(A(this,De),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return bx(A(this,De),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,fe(this,Vd,xx).call(this),fe(this,Ud,wx).call(this),A(this,De).removeObserver(this)}setOptions(e,n){const r=this.options,s=A(this,De);if(this.options=A(this,wn).defaultQueryOptions(e),fx(r,this.options)||A(this,wn).getQueryCache().notify({type:"observerOptionsUpdated",query:A(this,De),observer:this}),typeof this.options.enabled<"u"&&typeof this.options.enabled!="boolean")throw new Error("Expected enabled to be a boolean");this.options.queryKey||(this.options.queryKey=r.queryKey),fe(this,Bd,Ex).call(this);const i=this.hasListeners();i&&ET(A(this,De),s,this.options,r)&&fe(this,go,nc).call(this),this.updateResult(n),i&&(A(this,De)!==s||this.options.enabled!==r.enabled||this.options.staleTime!==r.staleTime)&&fe(this,Fd,mx).call(this);const o=fe(this,$d,gx).call(this);i&&(A(this,De)!==s||this.options.enabled!==r.enabled||o!==A(this,Ks))&&fe(this,Md,vx).call(this,o)}getOptimisticResult(e){const n=A(this,wn).getQueryCache().build(A(this,wn),e),r=this.createResult(n,e);return sG(this,r)&&(H(this,Zt,r),H(this,kl,this.options),H(this,fo,A(this,De).state)),r}getCurrentResult(){return A(this,Zt)}trackResult(e){const n={};return Object.keys(e).forEach(r=>{Object.defineProperty(n,r,{configurable:!1,enumerable:!0,get:()=>(A(this,mo).add(r),e[r])})}),n}getCurrentQuery(){return A(this,De)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const n=A(this,wn).defaultQueryOptions(e),r=A(this,wn).getQueryCache().build(A(this,wn),n);return r.isFetchingOptimistic=!0,r.fetch().then(()=>this.createResult(r,n))}fetch(e){return fe(this,go,nc).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),A(this,Zt)))}createResult(e,n){var C;const r=A(this,De),s=this.options,i=A(this,Zt),o=A(this,fo),a=A(this,kl),c=e!==r?e.state:A(this,Il),{state:d}=e;let{error:h,errorUpdatedAt:f,fetchStatus:p,status:y}=d,v=!1,_;if(n._optimisticResults){const I=this.hasListeners(),k=!I&&wT(e,n),O=I&&ET(e,r,n,s);(k||O)&&(p=Zm(e.options.networkMode)?"fetching":"paused",d.dataUpdatedAt||(y="pending")),n._optimisticResults==="isRestoring"&&(p="idle")}if(n.select&&typeof d.data<"u")if(i&&d.data===(o==null?void 0:o.data)&&n.select===A(this,Dd))_=A(this,Rl);else try{H(this,Dd,n.select),_=n.select(d.data),_=yx(i==null?void 0:i.data,_,n),H(this,Rl,_),H(this,Dr,null)}catch(I){H(this,Dr,I)}else _=d.data;if(typeof n.placeholderData<"u"&&typeof _>"u"&&y==="pending"){let I;if(i!=null&&i.isPlaceholderData&&n.placeholderData===(a==null?void 0:a.placeholderData))I=i.data;else if(I=typeof n.placeholderData=="function"?n.placeholderData((C=A(this,Pl))==null?void 0:C.state.data,A(this,Pl)):n.placeholderData,n.select&&typeof I<"u")try{I=n.select(I),H(this,Dr,null)}catch(k){H(this,Dr,k)}typeof I<"u"&&(y="success",_=yx(i==null?void 0:i.data,I,n),v=!0)}A(this,Dr)&&(h=A(this,Dr),_=A(this,Rl),f=Date.now(),y="error");const g=p==="fetching",m=y==="pending",w=y==="error",E=m&&g;return{status:y,fetchStatus:p,isPending:m,isSuccess:y==="success",isError:w,isInitialLoading:E,isLoading:E,data:_,dataUpdatedAt:d.dataUpdatedAt,error:h,errorUpdatedAt:f,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>c.dataUpdateCount||d.errorUpdateCount>c.errorUpdateCount,isFetching:g,isRefetching:g&&!m,isLoadingError:w&&d.dataUpdatedAt===0,isPaused:p==="paused",isPlaceholderData:v,isRefetchError:w&&d.dataUpdatedAt!==0,isStale:fE(e,n),refetch:this.refetch}}updateResult(e){const n=A(this,Zt),r=this.createResult(A(this,De),this.options);if(H(this,fo,A(this,De).state),H(this,kl,this.options),A(this,fo).data!==void 0&&H(this,Pl,A(this,De)),fx(r,n))return;H(this,Zt,r);const s={},i=()=>{if(!n)return!0;const{notifyOnChangeProps:o}=this.options,a=typeof o=="function"?o():o;if(a==="all"||!a&&!A(this,mo).size)return!0;const l=new Set(a??A(this,mo));return this.options.throwOnError&&l.add("error"),Object.keys(A(this,Zt)).some(c=>{const d=c;return A(this,Zt)[d]!==n[d]&&l.has(d)})};(e==null?void 0:e.listeners)!==!1&&i()&&(s.listeners=!0),fe(this,fm,nO).call(this,{...s,...e})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&fe(this,Ld,_x).call(this)}},wn=new WeakMap,De=new WeakMap,Il=new WeakMap,Zt=new WeakMap,fo=new WeakMap,kl=new WeakMap,Dr=new WeakMap,Dd=new WeakMap,Rl=new WeakMap,Pl=new WeakMap,po=new WeakMap,yo=new WeakMap,Ks=new WeakMap,mo=new WeakMap,go=new WeakSet,nc=function(e){fe(this,Bd,Ex).call(this);let n=A(this,De).fetch(this.options,e);return e!=null&&e.throwOnError||(n=n.catch(Gn)),n},Fd=new WeakSet,mx=function(){if(fe(this,Vd,xx).call(this),nu||A(this,Zt).isStale||!hx(this.options.staleTime))return;const n=Yj(A(this,Zt).dataUpdatedAt,this.options.staleTime)+1;H(this,po,setTimeout(()=>{A(this,Zt).isStale||this.updateResult()},n))},$d=new WeakSet,gx=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(A(this,De)):this.options.refetchInterval)??!1},Md=new WeakSet,vx=function(e){fe(this,Ud,wx).call(this),H(this,Ks,e),!(nu||this.options.enabled===!1||!hx(A(this,Ks))||A(this,Ks)===0)&&H(this,yo,setInterval(()=>{(this.options.refetchIntervalInBackground||Ay.isFocused())&&fe(this,go,nc).call(this)},A(this,Ks)))},Ld=new WeakSet,_x=function(){fe(this,Fd,mx).call(this),fe(this,Md,vx).call(this,fe(this,$d,gx).call(this))},Vd=new WeakSet,xx=function(){A(this,po)&&(clearTimeout(A(this,po)),H(this,po,void 0))},Ud=new WeakSet,wx=function(){A(this,yo)&&(clearInterval(A(this,yo)),H(this,yo,void 0))},Bd=new WeakSet,Ex=function(){const e=A(this,wn).getQueryCache().build(A(this,wn),this.options);if(e===A(this,De))return;const n=A(this,De);H(this,De,e),H(this,Il,e.state),this.hasListeners()&&(n==null||n.removeObserver(this),e.addObserver(this))},fm=new WeakSet,nO=function(e){Ut.batch(()=>{e.listeners&&this.listeners.forEach(n=>{n(A(this,Zt))}),A(this,wn).getQueryCache().notify({query:A(this,De),type:"observerResultsUpdated"})})},Ek);function rG(t,e){return e.enabled!==!1&&!t.state.dataUpdatedAt&&!(t.state.status==="error"&&e.retryOnMount===!1)}function wT(t,e){return rG(t,e)||t.state.dataUpdatedAt>0&&bx(t,e,e.refetchOnMount)}function bx(t,e,n){if(e.enabled!==!1){const r=typeof n=="function"?n(t):n;return r==="always"||r!==!1&&fE(t,e)}return!1}function ET(t,e,n,r){return n.enabled!==!1&&(t!==e||r.enabled===!1)&&(!n.suspense||t.state.status!=="error")&&fE(t,n)}function fE(t,e){return t.isStaleByTime(e.staleTime)}function sG(t,e){return!fx(t.getCurrentResult(),e)}var rO=x.createContext(void 0),iG=t=>{const e=x.useContext(rO);if(t)return t;if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},oG=({client:t,children:e})=>(x.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),x.createElement(rO.Provider,{value:t},e)),sO=x.createContext(!1),aG=()=>x.useContext(sO);sO.Provider;function lG(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var uG=x.createContext(lG()),cG=()=>x.useContext(uG);function dG(t,e){return typeof t=="function"?t(...e):!!t}var hG=(t,e)=>{(t.suspense||t.throwOnError)&&(e.isReset()||(t.retryOnMount=!1))},fG=t=>{x.useEffect(()=>{t.clearReset()},[t])},pG=({result:t,errorResetBoundary:e,throwOnError:n,query:r})=>t.isError&&!e.isReset()&&!t.isFetching&&dG(n,[t.error,r]),yG=t=>{t.suspense&&typeof t.staleTime!="number"&&(t.staleTime=1e3)},mG=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,gG=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function vG(t,e,n){const r=iG(n),s=aG(),i=cG(),o=r.defaultQueryOptions(t);o._optimisticResults=s?"isRestoring":"optimistic",yG(o),hG(o,i),fG(i);const[a]=x.useState(()=>new e(r,o)),l=a.getOptimisticResult(o);if(x.useSyncExternalStore(x.useCallback(c=>{const d=s?()=>{}:a.subscribe(Ut.batchCalls(c));return a.updateResult(),d},[a,s]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),x.useEffect(()=>{a.setOptions(o,{listeners:!1})},[o,a]),mG(o,l))throw a.setOptions(o,{listeners:!1}),gG(o,a,i);if(pG({result:l,errorResetBoundary:i,throwOnError:o.throwOnError,query:a.getCurrentQuery()}))throw l.error;return o.notifyOnChangeProps?l:a.trackResult(l)}function pE(t,e){return vG(t,nG,e)}function iO(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=iO(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function _G(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=iO(t))&&(r&&(r+=" "),r+=e);return r}const bT=t=>typeof t=="boolean"?"".concat(t):t===0?"0":t,ST=_G,oO=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return ST(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=e,o=Object.keys(s).map(c=>{const d=n==null?void 0:n[c],h=i==null?void 0:i[c];if(d===null)return null;const f=bT(d)||bT(h);return s[c][f]}),a=n&&Object.entries(n).reduce((c,d)=>{let[h,f]=d;return f===void 0||(c[h]=f),c},{}),l=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((c,d)=>{let{class:h,className:f,...p}=d;return Object.entries(p).every(y=>{let[v,_]=y;return Array.isArray(_)?_.includes({...i,...a}[v]):{...i,...a}[v]===_})?[...c,h,f]:c},[]);return ST(t,o,l,n==null?void 0:n.class,n==null?void 0:n.className)},xG=oO(["font-semibold"],{variants:{variant:{contained:["border","rounded"],text:[],icon:["hover:enabled:bg-opacity-50 leading-4"]},color:{primary:[],secondary:[],success:[],danger:[],inverted:[]},size:{small:["text-sm"],medium:["text-base"],large:["text-md"],xlarge:["text-2xl"]},disabled:{true:["cursor-not-allowed opacity-30"]},loading:{true:["cursor-wait opacity-30"]}},compoundVariants:[{variant:"contained",size:"small",className:"py-1 px-2"},{variant:"contained",size:"medium",className:"py-2 px-4"},{variant:"contained",size:"large",className:"py-2 px-4"},{variant:"contained",size:"xlarge",className:"py-4 px-4"},{color:"primary",variant:"contained",className:"bg-teal-800 text-white border-transparent hover:enabled:bg-teal-700"},{color:"secondary",variant:"contained",className:"bg-white text-gray-800 border-gray-400 hover:enabled:bg-gray-100"},{color:"success",variant:"contained",className:"bg-green-100 text-green-500 border-green-400 hover:enabled:bg-green-200"},{color:"danger",variant:"contained",className:"bg-red-100 text-red-500 border-red-400 hover:enabled:bg-red-200"},{color:"primary",variant:"text",className:"text-teal-800 hover:enabled:text-teal-700"},{color:"secondary",variant:"text",className:"text-gray-800 hover:enabled:text-gray-700"},{color:"success",variant:"text",className:"text-green-800 hover:enabled:text-green-700"},{color:"danger",variant:"text",className:"text-red-800 hover:enabled:text-red-700"},{color:"inverted",variant:"text",className:"text-gray-100 hover:enabled:text-gray-0"},{color:"primary",variant:"icon",className:"text-teal-800 hover:enabled:text-teal-700 hover:enabled:bg-teal-100"},{color:"secondary",variant:"icon",className:"text-gray-800 hover:enabled:text-gray-700 hover:enabled:bg-gray-100"},{color:"success",variant:"icon",className:"text-green-800 hover:enabled:text-green-700 hover:enabled:bg-green-100"},{color:"danger",variant:"icon",className:"text-red-800 hover:enabled:text-red-700 hover:enabled:bg-red-100"},{color:"primary",size:"medium",className:"uppercase"}],defaultVariants:{color:"primary",size:"medium",variant:"contained"}});function ke({color:t,size:e,variant:n,className:r,type:s="button",loading:i,...o}){const a=x.useMemo(()=>xG({color:t,size:e,variant:n,disabled:o.disabled,loading:i,className:r}),[t,e,n,o.disabled,i,r]);return u.jsx("button",{type:s,className:a,disabled:o.disabled||i,...o})}const wG=typeof navigator>"u"?!1:navigator.product==="ReactNative",aO={timeout:wG?6e4:12e4},EG=function(e){const n={...aO,...typeof e=="string"?{url:e}:e},{searchParams:r}=new URL(n.url,"http://localhost");if(n.timeout=lO(n.timeout),n.query){for(const[o,a]of Object.entries(n.query))if(a!==void 0)if(Array.isArray(a))for(const l of a)r.append(o,l);else r.append(o,a)}const[s]=n.url.split("?"),i=r.toString();return i&&(n.url="".concat(s,"?").concat(i)),n.method=n.body&&!n.method?"POST":(n.method||"GET").toUpperCase(),n};function lO(t){if(t===!1||t===0)return!1;if(t.connect||t.socket)return t;const e=Number(t);return isNaN(e)?lO(aO.timeout):{connect:e,socket:e}}const bG=/^https?:\/\//i,SG=function(e){if(!bG.test(e.url))throw new Error('"'.concat(e.url,'" is not a valid URL'))};var n_=function(t){return t.replace(/^\s+|\s+$/g,"")},CG=function(t){return Object.prototype.toString.call(t)==="[object Array]"},AG=function(t){if(!t)return{};for(var e={},n=n_(t).split(`
`),r=0;r<n.length;r++){var s=n[r],i=s.indexOf(":"),o=n_(s.slice(0,i)).toLowerCase(),a=n_(s.slice(i+1));typeof e[o]>"u"?e[o]=a:CG(e[o])?e[o].push(a):e[o]=[e[o],a]}return e};const TG=ow(AG),IG=t=>function(n,r){const s=n==="onError";let i=r;for(var o=arguments.length,a=new Array(o>2?o-2:0),l=2;l<o;l++)a[l-2]=arguments[l];for(let c=0;c<t[n].length;c++){const d=t[n][c];if(i=d(i,...a),s&&!i)break}return i};function kG(){const t=Object.create(null);let e=0;function n(s){const i=e++;return t[i]=s,function(){delete t[i]}}function r(s){for(const i in t)t[i](s)}return{publish:r,subscribe:n}}const RG=["request","response","progress","error","abort"],CT=["processOptions","validateOptions","interceptRequest","finalizeOptions","onRequest","onResponse","onError","onReturn","onHeaders"];function uO(t,e){const n=[],r=CT.reduce((i,o)=>(i[o]=i[o]||[],i),{processOptions:[EG],validateOptions:[SG]});function s(i){const o=(y,v,_)=>{let g=y,m=v;if(!g)try{m=l("onResponse",v,_)}catch(w){m=null,g=w}g=g&&l("onError",g,_),g?a.error.publish(g):m&&a.response.publish(m)},a=RG.reduce((y,v)=>(y[v]=kG(),y),{}),l=IG(r),c=l("processOptions",i);l("validateOptions",c);const d={options:c,channels:a,applyMiddleware:l};let h;const f=a.request.subscribe(y=>{h=e(y,(v,_)=>o(v,_,y))});a.abort.subscribe(()=>{f(),h&&h.abort()});const p=l("onReturn",a,d);return p===a&&a.request.publish(d),p}return s.use=function(o){if(!o)throw new Error("Tried to add middleware that resolved to falsey value");if(typeof o=="function")throw new Error("Tried to add middleware that was a function. It probably expects you to pass options to it.");if(o.onReturn&&r.onReturn.length>0)throw new Error("Tried to add new middleware with `onReturn` handler, but another handler has already been registered for this event");return CT.forEach(a=>{o[a]&&r[a].push(o[a])}),n.push(o),s},s.clone=()=>uO(n,e),t.forEach(s.use),s}var cO=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},zn=(t,e,n)=>(cO(t,e,"read from private field"),n?n.call(t):e.get(t)),Ui=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},Ns=(t,e,n,r)=>(cO(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),Yf,Jf,Sa,Xf,Os,Zf,ep;class dO{constructor(){this.readyState=0,this.responseType="",Ui(this,Yf,void 0),Ui(this,Jf,void 0),Ui(this,Sa,void 0),Ui(this,Xf,{}),Ui(this,Os,void 0),Ui(this,Zf,{}),Ui(this,ep,void 0)}open(e,n,r){Ns(this,Yf,e),Ns(this,Jf,n),Ns(this,Sa,""),this.readyState=1,this.onreadystatechange(),Ns(this,Os,void 0)}abort(){zn(this,Os)&&zn(this,Os).abort()}getAllResponseHeaders(){return zn(this,Sa)}setRequestHeader(e,n){zn(this,Xf)[e]=n}setInit(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Ns(this,Zf,e),Ns(this,ep,n)}send(e){const n=this.responseType!=="arraybuffer",r={...zn(this,Zf),method:zn(this,Yf),headers:zn(this,Xf),body:e};typeof AbortController=="function"&&zn(this,ep)&&(Ns(this,Os,new AbortController),typeof EventTarget<"u"&&zn(this,Os).signal instanceof EventTarget&&(r.signal=zn(this,Os).signal)),typeof document<"u"&&(r.credentials=this.withCredentials?"include":"omit"),fetch(zn(this,Jf),r).then(s=>(s.headers.forEach((i,o)=>{Ns(this,Sa,zn(this,Sa)+"".concat(o,": ").concat(i,`\r
`))}),this.status=s.status,this.statusText=s.statusText,this.readyState=3,n?s.text():s.arrayBuffer())).then(s=>{typeof s=="string"?this.responseText=s:this.response=s,this.readyState=4,this.onreadystatechange()}).catch(s=>{var i;if(s.name==="AbortError"){this.onabort();return}(i=this.onerror)==null||i.call(this,s)})}}Yf=new WeakMap;Jf=new WeakMap;Sa=new WeakMap;Xf=new WeakMap;Os=new WeakMap;Zf=new WeakMap;ep=new WeakMap;const Sx=typeof XMLHttpRequest=="function"?"xhr":"fetch",PG=Sx==="xhr"?XMLHttpRequest:dO,NG=(t,e)=>{var n;const r=t.options,s=t.applyMiddleware("finalizeOptions",r),i={},o=t.applyMiddleware("interceptRequest",void 0,{adapter:Sx,context:t});if(o){const E=setTimeout(e,0,null,o);return{abort:()=>clearTimeout(E)}}let a=new PG;a instanceof dO&&typeof s.fetch=="object"&&a.setInit(s.fetch,(n=s.useAbortSignal)!=null?n:!0);const l=s.headers,c=s.timeout;let d=!1,h=!1,f=!1;if(a.onerror=E=>{g(new Error("Request error while attempting to reach ".concat(s.url).concat(E.lengthComputable?"(".concat(E.loaded," of ").concat(E.total," bytes transferred)"):"")))},a.ontimeout=E=>{g(new Error("Request timeout while attempting to reach ".concat(s.url).concat(E.lengthComputable?"(".concat(E.loaded," of ").concat(E.total," bytes transferred)"):"")))},a.onabort=()=>{_(!0),d=!0},a.onreadystatechange=()=>{v(),!(d||a.readyState!==4)&&a.status!==0&&w()},a.open(s.method,s.url,!0),a.withCredentials=!!s.withCredentials,l&&a.setRequestHeader)for(const E in l)l.hasOwnProperty(E)&&a.setRequestHeader(E,l[E]);return s.rawBody&&(a.responseType="arraybuffer"),t.applyMiddleware("onRequest",{options:s,adapter:Sx,request:a,context:t}),a.send(s.body||null),c&&(i.connect=setTimeout(()=>y("ETIMEDOUT"),c.connect)),{abort:p};function p(){d=!0,a&&a.abort()}function y(E){f=!0,a.abort();const T=new Error(E==="ESOCKETTIMEDOUT"?"Socket timed out on request to ".concat(s.url):"Connection timed out on request to ".concat(s.url));T.code=E,t.channels.error.publish(T)}function v(){c&&(_(),i.socket=setTimeout(()=>y("ESOCKETTIMEDOUT"),c.socket))}function _(E){(E||d||a.readyState>=2&&i.connect)&&clearTimeout(i.connect),i.socket&&clearTimeout(i.socket)}function g(E){if(h)return;_(!0),h=!0,a=null;const T=E||new Error("Network error while attempting to reach ".concat(s.url));T.isNetworkError=!0,T.request=s,e(T)}function m(){return{body:a.response||(a.responseType===""||a.responseType==="text"?a.responseText:""),url:s.url,method:s.method,headers:TG(a.getAllResponseHeaders()),statusCode:a.status,statusMessage:a.statusText}}function w(){if(!(d||h||f)){if(a.status===0){g(new Error("Unknown XHR error"));return}_(),h=!0,e(null,m())}}},jG=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:NG;return uO(t,e)};var AT={exports:{}},r_,TT;function OG(){if(TT)return r_;TT=1;var t=1e3,e=t*60,n=e*60,r=n*24,s=r*7,i=r*365.25;r_=function(d,h){h=h||{};var f=typeof d;if(f==="string"&&d.length>0)return o(d);if(f==="number"&&isFinite(d))return h.long?l(d):a(d);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(d))};function o(d){if(d=String(d),!(d.length>100)){var h=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(d);if(h){var f=parseFloat(h[1]),p=(h[2]||"ms").toLowerCase();switch(p){case"years":case"year":case"yrs":case"yr":case"y":return f*i;case"weeks":case"week":case"w":return f*s;case"days":case"day":case"d":return f*r;case"hours":case"hour":case"hrs":case"hr":case"h":return f*n;case"minutes":case"minute":case"mins":case"min":case"m":return f*e;case"seconds":case"second":case"secs":case"sec":case"s":return f*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return f;default:return}}}}function a(d){var h=Math.abs(d);return h>=r?Math.round(d/r)+"d":h>=n?Math.round(d/n)+"h":h>=e?Math.round(d/e)+"m":h>=t?Math.round(d/t)+"s":d+"ms"}function l(d){var h=Math.abs(d);return h>=r?c(d,h,r,"day"):h>=n?c(d,h,n,"hour"):h>=e?c(d,h,e,"minute"):h>=t?c(d,h,t,"second"):d+" ms"}function c(d,h,f,p){var y=h>=f*1.5;return Math.round(d/f)+" "+p+(y?"s":"")}return r_}function DG(t){n.debug=n,n.default=n,n.coerce=l,n.disable=i,n.enable=s,n.enabled=o,n.humanize=OG(),n.destroy=c,Object.keys(t).forEach(d=>{n[d]=t[d]}),n.names=[],n.skips=[],n.formatters={};function e(d){let h=0;for(let f=0;f<d.length;f++)h=(h<<5)-h+d.charCodeAt(f),h|=0;return n.colors[Math.abs(h)%n.colors.length]}n.selectColor=e;function n(d){let h,f=null,p,y;function v(..._){if(!v.enabled)return;const g=v,m=Number(new Date),w=m-(h||m);g.diff=w,g.prev=h,g.curr=m,h=m,_[0]=n.coerce(_[0]),typeof _[0]!="string"&&_.unshift("%O");let E=0;_[0]=_[0].replace(/%([a-zA-Z%])/g,(C,I)=>{if(C==="%%")return"%";E++;const k=n.formatters[I];if(typeof k=="function"){const O=_[E];C=k.call(g,O),_.splice(E,1),E--}return C}),n.formatArgs.call(g,_),(g.log||n.log).apply(g,_)}return v.namespace=d,v.useColors=n.useColors(),v.color=n.selectColor(d),v.extend=r,v.destroy=n.destroy,Object.defineProperty(v,"enabled",{enumerable:!0,configurable:!1,get:()=>f!==null?f:(p!==n.namespaces&&(p=n.namespaces,y=n.enabled(d)),y),set:_=>{f=_}}),typeof n.init=="function"&&n.init(v),v}function r(d,h){const f=n(this.namespace+(typeof h>"u"?":":h)+d);return f.log=this.log,f}function s(d){n.save(d),n.namespaces=d,n.names=[],n.skips=[];let h;const f=(typeof d=="string"?d:"").split(/[\s,]+/),p=f.length;for(h=0;h<p;h++)f[h]&&(d=f[h].replace(/\*/g,".*?"),d[0]==="-"?n.skips.push(new RegExp("^"+d.slice(1)+"$")):n.names.push(new RegExp("^"+d+"$")))}function i(){const d=[...n.names.map(a),...n.skips.map(a).map(h=>"-"+h)].join(",");return n.enable(""),d}function o(d){if(d[d.length-1]==="*")return!0;let h,f;for(h=0,f=n.skips.length;h<f;h++)if(n.skips[h].test(d))return!1;for(h=0,f=n.names.length;h<f;h++)if(n.names[h].test(d))return!0;return!1}function a(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function l(d){return d instanceof Error?d.stack||d.message:d}function c(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}var FG=DG;(function(t,e){e.formatArgs=r,e.save=s,e.load=i,e.useColors=n,e.storage=o(),e.destroy=(()=>{let l=!1;return()=>{l||(l=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const c="color: "+this.color;l.splice(1,0,c,"color: inherit");let d=0,h=0;l[0].replace(/%[a-zA-Z%]/g,f=>{f!=="%%"&&(d++,f==="%c"&&(h=d))}),l.splice(h,0,c)}e.log=console.debug||console.log||(()=>{});function s(l){try{l?e.storage.setItem("debug",l):e.storage.removeItem("debug")}catch{}}function i(){let l;try{l=e.storage.getItem("debug")}catch{}return!l&&typeof process<"u"&&"env"in process&&(l={}.DEBUG),l}function o(){try{return localStorage}catch{}}t.exports=FG(e);const{formatters:a}=t.exports;a.j=function(l){try{return JSON.stringify(l)}catch(c){return"[UnexpectedJSONParseError]: "+c.message}}})(AT,AT.exports);/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */function IT(t){return Object.prototype.toString.call(t)==="[object Object]"}function $G(t){var e,n;return IT(t)===!1?!1:(e=t.constructor,e===void 0?!0:(n=e.prototype,!(IT(n)===!1||n.hasOwnProperty("isPrototypeOf")===!1)))}const MG=typeof Buffer>"u"?()=>!1:t=>Buffer.isBuffer(t),LG=["boolean","string","number"];function VG(){return{processOptions:t=>{const e=t.body;return!e||!(!(typeof e.pipe=="function")&&!MG(e)&&(LG.indexOf(typeof e)!==-1||Array.isArray(e)||$G(e)))?t:Object.assign({},t,{body:JSON.stringify(t.body),headers:Object.assign({},t.headers,{"Content-Type":"application/json"})})}}}function UG(t){return{onResponse:n=>{const r=n.headers["content-type"]||"",s=t&&t.force||r.indexOf("application/json")!==-1;return!n.body||!r||!s?n:Object.assign({},n,{body:e(n.body)})},processOptions:n=>Object.assign({},n,{headers:Object.assign({Accept:"application/json"},n.headers)})};function e(n){try{return JSON.parse(n)}catch(r){throw r.message="Failed to parsed response body as JSON: ".concat(r.message),r}}}let rc={};typeof globalThis<"u"?rc=globalThis:typeof window<"u"?rc=window:typeof global<"u"?rc=global:typeof self<"u"&&(rc=self);var BG=rc;function zG(){const e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).implementation||BG.Observable;if(!e)throw new Error("`Observable` is not available in global scope, and no implementation was passed");return{onReturn:(n,r)=>new e(s=>(n.error.subscribe(i=>s.error(i)),n.progress.subscribe(i=>s.next(Object.assign({type:"progress"},i))),n.response.subscribe(i=>{s.next(Object.assign({type:"response"},i)),s.complete()}),n.request.publish(r),()=>n.abort.publish()))}}function WG(){return{onRequest:t=>{if(t.adapter!=="xhr")return;const e=t.request,n=t.context;"upload"in e&&"onprogress"in e.upload&&(e.upload.onprogress=r("upload")),"onprogress"in e&&(e.onprogress=r("download"));function r(s){return i=>{const o=i.lengthComputable?i.loaded/i.total*100:-1;n.channels.progress.publish({stage:s,percent:o,total:i.total,loaded:i.loaded,lengthComputable:i.lengthComputable})}}}}}class qG{constructor(e){this.__CANCEL__=!0,this.message=e}toString(){return"Cancel".concat(this.message?": ".concat(this.message):"")}}const kT=class{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n=null;this.promise=new Promise(r=>{n=r}),e(r=>{this.reason||(this.reason=new qG(r),n(this.reason))})}};kT.source=()=>{let t;return{token:new kT(n=>{t=n}),cancel:t}};var hO=(t,e,n)=>n.method!=="GET"&&n.method!=="HEAD"?!1:t.isNetworkError||!1;const HG=t=>t!==null&&typeof t=="object"&&typeof t.pipe=="function";var GG=t=>{const e=t.maxRetries||5,n=t.retryDelay||QG,r=t.shouldRetry;return{onError:(s,i)=>{const o=i.options,a=o.maxRetries||e,l=o.shouldRetry||r,c=o.attemptNumber||0;if(HG(o.body)||!l(s,c,o)||c>=a)return s;const d=Object.assign({},i,{options:Object.assign({},o,{attemptNumber:c+1})});return setTimeout(()=>i.channels.request.publish(d),n(c)),null}}};function QG(t){return 100*Math.pow(2,t)+Math.random()*100}const yE=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return GG({shouldRetry:hO,...t})};yE.shouldRetry=hO;var Cx=function(t,e){return Cx=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},Cx(t,e)};function mE(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Cx(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Iy=function(){return Iy=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Iy.apply(this,arguments)};function RT(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ky(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return i}function Ry(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}function Kr(t){return typeof t=="function"}function fO(t){var e=function(r){Error.call(r),r.stack=new Error().stack},n=t(e);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var s_=fO(function(t){return function(n){t(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,s){return s+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function PT(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var gE=function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,n,r,s,i;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var a=RT(o),l=a.next();!l.done;l=a.next()){var c=l.value;c.remove(this)}}catch(v){e={error:v}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}else o.remove(this);var d=this.initialTeardown;if(Kr(d))try{d()}catch(v){i=v instanceof s_?v.errors:[v]}var h=this._finalizers;if(h){this._finalizers=null;try{for(var f=RT(h),p=f.next();!p.done;p=f.next()){var y=p.value;try{NT(y)}catch(v){i=i??[],v instanceof s_?i=Ry(Ry([],ky(i)),ky(v.errors)):i.push(v)}}}catch(v){r={error:v}}finally{try{p&&!p.done&&(s=f.return)&&s.call(f)}finally{if(r)throw r.error}}}if(i)throw new s_(i)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)NT(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}},t.prototype._hasParent=function(e){var n=this._parentage;return n===e||Array.isArray(n)&&n.includes(e)},t.prototype._addParent=function(e){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e},t.prototype._removeParent=function(e){var n=this._parentage;n===e?this._parentage=null:Array.isArray(n)&&PT(n,e)},t.prototype.remove=function(e){var n=this._finalizers;n&&PT(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=function(){var e=new t;return e.closed=!0,e}(),t}();gE.EMPTY;function pO(t){return t instanceof gE||t&&"closed"in t&&Kr(t.remove)&&Kr(t.add)&&Kr(t.unsubscribe)}function NT(t){Kr(t)?t():t.unsubscribe()}var yO={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Ax={setTimeout:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var s=Ax.delegate;return s!=null&&s.setTimeout?s.setTimeout.apply(s,Ry([t,e],ky(n))):setTimeout.apply(void 0,Ry([t,e],ky(n)))},clearTimeout:function(t){var e=Ax.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function KG(t){Ax.setTimeout(function(){throw t})}function jT(){}function YG(t){t()}var vE=function(t){mE(e,t);function e(n){var r=t.call(this)||this;return r.isStopped=!1,n?(r.destination=n,pO(n)&&n.add(r)):r.destination=eQ,r}return e.create=function(n,r,s){return new Tx(n,r,s)},e.prototype.next=function(n){this.isStopped||this._next(n)},e.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(n){this.destination.next(n)},e.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(gE),JG=Function.prototype.bind;function i_(t,e){return JG.call(t,e)}var XG=function(){function t(e){this.partialObserver=e}return t.prototype.next=function(e){var n=this.partialObserver;if(n.next)try{n.next(e)}catch(r){af(r)}},t.prototype.error=function(e){var n=this.partialObserver;if(n.error)try{n.error(e)}catch(r){af(r)}else af(e)},t.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(n){af(n)}},t}(),Tx=function(t){mE(e,t);function e(n,r,s){var i=t.call(this)||this,o;if(Kr(n)||!n)o={next:n??void 0,error:r??void 0,complete:s??void 0};else{var a;i&&yO.useDeprecatedNextContext?(a=Object.create(n),a.unsubscribe=function(){return i.unsubscribe()},o={next:n.next&&i_(n.next,a),error:n.error&&i_(n.error,a),complete:n.complete&&i_(n.complete,a)}):o=n}return i.destination=new XG(o),i}return e}(vE);function af(t){KG(t)}function ZG(t){throw t}var eQ={closed:!0,next:jT,error:ZG,complete:jT},tQ=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function nQ(t){return t}function rQ(t){return t.length===0?nQ:t.length===1?t[0]:function(n){return t.reduce(function(r,s){return s(r)},n)}}var md=function(){function t(e){e&&(this._subscribe=e)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(e,n,r){var s=this,i=iQ(e)?e:new Tx(e,n,r);return YG(function(){var o=s,a=o.operator,l=o.source;i.add(a?a.call(i,l):l?s._subscribe(i):s._trySubscribe(i))}),i},t.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(n){e.error(n)}},t.prototype.forEach=function(e,n){var r=this;return n=OT(n),new n(function(s,i){var o=new Tx({next:function(a){try{e(a)}catch(l){i(l),o.unsubscribe()}},error:i,complete:s});r.subscribe(o)})},t.prototype._subscribe=function(e){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(e)},t.prototype[tQ]=function(){return this},t.prototype.pipe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return rQ(e)(this)},t.prototype.toPromise=function(e){var n=this;return e=OT(e),new e(function(r,s){var i;n.subscribe(function(o){return i=o},function(o){return s(o)},function(){return r(i)})})},t.create=function(e){return new t(e)},t}();function OT(t){var e;return(e=t??yO.Promise)!==null&&e!==void 0?e:Promise}function sQ(t){return t&&Kr(t.next)&&Kr(t.error)&&Kr(t.complete)}function iQ(t){return t&&t instanceof vE||sQ(t)&&pO(t)}function oQ(t){return Kr(t==null?void 0:t.lift)}function mO(t){return function(e){if(oQ(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function gO(t,e,n,r,s){return new aQ(t,e,n,r,s)}var aQ=function(t){mE(e,t);function e(n,r,s,i,o,a){var l=t.call(this,n)||this;return l.onFinalize=o,l.shouldUnsubscribe=a,l._next=r?function(c){try{r(c)}catch(d){n.error(d)}}:t.prototype._next,l._error=i?function(c){try{i(c)}catch(d){n.error(d)}finally{this.unsubscribe()}}:t.prototype._error,l._complete=s?function(){try{s()}catch(c){n.error(c)}finally{this.unsubscribe()}}:t.prototype._complete,l}return e.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;t.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},e}(vE),lQ=fO(function(t){return function(){t(this),this.name="EmptyError",this.message="no elements in sequence"}});function Pt(t,e){var n=typeof e=="object";return new Promise(function(r,s){var i=!1,o;t.subscribe({next:function(a){o=a,i=!0},error:s,complete:function(){i?r(o):n?r(e.defaultValue):s(new lQ)}})})}function Wo(t,e){return mO(function(n,r){var s=0;n.subscribe(gO(r,function(i){r.next(t.call(e,i,s++))}))})}function fh(t,e){return mO(function(n,r){var s=0;n.subscribe(gO(r,function(i){return t.call(e,i,s++)&&r.next(i)}))})}const o_=5;class uQ extends Error{constructor(e){const n=vO(e);super(n.message),this.statusCode=400,Object.assign(this,n)}}class cQ extends Error{constructor(e){const n=vO(e);super(n.message),this.statusCode=500,Object.assign(this,n)}}function vO(t){const e=t.body,n={response:t,statusCode:t.statusCode,responseBody:fQ(e,t),message:"",details:void 0};if(e.error&&e.message)return n.message="".concat(e.error," - ").concat(e.message),n;if(dQ(e)){const r=e.error.items||[],s=r.slice(0,o_).map(o=>{var a;return(a=o.error)==null?void 0:a.description}).filter(Boolean);let i=s.length?`:
- `.concat(s.join(`
- `)):"";return r.length>o_&&(i+=`
...and `.concat(r.length-o_," more")),n.message="".concat(e.error.description).concat(i),n.details=e.error,n}return e.error&&e.error.description?(n.message=e.error.description,n.details=e.error,n):(n.message=e.error||e.message||hQ(t),n)}function dQ(t){return DT(t)&&DT(t.error)&&t.error.type==="mutationError"&&typeof t.error.description=="string"}function DT(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function hQ(t){const e=t.statusMessage?" ".concat(t.statusMessage):"";return"".concat(t.method,"-request to ").concat(t.url," resulted in HTTP ").concat(t.statusCode).concat(e)}function fQ(t,e){return(e.headers["content-type"]||"").toLowerCase().indexOf("application/json")!==-1?JSON.stringify(t,null,2):t}const pQ={onResponse:t=>{if(t.statusCode>=500)throw new cQ(t);if(t.statusCode>=400)throw new uQ(t);return t}},yQ={onResponse:t=>{const e=t.headers["x-sanity-warning"];return(Array.isArray(e)?e:[e]).filter(Boolean).forEach(r=>console.warn(r)),t}};function FT(t,e){let{maxRetries:n=5,retryDelay:r}=e;const s=jG([n>0?yE({retryDelay:r,maxRetries:n,shouldRetry:mQ}):{},...t,yQ,VG(),UG(),WG(),pQ,zG({implementation:md})]);function i(o){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:s)({maxRedirects:0,...o})}return i.defaultRequester=s,i}function mQ(t,e,n){const r=n.method==="GET"||n.method==="HEAD",i=(n.uri||n.url).startsWith("/data/query"),o=t.response&&(t.response.statusCode===429||t.response.statusCode===502||t.response.statusCode===503);return(r||i)&&o?!0:yE.shouldRetry(t,e,n)}function _O(t){if(typeof t=="string"||Array.isArray(t))return{id:t};if(typeof t=="object"&&t!==null&&"query"in t&&typeof t.query=="string")return"params"in t&&typeof t.params=="object"&&t.params!==null?{query:t.query,params:t.params}:{query:t.query};const e=["* Document ID (<docId>)","* Array of document IDs","* Object containing `query`"].join(`
`);throw new Error(`Unknown selection - must be one of:

`.concat(e))}const $T=["image","file"],MT=["before","after","replace"],xO=t=>{if(!/^(~[a-z0-9]{1}[-\w]{0,63}|[a-z0-9]{1}[-\w]{0,63})$/.test(t))throw new Error("Datasets can only contain lowercase characters, numbers, underscores and dashes, and start with tilde, and be maximum 64 characters")},gQ=t=>{if(!/^[-a-z0-9]+$/i.test(t))throw new Error("`projectId` can only contain only a-z, 0-9 and dashes")},vQ=t=>{if($T.indexOf(t)===-1)throw new Error("Invalid asset type: ".concat(t,". Must be one of ").concat($T.join(", ")))},Pc=(t,e)=>{if(e===null||typeof e!="object"||Array.isArray(e))throw new Error("".concat(t,"() takes an object of properties"))},wO=(t,e)=>{if(typeof e!="string"||!/^[a-z0-9_][a-z0-9_.-]{0,127}$/i.test(e)||e.includes(".."))throw new Error("".concat(t,'(): "').concat(e,'" is not a valid document ID'))},Py=(t,e)=>{if(!e._id)throw new Error("".concat(t,'() requires that the document contains an ID ("_id" property)'));wO(t,e._id)},_Q=(t,e,n)=>{const r="insert(at, selector, items)";if(MT.indexOf(t)===-1){const s=MT.map(i=>'"'.concat(i,'"')).join(", ");throw new Error("".concat(r,' takes an "at"-argument which is one of: ').concat(s))}if(typeof e!="string")throw new Error("".concat(r,' takes a "selector"-argument which must be a string'));if(!Array.isArray(n))throw new Error("".concat(r,' takes an "items"-argument which must be an array'))},EO=t=>{if(!t.dataset)throw new Error("`dataset` must be provided to perform queries");return t.dataset||""},bO=t=>{if(typeof t!="string"||!/^[a-z0-9._-]{1,75}$/i.test(t))throw new Error("Tag can only contain alphanumeric characters, underscores, dashes and dots, and be between one and 75 characters long.");return t};var SO=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},hl=(t,e,n)=>(SO(t,e,"read from private field"),n?n.call(t):e.get(t)),CO=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},AO=(t,e,n,r)=>(SO(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),Ca,Aa;class TO{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.selection=e,this.operations=n}set(e){return this._assign("set",e)}setIfMissing(e){return this._assign("setIfMissing",e)}diffMatchPatch(e){return Pc("diffMatchPatch",e),this._assign("diffMatchPatch",e)}unset(e){if(!Array.isArray(e))throw new Error("unset(attrs) takes an array of attributes to unset, non-array given");return this.operations=Object.assign({},this.operations,{unset:e}),this}inc(e){return this._assign("inc",e)}dec(e){return this._assign("dec",e)}insert(e,n,r){return _Q(e,n,r),this._assign("insert",{[e]:n,items:r})}append(e,n){return this.insert("after","".concat(e,"[-1]"),n)}prepend(e,n){return this.insert("before","".concat(e,"[0]"),n)}splice(e,n,r,s){const i=typeof r>"u"||r===-1,o=n<0?n-1:n,a=i?-1:Math.max(0,n+r),l=o<0&&a>=0?"":a,c="".concat(e,"[").concat(o,":").concat(l,"]");return this.insert("replace",c,s||[])}ifRevisionId(e){return this.operations.ifRevisionID=e,this}serialize(){return{..._O(this.selection),...this.operations}}toJSON(){return this.serialize()}reset(){return this.operations={},this}_assign(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return Pc(e,n),this.operations=Object.assign({},this.operations,{[e]:Object.assign({},r&&this.operations[e]||{},n)}),this}_set(e,n){return this._assign(e,n,!1)}}const xQ=class IO extends TO{constructor(e,n,r){super(e,n),CO(this,Ca,void 0),AO(this,Ca,r)}clone(){return new IO(this.selection,{...this.operations},hl(this,Ca))}commit(e){if(!hl(this,Ca))throw new Error("No `client` passed to patch, either provide one or pass the patch to a clients `mutate()` method");const n=typeof this.selection=="string",r=Object.assign({returnFirst:n,returnDocuments:!0},e);return hl(this,Ca).mutate({patch:this.serialize()},r)}};Ca=new WeakMap;let Nc=xQ;const wQ=class kO extends TO{constructor(e,n,r){super(e,n),CO(this,Aa,void 0),AO(this,Aa,r)}clone(){return new kO(this.selection,{...this.operations},hl(this,Aa))}commit(e){if(!hl(this,Aa))throw new Error("No `client` passed to patch, either provide one or pass the patch to a clients `mutate()` method");const n=typeof this.selection=="string",r=Object.assign({returnFirst:n,returnDocuments:!0},e);return hl(this,Aa).mutate({patch:this.serialize()},r)}};Aa=new WeakMap;let jc=wQ;var RO=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},ei=(t,e,n)=>(RO(t,e,"read from private field"),n?n.call(t):e.get(t)),PO=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},NO=(t,e,n,r)=>(RO(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),Hi,Gi;const jO={returnDocuments:!1};class OO{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;this.operations=e,this.trxId=n}create(e){return Pc("create",e),this._add({create:e})}createIfNotExists(e){const n="createIfNotExists";return Pc(n,e),Py(n,e),this._add({[n]:e})}createOrReplace(e){const n="createOrReplace";return Pc(n,e),Py(n,e),this._add({[n]:e})}delete(e){return wO("delete",e),this._add({delete:{id:e}})}transactionId(e){return e?(this.trxId=e,this):this.trxId}serialize(){return[...this.operations]}toJSON(){return this.serialize()}reset(){return this.operations=[],this}_add(e){return this.operations.push(e),this}}const EQ=class DO extends OO{constructor(e,n,r){super(e,r),PO(this,Hi,void 0),NO(this,Hi,n)}clone(){return new DO([...this.operations],ei(this,Hi),this.trxId)}commit(e){if(!ei(this,Hi))throw new Error("No `client` passed to transaction, either provide one or pass the transaction to a clients `mutate()` method");return ei(this,Hi).mutate(this.serialize(),Object.assign({transactionId:this.trxId},jO,e||{}))}patch(e,n){const r=typeof n=="function";if(typeof e!="string"&&e instanceof jc)return this._add({patch:e.serialize()});if(r){const i=n(new jc(e,{},ei(this,Hi)));if(!(i instanceof jc))throw new Error("function passed to `patch()` must return the patch");return this._add({patch:i.serialize()})}return this._add({patch:{id:e,...n}})}};Hi=new WeakMap;let FO=EQ;const bQ=class $O extends OO{constructor(e,n,r){super(e,r),PO(this,Gi,void 0),NO(this,Gi,n)}clone(){return new $O([...this.operations],ei(this,Gi),this.trxId)}commit(e){if(!ei(this,Gi))throw new Error("No `client` passed to transaction, either provide one or pass the transaction to a clients `mutate()` method");return ei(this,Gi).mutate(this.serialize(),Object.assign({transactionId:this.trxId},jO,e||{}))}patch(e,n){const r=typeof n=="function";if(typeof e!="string"&&e instanceof Nc)return this._add({patch:e.serialize()});if(r){const i=n(new Nc(e,{},ei(this,Gi)));if(!(i instanceof Nc))throw new Error("function passed to `patch()` must return the patch");return this._add({patch:i.serialize()})}return this._add({patch:{id:e,...n}})}};Gi=new WeakMap;let MO=bQ;const SQ="https://www.sanity.io/help/";function _E(t){return SQ+t}function CQ(t){let e=!1,n;return function(){return e||(n=t(...arguments),e=!0),n}}const eg=t=>CQ(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return console.warn(t.join(" "),...n)}),AQ=eg(["Since you haven't set a value for `useCdn`, we will deliver content using our","global, edge-cached API-CDN. If you wish to have content delivered faster, set","`useCdn: false` to use the Live API. Note: You may incur higher costs using the live API."]),TQ=eg(["The Sanity client is configured with the `perspective` set to `previewDrafts`, which doesn't support the API-CDN.","The Live API will be used instead. Set `useCdn: false` in your configuration to hide this warning."]),IQ=eg(["You have configured Sanity client to use a token in the browser. This may cause unintentional security issues.","See ".concat(_E("js-client-browser-token")," for more information and how to hide this warning.")]),kQ=eg(["Using the Sanity client without specifying an API version is deprecated.","See ".concat(_E("js-client-api-version"))]),RQ="apicdn.sanity.io",Ny={apiHost:"https://api.sanity.io",apiVersion:"1",useProjectHostname:!0},PQ=["localhost","127.0.0.1","0.0.0.0"],NQ=t=>PQ.indexOf(t)!==-1,jQ=function(e){if(e==="1"||e==="X")return;const n=new Date(e);if(!(/^\d{4}-\d{2}-\d{2}$/.test(e)&&n instanceof Date&&n.getTime()>0))throw new Error("Invalid API version string, expected `1` or date in format `YYYY-MM-DD`")},LO=function(e){switch(e){case"previewDrafts":case"published":case"raw":return;default:throw new TypeError("Invalid API perspective string, expected `published`, `previewDrafts` or `raw`")}},VO=(t,e)=>{const n=Object.assign({},e,t);n.apiVersion||kQ();const r=Object.assign({},Ny,n),s=r.useProjectHostname;if(typeof Promise>"u"){const h=_E("js-client-promise-polyfill");throw new Error("No native Promise-implementation found, polyfill needed - see ".concat(h))}if(s&&!r.projectId)throw new Error("Configuration must contain `projectId`");if(typeof r.perspective=="string"&&LO(r.perspective),"encodeSourceMapAtPath"in r||"encodeSourceMap"in r||"studioUrl"in r||"logger"in r)throw new Error("It looks like you're using options meant for '@sanity/preview-kit/client', such as 'encodeSourceMapAtPath', 'encodeSourceMap', 'studioUrl' and 'logger'. Make sure you're using the right import.");if("stega"in r&&r.stega!==void 0&&r.stega!==!1)throw new Error("It looks like you're using options meant for '@sanity/client/stega'. Make sure you're using the right import. Or set 'stega' in 'createClient' to 'false'.");const i=typeof window<"u"&&window.location&&window.location.hostname,o=i&&NQ(window.location.hostname);i&&o&&r.token&&r.ignoreBrowserTokenWarning!==!0?IQ():typeof r.useCdn>"u"&&AQ(),s&&gQ(r.projectId),r.dataset&&xO(r.dataset),"requestTagPrefix"in r&&(r.requestTagPrefix=r.requestTagPrefix?bO(r.requestTagPrefix).replace(/\.+$/,""):void 0),r.apiVersion="".concat(r.apiVersion).replace(/^v/,""),r.isDefaultApi=r.apiHost===Ny.apiHost,r.useCdn=r.useCdn!==!1&&!r.withCredentials,jQ(r.apiVersion);const a=r.apiHost.split("://",2),l=a[0],c=a[1],d=r.isDefaultApi?RQ:c;return r.useProjectHostname?(r.url="".concat(l,"://").concat(r.projectId,".").concat(c,"/v").concat(r.apiVersion),r.cdnUrl="".concat(l,"://").concat(r.projectId,".").concat(d,"/v").concat(r.apiVersion)):(r.url="".concat(r.apiHost,"/v").concat(r.apiVersion),r.cdnUrl=r.url),r},OQ="X-Sanity-Project-ID";function DQ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={},r=e.token||t.token;r&&(n.Authorization="Bearer ".concat(r)),!e.useGlobalApi&&!t.useProjectHostname&&t.projectId&&(n[OQ]=t.projectId);const s=!!(typeof e.withCredentials>"u"?t.token||t.withCredentials:e.withCredentials),i=typeof e.timeout>"u"?t.timeout:e.timeout;return Object.assign({},e,{headers:Object.assign({},n,e.headers||{}),timeout:typeof i>"u"?5*60*1e3:i,proxy:e.proxy||t.proxy,json:!0,withCredentials:s,fetch:typeof e.fetch=="object"&&typeof t.fetch=="object"?{...t.fetch,...e.fetch}:e.fetch||t.fetch})}const UO=t=>{let{query:e,params:n={},options:r={}}=t;const s=new URLSearchParams,{tag:i,...o}=r;i&&s.append("tag",i),s.append("query",e);for(const[a,l]of Object.entries(n))s.append("$".concat(a),JSON.stringify(l));for(const[a,l]of Object.entries(o))l&&s.append(a,"".concat(l));return"?".concat(s)},FQ=(t,e)=>t===!1?void 0:typeof t>"u"?e:t,$Q=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{dryRun:t.dryRun,returnIds:!0,returnDocuments:FQ(t.returnDocuments,!0),visibility:t.visibility||"sync",autoGenerateArrayKeys:t.autoGenerateArrayKeys,skipCrossDatasetReferenceValidation:t.skipCrossDatasetReferenceValidation}},xE=t=>t.type==="response",MQ=t=>t.body,LQ=(t,e)=>t.reduce((n,r)=>(n[e(r)]=r,n),Object.create(null)),VQ=11264;function BO(t,e,n,r){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const i=s.filterResponse===!1?d=>d:d=>d.result,{cache:o,next:a,...l}={useAbortSignal:typeof s.signal<"u",...s},c=typeof o<"u"||typeof a<"u"?{...l,fetch:{cache:o,next:a}}:l;return ph(t,e,"query",{query:n,params:r},c).pipe(Wo(i))}function zO(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const s={uri:xu(t,"doc",n),json:!0,tag:r.tag};return yh(t,e,s).pipe(fh(xE),Wo(i=>i.body.documents&&i.body.documents[0]))}function WO(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const s={uri:xu(t,"doc",n.join(",")),json:!0,tag:r.tag};return yh(t,e,s).pipe(fh(xE),Wo(i=>{const o=LQ(i.body.documents||[],a=>a._id);return n.map(a=>o[a]||null)}))}function qO(t,e,n,r){return Py("createIfNotExists",n),tg(t,e,n,"createIfNotExists",r)}function HO(t,e,n,r){return Py("createOrReplace",n),tg(t,e,n,"createOrReplace",r)}function GO(t,e,n,r){return ph(t,e,"mutate",{mutations:[{delete:_O(n)}]},r)}function QO(t,e,n,r){let s;n instanceof jc||n instanceof Nc?s={patch:n.serialize()}:n instanceof FO||n instanceof MO?s=n.serialize():s=n;const i=Array.isArray(s)?s:[s],o=r&&r.transactionId||void 0;return ph(t,e,"mutate",{mutations:i,transactionId:o},r)}function ph(t,e,n,r){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const i=n==="mutate",o=n==="query",a=i?"":UO(r),l=!i&&a.length<VQ,c=l?a:"",d=s.returnFirst,{timeout:h,token:f,tag:p,headers:y}=s,v=xu(t,n,c),_={method:l?"GET":"POST",uri:v,json:!0,body:l?void 0:r,query:i&&$Q(s),timeout:h,headers:y,token:f,tag:p,perspective:s.perspective,resultSourceMap:s.resultSourceMap,canUseCdn:o,signal:s.signal,fetch:s.fetch,useAbortSignal:s.useAbortSignal};return yh(t,e,_).pipe(fh(xE),Wo(MQ),Wo(g=>{if(!i)return g;const m=g.results||[];if(s.returnDocuments)return d?m[0]&&m[0].document:m.map(T=>T.document);const w=d?"documentId":"documentIds",E=d?m[0]&&m[0].id:m.map(T=>T.id);return{transactionId:g.transactionId,results:m,[w]:E}}))}function tg(t,e,n,r){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const i={[r]:n},o=Object.assign({returnFirst:!0,returnDocuments:!0},s);return ph(t,e,"mutate",{mutations:[i]},o)}function yh(t,e,n){var r;const s=n.url||n.uri,i=t.config(),o=typeof n.canUseCdn>"u"?["GET","HEAD"].indexOf(n.method||"GET")>=0&&s.indexOf("/data/")===0:n.canUseCdn;let a=i.useCdn&&o;const l=n.tag&&i.requestTagPrefix?[i.requestTagPrefix,n.tag].join("."):n.tag||i.requestTagPrefix;if(l&&n.tag!==null&&(n.query={tag:bO(l),...n.query}),["GET","HEAD","POST"].indexOf(n.method||"GET")>=0&&s.indexOf("/data/query/")===0){const h=(r=n.resultSourceMap)!=null?r:i.resultSourceMap;h!==void 0&&h!==!1&&(n.query={resultSourceMap:h,...n.query});const f=n.perspective||i.perspective;typeof f=="string"&&f!=="raw"&&(LO(f),n.query={perspective:f,...n.query},f==="previewDrafts"&&a&&(a=!1,TQ()))}const c=DQ(i,Object.assign({},n,{url:wE(t,s,a)})),d=new md(h=>e(c,i.requester).subscribe(h));return n.signal?d.pipe(UQ(n.signal)):d}function Ar(t,e,n){return yh(t,e,n).pipe(fh(s=>s.type==="response"),Wo(s=>s.body))}function xu(t,e,n){const r=t.config(),s=EO(r),i="/".concat(e,"/").concat(s),o=n?"".concat(i,"/").concat(n):i;return"/data".concat(o).replace(/\/($|\?)/,"$1")}function wE(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const{url:r,cdnUrl:s}=t.config(),i=n?s:r;return"".concat(i,"/").concat(e.replace(/^\//,""))}function UQ(t){return e=>new md(n=>{const r=()=>n.error(zQ(t));if(t&&t.aborted){r();return}const s=e.subscribe(n);return t.addEventListener("abort",r),()=>{t.removeEventListener("abort",r),s.unsubscribe()}})}const BQ=!!globalThis.DOMException;function zQ(t){var e,n;if(BQ)return new DOMException((e=t==null?void 0:t.reason)!=null?e:"The operation was aborted.","AbortError");const r=new Error((n=t==null?void 0:t.reason)!=null?n:"The operation was aborted.");return r.name="AbortError",r}var KO=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},jy=(t,e,n)=>(KO(t,e,"read from private field"),n?n.call(t):e.get(t)),Oy=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},Dy=(t,e,n,r)=>(KO(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),tp,np,rp,sp;class WQ{constructor(e,n){Oy(this,tp,void 0),Oy(this,np,void 0),Dy(this,tp,e),Dy(this,np,n)}upload(e,n,r){return YO(jy(this,tp),jy(this,np),e,n,r)}}tp=new WeakMap;np=new WeakMap;class qQ{constructor(e,n){Oy(this,rp,void 0),Oy(this,sp,void 0),Dy(this,rp,e),Dy(this,sp,n)}upload(e,n,r){const s=YO(jy(this,rp),jy(this,sp),e,n,r);return Pt(s.pipe(fh(i=>i.type==="response"),Wo(i=>i.body.document)))}}rp=new WeakMap;sp=new WeakMap;function YO(t,e,n,r){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};vQ(n);let i=s.extract||void 0;i&&!i.length&&(i=["none"]);const o=EO(t.config()),a=n==="image"?"images":"files",l=HQ(s,r),{tag:c,label:d,title:h,description:f,creditLine:p,filename:y,source:v}=l,_={label:d,title:h,description:f,filename:y,meta:i,creditLine:p};return v&&(_.sourceId=v.id,_.sourceName=v.name,_.sourceUrl=v.url),yh(t,e,{tag:c,method:"POST",timeout:l.timeout||0,uri:"/assets/".concat(a,"/").concat(o),headers:l.contentType?{"Content-Type":l.contentType}:{},query:_,body:r})}function HQ(t,e){return typeof File>"u"||!(e instanceof File)?t:Object.assign({filename:t.preserveFilename===!1?void 0:e.name,contentType:e.type},t)}var GQ=(t,e)=>Object.keys(e).concat(Object.keys(t)).reduce((n,r)=>(n[r]=typeof t[r]>"u"?e[r]:t[r],n),{});const QQ=(t,e)=>e.reduce((n,r)=>(typeof t[r]>"u"||(n[r]=t[r]),n),{}),KQ=16e3-1200,YQ=["includePreviousRevision","includeResult","visibility","effectFormat","tag"],JQ={includeResult:!0};function JO(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{url:r,token:s,withCredentials:i,requestTagPrefix:o}=this.config(),a=n.tag&&o?[o,n.tag].join("."):n.tag,l={...GQ(n,JQ),tag:a},c=QQ(l,YQ),d=UO({query:t,params:e,options:{tag:a,...c}}),h="".concat(r).concat(xu(this,"listen",d));if(h.length>KQ)return new md(v=>v.error(new Error("Query too large for listener")));const f=l.events?l.events:["mutation"],p=f.indexOf("reconnect")!==-1,y={};return(s||i)&&(y.withCredentials=!0),s&&(y.headers={Authorization:"Bearer ".concat(s)}),new md(v=>{let _;O().then(P=>{_=P}).catch(P=>{v.error(P),j()});let g,m=!1;function w(){m||(k(),!m&&_.readyState===_.CLOSED&&(I(),clearTimeout(g),g=setTimeout(L,100)))}function E(P){v.error(XQ(P))}function T(P){const D=XO(P);return D instanceof Error?v.error(D):v.next(D)}function C(){m=!0,I(),v.complete()}function I(){_&&(_.removeEventListener("error",w),_.removeEventListener("channelError",E),_.removeEventListener("disconnect",C),f.forEach(P=>_.removeEventListener(P,T)),_.close())}function k(){p&&v.next({type:"reconnect"})}async function O(){const{default:P}=await VP(()=>import("./browser-254e0c4d.js").then(te=>te.b),[]),D=new P(h,y);return D.addEventListener("error",w),D.addEventListener("channelError",E),D.addEventListener("disconnect",C),f.forEach(te=>D.addEventListener(te,T)),D}function L(){O().then(P=>{_=P}).catch(P=>{v.error(P),j()})}function j(){m=!0,I()}return j})}function XO(t){try{const e=t.data&&JSON.parse(t.data)||{};return Object.assign({type:t.type},e)}catch(e){return e}}function XQ(t){if(t instanceof Error)return t;const e=XO(t);return e instanceof Error?e:new Error(ZQ(e))}function ZQ(t){return t.error?t.error.description?t.error.description:typeof t.error=="string"?t.error:JSON.stringify(t.error,null,2):t.message||"Unknown listener error"}var ZO=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},en=(t,e,n)=>(ZO(t,e,"read from private field"),n?n.call(t):e.get(t)),Fy=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},$y=(t,e,n,r)=>(ZO(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),Qi,Ki,Yi,Ji;class eK{constructor(e,n){Fy(this,Qi,void 0),Fy(this,Ki,void 0),$y(this,Qi,e),$y(this,Ki,n)}create(e,n){return fl(en(this,Qi),en(this,Ki),"PUT",e,n)}edit(e,n){return fl(en(this,Qi),en(this,Ki),"PATCH",e,n)}delete(e){return fl(en(this,Qi),en(this,Ki),"DELETE",e)}list(){return Ar(en(this,Qi),en(this,Ki),{uri:"/datasets",tag:null})}}Qi=new WeakMap;Ki=new WeakMap;class tK{constructor(e,n){Fy(this,Yi,void 0),Fy(this,Ji,void 0),$y(this,Yi,e),$y(this,Ji,n)}create(e,n){return Pt(fl(en(this,Yi),en(this,Ji),"PUT",e,n))}edit(e,n){return Pt(fl(en(this,Yi),en(this,Ji),"PATCH",e,n))}delete(e){return Pt(fl(en(this,Yi),en(this,Ji),"DELETE",e))}list(){return Pt(Ar(en(this,Yi),en(this,Ji),{uri:"/datasets",tag:null}))}}Yi=new WeakMap;Ji=new WeakMap;function fl(t,e,n,r,s){return xO(r),Ar(t,e,{method:n,uri:"/datasets/".concat(r),body:s,tag:null})}var eD=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},ti=(t,e,n)=>(eD(t,e,"read from private field"),n?n.call(t):e.get(t)),My=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},Ly=(t,e,n,r)=>(eD(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),sc,ic,oc,ac;class nK{constructor(e,n){My(this,sc,void 0),My(this,ic,void 0),Ly(this,sc,e),Ly(this,ic,n)}list(e){const n=(e==null?void 0:e.includeMembers)===!1?"/projects?includeMembers=false":"/projects";return Ar(ti(this,sc),ti(this,ic),{uri:n})}getById(e){return Ar(ti(this,sc),ti(this,ic),{uri:"/projects/".concat(e)})}}sc=new WeakMap;ic=new WeakMap;class rK{constructor(e,n){My(this,oc,void 0),My(this,ac,void 0),Ly(this,oc,e),Ly(this,ac,n)}list(e){const n=(e==null?void 0:e.includeMembers)===!1?"/projects?includeMembers=false":"/projects";return Pt(Ar(ti(this,oc),ti(this,ac),{uri:n}))}getById(e){return Pt(Ar(ti(this,oc),ti(this,ac),{uri:"/projects/".concat(e)}))}}oc=new WeakMap;ac=new WeakMap;var tD=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},Vy=(t,e,n)=>(tD(t,e,"read from private field"),n?n.call(t):e.get(t)),Uy=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},By=(t,e,n,r)=>(tD(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),ip,op,ap,lp;class sK{constructor(e,n){Uy(this,ip,void 0),Uy(this,op,void 0),By(this,ip,e),By(this,op,n)}getById(e){return Ar(Vy(this,ip),Vy(this,op),{uri:"/users/".concat(e)})}}ip=new WeakMap;op=new WeakMap;class iK{constructor(e,n){Uy(this,ap,void 0),Uy(this,lp,void 0),By(this,ap,e),By(this,lp,n)}getById(e){return Pt(Ar(Vy(this,ap),Vy(this,lp),{uri:"/users/".concat(e)}))}}ap=new WeakMap;lp=new WeakMap;var nD=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},he=(t,e,n)=>(nD(t,e,"read from private field"),n?n.call(t):e.get(t)),zy=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},Wy=(t,e,n,r)=>(nD(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),Xi,St,Zi,yt;const oK=class Ix{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ny;zy(this,Xi,void 0),zy(this,St,void 0),this.listen=JO,this.config(n),Wy(this,St,e),this.assets=new WQ(this,he(this,St)),this.datasets=new eK(this,he(this,St)),this.projects=new nK(this,he(this,St)),this.users=new sK(this,he(this,St))}clone(){return new Ix(he(this,St),this.config())}config(e){if(e===void 0)return{...he(this,Xi)};if(he(this,Xi)&&he(this,Xi).allowReconfigure===!1)throw new Error("Existing client instance cannot be reconfigured - use `withConfig(newConfig)` to return a new client");return Wy(this,Xi,VO(e,he(this,Xi)||{})),this}withConfig(e){return new Ix(he(this,St),{...this.config(),...e})}fetch(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return BO(this,he(this,St),e,n,r)}getDocument(e,n){return zO(this,he(this,St),e,n)}getDocuments(e,n){return WO(this,he(this,St),e,n)}create(e,n){return tg(this,he(this,St),e,"create",n)}createIfNotExists(e,n){return qO(this,he(this,St),e,n)}createOrReplace(e,n){return HO(this,he(this,St),e,n)}delete(e,n){return GO(this,he(this,St),e,n)}mutate(e,n){return QO(this,he(this,St),e,n)}patch(e,n){return new Nc(e,n,this)}transaction(e){return new MO(e,this)}request(e){return Ar(this,he(this,St),e)}getUrl(e,n){return wE(this,e,n)}getDataUrl(e,n){return xu(this,e,n)}};Xi=new WeakMap;St=new WeakMap;let aK=oK;const lK=class kx{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ny;zy(this,Zi,void 0),zy(this,yt,void 0),this.listen=JO,this.config(n),Wy(this,yt,e),this.assets=new qQ(this,he(this,yt)),this.datasets=new tK(this,he(this,yt)),this.projects=new rK(this,he(this,yt)),this.users=new iK(this,he(this,yt)),this.observable=new aK(e,n)}clone(){return new kx(he(this,yt),this.config())}config(e){if(e===void 0)return{...he(this,Zi)};if(he(this,Zi)&&he(this,Zi).allowReconfigure===!1)throw new Error("Existing client instance cannot be reconfigured - use `withConfig(newConfig)` to return a new client");return this.observable&&this.observable.config(e),Wy(this,Zi,VO(e,he(this,Zi)||{})),this}withConfig(e){return new kx(he(this,yt),{...this.config(),...e})}fetch(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Pt(BO(this,he(this,yt),e,n,r))}getDocument(e,n){return Pt(zO(this,he(this,yt),e,n))}getDocuments(e,n){return Pt(WO(this,he(this,yt),e,n))}create(e,n){return Pt(tg(this,he(this,yt),e,"create",n))}createIfNotExists(e,n){return Pt(qO(this,he(this,yt),e,n))}createOrReplace(e,n){return Pt(HO(this,he(this,yt),e,n))}delete(e,n){return Pt(GO(this,he(this,yt),e,n))}mutate(e,n){return Pt(QO(this,he(this,yt),e,n))}patch(e,n){return new jc(e,n,this)}transaction(e){return new FO(e,this)}request(e){return Pt(Ar(this,he(this,yt),e))}dataRequest(e,n,r){return Pt(ph(this,he(this,yt),e,n,r))}getUrl(e,n){return wE(this,e,n)}getDataUrl(e,n){return xu(this,e,n)}};Zi=new WeakMap;yt=new WeakMap;let uK=lK;function cK(t,e){return{requester:FT(t,{}).defaultRequester,createClient:i=>new e(FT(t,{maxRetries:i.maxRetries,retryDelay:i.retryDelay}),i)}}var dK=[];const hK=cK(dK,uK),fK=hK.createClient,rD=fK({projectId:"0a9a4r26",dataset:"production",useCdn:!0,apiVersion:"2023-05-03",token:{}.VITE_DATABASE_API_KEY}),pK=()=>rD.fetch('*[_type == "match" && !(_id in path("drafts.**")) && (status == "initialized" || status == "streaming")]{ _id, name, playerEast->{team->{name, "squareLogoImage": squareLogoImage.asset->url, "color": color.hex}, player->{name, designation, "portraitImage": portraitImage.asset->url}, overridedDesignation, overridedName, "overridedColor": overridedColor.hex, "overridedPortraitImage": overridedPortraitImage.asset->url}, playerSouth->{team->{name, "squareLogoImage": squareLogoImage.asset->url, "color": color.hex}, player->{name, designation, "portraitImage": portraitImage.asset->url}, overridedDesignation, overridedName, overridedColor, "overridedPortraitImage": overridedPortraitImage.asset->url}, playerWest->{team->{name, "squareLogoImage": squareLogoImage.asset->url, "color": color.hex}, player->{name, designation, "portraitImage": portraitImage.asset->url}, overridedDesignation, overridedName, overridedColor, "overridedPortraitImage": overridedPortraitImage.asset->url}, playerNorth->{team->{name, "squareLogoImage": squareLogoImage.asset->url, "color": color.hex}, player->{name, designation, "portraitImage": portraitImage.asset->url}, overridedDesignation, overridedName, overridedColor, "overridedPortraitImage": overridedPortraitImage.asset->url},tournament->}'),sD=t=>rD.fetch(`*[_type == "match" && _id == "${t}" && (status == "initialized" || status == "streaming")]{ _id, name, playerEast->{team->{name, "squareLogoImage": squareLogoImage.asset->url, "color": color.hex}, player->{name, designation, "portraitImage": portraitImage.asset->url, nickname}, overridedDesignation, overridedName, overridedNickname, isHideNickname, "overridedColor": overridedColor.hex, "overridedPortraitImage": overridedPortraitImage.asset->url}, playerSouth->{team->{name, "squareLogoImage": squareLogoImage.asset->url, "color": color.hex}, player->{name, designation, "portraitImage": portraitImage.asset->url, nickname}, overridedDesignation, overridedName, overridedNickname, isHideNickname, overridedColor, "overridedPortraitImage": overridedPortraitImage.asset->url}, playerWest->{team->{name, "squareLogoImage": squareLogoImage.asset->url, "color": color.hex}, player->{name, designation, "portraitImage": portraitImage.asset->url, nickname}, overridedDesignation, overridedName, overridedNickname, isHideNickname, overridedColor, "overridedPortraitImage": overridedPortraitImage.asset->url}, playerNorth->{team->{name, "squareLogoImage": squareLogoImage.asset->url, "color": color.hex}, player->{name, designation, "portraitImage": portraitImage.asset->url, nickname}, overridedDesignation, overridedName, overridedNickname, isHideNickname, overridedColor, "overridedPortraitImage": overridedPortraitImage.asset->url},tournament->}`).then(e=>e[0]),Wa=t=>{const e=t.overridedPortraitImage||t.player.portraitImage?`${t.overridedPortraitImage??t.player.portraitImage}?w=360&h=500`:null,n=t.team.squareLogoImage?`${t.team.squareLogoImage}?w=500&h=500`:"",r=t.team.squareLogoImage?`${t.team.squareLogoImage}?w=1000&h=1000`:"",s=t.overridedDesignation??t.team.name??t.player.designation,i=t.overridedName??t.player.name,o=t.overridedColor??t.team.color;return{name:i,nickname:t.isHideNickname?"":t.overridedNickname||t.player.nickname||"",color:o,title:s,teamPicUrl:n,largeTeamPicUrl:r,proPicUrl:e}},LT=`body { 
  background-color: rgba(0, 0, 0, 0); 
  color: rgba(0, 0, 0, 0); 
  margin: 0px auto; 
  overflow: hidden; 
}

.body-hidden {
  display: none;
}`;function yK(){const t=x.useCallback(()=>{window.navigator.clipboard.writeText(LT)},[]);return u.jsx("div",{className:"flex items-center justify-center gap-x-8",children:u.jsxs("div",{children:[u.jsx("p",{children:"1. 打開OBS"}),u.jsxs("p",{children:["2. 來源 ","->"," + ","->"," 瀏覽器，然後照下面設定"]}),u.jsxs("p",{children:["- 網址 = ",u.jsxs("strong",{children:[window.location.origin,"/obs/1"]}),u.jsx("br",{}),"- 寬度 = 1920, 高度 = 1080",u.jsx("br",{})," - 自訂CSS ="," ",u.jsxs("div",{className:"relative bg-gray-700 text-white p-4 rounded",children:[u.jsx("pre",{children:LT}),u.jsx("div",{className:"absolute top-2 right-2",children:u.jsx("button",{type:"button",onClick:t,children:u.jsx("i",{className:"bi bi-copy"})})})]}),u.jsx("br",{}),"其餘默認即可。"]}),u.jsx("p",{children:"4. 確定"})]})})}let mK=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,n)=>(n&=63,n<36?e+=n.toString(36):n<62?e+=(n-26).toString(36).toUpperCase():n>62?e+="-":e+="_",e),"");const ps=(t=12)=>mK(t),gK=()=>{const t=new Date;return`${t.getFullYear()}${t.getMonth()+1}${t.getDate()}`},Rx=t=>`https://api.qrserver.com/v1/create-qr-code/?size=512x512&data=${t}`,iD=t=>{let e=parseInt(t.substring(1,3),16),n=parseInt(t.substring(3,5),16),r=parseInt(t.substring(5,7),16);e=Math.round(e*1.25),n=Math.round(n*1.25),r=Math.round(r*1.25),e=e<255?e:255,n=n<255?n:255,r=r<255?r:255,e=Math.round(e),n=Math.round(n),r=Math.round(r);const s=e.toString(16).length===1?`0${e.toString(16)}`:e.toString(16),i=n.toString(16).length===1?`0${n.toString(16)}`:n.toString(16),o=r.toString(16).length===1?`0${r.toString(16)}`:r.toString(16);return`#${s}${i}${o}`},vK=t=>{switch(t){case"12":return"三倍滿 (12翻)";case"13":return"累計役滿 (13翻)"}return"(未知)"},_K=t=>{switch(t){case"13":return"單倍役滿";case"26":return"雙倍役滿";case"39":return"三倍役滿";case"130":return"無上限"}return"(未知)"},xK=t=>typeof t>"u"||t===null?"-":t>=0?`+${t.toFixed(1)}`:`▲${Math.abs(t).toFixed(1)}`,wK=t=>t===1?"1st":t===2?"2nd":t===3?"3rd":`${t}th`,lf=({teamPlayer:t})=>{const e=t.overridedPortraitImage||t.player.portraitImage?`${t.overridedPortraitImage??t.player.portraitImage}?w=32&h=32`:null,n=`${t.team.squareLogoImage}?w=32&h=32`,r=t.overridedDesignation??t.team.name??t.player.designation,s=t.overridedName??t.player.name,i=t.overridedColor??t.team.color;return u.jsxs("div",{className:"flex justify-start items-center gap-x-1 border-l-4 pl-2",style:{borderColor:i},children:[u.jsx("div",{className:"w-8 h-8",children:n&&u.jsx("img",{src:n,alt:r})}),u.jsx("div",{className:"w-8 h-8",children:e&&u.jsx("img",{src:e,alt:s})}),u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"text-sm text-neutral-600",children:r}),u.jsx("p",{className:"font-bold",children:s})]})]})};function EK(){const{data:t}=pE({queryKey:["matches"],queryFn:pK}),{data:e,set:n}=Mn("obs/1");return x.useCallback(r=>{const s=r.currentTarget.getAttribute("data-id");s&&confirm(`請確定上一局對局已經結束才開始新的直播！！
確定要開始直播新的對局嗎？`)&&n({matchId:s})},[]),u.jsx("div",{className:"container mx-auto",children:u.jsxs("div",{className:"h-screen flex flex-col py-16 gap-y-12",children:[u.jsx("div",{className:"shrink-0",children:u.jsxs("h1",{className:"text-4xl font-bold text-center",children:[u.jsx("img",{src:"/images/master-logo.jpeg",className:"inline-block w-16",alt:"HKMSCA"})," ",u.jsx("span",{children:"日麻比賽直播系統 (牌藝攻防)"})]})}),u.jsxs("div",{className:"shrink-0 space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-3 gap-x-4",children:[u.jsx("div",{children:u.jsxs("div",{className:"px-8 py-4 bg-green-300 border-2 border-green-600 text-center space-y-4",children:[u.jsx("p",{className:"text-3xl font-bold text-green-900",children:"OBS設定"}),u.jsxs("p",{className:"text-2xl",children:["固定的直播頁面："," ",u.jsxs("a",{href:`${location.origin}/obs/1`,target:"_blank",className:"text-black",children:[location.origin,"/obs/1"]})]}),u.jsx("div",{className:"text-left",children:u.jsx(yK,{})})]})}),u.jsx("div",{children:u.jsxs("div",{className:"px-8 py-4 bg-blue-300 border-2 border-blue-600 text-center space-y-4",children:[u.jsx("p",{className:"text-3xl font-bold text-blue-900",children:"主播"}),u.jsxs("p",{className:"text-2xl",children:["固定的紀錄頁面：",u.jsxs("a",{href:`${location.origin}/obs/1/stat`,target:"_blank",className:"text-black",children:[location.origin,"/obs/1/stat"]})]}),u.jsx("div",{className:"pt-16",children:u.jsx("img",{className:"mx-auto block w-64 h-64",src:Rx(`${location.origin}/obs/1/stat`),alt:""})})]})}),u.jsx("div",{children:u.jsxs("div",{className:"px-8 py-4 bg-yellow-300 border-2 border-yellow-600 text-center space-y-4",children:[u.jsx("p",{className:"text-3xl font-bold text-yellow-900",children:"控制台"}),u.jsxs("p",{className:"text-2xl",children:["固定的控制台頁面：",u.jsxs("a",{href:`${location.origin}/obs/1/control`,target:"_blank",className:"text-black",children:[location.origin,"/obs/1/control"]})]}),u.jsx("div",{className:"pt-16",children:u.jsx("img",{className:"mx-auto block w-64 h-64",src:Rx(`${location.origin}/obs/1/control`),alt:""})})]})})]}),u.jsx("div",{children:u.jsxs("table",{className:"data-table w-full text-left",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"對局"}),u.jsx("th",{children:"東"}),u.jsx("th",{children:"南"}),u.jsx("th",{children:"西"}),u.jsx("th",{children:"北"}),u.jsx("th",{className:"text-right",children:"操作"})]})}),u.jsx("tbody",{children:t==null?void 0:t.map(r=>u.jsxs("tr",{children:[u.jsxs("th",{children:[u.jsx("p",{children:r.name}),u.jsx("p",{className:"font-normal text-sm text-neutral-600",children:r.tournament.name})]}),u.jsx("td",{children:u.jsx(lf,{teamPlayer:r.playerEast})}),u.jsx("td",{children:u.jsx(lf,{teamPlayer:r.playerSouth})}),u.jsx("td",{children:u.jsx(lf,{teamPlayer:r.playerWest})}),u.jsx("td",{children:u.jsx(lf,{teamPlayer:r.playerNorth})}),u.jsxs("td",{className:"space-x-2 text-right",children:[u.jsxs("a",{href:`/match/${r._id}/nameplates`,target:"_blank",children:[u.jsx("i",{className:"bi bi-person-badge"})," 列印名牌"]}),r._id===(e==null?void 0:e.matchId)?u.jsxs("span",{className:"bg-red-600 px-2 py-1 rounded text-white",children:[u.jsx("i",{className:"bi bi-record-circle"})," LIVE 直播中"]}):u.jsxs("a",{href:`/match/${r._id}/control`,target:"_blank",className:"text-red-600",children:[u.jsx("i",{className:"bi bi-record-circle"})," 直播此對局"]})]})]},r._id))})]})}),u.jsx("div",{children:u.jsx("div",{className:"text-center space-x-4",children:u.jsx("a",{href:"https://hkmjbs.sanity.studio/",target:"_blank",children:u.jsxs(ke,{color:"secondary",children:["資料庫 ",u.jsx("i",{className:"bi bi-box-arrow-up-right"})]})})})}),u.jsx("div",{className:"flex gap-x-4"})]})]})})}const bK=t=>{const e={};for(let n=0;n<t.length;n+=1)e[n.toString()]=t[n];return e},VT=t=>{if(t.length!==0)return t[t.length-1]},Is=t=>{const{data:e,update:n}=Mn(`/matches/${t}`),{data:r,update:s,push:i}=Mn("matchRounds",{order:{byChild:"matchId"},filter:{equalTo:t}}),o=x.useMemo(()=>VT(Object.values(r??{}))??void 0,[r]),a=x.useMemo(()=>Object.values((o==null?void 0:o.doras)??{}),[o]),l=x.useCallback(y=>{const v=VT(Object.keys(r??{}));v&&s({[v]:{...o,...y}})},[o,r,s]),c=x.useCallback(y=>{l({doras:bK(y)})},[l]),d=x.useCallback(y=>{n({name:y})},[n]),h=x.useCallback(y=>{n({activeResultDetail:y})},[n]),f=x.useCallback(y=>{n({showPoints:y})},[n]),p=x.useCallback(y=>{s({[y]:{...r==null?void 0:r[y],hasBroadcasted:!0}})},[r,s]);return{match:e,matchRounds:r,matchCurrentRound:o,matchCurrentRoundDoras:a,setMatchName:d,setMatchPointDisplay:f,setMatchActiveResultDetail:h,setMatchRoundHasBroadcastedToTrue:p,setCurrentRoundDoras:c,updateCurrentMatchRound:l,pushMatchRound:i}};var rt=(t=>(t[t.Unknown=0]="Unknown",t[t.Exhausted=-1]="Exhausted",t[t.Ron=1]="Ron",t[t.SelfDrawn=2]="SelfDrawn",t[t.Hotfix=-2]="Hotfix",t))(rt||{}),Ue=(t=>(t[t.Unknown=0]="Unknown",t[t.NextRound=1]="NextRound",t[t.Extended=2]="Extended",t[t.NextRoundAndExtended=3]="NextRoundAndExtended",t[t.Hotfix=-2]="Hotfix",t[t.End=-1]="End",t))(Ue||{}),ut=(t=>(t[t.Win=1]="Win",t[t.Lose=-1]="Lose",t[t.None=0]="None",t))(ut||{}),An=(t=>(t[t.East=0]="East",t[t.South=1]="South",t[t.West=2]="West",t[t.North=3]="North",t))(An||{});const a_=[An.East,An.South,An.West,An.North],UT=["0","1","2","3"],SK=t=>parseInt(t,10),$i=(t,e)=>a_[(4+SK(t)-(e-1)%a_.length)%a_.length],vr=(t,e)=>$i(t,e)===An.East,CK=(t,e)=>$i(t,e)===An.South,AK=(t,e)=>$i(t,e)===An.West,TK=(t,e)=>$i(t,e)===An.North,oD=t=>t>=1&&t<=4,aD=t=>t>=5&&t<=8,lD=t=>t>=9&&t<=12,uD=t=>t>=13&&t<=16,pa={"1h20f":{ne:200,e:400,ner:1e3,er:1500},"1h25f":{ne:200,e:400,ner:1e3,er:1500},"1h30f":{ne:300,e:500,ner:1e3,er:1500},"1h40f":{ne:400,e:700,ner:1300,er:2e3},"1h50f":{ne:400,e:800,ner:1600,er:2400},"1h60f":{ne:500,e:1e3,ner:2e3,er:2900},"1h70f":{ne:600,e:1200,ner:2300,er:3400},"1h80f":{ne:700,e:1300,ner:2600,er:3900},"1h90f":{ne:800,e:1500,ner:2900,er:4400},"1h100f":{ne:800,e:1600,ner:3200,er:4800},"1h110f":{ne:900,e:1800,ner:3600,er:5300},"2h20f":{ne:400,e:700,ner:1500,er:2100},"2h25f":{ne:400,e:800,ner:1600,er:2400},"2h30f":{ne:500,e:1e3,ner:2e3,er:2900},"2h40f":{ne:700,e:1300,ner:2600,er:3900},"2h50f":{ne:800,e:1600,ner:3200,er:4800},"2h60f":{ne:1e3,e:2e3,ner:3900,er:5800},"2h70f":{ne:1200,e:2300,ner:4500,er:6800},"2h80f":{ne:1300,e:2600,ner:5200,er:7700},"2h90f":{ne:1500,e:2900,ner:5800,er:8700},"2h100f":{ne:1600,e:3200,ner:6400,er:9600},"2h110f":{ne:1800,e:3600,ner:7100,er:10600},"3h20f":{ne:700,e:1300,ner:2600,er:3900},"3h25f":{ne:800,e:1600,ner:3200,er:4800},"3h30f":{ne:1e3,e:2e3,ner:3900,er:5800},"3h40f":{ne:1300,e:2600,ner:5200,er:7700},"3h50f":{ne:1600,e:3200,ner:6400,er:9600},"3h60f":{ne:2e3,e:3900,ner:7700,er:11600},"4h20f":{ne:1300,e:2600,ner:5200,er:7700},"4h25f":{ne:1600,e:3200,ner:6400,er:9600},"4h30f":{ne:2e3,e:3900,ner:7700,er:11600},"5h":{ne:2e3,e:4e3,ner:8e3,er:12e3},"6h":{ne:3e3,e:6e3,ner:12e3,er:18e3},"7h":{ne:3e3,e:6e3,ner:12e3,er:18e3},"8h":{ne:4e3,e:8e3,ner:16e3,er:24e3},"9h":{ne:4e3,e:8e3,ner:16e3,er:24e3},"10h":{ne:4e3,e:8e3,ner:16e3,er:24e3},"11h":{ne:6e3,e:12e3,ner:24e3,er:36e3},"12h":{ne:6e3,e:12e3,ner:24e3,er:36e3}},IK=(t,e,n)=>{let r;const s=parseInt(t,10);if(Number.isNaN(s))throw new Error(`han "${t}" is NaN`);const i=parseInt(e,10);if(Number.isNaN(i))throw new Error(`fu "${e}" is NaN`);return s>=13?r=pa["12h"]:s>=5?r=pa[`${s}h`]:s>=4&&i>=(n!=null&&n.roundUp?30:40)||s>=3&&i>=(n!=null&&n.roundUp?60:70)?r=pa["5h"]:r=pa[`${s}h${i}f`],r||pa["1h30f"]},kK=(t=1)=>({ne:8e3*t,e:16e3*t,ner:32e3*t,er:48e3*t}),BT=(t,e,n,r,s,i)=>{const o=n>0?kK(n):IK(t,e,i);return r?s?{win:o.er,target:o.er}:{win:o.e*3,all:o.e}:s?{win:o.ner,target:o.ner}:{win:o.e+2*o.ne,east:o.e,others:o.ne}},RK=t=>t.all||t.east?rt.SelfDrawn:t.target?rt.Ron:rt.Unknown,zT=t=>UT[(t-1)%UT.length],PK=t=>({0:{beforeScore:t[0].afterScore,afterScore:t[0].afterScore,isRevealed:!1,isRiichi:!1,isYellowCarded:t[0].isYellowCarded,isRedCarded:t[0].isRedCarded,type:ut.None,scoreChanges:[],prevScoreChanges:t[0].scoreChanges??[],detail:{han:1,fu:30,yakumanCount:0,dora:0,redDora:0,innerDora:0,yakus:[],raw:{},isRevealed:!1,isRiichied:!1}},1:{beforeScore:t[1].afterScore,afterScore:t[1].afterScore,isRevealed:!1,isRiichi:!1,isYellowCarded:t[1].isYellowCarded,isRedCarded:t[1].isRedCarded,type:ut.None,scoreChanges:[],prevScoreChanges:t[1].scoreChanges??[],detail:{han:1,fu:30,yakumanCount:0,dora:0,redDora:0,innerDora:0,yakus:[],raw:{},isRevealed:!1,isRiichied:!1}},2:{beforeScore:t[2].afterScore,afterScore:t[2].afterScore,isRevealed:!1,isRiichi:!1,isYellowCarded:t[2].isYellowCarded,isRedCarded:t[2].isRedCarded,type:ut.None,scoreChanges:[],prevScoreChanges:t[2].scoreChanges??[],detail:{han:1,fu:30,yakumanCount:0,dora:0,redDora:0,innerDora:0,yakus:[],raw:{},isRevealed:!1,isRiichied:!1}},3:{beforeScore:t[3].afterScore,afterScore:t[3].afterScore,isRevealed:!1,isRiichi:!1,isYellowCarded:t[3].isYellowCarded,isRedCarded:t[3].isRedCarded,type:ut.None,scoreChanges:[],prevScoreChanges:t[3].scoreChanges??[],detail:{han:1,fu:30,yakumanCount:0,dora:0,redDora:0,innerDora:0,yakus:[],raw:{},isRevealed:!1,isRiichied:!1}}}),WT=t=>PK({0:t[0],1:t[1],2:t[2],3:t[3]}),NK=()=>`${gK()}-${ps(6)}`,qy=(t,e,n)=>`${t}-${e}.${n}`,jK={1:"東 1 局",2:"東 2 局",3:"東 3 局",4:"東 4 局",5:"南 1 局",6:"南 2 局",7:"南 3 局",8:"南 4 局",9:"西 1 局",10:"西 2 局",11:"西 3 局",12:"西 4 局",13:"北 1 局",14:"北 2 局",15:"北 3 局",16:"北 4 局"},cD=(t,e,n=8)=>{try{const r=jK[Math.min(t,n)];if(!r)throw new Error(`Unable to parse round=${t} in MJMatchCounterSpan`);return e&&e!==0?`${r}${e}本場`:r}catch(r){return console.error(r),`${t}.${e??0}`}},dD=t=>{switch(t){case"0":return"3";case"1":return"0";case"2":return"1";case"3":return"2"}},hD=t=>{switch(t){case"0":return"1";case"1":return"2";case"2":return"3";case"3":return"0"}},fD=t=>{switch(t){case"0":return"2";case"1":return"3";case"2":return"0";case"3":return"1"}};function En({signed:t,className:e,positiveClassName:n,negativeClassName:r,value:s,animated:i,hideZero:o,title:a}){const[l,c]=x.useState(s),d=x.useRef(null),h=x.useCallback(y=>y===0?o?"":y.toLocaleString("en-US"):y>0?`${t?"+":""}${Math.floor(y).toLocaleString("en-US")}`:Math.floor(y).toLocaleString("en-US"),[o,t]),f=x.useMemo(()=>h(l),[h,l]),p=x.useMemo(()=>s>0?`${e??""} ${n??""}`:s<0?`${e??""} ${r??""}`:e,[e,r,n,s]);return x.useEffect(()=>{if(l!==s)if(i){for(let _=16;_<1e3;_+=16)setTimeout(()=>{d.current&&(d.current.innerText=Math.floor(l-(l-s)*(_/1e3)).toLocaleString("en-US"))},_);setTimeout(()=>{c(s)},1e3+16)}else c(s)},[i,l,s]),x.useEffect(()=>{d.current&&(d.current.innerText=f)},[f]),u.jsx("span",{title:a,ref:d,className:p})}const qT={"1m":"bg-[left_0%_top_0%]","2m":"bg-[left_10%_top_0%]","3m":"bg-[left_20%_top_0%]","4m":"bg-[left_30%_top_0%]","5m":"bg-[left_40%_top_0%]","6m":"bg-[left_50%_top_0%]","7m":"bg-[left_60%_top_0%]","8m":"bg-[left_70%_top_0%]","9m":"bg-[left_80%_top_0%]","0m":"bg-[left_30%_top_80%]","1p":"bg-[left_0%_top_20%]","2p":"bg-[left_10%_top_20%]","3p":"bg-[left_20%_top_20%]","4p":"bg-[left_30%_top_20%]","5p":"bg-[left_40%_top_20%]","6p":"bg-[left_50%_top_20%]","7p":"bg-[left_60%_top_20%]","8p":"bg-[left_70%_top_20%]","9p":"bg-[left_80%_top_20%]","0p":"bg-[left_40%_top_80%]","1s":"bg-[left_0%_top_40%]","2s":"bg-[left_10%_top_40%]","3s":"bg-[left_20%_top_40%]","4s":"bg-[left_30%_top_40%]","5s":"bg-[left_40%_top_40%]","6s":"bg-[left_50%_top_40%]","7s":"bg-[left_60%_top_40%]","8s":"bg-[left_70%_top_40%]","9s":"bg-[left_80%_top_40%]","0s":"bg-[left_50%_top_80%]","1z":"bg-[left_0%_top_60%]","2z":"bg-[left_10%_top_60%]","3z":"bg-[left_20%_top_60%]","4z":"bg-[left_30%_top_60%]","5z":"bg-[left_40%_top_60%]","6z":"bg-[left_50%_top_60%]","7z":"bg-[left_60%_top_60%]",default:"bg-[left_70%_top_60%]"};function Ur({className:t,children:e,...n}){const r=x.useMemo(()=>qT[e==null?void 0:e.toString()]??qT.default,[e]);return u.jsx("div",{className:`mahjong-tile ${r} ${t}`,...n})}function Ti({player:t,playerIndex:e,score:n,scoreChanges:r=[],point:s,ranking:i,isEast:o,isRiichi:a,isYellowCarded:l,isRedCarded:c,waitingTiles:d,onClickWaitingTiles:h,showPointAndRanking:f,className:p,...y}){const[v,_]=x.useState(n),[g,m]=x.useState(null),w=x.useMemo(()=>iD(t.color??"#000000"),[t.color]),E=x.useMemo(()=>!!g,[g]);return x.useEffect(()=>{n!==v&&(m(r),setTimeout(()=>{_(n)},2550),setTimeout(()=>{m(null)},3e3))},[n,r,v]),u.jsxs("div",{className:"relative min-w-[5.35em] mx-auto [&_.hide-if-changing]:transition-opacity [&_.hide-if-changing]:data-[score-changing='1']:opacity-0 overflow-visible","data-score-changing":E?"1":"0",children:[u.jsxs("div",{className:"absolute top-[0.05em] bottom-[0.15em] -left-[0.1em] -right-[0.1em] rounded-[0.1em] overflow-hidden -z-50",children:[l&&u.jsx("div",{className:"absolute top-0 left-0 w-[200%] aspect-square animate-[yellowPenaltyAni_8s_ease-in-out_1]"}),c&&u.jsx("div",{className:"absolute top-0 left-0 w-[200%] aspect-square animate-[redPenaltyAni_8s_ease-in-out_1]"})]}),l&&u.jsx("div",{className:"absolute -top-[0.4em] left-0 h-[0.5em] w-[0.37em] bg-[#ffe100] rounded-[0.05em]"}),c&&u.jsx("div",{className:"absolute -top-[0.4em] left-[0.45em] h-[0.5em] w-[0.37em] bg-[#ff1900] rounded-[0.05em]"}),u.jsxs("div",{className:"flex items-end gap-x-[0.1em]",children:[u.jsxs("div",{className:"shrink-0 w-[1.75em] h-full relative -bottom-[0.085em] -left-[0.085em]",children:[u.jsx("div",{className:"absolute w-full h-full bg-[#d1b571] overflow-hidden rounded-[0.1em]",style:{opacity:a?1:0},children:u.jsx("div",{className:"origin-bottom w-[200%] h-[100%] bg-[#d1291d] animate-[riichi_8s_ease-in-out_infinite]"})}),u.jsx("div",{className:"relative z-10 w-full aspect-[90/125] p-[0.085em]",children:u.jsxs("div",{className:"w-full h-full bg-white rounded-[0.08em] overflow-hidden",style:{background:`linear-gradient(180deg, ${t.color}, ${w})`},children:[t.teamPicUrl&&u.jsx("div",{className:"absolute inset-[0.085em] overflow-hidden",children:u.jsx("img",{className:"absolute max-w-[none] h-[2.2em] w-[2.2em] opacity-30 animate-[scrollFromRightToLeft_12s_linear_infinite]",src:t.teamPicUrl,alt:t.name})}),t.proPicUrl&&u.jsx("img",{className:"relative z-10 w-full h-full rounded-[0.08em]",src:t.proPicUrl,alt:t.name}),t.nickname&&u.jsx("div",{className:"absolute bottom-[0.085em] left-[0.085em] right-[0.085em] rounded-b-[0.08em] bg-[linear-gradient(to_top,#00000060,#00000050_70%,transparent)] text-white z-20",children:u.jsx("p",{className:"text-center text-[0.25em] font-semibold pb-[0.25em] pt-[0.5em]",children:t.nickname})})]})})]}),u.jsxs("div",{className:"flex-1 flex flex-col gap-y-[0.125em] items-start justify-end",children:[u.jsxs("div",{className:"bg-black bg-opacity-60 rounded text-[0.5em] flex gap-x-[0.2em] p-[0.1em] pl-[0.2em] pr-[0.2em] opacity-0 transition-opacity data-[has-waiting-tiles='1']:opacity-100 hide-if-changing cursor-pointer","data-has-waiting-tiles":d&&d.length>0||h?"1":"0",onClick:h,"data-player-index":e,children:[u.jsx("div",{className:"flex-1 leading-none min-h-[1.19em] flex flex-wrap gap-[0.15em]",children:d==null?void 0:d.map(T=>u.jsx(Ur,{className:"inline-block align-bottom w-[0.85em] animate-[fadeInFromLeft_1s_ease-in-out]",children:T},T))}),u.jsx("div",{className:"bg-[#FFFFFF] w-[4px]"}),u.jsxs("div",{className:"text-[#FFFFFF] text-[0.4em] leading-[1.3em] flex items-center",children:["待",u.jsx("br",{}),"牌"]})]}),u.jsxs("div",{className:`relative w-full text-left bg-white px-[0.1em] pb-[0.05em] pt-[0.08em] ${p}`,...y,style:{background:`linear-gradient(260deg, transparent, transparent 22px, ${w} 23px, ${t.color} 100%`},children:[u.jsxs("div",{className:"flex flex-col justify-center gap-y-[0.075em] mt-[0.04em]",children:[u.jsx("div",{className:"text-[0.1875em] ml-[0.1em] leading-none text-white hide-if-changing font-semibold",children:t.title||"　"}),u.jsx("div",{className:"text-[0.3125em] ml-[0.1em] leading-none text-white hide-if-changing font-semibold",children:t.name})]}),g&&u.jsx("div",{className:"absolute bottom-[2.75em] pr-[0.125em] left-0 text-[0.5625em] leading-none animate-[drop_3s_ease-in-out] font-numeric",children:g.map(T=>u.jsx("div",{children:u.jsx(En,{signed:!0,value:T,positiveClassName:"text-[#09eb09]",negativeClassName:"text-[#eb0000]"})}))}),u.jsxs("div",{className:"relative mt-[0.12em] mb-[0.03em]",children:[u.jsx("p",{className:"relative text-[0.5625em] flex-1 leading-none text-white font-numeric",style:{transition:"opacity 1s, bottom 1s",opacity:f?0:1,bottom:f?"1em":0},children:u.jsx(En,{animated:!0,value:v})}),u.jsxs("p",{className:"absolute left-0 right-[0.25em] text-[0.5625em] flex-1 leading-none text-white font-numeric",style:{transition:"opacity 1s, bottom 1s",opacity:f?1:0,bottom:f?0:"-1em"},children:[xK(s),u.jsx("span",{className:"text-[0.8em]",children:"pt"}),u.jsx("span",{className:"absolute right-0 bottom-0 text-[0.75em]",children:wK(i)})]})]})]})]})]}),u.jsx("div",{className:`mt-[0.2em] h-[0.075em] rounded-full ${o&&"bg-red-500"}`})]})}function _r({roundCount:t,extendedRoundCount:e,max:n=16,...r}){const s=x.useMemo(()=>cD(t,e??0,n),[t,n,e]);return u.jsx("span",{...r,children:s})}_r.defaultProps={extendedRoundCount:0};const uf=({player:t})=>u.jsxs("div",{className:"border-b-4 pb-1",style:{borderColor:t.color},children:[u.jsx("p",{className:"text-sm text-neutral-600",children:t.title}),u.jsx("p",{className:"font-bold",children:t.name})]});function cf({value:t}){return u.jsx(En,{value:t,positiveClassName:"text-green-600",negativeClassName:"text-red-600",signed:!0,hideZero:!0})}const df=({matchRound:t,playerIndex:e})=>u.jsxs("span",{children:[t.playerResults[e].isRiichi&&u.jsx("span",{className:"text-xs",children:"立"}),t.resultType===rt.Ron&&t.playerResults[e].type===ut.Lose&&u.jsx("span",{className:"text-xs",children:"統"}),t.resultType===rt.Ron&&t.playerResults[e].type===ut.Win&&u.jsx("span",{className:"text-xs",children:"和"}),t.resultType===rt.SelfDrawn&&t.playerResults[e].type===ut.Win&&u.jsx("span",{className:"text-xs",children:"摸"}),t.resultType===rt.Exhausted&&t.playerResults[e].type===ut.Win&&u.jsx("span",{className:"text-xs",children:"聽"})]});function wu({players:t,matchRounds:e,...n}){const r=x.useMemo(()=>Object.entries(e??{}),[e]);return u.jsxs("table",{...n,children:[u.jsx("thead",{children:u.jsxs("tr",{className:"border-b border-gray-400 [&>th]:p-2",children:[u.jsx("th",{className:"whitespace-nowrap px-16",children:"局數"}),u.jsx("th",{className:"w-1/4",children:u.jsx(uf,{player:t[0]})}),u.jsx("th",{className:"w-1/4",children:u.jsx(uf,{player:t[1]})}),u.jsx("th",{className:"w-1/4",children:u.jsx(uf,{player:t[2]})}),u.jsx("th",{className:"w-1/4",children:u.jsx(uf,{player:t[3]})})]})}),u.jsxs("tbody",{children:[r[0]&&u.jsxs("tr",{className:"even:bg-gray-200 [&>td]:p-2",children:[u.jsx("td",{className:"text-center"}),u.jsx("td",{className:"text-center",children:u.jsx(En,{value:r[0][1].playerResults[0].beforeScore})}),u.jsx("td",{className:"text-center",children:u.jsx(En,{value:r[0][1].playerResults[1].beforeScore})}),u.jsx("td",{className:"text-center",children:u.jsx(En,{value:r[0][1].playerResults[2].beforeScore})}),u.jsx("td",{className:"text-center",children:u.jsx(En,{value:r[0][1].playerResults[3].beforeScore})})]}),r.map(([s,i])=>i.resultType===rt.Hotfix?u.jsxs("tr",{className:"even:bg-gray-200 [&>td]:p-2",children:[u.jsx("td",{className:"text-center whitespace-nowrap px-16",children:"手動調整"}),u.jsx("td",{className:"text-center",children:i.playerResults[0].afterScore}),u.jsx("td",{className:"text-center",children:i.playerResults[1].afterScore}),u.jsx("td",{className:"text-center",children:i.playerResults[2].afterScore}),u.jsx("td",{className:"text-center",children:i.playerResults[3].afterScore})]},s):u.jsxs("tr",{className:"even:bg-gray-200 [&>td]:p-2",children:[u.jsx("td",{className:"text-center whitespace-nowrap",children:u.jsx(_r,{roundCount:i.roundCount,extendedRoundCount:i.extendedRoundCount,max:8,className:"px-4"})}),u.jsxs("td",{className:"text-center",children:[u.jsx(cf,{value:i.playerResults[0].afterScore-i.playerResults[0].beforeScore})," ",u.jsx(df,{matchRound:i,playerIndex:"0"})]}),u.jsxs("td",{className:"text-center",children:[u.jsx(cf,{value:i.playerResults[1].afterScore-i.playerResults[1].beforeScore})," ",u.jsx(df,{matchRound:i,playerIndex:"1"})]}),u.jsxs("td",{className:"text-center",children:[u.jsx(cf,{value:i.playerResults[2].afterScore-i.playerResults[2].beforeScore})," ",u.jsx(df,{matchRound:i,playerIndex:"2"})]}),u.jsxs("td",{className:"text-center",children:[u.jsx(cf,{value:i.playerResults[3].afterScore-i.playerResults[3].beforeScore})," ",u.jsx(df,{matchRound:i,playerIndex:"3"})]})]},s)),r[r.length-1]&&u.jsxs("tr",{className:"even:bg-gray-200 [&>td]:p-2",children:[u.jsx("td",{className:"text-center whitespace-nowrap px-16"}),u.jsx("td",{className:"text-center font-bold text-lg",children:u.jsx(En,{value:r[r.length-1][1].playerResults[0].afterScore})}),u.jsx("td",{className:"text-center font-bold text-lg",children:u.jsx(En,{value:r[r.length-1][1].playerResults[1].afterScore})}),u.jsx("td",{className:"text-center font-bold text-lg",children:u.jsx(En,{value:r[r.length-1][1].playerResults[2].afterScore})}),u.jsx("td",{className:"text-center font-bold text-lg",children:u.jsx(En,{value:r[r.length-1][1].playerResults[3].afterScore})})]})]})]})}function OK({params:{matchId:t}}){const{match:e,matchRounds:n,matchCurrentRound:r,matchCurrentRoundDoras:s}=Is(t);return!e||!r?u.jsx("div",{children:"對局讀取失敗。"}):u.jsx("div",{children:u.jsxs("div",{className:"container mx-auto my-8 px-8 space-y-6",children:[u.jsxs("div",{className:"flex flex-row items-stretch gap-x-4 text-white",children:[u.jsxs("div",{className:"shrink-0 rounded-[1rem] bg-black bg-opacity-50 p-2 flex items-stretch gap-x-4",children:[u.jsx("div",{className:"text-[2.5rem] leading-none border-[.25rem] rounded-[.75rem] pb-[0.3em] pt-[0.2em] px-4 border-current flex items-center justify-center",children:u.jsx(_r,{roundCount:r.roundCount,max:8})}),u.jsxs("div",{className:"flex flex-col justify-around",children:[u.jsxs("div",{className:"flex-1 flex flex-row items-center gap-x-2",children:[u.jsx("div",{className:"flex-1",children:u.jsx("img",{src:"/images/score-hundred.png",alt:"hundred",className:"h-4"})}),u.jsx("div",{children:r.extendedRoundCount??0})]}),u.jsxs("div",{className:"flex-1 flex flex-row items-center gap-x-2",children:[u.jsx("div",{className:"flex-1",children:u.jsx("img",{src:"/images/score-thousand.png",alt:"thousand",className:"h-4"})}),u.jsx("div",{children:r.cumulatedThousands??0})]})]}),u.jsx("div",{className:"flex items-center gap-x-2",children:s.map((i,o)=>u.jsx(Ur,{className:"w-9 cursor-pointer","data-index":o,children:i},i))})]}),u.jsx("div",{className:"flex-1"})]}),u.jsx("div",{className:"space-y-4",children:["0","1","2","3"].map(i=>u.jsx("div",{className:"flex gap-x-2 items-center",children:u.jsx("div",{className:"flex-1 text-[2.5rem]",children:u.jsx(Ti,{player:e.players[i],score:r.playerResults[i].beforeScore,scoreChanges:r.playerResults[i].prevScoreChanges,isEast:vr(i,r.roundCount),isRiichi:r.playerResults[i].isRiichi,isYellowCarded:r.playerResults[i].isYellowCarded,isRedCarded:r.playerResults[i].isRedCarded})})}))}),u.jsx(wu,{players:e.players,matchRounds:n,className:"w-full table-auto"})]})})}const HT=`body { 
  background-color: rgba(0, 0, 0, 0); 
  color: rgba(0, 0, 0, 0); 
  margin: 0px auto; 
  overflow: hidden; 
}

.body-hidden {
  display: none;
}`;function DK({matchId:t}){const e=x.useMemo(()=>`${window.location.origin}/match/${t}/control`,[t]),n=x.useCallback(()=>{window.navigator.clipboard.writeText(HT)},[]);return u.jsxs("div",{className:"flex items-center justify-center gap-x-8",children:[u.jsxs("div",{children:[u.jsx("p",{children:"1. 打開OBS"}),u.jsxs("p",{children:["2. 來源 ","->"," + ","->"," 瀏覽器，然後照下面設定"]}),u.jsxs("p",{children:["- 網址 = 此頁的網址 ",u.jsx("strong",{children:window.location.href}),u.jsx("br",{}),"- 寬度 = 1920, 高度 = 1080",u.jsx("br",{})," - 自訂CSS ="," ",u.jsxs("div",{className:"relative bg-gray-700 text-white p-4 rounded",children:[u.jsx("pre",{children:HT}),u.jsx("div",{className:"absolute top-2 right-2",children:u.jsx("button",{type:"button",onClick:n,children:u.jsx("i",{className:"bi bi-copy"})})})]})]})]}),u.jsxs("div",{children:[u.jsx("p",{children:'3. 在管理後台點擊右上角的 "開始OBS" '}),u.jsx("p",{children:"4. 確定"})]}),u.jsx("div",{className:"shrink-0",children:u.jsxs("a",{href:e,target:"_blank",rel:"noreferrer",className:"text-center underline",children:[u.jsx("img",{className:"block w-32 h-32",src:Rx(e),alt:""}),u.jsx("p",{children:"管理後台"})]})})]})}function FK({han:t,fu:e,yakumanCount:n,...r}){const s=x.useMemo(()=>{if(n&&n>0)return n===1?"役滿":n===2?"兩倍役滿":n===3?"三倍役滿":n===4?"四倍役滿":`${n}倍役滿`;if(t>=11)return"三倍滿";if(t>=8)return"倍滿";if(t>=6)return"跳滿";if(t>=5)return"滿貫";if(t>=4&&typeof e<"u"&&e>=40)return"滿貫";if(t>=3&&typeof e<"u"&&e>=70)return"滿貫";if(typeof e<"u")return},[n,t,e]);return s?u.jsx("div",{...r,children:s}):u.jsxs("div",{...r,children:[u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{children:t}),u.jsx("span",{children:"飜"})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{children:e}),u.jsx("span",{children:"符"})]})]})}const $K=({active:t,color:e="#000000",largeTeamPicUrl:n})=>u.jsxs(u.Fragment,{children:[u.jsx("img",{src:"/images/r.png",className:"w-0 h-0 opacity-0"}),u.jsx("img",{src:"/images/e.png",className:"w-0 h-0 opacity-0"}),u.jsx("img",{src:"/images/a.png",className:"w-0 h-0 opacity-0"}),u.jsx("img",{src:"/images/c.png",className:"w-0 h-0 opacity-0"}),u.jsx("img",{src:"/images/h.png",className:"w-0 h-0 opacity-0"}),u.jsx("img",{src:"/images/score-thousand.png",className:"w-0 h-0 opacity-0"}),t&&u.jsxs("div",{className:"reach-animation",children:[u.jsx("div",{className:"reach-background",style:{background:`linear-gradient(to bottom, transparent, ${e}80 40%, ${e}80 60%, transparent)`}}),u.jsx("div",{className:"reach-animation-logo",style:{backgroundImage:`url("${n}")`}}),u.jsx("div",{className:"reach-animation-bar",style:{backgroundImage:'url("/images/score-thousand.png")'}}),u.jsxs("div",{className:"reach-animation-text",children:[u.jsx("div",{className:"reach-animation-text-character c1",style:{backgroundImage:'url("/images/r.png")'}}),u.jsx("div",{className:"reach-animation-text-character c2",style:{backgroundImage:'url("/images/e.png")'}}),u.jsx("div",{className:"reach-animation-text-character c3",style:{backgroundImage:'url("/images/a.png")'}}),u.jsx("div",{className:"reach-animation-text-character c4",style:{backgroundImage:'url("/images/c.png")'}}),u.jsx("div",{className:"reach-animation-text-character c5",style:{backgroundImage:'url("/images/h.png")'}})]})]})]});function pD({params:{matchId:t}}){const{match:e,matchCurrentRound:n,matchCurrentRoundDoras:r}=Is(t),s=x.useMemo(()=>{if(!e||!n)return[];const h=[{ranking:1,point:50},{ranking:2,point:10},{ranking:3,point:-10},{ranking:4,point:-30}],f=Object.entries(n.playerResults).map(([p,y])=>({playerIndex:p,score:y.afterScore})).sort((p,y)=>y.score-p.score).map((p,y)=>({playerIndex:p.playerIndex,...h[y],point:(p.score-3e4)/1e3+h[y].point})).reduce((p,y)=>(p[y.playerIndex]={point:y.point,ranking:y.ranking},p),{});return["0","1","2","3"].map(p=>({...e.players[p],color:e.players[p].color,currentStatus:{...n.playerResults[p],isEast:vr(p,n.roundCount),...f[p]}}))},[e,n]),[i,o]=x.useState(null),[a,l]=x.useState(),[c,d]=x.useState({0:!1,1:!1,2:!1,3:!1});return x.useEffect(()=>{["0","1","2","3"].forEach(h=>{typeof(n==null?void 0:n.playerResults[h].isRiichi)<"u"&&n.playerResults[h].isRiichi!==c[h]&&(n.playerResults[h].isRiichi===!0&&(o(h),setTimeout(()=>{o(null)},2800)),d(f=>({...f,[h]:n.playerResults[h].isRiichi})))})},[n==null?void 0:n.playerResults,c]),x.useEffect(()=>{a!==(n==null?void 0:n.code)&&(l(n==null?void 0:n.code),d({0:!1,1:!1,2:!1,3:!1}))},[n==null?void 0:n.code,a]),!e||!n?u.jsx("div",{className:"text-current",children:"對局讀取失敗。"}):u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"w-screen h-screen mx-auto py-8 overflow-hidden text-[4.8rem] transition-opacity",style:{background:"linear-gradient(transparent, transparent 73%, rgba(0, 0, 0, 0.4))",opacity:i!==null?0:1},children:[u.jsxs("div",{className:"flex flex-row items-stretch gap-x-4 text-white",children:[u.jsxs("div",{className:"text-[0.6em] p-2 pl-10 pr-[1em] flex items-center gap-x-8 transition-[width]",style:{background:"linear-gradient(280deg, transparent, transparent 0.5em, #00000080 0.5em, #00000080 100%)"},children:[u.jsxs("div",{className:"",children:[u.jsx("div",{className:"text-[0.5em]",children:e.name}),u.jsxs("div",{className:"flex gap-x-8 items-center",children:[u.jsx("div",{className:"min-w-[3.5em]",children:u.jsx(_r,{roundCount:n.roundCount,max:8})}),u.jsxs("div",{className:"flex flex-col justify-around gap-2",children:[u.jsxs("div",{className:"flex-1 flex flex-row items-center gap-x-3",children:[u.jsx("div",{className:"flex-1",children:u.jsx("img",{src:"/images/score-hundred.png",alt:"hundred",className:"h-[0.25em] mt-[0.1em]"})}),u.jsx("div",{className:"text-[0.45em] leading-none",children:n.extendedRoundCount??0})]}),u.jsxs("div",{className:"flex-1 flex flex-row items-center gap-x-3",children:[u.jsx("div",{className:"flex-1",children:u.jsx("img",{src:"/images/score-thousand.png",alt:"thousand",className:"h-[0.25em] mt-[0.1em]"})}),u.jsx("div",{className:"text-[0.45em] leading-none",children:n.cumulatedThousands??0})]})]})]})]}),u.jsx("div",{className:"flex items-center gap-x-2",children:r.map(h=>u.jsx(Ur,{className:"w-[1.4em] animate-[fadeInFromLeft_0.5s_ease-in-out]",children:h},h))})]}),u.jsx("div",{className:"flex-1"})]}),u.jsx("div",{className:"flex items-center justify-center mt-20",children:u.jsx("div",{className:"body-hidden mx-20 text-[16px]",children:u.jsx(DK,{matchId:t})})}),u.jsx("div",{className:"fixed bottom-0 left-0 right-0 px-10 pb-6 grid grid-cols-4 items-end gap-x-8 text-white animate-[fadeInFromBottom_1s_ease-in-out]",style:{opacity:e.activeResultDetail?0:1,bottom:e.activeResultDetail?"-150px":0,transition:"opacity 0.5s, bottom 0.5s"},children:s.map(h=>u.jsxs("div",{className:"w-[5.35em]",children:[u.jsx(Ti,{player:h,score:h.currentStatus.afterScore,scoreChanges:h.currentStatus.scoreChanges,isEast:h.currentStatus.isEast,isRiichi:h.currentStatus.isRiichi&&n.resultType===rt.Unknown,waitingTiles:n.resultType===rt.Unknown?h.currentStatus.waitingTiles:[],isYellowCarded:h.currentStatus.isYellowCarded,isRedCarded:h.currentStatus.isRedCarded,ranking:h.currentStatus.ranking,point:h.currentStatus.point,showPointAndRanking:!!e.showPoints}),u.jsx("img",{src:h.largeTeamPicUrl,className:"w-0 h-0"})]},h.name))}),e.activeResultDetail&&u.jsxs("div",{className:"fixed bottom-0 left-0 right-0 px-10 pb-6 grid grid-cols-4 gap-x-8 text-white transition-opacity animate-[fadeInFromBottom_1s_ease-in-out]",children:[u.jsx("div",{className:"w-[5.35em]",children:u.jsx(Ti,{player:e.players[e.activeResultDetail.winnerPlayerIndex],score:n.playerResults[e.activeResultDetail.winnerPlayerIndex].afterScore})}),u.jsxs("div",{className:"col-span-3 bg-black bg-opacity-50 py-6 px-8 text-[0.5em] flex items-stretch gap-x-4",children:[u.jsx("div",{className:`flex-1 flex flex-wrap gap-x-[0.75em] ${e.activeResultDetail.yakumanCount>0?"self-center justify-center":""}`,children:e.activeResultDetail.yakus.map(({label:h})=>u.jsx("span",{children:h},h))}),u.jsx("div",{className:"shrink-0 w-px bg-neutral-200"}),u.jsx("div",{className:"shrink-0 min-w-[3em] self-center text-green-400 text-[1.4em] text-center",children:u.jsx(FK,{han:e.activeResultDetail.han,fu:e.activeResultDetail.fu,yakumanCount:e.activeResultDetail.yakumanCount})})]})]})]}),u.jsx("div",{className:"fixed inset-0 pointer-events-none",children:u.jsx($K,{active:i!==null,color:i&&s[i].color,largeTeamPicUrl:i&&s[i].largeTeamPicUrl})})]})}function nr({open:t,title:e,children:n,onClose:r,hideCloseButton:s}){const i=x.useRef(null);x.useEffect(()=>{if(i!=null&&i.current&&t){i.current.showModal();const{current:a}=i;return()=>{a.close()}}},[t]);const o=x.useCallback(()=>{r==null||r()},[r]);return u.jsx("dialog",{ref:i,onClose:o,children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex mb-4",children:[u.jsx("div",{className:"flex-1 items-center font-bold text-lg",children:e}),!s&&u.jsx("div",{className:"shrink-0",children:u.jsx("button",{type:"button",className:"absolute top-4 right-4",onClick:o,children:u.jsx("i",{className:"bi bi-x"})})})]}),n]})})}const EE=()=>u.jsx("div",{className:"inline-block w-4 h-4 border-2 border-neutral-800 border-l-transparent rounded-full animate-spin"});function MK({title:t,children:e,okButtonText:n="確認",cancelButtonText:r="取消",onClickOk:s,onClickCancel:i,...o}){const[a,l]=x.useState(!1),c=x.useCallback(()=>{s&&(l(!0),s().finally(()=>{l(!1)}))},[s]);return u.jsxs(nr,{title:t,...o,children:[u.jsx("div",{className:"mb-4",children:e}),u.jsxs("div",{className:"flex gap-x-4",children:[u.jsx("div",{className:"flex-1",children:u.jsx(ke,{type:"button",color:"secondary",className:"w-full",onClick:i,disabled:a,children:r})}),u.jsx("div",{className:"flex-1",children:u.jsx(ke,{type:"button",color:"danger",className:"w-full",onClick:c,disabled:a,children:a?u.jsx(EE,{}):n})})]})]})}const LK={isShowConfirmDialog:!1,setIsShowConfirmDialog:()=>{},confirmDialogOptions:{title:"警告"},setConfirmDialogOptions:()=>{}},yD=x.createContext(LK);function VK({children:t}){const[e,n]=x.useState(!1),[r,s]=x.useState({title:"警告"}),i=x.useMemo(()=>({isShowConfirmDialog:e,setIsShowConfirmDialog:n,confirmDialogOptions:r,setConfirmDialogOptions:s}),[r,e]),o=x.useCallback(()=>{n(!1)},[]);return u.jsxs(yD.Provider,{value:i,children:[t,u.jsx(MK,{open:e,okButtonText:r.okButtonText,cancelButtonText:r.cancelButtonText,onClickOk:r.onClickOk,onClickCancel:r.onClickCancel,onClose:o,...r,hideCloseButton:!0,children:r.content})]})}const UK=()=>{const t=x.useContext(yD);return{showConfirmDialog:x.useCallback(n=>{const r=async()=>(n.onClickOk??(async()=>Promise.resolve()))().then(()=>{t.setIsShowConfirmDialog(!1)}),s=async()=>(n.onClickCancel??(async()=>Promise.resolve()))().then(()=>{t.setIsShowConfirmDialog(!1)});t.setConfirmDialogOptions({...n,onClickOk:r,onClickCancel:s}),t.setIsShowConfirmDialog(!0)},[t])}};function cs({className:t,onChange:e,onChangeValue:n,...r}){const s=x.useMemo(()=>`block w-full rounded-md border-0 px-1 py-[9px] text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6 ${t}`,[t]),i=x.useCallback(o=>{e==null||e(o),n==null||n(o.currentTarget.value)},[e,n]);return u.jsx("select",{className:s,onChange:i,...r})}function BK({score:t,...e}){const n=x.useMemo(()=>t?t.target?t.target:t.all?`${t.all} ALL`:`${t.others},${t.east}`:"(錯誤)",[t]);return u.jsx("div",{...e,children:n})}function mD(){var t=x.useRef(!1),e=x.useCallback(function(){return t.current},[]);return x.useEffect(function(){return t.current=!0,function(){t.current=!1}},[]),e}function ng(t,e,n){e===void 0&&(e=[]),n===void 0&&(n={loading:!1});var r=x.useRef(0),s=mD(),i=x.useState(n),o=i[0],a=i[1],l=x.useCallback(function(){for(var c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];var h=++r.current;return o.loading||a(function(f){return Iy(Iy({},f),{loading:!0})}),t.apply(void 0,c).then(function(f){return s()&&h===r.current&&a({value:f,loading:!1}),f},function(f){return s()&&h===r.current&&a({error:f,loading:!1}),f})},e);return[o,l]}function zK(t,e){e===void 0&&(e=[]);var n=ng(t,e,{loading:!0}),r=n[0],s=n[1];return x.useEffect(function(){s()},[s]),r}var l_=function(){};function u_(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t&&t.addEventListener&&t.addEventListener.apply(t,e)}function c_(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t&&t.removeEventListener&&t.removeEventListener.apply(t,e)}var WK=typeof window<"u",qK=function(t,e){return typeof e=="boolean"?e:!t},HK=function(t){return x.useReducer(qK,t)};const vi=HK;var GK=function(t,e){return function(n,r){var s=n.getData("text/uri-list");if(s){(t.onUri||l_)(s,r);return}if(n.files&&n.files.length){(t.onFiles||l_)(Array.from(n.files),r);return}n.items&&n.items.length&&n.items[0].getAsString(function(i){e&&(t.onText||l_)(i,r)})}},QK=function(t,e){return{onDragOver:function(n){n.preventDefault()},onDragEnter:function(n){n.preventDefault(),e(!0)},onDragLeave:function(){e(!1)},onDrop:function(n){n.preventDefault(),n.persist(),e(!1),t(n.dataTransfer,n)},onPaste:function(n){n.persist(),t(n.clipboardData,n)}}},KK=function(t){t===void 0&&(t={});var e=t.onFiles,n=t.onText,r=t.onUri,s=mD(),i=x.useState(!1),o=i[0],a=i[1],l=x.useMemo(function(){return GK(t,s())},[e,n,r]),c=x.useMemo(function(){return QK(l,a)},[l,a]);return[c,{over:o}]};const YK=KK;var JK=function(t,e){var n=x.useRef(function(){});x.useEffect(function(){n.current=t}),x.useEffect(function(){if(e!==null){var r=setInterval(function(){return n.current()},e||0);return function(){return clearInterval(r)}}},[e])};const XK=JK;var GT=function(t,e){return new URLSearchParams(t).get(e)},ZK=function(t){var e=window.location,n=x.useState(function(){return GT(e.search,t)}),r=n[0],s=n[1];return x.useEffect(function(){var i=function(){s(GT(e.search,t))};return u_(window,"popstate",i),u_(window,"pushstate",i),u_(window,"replacestate",i),function(){c_(window,"popstate",i),c_(window,"pushstate",i),c_(window,"replacestate",i)}},[]),r},eY=function(){return null};const tY=WK?ZK:eY;function gD({onChange:t,onChangeChecked:e,className:n,...r}){const s=x.useCallback(i=>{t==null||t(i),e==null||e(i.currentTarget.checked)},[t,e]);return u.jsx("input",{className:"mt-[0.3rem] mr-2 h-3.5 w-8 appearance-none rounded-[0.4375rem] bg-neutral-300 dark:bg-neutral-600 before:pointer-events-none before:absolute before:h-3.5 before:w-3.5 before:rounded-full before:bg-transparent before:content-[''] after:absolute after:z-[2] after:-mt-[0.1875rem] after:h-5 after:w-5 after:rounded-full after:border-none after:bg-neutral-100 dark:after:bg-neutral-400 after:shadow-[0_0px_3px_0_rgb(0_0_0_/_7%),_0_2px_2px_0_rgb(0_0_0_/_4%)] after:transition-[background-color_0.2s,transform_0.2s] after:content-[''] checked:bg-blue-600 dark:checked:bg-blue-600 checked:after:absolute checked:after:z-[2] checked:after:-mt-[3px] checked:after:ml-[1.0625rem] checked:after:h-5 checked:after:w-5 checked:after:rounded-full checked:after:border-none checked:after:bg-blue-600 dark:checked:after:bg-blue-600 checked:after:shadow-[0_3px_1px_-2px_rgba(0,0,0,0.2),_0_2px_2px_0_rgba(0,0,0,0.14),_0_1px_5px_0_rgba(0,0,0,0.12)] checked:after:transition-[background-color_0.2s,transform_0.2s] checked:after:content-[''] hover:cursor-pointer focus:before:scale-100 focus:before:opacity-[0.12] focus:before:shadow-[3px_-1px_0px_13px_rgba(0,0,0,0.6)] focus:before:transition-[box-shadow_0.2s,transform_0.2s] focus:after:absolute focus:after:z-[1] focus:after:block focus:after:h-5 focus:after:w-5 focus:after:rounded-full focus:after:content-[''] checked:focus:border-blue-600 checked:focus:bg-blue-600 checked:focus:before:ml-[1.0625rem] checked:focus:before:scale-100 checked:focus:before:shadow-[3px_-1px_0px_13px_#3b71ca] checked:focus:before:transition-[box-shadow_0.2s,transform_0.2s]",type:"checkbox",role:"switch",id:"flexSwitchCheckDefault",onChange:s,...r})}function Hy({han:t,fu:e,yakumanCount:n,raw:r,isManganRoundUp:s,...i}){const o=x.useMemo(()=>n&&n>0?n===1?"役滿":n===2?"兩倍役滿":n===3?"三倍役滿":n===4?"四倍役滿":`${n}倍役滿`:r?typeof e<"u"&&t<=4?`${t}飜${e}符`:`${t}飜`:t>=11?"三倍滿":t>=8?"倍滿":t>=6?"跳滿":t>=5||t>=4&&typeof e<"u"&&(e>=40||s&&e>=30)||t>=3&&typeof e<"u"&&(e>=70||s&&e>=60)?"滿貫":typeof e<"u"?`${t}飜${e}符`:`${t}飜`,[n,r,t,e,s]);return u.jsx("div",{...i,children:o})}const hf=({options:t,value:e,onChange:n,disabled:r})=>{const[s,i]=x.useState(0),o=x.useMemo(()=>t[s],[s,t]),a=x.useCallback(()=>{const c=Math.max(0,s-1);i(c),n==null||n(t[c].value)},[s,n,t]),l=x.useCallback(()=>{const c=Math.min(t.length-1,s+1);i(c),n==null||n(t[c].value)},[s,n,t]);return x.useEffect(()=>{if(typeof e<"u"&&e!==o.value){const c=t.findIndex(d=>d.value===e);c!==-1&&i(c)}},[o.value,t,e]),u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"shrink-0",children:u.jsx("button",{className:"w-4 h-4 text-center text-xs disabled:text-transparent",onClick:a,disabled:r||s===0,children:u.jsx("i",{className:"bi bi-dash-circle"})})}),u.jsx("div",{className:"flex-1 text-center text-2xl",children:o.label}),u.jsx("div",{className:"shrink-0",children:u.jsx("button",{className:"w-4 h-4 text-center text-xs disabled:text-transparent",onClick:l,disabled:r||s===t.length-1,children:u.jsx("i",{className:"bi bi-plus-circle"})})})]})},qa=[{id:"riichi",label:"立直",han:1,hanIfOpened:0,disableFn:({isRevealed:t,raw:e})=>!!t||e["double-riichi"],group:"riichi"},{id:"double-riichi",label:"雙立直",han:2,hanIfOpened:0,disableFn:({isRevealed:t,raw:e})=>!!t||e.riichi,group:"riichi"},{id:"ippatsu",label:"一發",han:1,hanIfOpened:0,disableFn:({raw:t})=>!(t.riichi||t["double-riichi"])||!!t.chankan,group:"riichi"},{id:"menzenchin-tsumohou",label:"門前清自摸和",han:1,hanIfOpened:0,hidden:!0,group:"menzenchin-tsumohou"},{id:"tanyao",label:"斷么九",han:1,hanIfOpened:1,disableFn:({raw:t})=>!!t.chantaiyao||!!t["junchan-taiyao"]||!!t["yakuhai-east"]||!!t["yakuhai-south"]||!!t["yakuhai-west"]||!!t["yakuhai-north"]||!!t["yakuhai-haku"]||!!t["yakuhai-hatsu"]||!!t["yakuhai-chun"]||!!t.honroutou||!!t.honitsu||!!t.ittsu,group:"common"},{id:"pinfu",label:"平和",han:1,hanIfOpened:0,disableFn:({isRevealed:t,raw:e})=>!!t||!!e.chiitoitsu||!!e["yakuhai-east"]||!!e["yakuhai-south"]||!!e["yakuhai-west"]||!!e["yakuhai-north"]||!!e["yakuhai-haku"]||!!e["yakuhai-hatsu"]||!!e["yakuhai-chun"]||!!e.toitoi,group:"common"},{id:"yakuhai-east",label:"東",han:1,hanIfOpened:1,disableFn:({round:t,activePlayerIndex:e,raw:n})=>!vr(e,t)&&!oD(t)||!!n.tanyao||!!n.pinfu||!!n.chiitoitsu||!!n.chinitsu||!!n["junchan-taiyao"]||!!n.ryanpeikou,group:"yakuhai"},{id:"yakuhai-double-east",label:"雙東",han:2,hanIfOpened:2,hidden:!0,group:"yakuhai-special"},{id:"yakuhai-south",label:"南",han:1,hanIfOpened:1,disableFn:({round:t,activePlayerIndex:e,raw:n})=>!CK(e,t)&&!aD(t)||!!n.tanyao||!!n.pinfu||!!n.chiitoitsu||!!n.chinitsu||!!n["junchan-taiyao"]||!!n.ryanpeikou,group:"yakuhai"},{id:"yakuhai-double-south",label:"雙南",han:2,hanIfOpened:2,hidden:!0,group:"yakuhai-special"},{id:"yakuhai-west",label:"西",han:1,hanIfOpened:1,disableFn:({round:t,activePlayerIndex:e,raw:n})=>!AK(e,t)&&!lD(t)||!!n.tanyao||!!n.pinfu||!!n.chiitoitsu||!!n.chinitsu||!!n["junchan-taiyao"]||!!n.ryanpeikou,group:"yakuhai"},{id:"yakuhai-double-west",label:"雙西",han:2,hanIfOpened:2,hidden:!0,group:"yakuhai-special"},{id:"yakuhai-north",label:"北",han:1,hanIfOpened:1,disableFn:({round:t,activePlayerIndex:e,raw:n})=>!TK(e,t)&&!uD(t)||!!n.tanyao||!!n.pinfu||!!n.chiitoitsu||!!n.chinitsu||!!n["junchan-taiyao"]||!!n.ryanpeikou,group:"yakuhai"},{id:"yakuhai-double-north",label:"雙北",han:2,hanIfOpened:2,hidden:!0,group:"yakuhai-special"},{id:"yakuhai-haku",label:"白",han:1,hanIfOpened:1,group:"yakuhai",disableFn:({raw:t})=>!!t.tanyao||!!t.pinfu||!!t.chiitoitsu||!!t.chinitsu||!!t["junchan-taiyao"]||!!t.ryanpeikou},{id:"yakuhai-hatsu",label:"發",han:1,hanIfOpened:1,group:"yakuhai",disableFn:({raw:t})=>!!t.tanyao||!!t.pinfu||!!t.chiitoitsu||!!t.chinitsu||!!t["junchan-taiyao"]||!!t.ryanpeikou},{id:"yakuhai-chun",label:"中",han:1,hanIfOpened:1,group:"yakuhai",disableFn:({raw:t})=>!!t.tanyao||!!t.pinfu||!!t.chiitoitsu||!!t.chinitsu||!!t["junchan-taiyao"]||!!t.ryanpeikou},{id:"shousangen",label:"小三元",han:2,hanIfOpened:2,disableFn:({raw:t})=>[t["yakuhai-haku"],t["yakuhai-hatsu"],t["yakuhai-chun"]].filter(e=>!!e).length!==2,group:"yakuhai"},{id:"haitei-raoyue",label:"海底撈月",han:1,hanIfOpened:1,disableFn:({targetPlayerIndex:t,raw:e})=>t!=="-1"||!!e["rinshan-kaihou"],hiddenIfDisabled:!0,group:"luck"},{id:"houtei-raoyui",label:"河底撈魚",han:1,hanIfOpened:1,disableFn:({targetPlayerIndex:t})=>t==="-1",hiddenIfDisabled:!0,group:"luck"},{id:"rinshan-kaihou",label:"嶺上開花",han:1,hanIfOpened:1,disableFn:({targetPlayerIndex:t,raw:e})=>t!=="-1"||!!e.pinfu||!!e.chiitoitsu||!!e.ryanpeikou||!!e["haitei-raoyue"],hiddenIfDisabled:!0,group:"luck"},{id:"chankan",label:"搶槓",han:1,hanIfOpened:1,disableFn:({targetPlayerIndex:t})=>t==="-1",hiddenIfDisabled:!0,group:"luck"},{id:"chiitoitsu",label:"七對子",han:2,hanIfOpened:0,overrideFu:25,disableFn:({isRevealed:t,raw:e})=>!!t||!!e.iipeikou||!!e.ryanpeikou||!!e.pinfu||!!e["sanshku-doujun"]||!!e.ittsu||!!e.chantaiyao||!!e["junchan-taiyao"]||!!e.toitoi||!!e["sanshku-doukou"]||!!e.sanankou||!!e.sankantsu||!!e["rinshan-kaihou"],group:"peikou"},{id:"iipeikou",label:"一盃口",han:1,hanIfOpened:0,disableFn:({isRevealed:t,raw:e})=>!!t||!!e.ryanpeikou||!!e.chiitoitsu||!!e.honroutou||!!e.toitoi||!!e["sanshku-doukou"]||!!e.sanankou||!!e.sankantsu,group:"peikou"},{id:"ryanpeikou",label:"二盃口",han:3,hanIfOpened:0,disableFn:({isRevealed:t,raw:e})=>!!t||!!e.iipeikou||!!e.chiitoitsu||!!e["rinshan-kaihou"]||!!e["sanshku-doujun"]||!!e.ittsu||!!e.honroutou||!!e.toitoi||!!e["sanshku-doukou"]||!!e.sanankou||!!e.sankantsu||!!e["yakuhai-east"]||!!e["yakuhai-south"]||!!e["yakuhai-west"]||!!e["yakuhai-north"]||!!e["yakuhai-haku"]||!!e["yakuhai-hatsu"]||!!e["yakuhai-chun"],group:"peikou"},{id:"sanshku-doujun",label:"三色同順",han:2,hanIfOpened:1,disableFn:({raw:t})=>!!t["sanshku-doukou"]||!!t.sanankou||!!t.chiitoitsu||!!t.ittsu||!!t.sankantsu||!!t.ryanpeikou||!!t.honroutou||!!t.chinitsu||!!t.honitsu||!!t.toitoi,group:"row"},{id:"ittsu",label:"一氣通貫",han:2,hanIfOpened:1,disableFn:({raw:t})=>!!t["sanshku-doukou"]||!!t.sanankou||!!t.chiitoitsu||!!t.tanyao||!!t["sanshku-doujun"]||!!t.sankantsu||!!t.ryanpeikou||!!t.honroutou||!!t.chantaiyao||!!t["junchan-taiyao"]||!!t.toitoi,group:"row"},{id:"honitsu",label:"混一色",han:3,hanIfOpened:2,disableFn:({raw:t})=>!!t.chinitsu||!!t.tanyao||!!t["junchan-taiyao"]||!!t["sanshku-doujun"]||!!t["sanshku-doukou"],group:"itsu"},{id:"chinitsu",label:"清一色",han:6,hanIfOpened:5,disableFn:({raw:t})=>!!t.honitsu||!!t.honroutou||!!t.chantaiyao||!!t["sanshku-doukou"],group:"itsu"},{id:"chantaiyao",label:"混全帶么九",han:2,hanIfOpened:1,disableFn:({raw:t})=>!!t.tanyao||!!t["junchan-taiyao"]||!!t.honroutou||!!t.chiitoitsu||!!t.chinitsu||!!t.ittsu||!!t.toitoi,group:"taiyao"},{id:"junchan-taiyao",label:"純全帶么九",han:3,hanIfOpened:2,disableFn:({raw:t})=>!!t.tanyao||!!t.chantaiyao||!!t.honroutou||!!t.chiitoitsu||!!t.ittsu||!!t.honitsu||!!t.toitoi,group:"taiyao"},{id:"honroutou",label:"混老頭",han:2,hanIfOpened:2,disableFn:({raw:t})=>!!t.tanyao||!!t.chantaiyao||!!t["junchan-taiyao"]||!!t.chinitsu||!!t.iipeikou||!!t.ryanpeikou,group:"taiyao"},{id:"toitoi",label:"對對和",han:2,hanIfOpened:2,disableFn:({raw:t})=>!!t["sanshku-doujun"]||!!t.chiitoitsu||!!t.chantaiyao||!!t["junchan-taiyao"]||!!t.ittsu||!!t.iipeikou||!!t.ryanpeikou,group:"column"},{id:"sanshku-doukou",label:"三色同刻",han:2,hanIfOpened:2,disableFn:({raw:t})=>!!t["sanshku-doujun"]||!!t.chiitoitsu||!!t.ittsu||!!t.chinitsu||!!t.iipeikou||!!t.ryanpeikou||!!t.honitsu,group:"column"},{id:"sanankou",label:"三暗刻",han:2,hanIfOpened:2,disableFn:({raw:t})=>!!t["sanshku-doujun"]||!!t.chiitoitsu||!!t.ittsu||!!t.iipeikou||!!t.ryanpeikou,group:"column"},{id:"sankantsu",label:"三槓子",han:2,hanIfOpened:2,disableFn:({raw:t})=>!!t["sanshku-doujun"]||!!t.chiitoitsu||!!t.ittsu||!!t.iipeikou||!!t.ryanpeikou,group:"column"},{id:"kokushi-musou",label:"國士無雙",han:13,hanIfOpened:0,yakumanCount:1,disableFn:({raw:t,isRevealed:e})=>!!e||!!t.suuankou||!!t["suuankou-dannki"]||!!t.daisangen||!!t.shousuushii||!!t.daisuushii||!!t.tsuuiisou||!!t.chinroutou||!!t.suukantsu||!!t.ryuuiisou||!!t["chuuren-poutou"]||!!t["pure-chuuren-poutou"]||!!t["kokushi-musou-jsuan-men"],group:"kokushi-musou"},{id:"kokushi-musou-jsuan-men",label:"國士無雙十三面",han:13,hanIfOpened:0,yakumanCount:1,disableFn:({raw:t,isRevealed:e})=>!!e||!!t.suuankou||!!t["suuankou-dannki"]||!!t.daisangen||!!t.shousuushii||!!t.daisuushii||!!t.tsuuiisou||!!t.chinroutou||!!t.suukantsu||!!t.ryuuiisou||!!t["chuuren-poutou"]||!!t["pure-chuuren-poutou"]||!!t["kokushi-musou"],group:"kokushi-musou"},{id:"daisangen",label:"大三元",han:13,hanIfOpened:13,yakumanCount:1,disableFn:({raw:t})=>!!t["kokushi-musou"]||!!t.shousuushii||!!t.daisuushii||!!t.chinroutou||!!t.ryuuiisou||!!t["chuuren-poutou"]||!!t["pure-chuuren-poutou"],group:"kan"},{id:"shousuushii",label:"小四喜",han:13,hanIfOpened:13,yakumanCount:1,disableFn:({raw:t})=>!!t["kokushi-musou"]||!!t.daisangen||!!t.daisuushii||!!t.chinroutou||!!t.ryuuiisou||!!t["chuuren-poutou"]||!!t["pure-chuuren-poutou"],group:"kan"},{id:"daisuushii",label:"大四喜",han:26,hanIfOpened:26,yakumanCount:1,disableFn:({raw:t})=>!!t["kokushi-musou"]||!!t.daisangen||!!t.shousuushii||!!t.chinroutou||!!t.ryuuiisou||!!t["chuuren-poutou"]||!!t["pure-chuuren-poutou"],group:"kan"},{id:"chinroutou",label:"清老頭",han:13,hanIfOpened:13,yakumanCount:1,disableFn:({raw:t})=>!!t["kokushi-musou"]||!!t.shousuushii||!!t.daisangen||!!t.daisuushii||!!t.ryuuiisou||!!t["chuuren-poutou"]||!!t["pure-chuuren-poutou"],group:"kan"},{id:"ryuuiisou",label:"綠一色",han:13,hanIfOpened:13,yakumanCount:1,disableFn:({raw:t})=>!!t["kokushi-musou"]||!!t.shousuushii||!!t.daisangen||!!t.daisuushii||!!t.chinroutou||!!t["chuuren-poutou"]||!!t["pure-chuuren-poutou"]||!!t.tsuuiisou,group:"ryuuiisou"},{id:"tsuuiisou",label:"字一色",han:13,hanIfOpened:13,yakumanCount:1,disableFn:({raw:t})=>!!t["kokushi-musou"]||!!t.chinroutou||!!t.ryuuiisou||!!t["chuuren-poutou"]||!!t["pure-chuuren-poutou"],group:"combo"},{id:"suuankou",label:"四暗刻",han:13,hanIfOpened:0,yakumanCount:1,disableFn:({isRevealed:t,raw:e})=>!!t||!!e["kokushi-musou"]||!!e["chuuren-poutou"]||!!e["pure-chuuren-poutou"]||!!e["suuankou-dannki"],group:"combo"},{id:"suuankou-dannki",label:"四暗刻單騎",han:13,hanIfOpened:0,yakumanCount:1,disableFn:({isRevealed:t,raw:e})=>!!t||!!e["kokushi-musou"]||!!e["chuuren-poutou"]||!!e["pure-chuuren-poutou"]||!!e.suuankou,group:"combo"},{id:"suukantsu",label:"四槓子",han:13,hanIfOpened:13,yakumanCount:1,disableFn:({raw:t})=>!!t["kokushi-musou"]||!!t["chuuren-poutou"]||!!t["pure-chuuren-poutou"]||!!t.tenhou||!!t.chiihou||!!t.ronhou,group:"combo"},{id:"chuuren-poutou",label:"九連寶燈",han:13,hanIfOpened:0,yakumanCount:1,disableFn:({isRevealed:t,raw:e})=>!!t||!!e["kokushi-musou"]||!!e.daisangen||!!e.shousuushii||!!e.daisuushii||!!e.chinroutou||!!e.ryuuiisou||!!e.tsuuiisou||!!e.suuankou||!!e["suuankou-dannki"]||!!e.suukantsu||!!e["pure-chuuren-poutou"],group:"chuuren-poutou"},{id:"pure-chuuren-poutou",label:"純正九連寶燈",han:13,hanIfOpened:0,yakumanCount:1,disableFn:({isRevealed:t,raw:e})=>!!t||!!e["kokushi-musou"]||!!e.daisangen||!!e.shousuushii||!!e.daisuushii||!!e.chinroutou||!!e.ryuuiisou||!!e.tsuuiisou||!!e.suuankou||!!e["suuankou-dannki"]||!!e.suukantsu||!!e["chuuren-poutou"],group:"chuuren-poutou"},{id:"tenhou",label:"天和",han:13,hanIfOpened:0,yakumanCount:1,disableFn:({isRevealed:t,round:e,activePlayerIndex:n,targetPlayerIndex:r,raw:s})=>!!t||!vr(n,e)||r!=="-1"||!!s.suukantsu,hiddenIfDisabled:!0,group:"hou"},{id:"chiihou",label:"地和",han:13,hanIfOpened:0,yakumanCount:1,disableFn:({isRevealed:t,round:e,activePlayerIndex:n,targetPlayerIndex:r,raw:s})=>!!t||!!vr(n,e)||r!=="-1"||!!s.suukantsu,hiddenIfDisabled:!0,group:"hou"},{id:"ronhou",label:"人和",han:13,hanIfOpened:0,yakumanCount:1,disableFn:({isRevealed:t,round:e,activePlayerIndex:n,targetPlayerIndex:r,raw:s})=>!!t||!!vr(n,e)||r==="-1"||!!s.suukantsu,hiddenIfDisabled:!0,group:"hou"}],QT=qa.filter(({yakumanCount:t,hidden:e})=>!t&&!e),nY=QT.map(t=>t.group).filter((t,e)=>QT.findIndex(({group:n})=>t===n)===e),KT=qa.filter(({yakumanCount:t,hidden:e})=>typeof t<"u"&&t>0&&!e),rY=KT.map(t=>t.group).filter((t,e)=>KT.findIndex(({group:n})=>t===n)===e),YT=[{label:"0",value:"0"},{label:"1",value:"1"},{label:"2",value:"2"},{label:"3",value:"3"},{label:"4",value:"4"},{label:"5",value:"5"},{label:"6",value:"6"},{label:"7",value:"7"},{label:"8",value:"8"},{label:"9",value:"9"},{label:"10",value:"10"},{label:"11",value:"11"},{label:"12",value:"12"},{label:"13",value:"13"},{label:"14",value:"14"},{label:"15",value:"15"},{label:"16",value:"16"},{label:"17",value:"17"},{label:"18",value:"18"}],sY=[{label:"0",value:"0"},{label:"1",value:"1"},{label:"2",value:"2"},{label:"3",value:"3"}],iY=[{label:"30符",value:"30"},{label:"40符",value:"40"},{label:"50符",value:"50"},{label:"60符",value:"60"},{label:"70符",value:"70"},{label:"80符",value:"80"},{label:"90符",value:"90"},{label:"100符",value:"100"},{label:"110符",value:"110"},{label:"20符",value:"20"},{label:"25符",value:"25"}],JT=({yaku:t,active:e,isRevealed:n,disabled:r,onClick:s,hiddenIfDisabled:i})=>r&&i?u.jsx(u.Fragment,{}):u.jsx("button",{"data-id":t.id,"data-han":n?t.hanIfOpened:t.han,"data-active":e?"1":"0",disabled:r,className:"text-xl text-center px-3 border border-neutral-300 text-neutral-800 cursor-pointer hover:opacity-80 data-[han='0']:cursor-not-allowed disabled:opacity-20 disabled:hover:opacity-20 data-[active='1']:enabled:border-teal-800 data-[active='1']:enabled:text-white data-[active='1']:enabled:bg-teal-800 disabled:cursor-not-allowed",onClick:s,children:t.label},t.id),vD=({round:t,activePlayerIndex:e,targetPlayerIndex:n,onChange:r,value:s})=>{const[i,o]=x.useState({}),[a,l]=vi(!1),[c,d]=vi(!1),[h,f]=x.useState("0"),[p,y]=x.useState("0"),[v,_]=x.useState("0"),[g,m]=x.useState("30"),w=x.useCallback(I=>{const k=I.currentTarget.getAttribute("data-id");!k||!qa.find(({id:L})=>L===k)||o(L=>({...L,[k]:!L[k]}))},[]),E=x.useCallback(()=>{o({}),l(!1),f("0"),y("0"),_("0"),m("30")},[l]),T=x.useMemo(()=>({activePlayerIndex:e,targetPlayerIndex:n,round:t,isRevealed:a,raw:i}),[e,a,t,n,i]),C=x.useMemo(()=>{let I=parseInt(g),k=!1;const O=[],L={...i};n==="-1"&&!a&&(L["menzenchin-tsumohou"]=!0),L["yakuhai-east"]&&oD(t)?(L["yakuhai-east"]=!1,L["yakuhai-double-east"]=!0):L["yakuhai-south"]&&aD(t)?(L["yakuhai-south"]=!1,L["yakuhai-double-south"]=!0):L["yakuhai-west"]&&lD(t)?(L["yakuhai-west"]=!1,L["yakuhai-double-west"]=!0):L["yakuhai-north"]&&uD(t)&&(L["yakuhai-north"]=!1,L["yakuhai-double-north"]=!0),L["yakuhai-haku"]&&L["yakuhai-hatsu"]&&L["yakuhai-chun"]&&(L.daisangen=!0);const j=qa.filter(({id:D,disableFn:te})=>!!L[D]&&!(te!=null&&te(T))),P=j.filter(({yakumanCount:D})=>typeof D<"u"&&D>0);if(P.length>0)for(const D of P)D.yakumanCount&&D.yakumanCount>0&&O.push({id:D.id,label:D.label,han:0,yakumanCount:D.yakumanCount});else if(j.length>0){for(const D of j){const te=a?D.hanIfOpened:D.han;te!==0&&O.push({id:D.id,label:D.label,han:te,yakumanCount:0})}O.findIndex(({id:D})=>D==="chiitoitsu")!==-1?(k=!0,I=25):O.findIndex(({id:D})=>D==="pinfu")!==-1&&(k=!0,I=n==="-1"?20:30),h!=="0"&&O.push({id:`dora-${h}`,label:`寶牌${h}`,han:parseInt(h),yakumanCount:0}),p!=="0"&&O.push({id:`dora-${p}`,label:`赤寶牌${p}`,han:parseInt(p),yakumanCount:0}),v!=="0"&&O.push({id:`dora-${v}`,label:`赤寶牌${v}`,han:parseInt(v),yakumanCount:0})}return{han:O.reduce((D,{han:te})=>D+te,0),fu:I,yakumanCount:O.reduce((D,{yakumanCount:te})=>D+te,0),yakus:O,isFuOverrided:k,raw:i,dora:parseInt(h),redDora:parseInt(p),innerDora:parseInt(v),isRevealed:a,isRiichied:!!i.riichi}},[g,i,n,a,t,h,p,v,T]);return x.useEffect(()=>{r&&r(C)},[C,r]),x.useEffect(()=>{s&&(o(s.raw??{}),f(s.dora.toString()),y(s.redDora.toString()),_("0"),l(s.isRevealed))},[l,s]),u.jsxs("div",{children:[u.jsxs("div",{className:"flex justify-between mb-2",children:[u.jsxs("div",{children:[u.jsx(gD,{checked:a,onChangeChecked:l})," ","有副露？"]}),u.jsxs("div",{className:"space-x-4",children:[u.jsx("button",{className:"text-sm text-teal-700 underline",onClick:d,children:c?"一般役":"役滿役"}),u.jsx("button",{className:"text-sm text-teal-700 underline",onClick:E,children:"重置"})]})]}),!c&&u.jsxs("div",{children:[u.jsx("div",{className:"flex flex-wrap gap-y-4 gap-x-8",children:nY.map(I=>u.jsx("div",{className:"flex flex-wrap gap-2",children:qa.filter(({group:k})=>k===I).map(k=>{var O;return u.jsx(JT,{yaku:k,isRevealed:a,active:i[k.id],disabled:(O=k.disableFn)==null?void 0:O.call(k,T),hiddenIfDisabled:k.hiddenIfDisabled,onClick:w,children:k.label},k.id)})},I))}),u.jsx("table",{className:"w-full mt-2",children:u.jsx("tbody",{children:u.jsxs("tr",{children:[u.jsx("th",{className:"w-20 bg-yellow-400 px-1 border-yellow-100 border-t border-b",children:"寶牌"}),u.jsx("td",{className:"w-36 py-1 px-2 bg-yellow-200 data-[active='1']:text-red-600","data-active":h!=="0"?"1":"0",children:u.jsx(hf,{value:h,onChange:f,options:YT})}),u.jsx("td",{className:"w-2"}),u.jsx("th",{className:"w-20 bg-red-400 px-1 border-neutral-100 border-t border-b",children:"赤寶牌"}),u.jsx("td",{className:"w-36 py-1 px-2 bg-red-200 data-[active='1']:text-red-600","data-active":p!=="0"?"1":"0",children:u.jsx(hf,{value:p,onChange:y,options:sY})}),u.jsx("td",{className:"w-2"}),u.jsx("th",{className:"w-20 bg-blue-400 px-1 border-neutral-100 border-t border-b",children:"裡寶牌"}),u.jsx("td",{className:"w-36 py-1 px-2 bg-blue-200 data-[active='1']:text-red-600","data-active":v!=="0"?"1":"0",children:u.jsx(hf,{value:v,onChange:_,options:YT})}),u.jsx("td",{className:"w-2"}),u.jsx("th",{className:"w-20 bg-neutral-400 px-1 border-neutral-100 border-t border-b",children:"符數"}),u.jsx("td",{className:"w-36 py-1 px-2 bg-neutral-200",children:u.jsx(hf,{value:C.isFuOverrided?C.fu.toString():g,onChange:m,options:iY,disabled:C.isFuOverrided})})]})})})]}),c&&u.jsx("div",{className:"flex flex-wrap gap-y-4 gap-x-8",children:rY.map(I=>u.jsx("div",{className:"flex flex-wrap gap-2",children:qa.filter(({group:k})=>k===I).map(k=>{var O;return u.jsx(JT,{yaku:k,isRevealed:a,active:i[k.id],disabled:(O=k.disableFn)==null?void 0:O.call(k,T),hiddenIfDisabled:k.hiddenIfDisabled,onClick:w,children:k.label},k.id)})},I))})]})},oY=({result:t,matchSetting:e})=>{var n;return u.jsx("div",{children:u.jsx("table",{className:"w-full mt-2 bg-teal-100",children:u.jsx("tbody",{children:u.jsxs("tr",{children:[u.jsx("th",{className:"w-16 bg-teal-400 py-2 px-1",children:"結算"}),u.jsx("td",{className:"flex flex-wrap gap-2 p-2 align-middle",children:(n=t.yakus)==null?void 0:n.map(({label:r})=>u.jsx("span",{children:r},r))}),u.jsxs("td",{className:"w-32 bg-teal-400 text-center",children:[u.jsx(Hy,{han:t.han,fu:t.fu,yakumanCount:t.yakumanCount,isManganRoundUp:e.isManganRoundUp==="1"}),u.jsx(Hy,{className:"text-xs text-neutral-600",han:t.han,fu:t.fu,yakumanCount:t.yakumanCount,isManganRoundUp:e.isManganRoundUp==="1",raw:!0})]})]})})})})},aY=({onSubmit:t,defaultValue:e,open:n,onClose:r,...s})=>{const[i,o]=x.useState(),a=x.useCallback(()=>{i&&t(i)},[t,i]);return x.useEffect(()=>{o(e)},[e]),u.jsxs(nr,{open:n,onClose:r,children:[u.jsx(vD,{...s,onChange:o,value:e}),u.jsx("div",{className:"mt-4",children:u.jsx(ke,{className:"w-full",onClick:a,children:"儲存"})})]})};function pn({children:t,label:e,action:n,...r}){return u.jsx("div",{...r,children:u.jsxs("label",{children:[u.jsxs("div",{className:"flex items-center justify-between mb-1",children:[u.jsx("p",{className:"text-sm text-gray-800 font-bold",children:e}),u.jsx("div",{children:n})]}),u.jsx("div",{children:t})]})})}function lY({match:t,currentMatchRound:e,initialActivePlayerIndex:n="0",initialTargetPlayerIndex:r="-1",onSubmit:s,...i}){const[o,a]=x.useState({han:1,fu:30,yakumanCount:0,dora:0,redDora:0,innerDora:0,yakus:[],raw:{},isRevealed:!1,isRiichied:!1}),l=x.useMemo(()=>Object.keys(t.players).map(P=>({index:P.toString(),name:t.players[P].name,position:$i(P,e.roundCount)})),[t.players,e.roundCount]),[c,d]=x.useState(n??"0"),h=x.useMemo(()=>typeof c<"u"?l==null?void 0:l.find(({index:j})=>j===c):void 0,[c,l]),[f,p]=x.useState(r),y=x.useMemo(()=>{const j=BT(o.han,o.fu,o.yakumanCount,(h==null?void 0:h.position)===An.East,f!=="-1",{roundUp:t.setting.isManganRoundUp==="1"});return e.extendedRoundCount>0&&(j.win+=e.extendedRoundCount*300,j.target&&(j.target+=e.extendedRoundCount*300),j.all&&(j.all+=e.extendedRoundCount*100),j.east&&(j.east+=e.extendedRoundCount*100),j.others&&(j.others+=e.extendedRoundCount*100)),e.cumulatedThousands>0&&(j.win+=e.cumulatedThousands*1e3),j},[o.han,o.fu,o.yakumanCount,h==null?void 0:h.position,f,t.setting.isManganRoundUp,e.extendedRoundCount,e.cumulatedThousands]),v=x.useMemo(()=>u.jsxs("div",{children:[u.jsx(_r,{roundCount:e.roundCount,extendedRoundCount:e.extendedRoundCount,max:8}),u.jsx("span",{children:" 和了"})]}),[e.roundCount,e.extendedRoundCount]),_=x.useMemo(()=>o.isRevealed&&o.yakus&&o.yakus.findIndex(({id:j})=>j==="daisangen")!==-1,[o.isRevealed,o.yakus]),[g,m]=x.useState("-1"),w=x.useMemo(()=>o.isRevealed&&o.yakus&&o.yakus.findIndex(({id:j})=>j==="daisuushii")!==-1,[o.isRevealed,o.yakus]),[E,T]=x.useState("-1"),C=x.useMemo(()=>o.isRevealed&&o.yakus&&o.yakus.findIndex(({id:j})=>j==="suukantsu")!==-1,[o.isRevealed,o.yakus]),[I,k]=x.useState("-1"),O=x.useMemo(()=>{const j=Object.keys(e.playerResults),P={0:{...e.playerResults[0],beforeScore:e.playerResults[0].beforeScore,afterScore:e.playerResults[0].beforeScore,type:0,scoreChanges:[],prevScoreChanges:e.playerResults[0].scoreChanges??[]},1:{...e.playerResults[1],beforeScore:e.playerResults[1].beforeScore,afterScore:e.playerResults[1].beforeScore,type:0,scoreChanges:[],prevScoreChanges:e.playerResults[1].scoreChanges??[]},2:{...e.playerResults[2],beforeScore:e.playerResults[2].beforeScore,afterScore:e.playerResults[2].beforeScore,type:0,scoreChanges:[],prevScoreChanges:e.playerResults[2].scoreChanges??[]},3:{...e.playerResults[3],beforeScore:e.playerResults[3].beforeScore,afterScore:e.playerResults[3].beforeScore,type:0,scoreChanges:[],prevScoreChanges:e.playerResults[3].scoreChanges??[]}};if(c===f)return P;for(let te=0;te<j.length;te+=1){const G=j[te];G===c?(P[G].afterScore+=y.win,P[G].type=ut.Win,P[G].scoreChanges=[y.win]):y.target&&G===f?(P[G].afterScore-=y.target,P[G].type=ut.Lose,P[G].scoreChanges=[-y.target]):y.all?(P[G].afterScore-=y.all,P[G].type=ut.Lose,P[G].scoreChanges=[-y.all]):y.east&&y.others&&(vr(G,e.roundCount)?(P[G].afterScore-=y.east,P[G].type=ut.Lose,P[G].scoreChanges=[-y.east]):(P[G].afterScore-=y.others,P[G].type=ut.Lose,P[G].scoreChanges=[-y.others]))}[{bool:_,triggeredPlayerIndex:g,yakuId:"daisangen"},{bool:w,triggeredPlayerIndex:E,yakuId:"daisuushii"},{bool:C,triggeredPlayerIndex:I,yakuId:"suukantsu"}].forEach(({bool:te,triggeredPlayerIndex:G,yakuId:Ge})=>{var ct;if(te&&G!=="-1"&&G!==c&&G!==f){const z=(ct=o.yakus)==null?void 0:ct.find(({id:Z})=>Ge===Z);if(z){const Z=BT(1,30,z.yakumanCount,vr(c,e.roundCount),f!=="-1");if(Z.target){const K=Math.round(Z.target/2);P[f].afterScore+=K,P[f].scoreChanges[0]+=K,P[f].scoreChanges[0]===0&&P[f].scoreChanges.splice(0,1),P[G].afterScore-=K,typeof P[G].scoreChanges[0]>"u"?P[G].scoreChanges.push(-K):P[G].scoreChanges[0]-=K}else if(Z.all)for(let K=0;K<j.length;K+=1){const de=Z.all;j[K]!==c&&j[K]!==G&&(P[j[K]].afterScore+=de,P[j[K]].scoreChanges[0]+=de,P[j[K]].scoreChanges[0]===0&&P[j[K]].scoreChanges.splice(0,1),P[G].afterScore-=de,typeof P[G].scoreChanges[0]>"u"?P[G].scoreChanges.push(-de):P[G].scoreChanges[0]-=de)}else if(Z.east&&Z.others){for(let K=0;K<j.length;K+=1)if(j[K]!==c&&j[K]!==G){const de=vr(j[K],e.roundCount)?Z.east:Z.others;P[j[K]].afterScore+=de,P[j[K]].scoreChanges[0]+=de,P[j[K]].scoreChanges[0]===0&&P[j[K]].scoreChanges.splice(0,1),P[G].afterScore-=de,typeof P[G].scoreChanges[0]>"u"?P[G].scoreChanges.push(-de):P[G].scoreChanges[0]-=de}}}}},[]);let D=0;for(let te=0;te<j.length;te+=1){const G=j[te];G!==c&&P[G].isRiichi&&(P[G].afterScore-=1e3,P[G].scoreChanges.unshift(-1e3),D+=1e3)}return c&&D>0&&(P[c].afterScore+=D,P[c].scoreChanges.unshift(D)),P[c].detail=o,P},[c,y.all,y.east,y.others,y.target,y.win,e.playerResults,e.roundCount,_,w,C,f,o,g,E,I]),L=x.useCallback(()=>{if(!s||!o)return;const j={...e,resultType:RK(y),playerResults:O,nextRoundCumulatedThousands:0,resultDetail:{winnerPlayerIndex:c,...o,yakus:o.yakus??[]}};s(j)},[c,y,e,s,O,o]);return x.useEffect(()=>{i.open&&(d(n),p(r),a(e.playerResults[n].detail))},[e.playerResults,i.open,n,r]),u.jsx(nr,{title:v,...i,children:u.jsxs("div",{className:"space-y-8",children:[u.jsxs("div",{className:"flex gap-x-4 items-center",children:[u.jsx("div",{className:"flex-1",children:u.jsx(cs,{value:c,onChangeValue:d,children:l.map(({index:j,name:P})=>u.jsx("option",{value:j,children:P},j))})}),u.jsx("div",{className:"text-xs text-gray-500",children:"和了"}),u.jsx("div",{className:"flex-1",children:u.jsxs(cs,{value:f,onChangeValue:p,children:[u.jsx("option",{value:"-1",children:"自摸"}),l.map(({index:j,name:P})=>u.jsx("option",{value:j,children:P},j))]})})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("h5",{className:"font-bold",children:"役種"}),u.jsxs("div",{children:[u.jsx(vD,{round:e.roundCount,activePlayerIndex:c,targetPlayerIndex:f,onChange:a,value:e.playerResults[c].detail}),u.jsx(oY,{result:o,matchSetting:t.setting}),u.jsx("div",{className:"text-3xl font-bold text-center bg-teal-400 py-2",children:u.jsx(BK,{score:y})})]})]}),(_||w||C)&&u.jsxs("div",{className:"space-y-2 bg-yellow-200 p-4",children:[u.jsx("h5",{className:"font-bold",children:"包牌"}),u.jsxs("p",{children:["當某家打出的牌被鳴牌後，導致役滿確定時（大三元、大四喜、四槓子），便會觸發「包牌」。",u.jsx("br",{}),"- 如自摸，包牌者需支付該役種全部點數",u.jsx("br",{}),"- 如他家放銃，包牌者需支付該役種一半點數"]}),u.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[_&&u.jsx(pn,{label:"大三元包牌者",children:u.jsxs(cs,{value:g,onChangeValue:m,children:[u.jsx("option",{value:"-1",children:"沒有包牌"}),l.map(({index:j,name:P})=>u.jsx("option",{value:j,children:P},j))]})}),w&&u.jsx(pn,{label:"大四喜包牌者",children:u.jsxs(cs,{value:E,onChangeValue:T,children:[u.jsx("option",{value:"-1",children:"沒有包牌"}),l.map(({index:j,name:P})=>u.jsx("option",{value:j,children:P},j))]})}),C&&u.jsx(pn,{label:"四槓子包牌者",children:u.jsxs(cs,{value:I,onChangeValue:k,children:[u.jsx("option",{value:"-1",children:"沒有包牌"}),l.map(({index:j,name:P})=>u.jsx("option",{value:j,children:P},j))]})})]})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("h5",{className:"font-bold",children:"分數變動"}),u.jsxs("table",{className:"data-table w-full text-lg",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"玩家"}),u.jsx("th",{children:"目前分數"}),u.jsx("th",{children:"變動"}),u.jsx("th",{children:"最新分數"})]})}),u.jsx("tbody",{children:Object.keys(t.players).map(j=>u.jsxs("tr",{children:[u.jsx("th",{className:"text-white py-1",style:{background:t.players[j].color},children:t.players[j].name}),u.jsx("td",{className:"px-2 text-center w-32",children:O[j].beforeScore}),u.jsx("td",{className:"text-center w-32",children:u.jsx(En,{signed:!0,value:O[j].afterScore-O[j].beforeScore,positiveClassName:"text-green-400",negativeClassName:"text-red-400"})}),u.jsx("td",{className:"text-center w-32",children:O[j].afterScore})]},j))})]})]}),u.jsx("div",{className:"space-y-2",children:u.jsxs(ke,{onClick:L,className:"w-full",disabled:!(o!=null&&o.yakus)||o.yakus.length<=0,children:[u.jsx("i",{className:"bi bi-camera-reels-fill"})," 提交並播出分數變動動畫"]})})]})})}const uY=[["1m","2m","3m","4m","5m","6m","7m","8m","9m","0m"],["1p","2p","3p","4p","5p","6p","7p","8p","9p","0p"],["1s","2s","3s","4s","5s","6s","7s","8s","9s","0s"],["1z","2z","3z","4z","5z","6z","7z"]],XT={m:0,p:1,s:2,z:3},cY=(t,e)=>{const[n,r]=[t[0],t[1]],[s,i]=[e[0],e[1]];return r!==i?XT[r]-XT[i]:parseInt(n,10)-parseInt(s,10)};function ZT({onSubmit:t,onRemove:e,canRemove:n,hideRedTiles:r,multiple:s,defaultValue:i}){const[o,a]=x.useState([]),l=x.useCallback(h=>{var p;const f=(p=h.currentTarget)==null?void 0:p.getAttribute("data-key");f&&a(s?y=>{const v=y.indexOf(f);if(v===-1)return[...y,f].sort(cY);const _=[...y];return _.splice(v,1),_}:[f])},[s]),c=x.useCallback(()=>{o&&t&&(t==null||t(o),a([]))},[t,o]),d=x.useCallback(()=>{n&&(e==null||e(),a([]))},[n,e]);return x.useEffect(()=>{a(i??[])},[i]),u.jsxs("div",{children:[u.jsx("div",{className:`mb-4 grid ${r?"grid-cols-9":"grid-cols-10"} gap-1 lg:gap-x-2 lg:gap-y-4 items-center text-center`,children:uY.map(h=>h.map(f=>(!f.startsWith("0")||!r)&&u.jsx("button",{type:"button",onClick:l,"data-key":f,className:`${o.indexOf(f)!==-1?"bg-blue-400":"bg-black bg-opacity-20"} rounded p-1 lg:p-2`,children:u.jsx(Ur,{children:f})})))}),u.jsxs("div",{className:"flex gap-x-4",children:[n&&u.jsx("div",{className:"flex-1",children:u.jsx(ke,{className:"w-full",type:"button",color:"secondary",onClick:d,children:"移除"})}),u.jsx("div",{className:"flex-1",children:u.jsx(ke,{className:"w-full",type:"button",color:"primary",onClick:c,disabled:o.length===0,children:"確定"})})]})]})}function dY({match:t,currentMatchRound:e,onSubmit:n,...r}){x.useMemo(()=>Object.keys(t.players).map(h=>({index:h.toString(),name:t.players[h].name,position:$i(h,e.roundCount)})),[t.players,e.roundCount]);const[s,i]=x.useState({0:!1,1:!1,2:!1,3:!1}),o=x.useCallback(d=>{var p,y;const h=(p=d.currentTarget)==null?void 0:p.checked,f=(y=d.currentTarget)==null?void 0:y.getAttribute("data-player-index");typeof h>"u"||!f||i(v=>({...v,[f]:h}))},[]),a=x.useMemo(()=>u.jsxs("div",{children:[u.jsx(_r,{roundCount:e.roundCount,extendedRoundCount:e.extendedRoundCount,max:8}),u.jsx("span",{children:" 流局"})]}),[e.roundCount,e.extendedRoundCount]),l=x.useMemo(()=>{const d=Object.keys(e.playerResults),h={0:{...e.playerResults[0],beforeScore:e.playerResults[0].beforeScore,afterScore:e.playerResults[0].beforeScore,type:0,scoreChanges:[],prevScoreChanges:e.playerResults[0].prevScoreChanges??[]},1:{...e.playerResults[1],beforeScore:e.playerResults[1].beforeScore,afterScore:e.playerResults[1].beforeScore,type:0,scoreChanges:[],prevScoreChanges:e.playerResults[1].prevScoreChanges??[]},2:{...e.playerResults[2],beforeScore:e.playerResults[2].beforeScore,afterScore:e.playerResults[2].beforeScore,type:0,scoreChanges:[],prevScoreChanges:e.playerResults[2].prevScoreChanges??[]},3:{...e.playerResults[3],beforeScore:e.playerResults[3].beforeScore,afterScore:e.playerResults[3].beforeScore,type:0,scoreChanges:[],prevScoreChanges:e.playerResults[3].prevScoreChanges??[]}};let f=0,p=0;const y=Object.values(s).filter(v=>!!v).length;y===1?(f=3e3,p=1e3):y===2?(f=1500,p=1500):y===3&&(f=1e3,p=3e3);for(let v=0;v<d.length;v+=1){const _=d[v];f&&p&&(s[_]?(h[_].afterScore+=f,h[_].type=ut.Win,h[_].scoreChanges=[f]):(h[_].afterScore-=p,h[_].type=ut.Lose,h[_].scoreChanges=[-p])),h[_].isRiichi&&(h[_].afterScore-=1e3,h[_].scoreChanges.unshift(-1e3))}return h},[e.playerResults,s]),c=x.useCallback(()=>{if(!n)return;const d={...e,resultType:rt.Exhausted,playerResults:l,nextRoundCumulatedThousands:e.cumulatedThousands+Object.values(l).filter(({isRiichi:h})=>!!h).length};n(d)},[e,n,l]);return x.useEffect(()=>{var d,h,f,p;r.open&&i({0:!!e.playerResults[0].waitingTiles&&((d=e.playerResults[0].waitingTiles)==null?void 0:d.length)>0,1:!!e.playerResults[1].waitingTiles&&((h=e.playerResults[1].waitingTiles)==null?void 0:h.length)>0,2:!!e.playerResults[2].waitingTiles&&((f=e.playerResults[2].waitingTiles)==null?void 0:f.length)>0,3:!!e.playerResults[3].waitingTiles&&((p=e.playerResults[3].waitingTiles)==null?void 0:p.length)>0})},[e.playerResults,r.open]),u.jsx(nr,{title:a,...r,children:u.jsxs("div",{className:"space-y-8",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx("h5",{className:"font-bold",children:"分數變動"}),u.jsxs("table",{className:"data-table w-full text-lg",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"玩家"}),u.jsx("th",{className:"!bg-yellow-200",children:"聽牌？"}),u.jsx("th",{className:"w-32",children:"目前分數"}),u.jsx("th",{className:"w-32",children:"變動"}),u.jsx("th",{className:"w-32",children:"最新分數"})]})}),u.jsx("tbody",{children:Object.keys(t.players).map(d=>u.jsxs("tr",{children:[u.jsx("th",{className:"text-white py-1",style:{background:t.players[d].color},children:t.players[d].name}),u.jsx("td",{className:"text-center !bg-yellow-200",children:u.jsx(gD,{checked:s[d],onChange:o,"data-player-index":d})}),u.jsx("td",{className:"text-center",children:l[d].beforeScore}),u.jsx("td",{className:"text-center",children:u.jsx(En,{signed:!0,value:l[d].afterScore-l[d].beforeScore,positiveClassName:"text-green-400",negativeClassName:"text-red-400"})}),u.jsx("td",{className:"text-center",children:l[d].afterScore})]},d))})]})]}),u.jsx("div",{className:"space-y-2",children:u.jsxs(ke,{onClick:c,className:"w-full",children:[u.jsx("i",{className:"bi bi-camera-reels-fill"})," 提交並播出分數變動動畫"]})})]})})}var mh=t=>t.type==="checkbox",Ha=t=>t instanceof Date,fn=t=>t==null;const _D=t=>typeof t=="object";var bt=t=>!fn(t)&&!Array.isArray(t)&&_D(t)&&!Ha(t),xD=t=>bt(t)&&t.target?mh(t.target)?t.target.checked:t.target.value:t,hY=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,wD=(t,e)=>t.has(hY(e)),fY=t=>{const e=t.constructor&&t.constructor.prototype;return bt(e)&&e.hasOwnProperty("isPrototypeOf")},bE=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function dr(t){let e;const n=Array.isArray(t);if(t instanceof Date)e=new Date(t);else if(t instanceof Set)e=new Set(t);else if(!(bE&&(t instanceof Blob||t instanceof FileList))&&(n||bt(t)))if(e=n?[]:{},!n&&!fY(t))e=t;else for(const r in t)t.hasOwnProperty(r)&&(e[r]=dr(t[r]));else return t;return e}var gh=t=>Array.isArray(t)?t.filter(Boolean):[],tt=t=>t===void 0,Q=(t,e,n)=>{if(!e||!bt(t))return n;const r=gh(e.split(/[,[\].]+?/)).reduce((s,i)=>fn(s)?s:s[i],t);return tt(r)||r===t?tt(t[e])?n:t[e]:r},Mr=t=>typeof t=="boolean";const Gy={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},mr={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},os={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},pY=me.createContext(null),SE=()=>me.useContext(pY);var ED=(t,e,n,r=!0)=>{const s={defaultValues:e._defaultValues};for(const i in t)Object.defineProperty(s,i,{get:()=>{const o=i;return e._proxyFormState[o]!==mr.all&&(e._proxyFormState[o]=!r||mr.all),n&&(n[o]=!0),t[o]}});return s},Qn=t=>bt(t)&&!Object.keys(t).length,bD=(t,e,n,r)=>{n(t);const{name:s,...i}=t;return Qn(i)||Object.keys(i).length>=Object.keys(e).length||Object.keys(i).find(o=>e[o]===(!r||mr.all))},up=t=>Array.isArray(t)?t:[t],SD=(t,e,n)=>!t||!e||t===e||up(t).some(r=>r&&(n?r===e:r.startsWith(e)||e.startsWith(r)));function CE(t){const e=me.useRef(t);e.current=t,me.useEffect(()=>{const n=!t.disabled&&e.current.subject&&e.current.subject.subscribe({next:e.current.next});return()=>{n&&n.unsubscribe()}},[t.disabled])}function yY(t){const e=SE(),{control:n=e.control,disabled:r,name:s,exact:i}=t||{},[o,a]=me.useState(n._formState),l=me.useRef(!0),c=me.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1}),d=me.useRef(s);return d.current=s,CE({disabled:r,next:h=>l.current&&SD(d.current,h.name,i)&&bD(h,c.current,n._updateFormState)&&a({...n._formState,...h}),subject:n._subjects.state}),me.useEffect(()=>(l.current=!0,c.current.isValid&&n._updateValid(!0),()=>{l.current=!1}),[n]),ED(o,n,c.current,!1)}var Br=t=>typeof t=="string",CD=(t,e,n,r,s)=>Br(t)?(r&&e.watch.add(t),Q(n,t,s)):Array.isArray(t)?t.map(i=>(r&&e.watch.add(i),Q(n,i))):(r&&(e.watchAll=!0),n);function rg(t){const e=SE(),{control:n=e.control,name:r,defaultValue:s,disabled:i,exact:o}=t||{},a=me.useRef(r);a.current=r,CE({disabled:i,subject:n._subjects.values,next:d=>{SD(a.current,d.name,o)&&c(dr(CD(a.current,n._names,d.values||n._formValues,!1,s)))}});const[l,c]=me.useState(n._getWatch(r,s));return me.useEffect(()=>n._removeUnmounted()),l}var AE=t=>/^\w*$/.test(t),AD=t=>gh(t.replace(/["|']|\]/g,"").split(/\.|\[/));function Fe(t,e,n){let r=-1;const s=AE(e)?[e]:AD(e),i=s.length,o=i-1;for(;++r<i;){const a=s[r];let l=n;if(r!==o){const c=t[a];l=bt(c)||Array.isArray(c)?c:isNaN(+s[r+1])?{}:[]}t[a]=l,t=t[a]}return t}function mY(t){const e=SE(),{name:n,disabled:r,control:s=e.control,shouldUnregister:i}=t,o=wD(s._names.array,n),a=rg({control:s,name:n,defaultValue:Q(s._formValues,n,Q(s._defaultValues,n,t.defaultValue)),exact:!0}),l=yY({control:s,name:n}),c=me.useRef(s.register(n,{...t.rules,value:a}));return c.current=s.register(n,t.rules),me.useEffect(()=>{const d=s._options.shouldUnregister||i,h=(f,p)=>{const y=Q(s._fields,f);y&&(y._f.mount=p)};if(h(n,!0),d){const f=dr(Q(s._options.defaultValues,n));Fe(s._defaultValues,n,f),tt(Q(s._formValues,n))&&Fe(s._formValues,n,f)}return()=>{(o?d&&!s._state.action:d)?s.unregister(n):h(n,!1)}},[n,s,o,i]),me.useEffect(()=>{Q(s._fields,n)&&s._updateDisabledField({disabled:r,fields:s._fields,name:n,value:Q(s._fields,n)._f.value})},[r,n,s]),{field:{name:n,value:a,...Mr(r)||Mr(l.disabled)?{disabled:l.disabled||r}:{},onChange:me.useCallback(d=>c.current.onChange({target:{value:xD(d),name:n},type:Gy.CHANGE}),[n]),onBlur:me.useCallback(()=>c.current.onBlur({target:{value:Q(s._formValues,n),name:n},type:Gy.BLUR}),[n,s]),ref:d=>{const h=Q(s._fields,n);h&&d&&(h._f.ref={focus:()=>d.focus(),select:()=>d.select(),setCustomValidity:f=>d.setCustomValidity(f),reportValidity:()=>d.reportValidity()})}},formState:l,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!Q(l.errors,n)},isDirty:{enumerable:!0,get:()=>!!Q(l.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!Q(l.touchedFields,n)},error:{enumerable:!0,get:()=>Q(l.errors,n)}})}}const Sn=t=>t.render(mY(t));var gY=(t,e,n,r,s)=>e?{...n[t],types:{...n[t]&&n[t].types?n[t].types:{},[r]:s||!0}}:{},eI=t=>({isOnSubmit:!t||t===mr.onSubmit,isOnBlur:t===mr.onBlur,isOnChange:t===mr.onChange,isOnAll:t===mr.all,isOnTouch:t===mr.onTouched}),tI=(t,e,n)=>!n&&(e.watchAll||e.watch.has(t)||[...e.watch].some(r=>t.startsWith(r)&&/^\.\w+/.test(t.slice(r.length))));const cp=(t,e,n,r)=>{for(const s of n||Object.keys(t)){const i=Q(t,s);if(i){const{_f:o,...a}=i;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],s)&&!r)break;if(o.ref&&e(o.ref,o.name)&&!r)break}else bt(a)&&cp(a,e)}}};var vY=(t,e,n)=>{const r=gh(Q(t,n));return Fe(r,"root",e[n]),Fe(t,n,r),t},TE=t=>t.type==="file",ni=t=>typeof t=="function",Qy=t=>{if(!bE)return!1;const e=t?t.ownerDocument:0;return t instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},dp=t=>Br(t),IE=t=>t.type==="radio",Ky=t=>t instanceof RegExp;const nI={value:!1,isValid:!1},rI={value:!0,isValid:!0};var TD=t=>{if(Array.isArray(t)){if(t.length>1){const e=t.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:e,isValid:!!e.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!tt(t[0].attributes.value)?tt(t[0].value)||t[0].value===""?rI:{value:t[0].value,isValid:!0}:rI:nI}return nI};const sI={isValid:!1,value:null};var ID=t=>Array.isArray(t)?t.reduce((e,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:e,sI):sI;function iI(t,e,n="validate"){if(dp(t)||Array.isArray(t)&&t.every(dp)||Mr(t)&&!t)return{type:n,message:dp(t)?t:"",ref:e}}var ya=t=>bt(t)&&!Ky(t)?t:{value:t,message:""},oI=async(t,e,n,r,s)=>{const{ref:i,refs:o,required:a,maxLength:l,minLength:c,min:d,max:h,pattern:f,validate:p,name:y,valueAsNumber:v,mount:_,disabled:g}=t._f,m=Q(e,y);if(!_||g)return{};const w=o?o[0]:i,E=P=>{r&&w.reportValidity&&(w.setCustomValidity(Mr(P)?"":P||""),w.reportValidity())},T={},C=IE(i),I=mh(i),k=C||I,O=(v||TE(i))&&tt(i.value)&&tt(m)||Qy(i)&&i.value===""||m===""||Array.isArray(m)&&!m.length,L=gY.bind(null,y,n,T),j=(P,D,te,G=os.maxLength,Ge=os.minLength)=>{const ct=P?D:te;T[y]={type:P?G:Ge,message:ct,ref:i,...L(P?G:Ge,ct)}};if(s?!Array.isArray(m)||!m.length:a&&(!k&&(O||fn(m))||Mr(m)&&!m||I&&!TD(o).isValid||C&&!ID(o).isValid)){const{value:P,message:D}=dp(a)?{value:!!a,message:a}:ya(a);if(P&&(T[y]={type:os.required,message:D,ref:w,...L(os.required,D)},!n))return E(D),T}if(!O&&(!fn(d)||!fn(h))){let P,D;const te=ya(h),G=ya(d);if(!fn(m)&&!isNaN(m)){const Ge=i.valueAsNumber||m&&+m;fn(te.value)||(P=Ge>te.value),fn(G.value)||(D=Ge<G.value)}else{const Ge=i.valueAsDate||new Date(m),ct=K=>new Date(new Date().toDateString()+" "+K),z=i.type=="time",Z=i.type=="week";Br(te.value)&&m&&(P=z?ct(m)>ct(te.value):Z?m>te.value:Ge>new Date(te.value)),Br(G.value)&&m&&(D=z?ct(m)<ct(G.value):Z?m<G.value:Ge<new Date(G.value))}if((P||D)&&(j(!!P,te.message,G.message,os.max,os.min),!n))return E(T[y].message),T}if((l||c)&&!O&&(Br(m)||s&&Array.isArray(m))){const P=ya(l),D=ya(c),te=!fn(P.value)&&m.length>+P.value,G=!fn(D.value)&&m.length<+D.value;if((te||G)&&(j(te,P.message,D.message),!n))return E(T[y].message),T}if(f&&!O&&Br(m)){const{value:P,message:D}=ya(f);if(Ky(P)&&!m.match(P)&&(T[y]={type:os.pattern,message:D,ref:i,...L(os.pattern,D)},!n))return E(D),T}if(p){if(ni(p)){const P=await p(m,e),D=iI(P,w);if(D&&(T[y]={...D,...L(os.validate,D.message)},!n))return E(D.message),T}else if(bt(p)){let P={};for(const D in p){if(!Qn(P)&&!n)break;const te=iI(await p[D](m,e),w,D);te&&(P={...te,...L(D,te.message)},E(te.message),n&&(T[y]=P))}if(!Qn(P)&&(T[y]={ref:w,...P},!n))return T}}return E(!0),T};function _Y(t,e){const n=e.slice(0,-1).length;let r=0;for(;r<n;)t=tt(t)?r++:t[e[r++]];return t}function xY(t){for(const e in t)if(t.hasOwnProperty(e)&&!tt(t[e]))return!1;return!0}function $t(t,e){const n=Array.isArray(e)?e:AE(e)?[e]:AD(e),r=n.length===1?t:_Y(t,n),s=n.length-1,i=n[s];return r&&delete r[i],s!==0&&(bt(r)&&Qn(r)||Array.isArray(r)&&xY(r))&&$t(t,n.slice(0,-1)),t}function d_(){let t=[];return{get observers(){return t},next:s=>{for(const i of t)i.next&&i.next(s)},subscribe:s=>(t.push(s),{unsubscribe:()=>{t=t.filter(i=>i!==s)}}),unsubscribe:()=>{t=[]}}}var Yy=t=>fn(t)||!_D(t);function so(t,e){if(Yy(t)||Yy(e))return t===e;if(Ha(t)&&Ha(e))return t.getTime()===e.getTime();const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const s of n){const i=t[s];if(!r.includes(s))return!1;if(s!=="ref"){const o=e[s];if(Ha(i)&&Ha(o)||bt(i)&&bt(o)||Array.isArray(i)&&Array.isArray(o)?!so(i,o):i!==o)return!1}}return!0}var kD=t=>t.type==="select-multiple",wY=t=>IE(t)||mh(t),h_=t=>Qy(t)&&t.isConnected,RD=t=>{for(const e in t)if(ni(t[e]))return!0;return!1};function Jy(t,e={}){const n=Array.isArray(t);if(bt(t)||n)for(const r in t)Array.isArray(t[r])||bt(t[r])&&!RD(t[r])?(e[r]=Array.isArray(t[r])?[]:{},Jy(t[r],e[r])):fn(t[r])||(e[r]=!0);return e}function PD(t,e,n){const r=Array.isArray(t);if(bt(t)||r)for(const s in t)Array.isArray(t[s])||bt(t[s])&&!RD(t[s])?tt(e)||Yy(n[s])?n[s]=Array.isArray(t[s])?Jy(t[s],[]):{...Jy(t[s])}:PD(t[s],fn(e)?{}:e[s],n[s]):n[s]=!so(t[s],e[s]);return n}var f_=(t,e)=>PD(t,e,Jy(e)),ND=(t,{valueAsNumber:e,valueAsDate:n,setValueAs:r})=>tt(t)?t:e?t===""?NaN:t&&+t:n&&Br(t)?new Date(t):r?r(t):t;function p_(t){const e=t.ref;if(!(t.refs?t.refs.every(n=>n.disabled):e.disabled))return TE(e)?e.files:IE(e)?ID(t.refs).value:kD(e)?[...e.selectedOptions].map(({value:n})=>n):mh(e)?TD(t.refs).value:ND(tt(e.value)?t.ref.value:e.value,t)}var EY=(t,e,n,r)=>{const s={};for(const i of t){const o=Q(e,i);o&&Fe(s,i,o._f)}return{criteriaMode:n,names:[...t],fields:s,shouldUseNativeValidation:r}},qu=t=>tt(t)?t:Ky(t)?t.source:bt(t)?Ky(t.value)?t.value.source:t.value:t,bY=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate);function aI(t,e,n){const r=Q(t,n);if(r||AE(n))return{error:r,name:n};const s=n.split(".");for(;s.length;){const i=s.join("."),o=Q(e,i),a=Q(t,i);if(o&&!Array.isArray(o)&&n!==i)return{name:n};if(a&&a.type)return{name:i,error:a};s.pop()}return{name:n}}var SY=(t,e,n,r,s)=>s.isOnAll?!1:!n&&s.isOnTouch?!(e||t):(n?r.isOnBlur:s.isOnBlur)?!t:(n?r.isOnChange:s.isOnChange)?t:!0,CY=(t,e)=>!gh(Q(t,e)).length&&$t(t,e);const AY={mode:mr.onSubmit,reValidateMode:mr.onChange,shouldFocusError:!0};function TY(t={},e){let n={...AY,...t},r={submitCount:0,isDirty:!1,isLoading:ni(n.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},errors:{},disabled:!1},s={},i=bt(n.defaultValues)||bt(n.values)?dr(n.defaultValues||n.values)||{}:{},o=n.shouldUnregister?{}:dr(i),a={action:!1,mount:!1,watch:!1},l={mount:new Set,unMount:new Set,array:new Set,watch:new Set},c,d=0;const h={isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},f={values:d_(),array:d_(),state:d_()},p=t.resetOptions&&t.resetOptions.keepDirtyValues,y=eI(n.mode),v=eI(n.reValidateMode),_=n.criteriaMode===mr.all,g=S=>R=>{clearTimeout(d),d=setTimeout(S,R)},m=async S=>{if(h.isValid||S){const R=n.resolver?Qn((await O()).errors):await j(s,!0);R!==r.isValid&&f.state.next({isValid:R})}},w=S=>h.isValidating&&f.state.next({isValidating:S}),E=(S,R=[],N,J,q=!0,U=!0)=>{if(J&&N){if(a.action=!0,U&&Array.isArray(Q(s,S))){const b=N(Q(s,S),J.argA,J.argB);q&&Fe(s,S,b)}if(U&&Array.isArray(Q(r.errors,S))){const b=N(Q(r.errors,S),J.argA,J.argB);q&&Fe(r.errors,S,b),CY(r.errors,S)}if(h.touchedFields&&U&&Array.isArray(Q(r.touchedFields,S))){const b=N(Q(r.touchedFields,S),J.argA,J.argB);q&&Fe(r.touchedFields,S,b)}h.dirtyFields&&(r.dirtyFields=f_(i,o)),f.state.next({name:S,isDirty:D(S,R),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else Fe(o,S,R)},T=(S,R)=>{Fe(r.errors,S,R),f.state.next({errors:r.errors})},C=(S,R,N,J)=>{const q=Q(s,S);if(q){const U=Q(o,S,tt(N)?Q(i,S):N);tt(U)||J&&J.defaultChecked||R?Fe(o,S,R?U:p_(q._f)):Ge(S,U),a.mount&&m()}},I=(S,R,N,J,q)=>{let U=!1,b=!1;const B={name:S};if(!N||J){h.isDirty&&(b=r.isDirty,r.isDirty=B.isDirty=D(),U=b!==B.isDirty);const ie=so(Q(i,S),R);b=Q(r.dirtyFields,S),ie?$t(r.dirtyFields,S):Fe(r.dirtyFields,S,!0),B.dirtyFields=r.dirtyFields,U=U||h.dirtyFields&&b!==!ie}if(N){const ie=Q(r.touchedFields,S);ie||(Fe(r.touchedFields,S,N),B.touchedFields=r.touchedFields,U=U||h.touchedFields&&ie!==N)}return U&&q&&f.state.next(B),U?B:{}},k=(S,R,N,J)=>{const q=Q(r.errors,S),U=h.isValid&&Mr(R)&&r.isValid!==R;if(t.delayError&&N?(c=g(()=>T(S,N)),c(t.delayError)):(clearTimeout(d),c=null,N?Fe(r.errors,S,N):$t(r.errors,S)),(N?!so(q,N):q)||!Qn(J)||U){const b={...J,...U&&Mr(R)?{isValid:R}:{},errors:r.errors,name:S};r={...r,...b},f.state.next(b)}w(!1)},O=async S=>n.resolver(o,n.context,EY(S||l.mount,s,n.criteriaMode,n.shouldUseNativeValidation)),L=async S=>{const{errors:R}=await O(S);if(S)for(const N of S){const J=Q(R,N);J?Fe(r.errors,N,J):$t(r.errors,N)}else r.errors=R;return R},j=async(S,R,N={valid:!0})=>{for(const J in S){const q=S[J];if(q){const{_f:U,...b}=q;if(U){const B=l.array.has(U.name),ie=await oI(q,o,_,n.shouldUseNativeValidation&&!R,B);if(ie[U.name]&&(N.valid=!1,R))break;!R&&(Q(ie,U.name)?B?vY(r.errors,ie,U.name):Fe(r.errors,U.name,ie[U.name]):$t(r.errors,U.name))}b&&await j(b,R,N)}}return N.valid},P=()=>{for(const S of l.unMount){const R=Q(s,S);R&&(R._f.refs?R._f.refs.every(N=>!h_(N)):!h_(R._f.ref))&&kr(S)}l.unMount=new Set},D=(S,R)=>(S&&R&&Fe(o,S,R),!so(Qe(),i)),te=(S,R,N)=>CD(S,l,{...a.mount?o:tt(R)?i:Br(S)?{[S]:R}:R},N,R),G=S=>gh(Q(a.mount?o:i,S,t.shouldUnregister?Q(i,S,[]):[])),Ge=(S,R,N={})=>{const J=Q(s,S);let q=R;if(J){const U=J._f;U&&(!U.disabled&&Fe(o,S,ND(R,U)),q=Qy(U.ref)&&fn(R)?"":R,kD(U.ref)?[...U.ref.options].forEach(b=>b.selected=q.includes(b.value)):U.refs?mh(U.ref)?U.refs.length>1?U.refs.forEach(b=>(!b.defaultChecked||!b.disabled)&&(b.checked=Array.isArray(q)?!!q.find(B=>B===b.value):q===b.value)):U.refs[0]&&(U.refs[0].checked=!!q):U.refs.forEach(b=>b.checked=b.value===q):TE(U.ref)?U.ref.value="":(U.ref.value=q,U.ref.type||f.values.next({name:S,values:{...o}})))}(N.shouldDirty||N.shouldTouch)&&I(S,q,N.shouldTouch,N.shouldDirty,!0),N.shouldValidate&&de(S)},ct=(S,R,N)=>{for(const J in R){const q=R[J],U=`${S}.${J}`,b=Q(s,U);(l.array.has(S)||!Yy(q)||b&&!b._f)&&!Ha(q)?ct(U,q,N):Ge(U,q,N)}},z=(S,R,N={})=>{const J=Q(s,S),q=l.array.has(S),U=dr(R);Fe(o,S,U),q?(f.array.next({name:S,values:{...o}}),(h.isDirty||h.dirtyFields)&&N.shouldDirty&&f.state.next({name:S,dirtyFields:f_(i,o),isDirty:D(S,U)})):J&&!J._f&&!fn(U)?ct(S,U,N):Ge(S,U,N),tI(S,l)&&f.state.next({...r}),f.values.next({name:S,values:{...o}}),!a.mount&&e()},Z=async S=>{const R=S.target;let N=R.name,J=!0;const q=Q(s,N),U=()=>R.type?p_(q._f):xD(S),b=B=>{J=Number.isNaN(B)||B===Q(o,N,B)};if(q){let B,ie;const at=U(),sa=S.type===Gy.BLUR||S.type===Gy.FOCUS_OUT,PM=!bY(q._f)&&!n.resolver&&!Q(r.errors,N)&&!q._f.deps||SY(sa,Q(r.touchedFields,N),r.isSubmitted,v,y),Fg=tI(N,l,sa);Fe(o,N,at),sa?(q._f.onBlur&&q._f.onBlur(S),c&&c(0)):q._f.onChange&&q._f.onChange(S);const $g=I(N,at,sa,!1),NM=!Qn($g)||Fg;if(!sa&&f.values.next({name:N,type:S.type,values:{...o}}),PM)return h.isValid&&m(),NM&&f.state.next({name:N,...Fg?{}:$g});if(!sa&&Fg&&f.state.next({...r}),w(!0),n.resolver){const{errors:kb}=await O([N]);if(b(at),J){const jM=aI(r.errors,s,N),Rb=aI(kb,s,jM.name||N);B=Rb.error,N=Rb.name,ie=Qn(kb)}}else B=(await oI(q,o,_,n.shouldUseNativeValidation))[N],b(at),J&&(B?ie=!1:h.isValid&&(ie=await j(s,!0)));J&&(q._f.deps&&de(q._f.deps),k(N,ie,B,$g))}},K=(S,R)=>{if(Q(r.errors,R)&&S.focus)return S.focus(),1},de=async(S,R={})=>{let N,J;const q=up(S);if(w(!0),n.resolver){const U=await L(tt(S)?S:q);N=Qn(U),J=S?!q.some(b=>Q(U,b)):N}else S?(J=(await Promise.all(q.map(async U=>{const b=Q(s,U);return await j(b&&b._f?{[U]:b}:b)}))).every(Boolean),!(!J&&!r.isValid)&&m()):J=N=await j(s);return f.state.next({...!Br(S)||h.isValid&&N!==r.isValid?{}:{name:S},...n.resolver||!S?{isValid:N}:{},errors:r.errors,isValidating:!1}),R.shouldFocus&&!J&&cp(s,K,S?q:l.mount),J},Qe=S=>{const R={...i,...a.mount?o:{}};return tt(S)?R:Br(S)?Q(R,S):S.map(N=>Q(R,N))},ss=(S,R)=>({invalid:!!Q((R||r).errors,S),isDirty:!!Q((R||r).dirtyFields,S),isTouched:!!Q((R||r).touchedFields,S),error:Q((R||r).errors,S)}),Bn=S=>{S&&up(S).forEach(R=>$t(r.errors,R)),f.state.next({errors:S?r.errors:{}})},Rs=(S,R,N)=>{const J=(Q(s,S,{_f:{}})._f||{}).ref;Fe(r.errors,S,{...R,ref:J}),f.state.next({name:S,errors:r.errors,isValid:!1}),N&&N.shouldFocus&&J&&J.focus&&J.focus()},ar=(S,R)=>ni(S)?f.values.subscribe({next:N=>S(te(void 0,R),N)}):te(S,R,!0),kr=(S,R={})=>{for(const N of S?up(S):l.mount)l.mount.delete(N),l.array.delete(N),R.keepValue||($t(s,N),$t(o,N)),!R.keepError&&$t(r.errors,N),!R.keepDirty&&$t(r.dirtyFields,N),!R.keepTouched&&$t(r.touchedFields,N),!n.shouldUnregister&&!R.keepDefaultValue&&$t(i,N);f.values.next({values:{...o}}),f.state.next({...r,...R.keepDirty?{isDirty:D()}:{}}),!R.keepIsValid&&m()},Iu=({disabled:S,name:R,field:N,fields:J,value:q})=>{if(Mr(S)){const U=S?void 0:tt(q)?p_(N?N._f:Q(J,R)._f):q;Fe(o,R,U),I(R,U,!1,!1,!0)}},ku=(S,R={})=>{let N=Q(s,S);const J=Mr(R.disabled);return Fe(s,S,{...N||{},_f:{...N&&N._f?N._f:{ref:{name:S}},name:S,mount:!0,...R}}),l.mount.add(S),N?Iu({field:N,disabled:R.disabled,name:S}):C(S,!0,R.value),{...J?{disabled:R.disabled}:{},...n.progressive?{required:!!R.required,min:qu(R.min),max:qu(R.max),minLength:qu(R.minLength),maxLength:qu(R.maxLength),pattern:qu(R.pattern)}:{},name:S,onChange:Z,onBlur:Z,ref:q=>{if(q){ku(S,R),N=Q(s,S);const U=tt(q.value)&&q.querySelectorAll&&q.querySelectorAll("input,select,textarea")[0]||q,b=wY(U),B=N._f.refs||[];if(b?B.find(ie=>ie===U):U===N._f.ref)return;Fe(s,S,{_f:{...N._f,...b?{refs:[...B.filter(h_),U,...Array.isArray(Q(i,S))?[{}]:[]],ref:{type:U.type,name:S}}:{ref:U}}}),C(S,!1,void 0,U)}else N=Q(s,S,{}),N._f&&(N._f.mount=!1),(n.shouldUnregister||R.shouldUnregister)&&!(wD(l.array,S)&&a.action)&&l.unMount.add(S)}}},cn=()=>n.shouldFocusError&&cp(s,K,l.mount),Vi=S=>{Mr(S)&&(f.state.next({disabled:S}),cp(s,R=>{R.disabled=S},0,!1))},jh=(S,R)=>async N=>{N&&(N.preventDefault&&N.preventDefault(),N.persist&&N.persist());let J=dr(o);if(f.state.next({isSubmitting:!0}),n.resolver){const{errors:q,values:U}=await O();r.errors=q,J=U}else await j(s);$t(r.errors,"root"),Qn(r.errors)?(f.state.next({errors:{}}),await S(J,N)):(R&&await R({...r.errors},N),cn(),setTimeout(cn)),f.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Qn(r.errors),submitCount:r.submitCount+1,errors:r.errors})},Dg=(S,R={})=>{Q(s,S)&&(tt(R.defaultValue)?z(S,Q(i,S)):(z(S,R.defaultValue),Fe(i,S,R.defaultValue)),R.keepTouched||$t(r.touchedFields,S),R.keepDirty||($t(r.dirtyFields,S),r.isDirty=R.defaultValue?D(S,Q(i,S)):D()),R.keepError||($t(r.errors,S),h.isValid&&m()),f.state.next({...r}))},Oh=(S,R={})=>{const N=S?dr(S):i,J=dr(N),q=S&&!Qn(S)?J:i;if(R.keepDefaultValues||(i=N),!R.keepValues){if(R.keepDirtyValues||p)for(const U of l.mount)Q(r.dirtyFields,U)?Fe(q,U,Q(o,U)):z(U,Q(q,U));else{if(bE&&tt(S))for(const U of l.mount){const b=Q(s,U);if(b&&b._f){const B=Array.isArray(b._f.refs)?b._f.refs[0]:b._f.ref;if(Qy(B)){const ie=B.closest("form");if(ie){ie.reset();break}}}}s={}}o=t.shouldUnregister?R.keepDefaultValues?dr(i):{}:dr(q),f.array.next({values:{...q}}),f.values.next({values:{...q}})}l={mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},!a.mount&&e(),a.mount=!h.isValid||!!R.keepIsValid,a.watch=!!t.shouldUnregister,f.state.next({submitCount:R.keepSubmitCount?r.submitCount:0,isDirty:R.keepDirty?r.isDirty:!!(R.keepDefaultValues&&!so(S,i)),isSubmitted:R.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:R.keepDirtyValues?r.dirtyFields:R.keepDefaultValues&&S?f_(i,S):{},touchedFields:R.keepTouched?r.touchedFields:{},errors:R.keepErrors?r.errors:{},isSubmitSuccessful:R.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1})},Dh=(S,R)=>Oh(ni(S)?S(o):S,R);return{control:{register:ku,unregister:kr,getFieldState:ss,handleSubmit:jh,setError:Rs,_executeSchema:O,_getWatch:te,_getDirty:D,_updateValid:m,_removeUnmounted:P,_updateFieldArray:E,_updateDisabledField:Iu,_getFieldArray:G,_reset:Oh,_resetDefaultValues:()=>ni(n.defaultValues)&&n.defaultValues().then(S=>{Dh(S,n.resetOptions),f.state.next({isLoading:!1})}),_updateFormState:S=>{r={...r,...S}},_disableForm:Vi,_subjects:f,_proxyFormState:h,get _fields(){return s},get _formValues(){return o},get _state(){return a},set _state(S){a=S},get _defaultValues(){return i},get _names(){return l},set _names(S){l=S},get _formState(){return r},set _formState(S){r=S},get _options(){return n},set _options(S){n={...n,...S}}},trigger:de,register:ku,handleSubmit:jh,watch:ar,setValue:z,getValues:Qe,reset:Dh,resetField:Dg,clearErrors:Bn,unregister:kr,setError:Rs,setFocus:(S,R={})=>{const N=Q(s,S),J=N&&N._f;if(J){const q=J.refs?J.refs[0]:J.ref;q.focus&&(q.focus(),R.shouldSelect&&q.select())}},getFieldState:ss}}function sg(t={}){const e=me.useRef(),n=me.useRef(),[r,s]=me.useState({isDirty:!1,isValidating:!1,isLoading:ni(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},errors:{},disabled:!1,defaultValues:ni(t.defaultValues)?void 0:t.defaultValues});e.current||(e.current={...TY(t,()=>s(o=>({...o}))),formState:r});const i=e.current.control;return i._options=t,CE({subject:i._subjects.state,next:o=>{bD(o,i._proxyFormState,i._updateFormState,!0)&&s({...i._formState})}}),me.useEffect(()=>i._disableForm(t.disabled),[i,t.disabled]),me.useEffect(()=>{if(i._proxyFormState.isDirty){const o=i._getDirty();o!==r.isDirty&&i._subjects.state.next({isDirty:o})}},[i,r.isDirty]),me.useEffect(()=>{t.values&&!so(t.values,n.current)?(i._reset(t.values,i._options.resetOptions),n.current=t.values):i._resetDefaultValues()},[t.values,i]),me.useEffect(()=>{i._state.mount||(i._updateValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),e.current.formState=ED(r,i),e.current}function jD({player:t,onClickEdit:e,children:n,...r}){const s=x.useCallback(()=>{e==null||e(t)},[e,t]);return u.jsxs("div",{className:"relative flex-1 flex items-center gap-x-2 rounded p-2 text-white",style:{backgroundColor:t.color??"#115e59"},...r,children:[t.teamPicUrl&&u.jsx("div",{className:"absolute inset-0 opacity-10 bg-center bg-no-repeat bg-cover",style:{backgroundImage:`url(${t.teamPicUrl})`}}),u.jsx("div",{className:"relative z-10 shrink-0",children:u.jsx("div",{className:"w-14 h-14 bg-center bg-contain bg-no-repeat rounded",style:{backgroundImage:`url(${t.proPicUrl||"/images/portrait-placeholder.jpeg"})`}})}),u.jsxs("div",{className:"flex-1 relative z-10 ",children:[u.jsx("div",{children:t.title??"(無頭銜)"}),u.jsx("div",{className:"text-2xl",children:t.name??"(無名稱)"})]}),e&&u.jsx("div",{className:"shrink-0",children:u.jsx(ke,{variant:"icon",color:"inverted",type:"button",onClick:s,children:u.jsx("i",{className:"bi bi-pencil"})})})]})}const IY=oO(["block w-full rounded-md border-0 p-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600"]);function ri({className:t,...e}){const n=x.useMemo(()=>IY({className:t}),[t]);return u.jsx("input",{className:n,...e})}function kY({match:t,currentMatchRound:e,onSubmit:n,...r}){const{reset:s,handleSubmit:i,control:o}=sg({defaultValues:{player_0:0,player_1:0,player_2:0,player_3:0,cumulatedThousands:0,roundCount:0,extendedRoundCount:0}}),a=x.useMemo(()=>Object.keys(t.players).map(d=>({...t.players[d],index:d.toString(),position:$i(d,e.roundCount)})),[t.players,e.roundCount]),l=x.useMemo(()=>i(c=>{if(!n)return;const d={...e,resultType:rt.Hotfix,playerResults:{0:{...e.playerResults[0],afterScore:parseInt(c.player_0,10)},1:{...e.playerResults[1],afterScore:parseInt(c.player_1,10)},2:{...e.playerResults[2],afterScore:parseInt(c.player_2,10)},3:{...e.playerResults[3],afterScore:parseInt(c.player_3,10)}},cumulatedThousands:parseInt(c.cumulatedThousands,10),roundCount:parseInt(c.roundCount,10),extendedRoundCount:parseInt(c.extendedRoundCount,10)};n(d)}),[e,i,n]);return x.useEffect(()=>{r.open&&s({player_0:e.playerResults[0].beforeScore,player_1:e.playerResults[1].beforeScore,player_2:e.playerResults[2].beforeScore,player_3:e.playerResults[3].beforeScore,cumulatedThousands:e.cumulatedThousands,roundCount:e.roundCount,extendedRoundCount:e.extendedRoundCount})},[e.cumulatedThousands,e.extendedRoundCount,e.playerResults,e.roundCount,r.open,s]),u.jsx(nr,{title:"手動調整分數",...r,children:u.jsxs("div",{className:"space-y-8",children:[u.jsx("div",{className:"space-y-2",children:u.jsxs("table",{className:"data-table w-full",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{className:"w-1/2",children:"玩家"}),u.jsx("th",{className:"w-1/4",children:"現在分數"}),u.jsx("th",{className:"w-1/4",children:"新的分數"})]})}),u.jsxs("tbody",{children:[a.map(c=>u.jsxs("tr",{children:[u.jsx("td",{className:"px-2 border border-gray-200 align-middle",children:u.jsx(jD,{player:c})}),u.jsx("td",{className:"text-center px-2 border border-gray-200 align-middle",children:e.playerResults[c.index].beforeScore}),u.jsx("td",{className:"px-2 border border-gray-200 align-middle",children:u.jsx(Sn,{name:`player_${c.index}`,control:o,rules:{required:!0},render:({field:d})=>u.jsx(ri,{className:"text-center",type:"number",...d})})})]},c.index)),u.jsxs("tr",{children:[u.jsx("td",{className:"px-2 border border-gray-200 align-middle",children:"供托"}),u.jsx("td",{className:"text-center px-2 border border-gray-200 align-middle",children:e.cumulatedThousands}),u.jsx("td",{className:"px-2 border border-gray-200 align-middle",children:u.jsx(Sn,{name:"cumulatedThousands",control:o,rules:{required:!0},render:({field:c})=>u.jsx(ri,{className:"text-center",type:"number",...c})})})]}),u.jsxs("tr",{children:[u.jsx("td",{className:"px-2 border border-gray-200 align-middle",children:"局數(東1局=1, 東2局=2, ...)"}),u.jsx("td",{className:"text-center px-2 border border-gray-200 align-middle",children:e.roundCount}),u.jsx("td",{className:"px-2 border border-gray-200 align-middle",children:u.jsx(Sn,{name:"roundCount",control:o,rules:{required:!0},render:({field:c})=>u.jsx(ri,{className:"text-center",type:"number",...c})})})]}),u.jsxs("tr",{children:[u.jsx("td",{className:"px-2 border border-gray-200 align-middle",children:"本場數"}),u.jsx("td",{className:"text-center px-2 border border-gray-200 align-middle",children:e.extendedRoundCount}),u.jsx("td",{className:"px-2 border border-gray-200 align-middle",children:u.jsx(Sn,{name:"extendedRoundCount",control:o,rules:{required:!0},render:({field:c})=>u.jsx(ri,{className:"text-center",type:"number",...c})})})]})]})]})}),u.jsx("div",{className:"space-y-2",children:u.jsx(ke,{onClick:l,className:"w-full",children:"提交並更新直播畫面"})})]})})}const ff=({teamPlayer:t})=>u.jsx(Ti,{player:Wa(t),score:25e3}),RY=({dbMatch:t})=>{const e=Kj(),n=x.useCallback(async()=>{if(!confirm("確定資料都正確了嗎？要開始對局了嗎？"))return;const r={code:t._id,name:t.name,remark:"",createdAt:new Date().toISOString(),createdBy:"Dicky",updatedAt:new Date().toISOString(),updatedBy:"Dicky",setting:{startingScore:t.tournament.startingScore,isManganRoundUp:t.tournament.startingScore?"1":"0",yakuMax:t.tournament.yakuMax,yakumanMax:t.tournament.yakumanMax},players:{0:Wa(t.playerEast),1:Wa(t.playerSouth),2:Wa(t.playerWest),3:Wa(t.playerNorth)},activeResultDetail:null};await e.set(`matches/${t._id}`,r);const s=parseInt(t.tournament.startingScore),i={matchId:t._id,code:qy(t._id,1,0),roundCount:1,extendedRoundCount:0,cumulatedThousands:0,nextRoundCumulatedThousands:0,resultType:0,nextRoundType:0,playerResults:{0:{beforeScore:s,afterScore:s,type:0,scoreChanges:[],prevScoreChanges:[],detail:{han:1,fu:30,yakumanCount:0,dora:0,redDora:0,innerDora:0,yakus:[],raw:{},isRevealed:!1,isRiichied:!1}},1:{beforeScore:s,afterScore:s,type:0,scoreChanges:[],prevScoreChanges:[],detail:{han:1,fu:30,yakumanCount:0,dora:0,redDora:0,innerDora:0,yakus:[],raw:{},isRevealed:!1,isRiichied:!1}},2:{beforeScore:s,afterScore:s,type:0,scoreChanges:[],prevScoreChanges:[],detail:{han:1,fu:30,yakumanCount:0,dora:0,redDora:0,innerDora:0,yakus:[],raw:{},isRevealed:!1,isRiichied:!1}},3:{beforeScore:s,afterScore:s,type:0,scoreChanges:[],prevScoreChanges:[],detail:{han:1,fu:30,yakumanCount:0,dora:0,redDora:0,innerDora:0,yakus:[],raw:{},isRevealed:!1,isRiichied:!1}}},doras:[]};await e.push("matchRounds",i),await e.set("obs/1",{matchId:t._id})},[t._id,t.name,t.playerEast,t.playerNorth,t.playerSouth,t.playerWest,t.tournament.startingScore,t.tournament.yakuMax,t.tournament.yakumanMax,e]);return u.jsx("div",{className:"container mx-auto max-w-screen-md py-16",children:u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"bg-red-500 p-4 text-white space-y-2",children:[u.jsx("div",{className:"text-center text-6xl",children:u.jsx("i",{className:"bi bi-exclamation-triangle"})}),u.jsxs("p",{className:"text-center text-xl",children:["這是開始直播前的最後機會，請檢查以下內容是否完全正確。",u.jsx("br",{}),"一旦對局開始，要修改內容就很麻煩。",u.jsx("br",{}),u.jsx("br",{}),"如果要修改，請在資料庫修改後，刷新此頁面。"]})]}),u.jsxs("h4",{className:"text-3xl",children:[u.jsx("span",{className:"text-neutral-600",children:"對局名稱:"})," ",u.jsx("span",{className:"font-bold",children:t.name})]}),u.jsxs("div",{className:"grid grid-cols-10 gap-x-2",children:[u.jsxs("div",{className:"col-span-4 col-start-4",children:[u.jsx("div",{className:"text-[48px]",children:u.jsx(ff,{teamPlayer:t.playerWest})}),u.jsx("p",{className:"text-center text-4xl",children:"西"})]}),u.jsxs("div",{className:"col-span-4 col-start-1 flex items-center gap-x-2",children:[u.jsx("div",{className:"flex-1 text-[48px]",children:u.jsx(ff,{teamPlayer:t.playerNorth})}),u.jsx("div",{className:"shrink-0 text-4xl",children:"北"})]}),u.jsx("div",{className:"col-span-2"}),u.jsxs("div",{className:"col-span-4 flex items-center gap-x-2",children:[u.jsx("div",{className:"shrink-0 text-4xl",children:"南"}),u.jsx("div",{className:"flex-1 text-[48px]",children:u.jsx(ff,{teamPlayer:t.playerSouth})})]}),u.jsxs("div",{className:"col-span-4 col-start-4",children:[u.jsx("p",{className:"text-center text-4xl",children:"東"}),u.jsx("div",{className:"text-[48px]",children:u.jsx(ff,{teamPlayer:t.playerEast})})]})]}),u.jsxs("div",{className:"text-2xl",children:[u.jsx("span",{className:"text-neutral-600",children:"聯賽:"})," ",u.jsx("span",{className:"font-bold",children:t.tournament.name})]}),u.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[u.jsxs("div",{className:"border border-neutral-400 pt-2 py-4 rounded text-center bg-white",children:[u.jsx("p",{className:"text-neutral-600 font-bold text-sm",children:"起始點數"}),u.jsx("p",{className:"text-4xl",children:t.tournament.startingScore})]}),u.jsxs("div",{className:"border border-neutral-400 pt-2 py-4 rounded text-center bg-white",children:[u.jsx("p",{className:"text-neutral-600 font-bold text-sm",children:"切上滿貫"}),u.jsx("p",{className:"text-4xl",children:t.tournament.isManganRoundUp?"有":"沒有"})]}),u.jsxs("div",{className:"border border-neutral-400 pt-2 py-4 rounded text-center bg-white",children:[u.jsx("p",{className:"text-neutral-600 font-bold text-sm",children:"翻數上限"}),u.jsx("p",{className:"text-4xl",children:vK(t.tournament.yakuMax)})]}),u.jsxs("div",{className:"border border-neutral-400 pt-2 py-4 rounded text-center bg-white",children:[u.jsx("p",{className:"text-neutral-600 font-bold text-sm",children:"役滿上限"}),u.jsx("p",{className:"text-4xl",children:_K(t.tournament.yakumanMax)})]})]}),u.jsx("div",{className:"pt-8",children:u.jsx(ke,{className:"w-full",size:"xlarge",variant:"contained",color:"success",onClick:n,children:"確認以上內容無誤，開始對局"})})]})})},PY=({players:t,currentRound:e,onAction:n})=>{const r=x.useCallback(s=>{const i=s.currentTarget.getAttribute("data-player-index"),o=s.currentTarget.getAttribute("data-action");n(i,o)},[n]);return u.jsx("div",{className:"space-y-2",children:["0","1","2","3"].map(s=>{var i,o;return u.jsx("table",{className:"w-full border border-black ring-2 ring-transparent data-[east='1']:ring-red-500 bg-white","data-east":vr(s,e.roundCount)?"1":"0",children:u.jsxs("tbody",{children:[u.jsxs("tr",{children:[u.jsxs("td",{className:"p-1 text-white w-32 relative",style:{background:t[s].color},children:[u.jsx("button",{className:"absolute text-gray-900 text-xs px-1 rounded",style:{backgroundColor:"#ffe100",width:"2rem",height:"2.5rem",top:"0rem",left:"-2.5rem",opacity:e.playerResults[s].isYellowCarded?1:.35},"data-player-index":s,"data-action":"yellow-card",onClick:r,children:"黃牌"}),u.jsx("button",{className:"absolute text-gray-900 text-xs px-1 rounded",style:{backgroundColor:"#ff1900",width:"2rem",height:"2.5rem",top:"2.7rem",left:"-2.5rem",opacity:e.playerResults[s].isRedCarded?1:.35},"data-player-index":s,"data-action":"red-card",onClick:r,children:"紅牌"}),u.jsxs("div",{className:"flex gap-x-1 items-center w-32",children:[u.jsx("img",{className:"shrink-0 w-8 h-8 inline-block",src:t[s].teamPicUrl,alt:t[s].title}),u.jsx("img",{className:"shrink-0 w-[1.44rem] h-8 inline-block",src:t[s].proPicUrl,alt:t[s].name}),u.jsxs("div",{className:"flex-1 align-middle overflow-hidden",children:[u.jsx("p",{className:"whitespace-nowrap overflow-ellipsis",children:t[s].title}),u.jsx("p",{className:"whitespace-nowrap overflow-ellipsis",children:t[s].nickname||t[s].name})]})]})]}),u.jsx("td",{className:"px-2 border-b border-black",colSpan:2,children:u.jsxs("button",{className:"py-2 text-left block","data-player-index":s,"data-action":"waitingTile",onClick:r,children:[u.jsx("span",{className:"mr-2 text-xl",children:"待牌"}),u.jsx("div",{className:"inline-block space-x-1",children:(i=e.playerResults[s].waitingTiles)==null?void 0:i.map(a=>u.jsx(Ur,{className:"inline-block align-middle w-8 animate-[fadeInFromLeft_1s_ease-in-out]",children:a},a))})]})}),u.jsxs("td",{className:"whitespace-nowrap w-0 space-y-1 pr-1",rowSpan:2,children:[u.jsxs("div",{className:"space-x-1",children:[u.jsx("button",{className:"px-1 bg-neutral-200 border rounded border-neutral-700 text-xl disabled:opacity-20 disabled:cursor-not-allowed data-[active='1']:bg-teal-800 data-[active='1']:text-yellow-300","data-player-index":s,"data-action":"reveal",onClick:r,"data-active":e.playerResults[s].isRevealed?"1":"0",disabled:e.playerResults[s].isRiichi,children:"副露"}),u.jsxs("button",{className:"px-1 bg-neutral-200 border rounded border-neutral-700 text-xl","data-player-index":s,"data-action":"ron-before",onClick:r,children:["和",t[dD(s)].nickname||"上家"]})]}),u.jsxs("div",{className:"space-x-1",children:[u.jsx("button",{className:"px-1 bg-neutral-200 border rounded border-neutral-700 text-xl disabled:opacity-20 disabled:cursor-not-allowed data-[active='1']:bg-red-800 data-[active='1']:text-yellow-300","data-player-index":s,"data-action":"riichi",onClick:r,"data-active":e.playerResults[s].isRiichi?"1":"0",disabled:e.playerResults[s].isRevealed,children:"立直"}),u.jsxs("button",{className:"px-1 bg-neutral-200 border rounded border-neutral-700 text-xl","data-player-index":s,"data-action":"ron-opposite",onClick:r,children:["和",t[fD(s)].nickname||"對家"]})]}),u.jsxs("div",{className:"space-x-1",children:[u.jsx("button",{className:"px-1 bg-neutral-200 border rounded border-neutral-700 text-xl","data-player-index":s,"data-action":"ron-self",onClick:r,children:"自摸"}),u.jsxs("button",{className:"px-1 bg-neutral-200 border rounded border-neutral-700 text-xl","data-player-index":s,"data-action":"ron-after",onClick:r,children:["和",t[hD(s)].nickname||"下家"]})]})]})]}),u.jsxs("tr",{children:[u.jsx("td",{className:"p-1 space-x-1 text-white text-4xl",style:{background:t[s].color},children:e.playerResults[s].afterScore}),u.jsx("td",{className:"px-2",children:u.jsxs("button",{className:"py-2 text-left text-xl","data-player-index":s,"data-action":"yaku",onClick:r,children:[u.jsx("span",{className:"mr-2 text-xl",children:"役"}),u.jsx("div",{className:"inline-block space-x-1",children:(o=e.playerResults[s].detail.yakus)==null?void 0:o.map(({label:a})=>u.jsx("span",{children:a},a))})]})}),u.jsx("td",{className:"w-0 text-right whitespace-nowrap px-4",children:u.jsxs("div",{children:[u.jsxs("div",{className:"data-[active='1']:bg-yellow-200","data-active":e.playerResults[s].detail.dora>0?"1":"0",children:[u.jsx("button",{className:"px-2 text-lg leading-0","data-player-index":s,"data-action":"dora-normal-minus",onClick:r,children:"-"}),"寶",e.playerResults[s].detail.dora,u.jsx("button",{className:"px-2 text-lg leading-0","data-player-index":s,"data-action":"dora-normal-plus",onClick:r,children:"+"})]}),u.jsxs("div",{className:"data-[active='1']:bg-red-200","data-active":e.playerResults[s].detail.redDora>0?"1":"0",children:[u.jsx("button",{className:"px-2 text-lg leading-0","data-player-index":s,"data-action":"dora-red-minus",onClick:r,children:"-"}),"赤",e.playerResults[s].detail.redDora??0,u.jsx("button",{className:"px-2 text-lg leading-0","data-player-index":s,"data-action":"dora-red-plus",onClick:r,children:"+"})]})]})})]})]})},s)})})},NY=[["0","3","1","2"],["3","2","0","1"],["2","1","3","0"],["1","0","2","3"]],jY=({players:t,currentRound:e,onAction:n})=>{var l,c,d,h;const[r,s]=x.useState(0),i=x.useMemo(()=>NY[r],[r]),o=x.useCallback(f=>{const p=f.currentTarget.getAttribute("data-player-index"),y=f.currentTarget.getAttribute("data-action");n(p,y)},[n]),a=x.useCallback(()=>{s(f=>(f+1)%4)},[]);return u.jsxs("div",{children:[u.jsx("div",{className:"text-center mb-4",children:u.jsxs(ke,{size:"small",onClick:a,children:["逆時針旋轉 ",u.jsx("i",{className:"bi bi-arrow-counterclockwise"})]})}),u.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[u.jsx("table",{className:"w-full border border-black",children:u.jsxs("tbody",{children:[u.jsxs("tr",{children:[u.jsxs("td",{className:"p-1 space-x-1 text-white",style:{background:t[i[0]].color},children:[u.jsx("img",{className:"w-8 h-8 inline-block",src:t[i[0]].teamPicUrl,alt:t[i[0]].title}),u.jsx("img",{className:"w-[1.44rem] h-8 inline-block",src:t[i[0]].proPicUrl,alt:t[i[0]].name}),u.jsxs("div",{className:"inline-block align-middle",children:[u.jsx("p",{children:t[i[0]].title}),u.jsx("p",{children:t[i[0]].name})]})]}),u.jsx("td",{className:"p-1 space-x-1 text-white text-4xl text-right pr-2",style:{background:t[i[0]].color},children:e.playerResults[i[0]].afterScore})]}),u.jsx("tr",{children:u.jsx("td",{className:"w-1/2 px-2 h-16",colSpan:2,children:u.jsxs("button",{className:"py-2 text-left block","data-player-index":i[0],"data-action":"waitingTile",onClick:o,children:[u.jsx("span",{className:"mr-2 text-xl",children:"待牌"}),u.jsx("div",{className:"inline-block space-x-1",children:(l=e.playerResults[i[0]].waitingTiles)==null?void 0:l.map(f=>u.jsx(Ur,{className:"inline-block align-middle w-8 animate-[fadeInFromLeft_1s_ease-in-out]",children:f},f))})]})})}),u.jsxs("tr",{children:[u.jsx("td",{className:"w-full px-2",children:u.jsx("span",{children:"役"})}),u.jsx("td",{className:"w-0 text-right whitespace-nowrap px-4 pb-4",children:u.jsxs("div",{children:[u.jsxs("div",{className:"data-[active='1']:bg-yellow-200","data-active":e.playerResults[i[0]].detail.dora>0?"1":"0",children:[u.jsx("button",{className:"px-2 text-lg leading-0","data-player-index":i[0],"data-action":"dora-normal-minus",onClick:o,children:"-"}),"寶",e.playerResults[i[0]].detail.dora,u.jsx("button",{className:"px-2 text-lg leading-0","data-player-index":i[0],"data-action":"dora-normal-plus",onClick:o,children:"+"})]}),u.jsxs("div",{className:"data-[active='1']:bg-red-200","data-active":e.playerResults[i[0]].detail.redDora>0?"1":"0",children:[u.jsx("button",{className:"px-2 text-lg leading-0","data-player-index":i[0],"data-action":"dora-red-minus",onClick:o,children:"-"}),"赤",e.playerResults[i[0]].detail.redDora??0,u.jsx("button",{className:"px-2 text-lg leading-0","data-player-index":i[0],"data-action":"dora-red-plus",onClick:o,children:"+"})]})]})})]}),u.jsx("tr",{children:u.jsx("td",{className:"whitespace-nowrap",colSpan:2,children:u.jsxs("div",{className:" grid grid-cols-3 gap-2 justify-center",children:[u.jsx("button",{className:"px-1 py-1 bg-neutral-200 border rounded border-neutral-700 text-xl mr-4 disabled:opacity-20 disabled:cursor-not-allowed data-[active='1']:bg-teal-800 data-[active='1']:text-yellow-300","data-player-index":i[0],"data-action":"reveal",onClick:o,"data-active":e.playerResults[i[0]].isRevealed?"1":"0",disabled:e.playerResults[i[0]].isRiichi,children:"副露"}),u.jsx("button",{className:"px-1 py-1 bg-neutral-200 border rounded border-neutral-700 text-xl","data-player-index":i[0],"data-action":"ron-self",onClick:o,children:"自摸"}),u.jsx("button",{className:"px-1 py-1 bg-neutral-200 border rounded border-neutral-700 text-xl","data-player-index":i[0],"data-action":"ron-before",onClick:o,children:"和上家←"}),u.jsx("button",{className:"px-1 py-1 bg-neutral-200 border rounded border-neutral-700 text-xl mr-4 disabled:opacity-20 disabled:cursor-not-allowed data-[active='1']:bg-red-800 data-[active='1']:text-yellow-300","data-player-index":i[0],"data-action":"riichi",onClick:o,"data-active":e.playerResults[i[0]].isRiichi?"1":"0",disabled:e.playerResults[i[0]].isRevealed,children:"立直"}),u.jsx("button",{className:"px-1 py-1 bg-neutral-200 border rounded border-neutral-700 text-xl","data-player-index":i[0],"data-action":"ron-after",onClick:o,children:"和下家↑"}),u.jsx("button",{className:"px-1 py-1 bg-neutral-200 border rounded border-neutral-700 text-xl","data-player-index":i[0],"data-action":"ron-opposite",onClick:o,children:"和對家↖"})]})})})]})}),u.jsx("table",{className:"w-full border border-black",children:u.jsxs("tbody",{children:[u.jsxs("tr",{children:[u.jsxs("td",{className:"p-1 space-x-1 text-white",style:{background:t[i[1]].color},children:[u.jsx("img",{className:"w-8 h-8 inline-block",src:t[i[1]].teamPicUrl,alt:t[i[1]].title}),u.jsx("img",{className:"w-[1.44rem] h-8 inline-block",src:t[i[1]].proPicUrl,alt:t[i[1]].name}),u.jsxs("div",{className:"inline-block align-middle",children:[u.jsx("p",{children:t[i[1]].title}),u.jsx("p",{children:t[i[1]].name})]})]}),u.jsx("td",{className:"p-1 space-x-1 text-white text-4xl text-right pr-2",style:{background:t[i[1]].color},children:e.playerResults[i[1]].afterScore})]}),u.jsx("tr",{children:u.jsx("td",{className:"w-1/2 px-2 h-16",colSpan:2,children:u.jsxs("button",{className:"py-2 text-left block","data-player-index":i[1],"data-action":"waitingTile",onClick:o,children:[u.jsx("span",{className:"mr-2 text-xl",children:"待牌"}),u.jsx("div",{className:"inline-block space-x-1",children:(c=e.playerResults[i[1]].waitingTiles)==null?void 0:c.map(f=>u.jsx(Ur,{className:"inline-block align-middle w-8 animate-[fadeInFromLeft_1s_ease-in-out]",children:f},f))})]})})}),u.jsxs("tr",{children:[u.jsx("td",{className:"w-full px-2",children:u.jsx("span",{children:"役"})}),u.jsx("td",{className:"w-0 text-right whitespace-nowrap px-4 pb-4",children:u.jsxs("div",{children:[u.jsxs("div",{className:"data-[active='1']:bg-yellow-200","data-active":e.playerResults[i[1]].detail.dora>0?"1":"0",children:[u.jsx("button",{className:"px-2 text-lg leading-0","data-player-index":i[1],"data-action":"dora-normal-minus",onClick:o,children:"-"}),"寶",e.playerResults[i[1]].detail.dora,u.jsx("button",{className:"px-2 text-lg leading-0","data-player-index":i[1],"data-action":"dora-normal-plus",onClick:o,children:"+"})]}),u.jsxs("div",{className:"data-[active='1']:bg-red-200","data-active":e.playerResults[i[1]].detail.redDora>0?"1":"0",children:[u.jsx("button",{className:"px-2 text-lg leading-0","data-player-index":i[1],"data-action":"dora-red-minus",onClick:o,children:"-"}),"赤",e.playerResults[i[1]].detail.redDora??0,u.jsx("button",{className:"px-2 text-lg leading-0","data-player-index":i[1],"data-action":"dora-red-plus",onClick:o,children:"+"})]})]})})]}),u.jsx("tr",{children:u.jsx("td",{className:"whitespace-nowrap",colSpan:2,children:u.jsxs("div",{className:" grid grid-cols-3 gap-2 justify-center",children:[u.jsx("button",{className:"px-1 py-1 bg-neutral-200 border rounded border-neutral-700 text-xl","data-player-index":i[1],"data-action":"ron-after",onClick:o,children:"→和下家"}),u.jsx("button",{className:"px-1 py-1 bg-neutral-200 border rounded border-neutral-700 text-xl","data-player-index":i[1],"data-action":"ron-self",onClick:o,children:"自摸"}),u.jsx("button",{className:"px-1 py-1 bg-neutral-200 border rounded border-neutral-700 text-xl ml-4 disabled:opacity-20 disabled:cursor-not-allowed data-[active='1']:bg-teal-800 data-[active='1']:text-yellow-300","data-player-index":i[1],"data-action":"reveal",onClick:o,"data-active":e.playerResults[i[1]].isRevealed?"1":"0",disabled:e.playerResults[i[1]].isRiichi,children:"副露"}),u.jsx("button",{className:"px-1 py-1 bg-neutral-200 border rounded border-neutral-700 text-xl","data-player-index":i[1],"data-action":"ron-opposite",onClick:o,children:"↗和對家"}),u.jsx("button",{className:"px-1 py-1 bg-neutral-200 border rounded border-neutral-700 text-xl","data-player-index":i[1],"data-action":"ron-before",onClick:o,children:"↑和上家"}),u.jsx("button",{className:"px-1 py-1 bg-neutral-200 border rounded border-neutral-700 text-xl ml-4 disabled:opacity-20 disabled:cursor-not-allowed data-[active='1']:bg-red-800 data-[active='1']:text-yellow-300","data-player-index":i[1],"data-action":"riichi",onClick:o,"data-active":e.playerResults[i[1]].isRiichi?"1":"0",disabled:e.playerResults[i[1]].isRevealed,children:"立直"})]})})})]})}),u.jsx("table",{className:"w-full border border-black",children:u.jsxs("tbody",{children:[u.jsx("tr",{children:u.jsx("td",{className:"whitespace-nowrap",colSpan:2,children:u.jsxs("div",{className:" grid grid-cols-3 gap-2 justify-center",children:[u.jsx("button",{className:"px-1 py-1 bg-neutral-200 border rounded border-neutral-700 text-xl mr-4 disabled:opacity-20 disabled:cursor-not-allowed data-[active='1']:bg-red-800 data-[active='1']:text-yellow-300","data-player-index":i[2],"data-action":"riichi",onClick:o,"data-active":e.playerResults[i[2]].isRiichi?"1":"0",disabled:e.playerResults[i[2]].isRevealed,children:"立直"}),u.jsx("button",{className:"px-1 py-1 bg-neutral-200 border rounded border-neutral-700 text-xl","data-player-index":i[2],"data-action":"ron-before",onClick:o,children:"和上家↓"}),u.jsx("button",{className:"px-1 py-1 bg-neutral-200 border rounded border-neutral-700 text-xl","data-player-index":i[2],"data-action":"ron-opposite",onClick:o,children:"和對家↙"}),u.jsx("button",{className:"px-1 py-1 bg-neutral-200 border rounded border-neutral-700 text-xl mr-4 disabled:opacity-20 disabled:cursor-not-allowed data-[active='1']:bg-teal-800 data-[active='1']:text-yellow-300","data-player-index":i[2],"data-action":"reveal",onClick:o,"data-active":e.playerResults[i[2]].isRevealed?"1":"0",disabled:e.playerResults[i[2]].isRiichi,children:"副露"}),u.jsx("button",{className:"px-1 py-1 bg-neutral-200 border rounded border-neutral-700 text-xl","data-player-index":i[2],"data-action":"ron-self",onClick:o,children:"自摸"}),u.jsx("button",{className:"px-1 py-1 bg-neutral-200 border rounded border-neutral-700 text-xl","data-player-index":i[2],"data-action":"ron-after",onClick:o,children:"和下家←"})]})})}),u.jsxs("tr",{children:[u.jsx("td",{className:"w-full px-2",children:u.jsx("span",{children:"役"})}),u.jsx("td",{className:"w-0 text-right whitespace-nowrap px-4 pt-4",children:u.jsxs("div",{children:[u.jsxs("div",{className:"data-[active='1']:bg-yellow-200","data-active":e.playerResults[i[2]].detail.dora>0?"1":"0",children:[u.jsx("button",{className:"px-2 text-lg leading-0","data-player-index":i[2],"data-action":"dora-normal-minus",onClick:o,children:"-"}),"寶",e.playerResults[i[2]].detail.dora,u.jsx("button",{className:"px-2 text-lg leading-0","data-player-index":i[2],"data-action":"dora-normal-plus",onClick:o,children:"+"})]}),u.jsxs("div",{className:"data-[active='1']:bg-red-200","data-active":e.playerResults[i[2]].detail.redDora>0?"1":"0",children:[u.jsx("button",{className:"px-2 text-lg leading-0","data-player-index":i[2],"data-action":"dora-red-minus",onClick:o,children:"-"}),"赤",e.playerResults[i[2]].detail.redDora??0,u.jsx("button",{className:"px-2 text-lg leading-0","data-player-index":i[2],"data-action":"dora-red-plus",onClick:o,children:"+"})]})]})})]}),u.jsx("tr",{children:u.jsx("td",{className:"w-1/2 px-2 h-16",colSpan:2,children:u.jsxs("button",{className:"py-2 text-left block","data-player-index":i[2],"data-action":"waitingTile",onClick:o,children:[u.jsx("span",{className:"mr-2 text-xl",children:"待牌"}),u.jsx("div",{className:"inline-block space-x-1",children:(d=e.playerResults[i[2]].waitingTiles)==null?void 0:d.map(f=>u.jsx(Ur,{className:"inline-block align-middle w-8 animate-[fadeInFromLeft_1s_ease-in-out]",children:f},f))})]})})}),u.jsxs("tr",{children:[u.jsxs("td",{className:"p-1 space-x-1 text-white",style:{background:t[i[2]].color},children:[u.jsx("img",{className:"w-8 h-8 inline-block",src:t[i[2]].teamPicUrl,alt:t[i[2]].title}),u.jsx("img",{className:"w-[1.44rem] h-8 inline-block",src:t[i[2]].proPicUrl,alt:t[i[2]].name}),u.jsxs("div",{className:"inline-block align-middle",children:[u.jsx("p",{children:t[i[2]].title}),u.jsx("p",{children:t[i[2]].name})]})]}),u.jsx("td",{className:"p-1 space-x-1 text-white text-4xl text-right pr-2",style:{background:t[i[2]].color},children:e.playerResults[i[2]].afterScore})]})]})}),u.jsx("table",{className:"w-full border border-black",children:u.jsxs("tbody",{children:[u.jsx("tr",{children:u.jsx("td",{className:"whitespace-nowrap",colSpan:2,children:u.jsxs("div",{className:" grid grid-cols-3 gap-2 justify-center",children:[u.jsx("button",{className:"px-1 py-1 bg-neutral-200 border rounded border-neutral-700 text-xl","data-player-index":i[3],"data-action":"ron-opposite",onClick:o,children:"↘和對家"}),u.jsx("button",{className:"px-1 py-1 bg-neutral-200 border rounded border-neutral-700 text-xl","data-player-index":i[3],"data-action":"ron-after",onClick:o,children:"↓和下家"}),u.jsx("button",{className:"px-1 py-1 bg-neutral-200 border rounded border-neutral-700 text-xl ml-4 disabled:opacity-20 disabled:cursor-not-allowed data-[active='1']:bg-red-800 data-[active='1']:text-yellow-300","data-player-index":i[3],"data-action":"riichi",onClick:o,"data-active":e.playerResults[i[3]].isRiichi?"1":"0",disabled:e.playerResults[i[3]].isRevealed,children:"立直"}),u.jsx("button",{className:"px-1 py-1 bg-neutral-200 border rounded border-neutral-700 text-xl","data-player-index":i[3],"data-action":"ron-before",onClick:o,children:"→和上家"}),u.jsx("button",{className:"px-1 py-1 bg-neutral-200 border rounded border-neutral-700 text-xl","data-player-index":i[3],"data-action":"ron-self",onClick:o,children:"自摸"}),u.jsx("button",{className:"px-1 py-1 bg-neutral-200 border rounded border-neutral-700 text-xl ml-4 disabled:opacity-20 disabled:cursor-not-allowed data-[active='1']:bg-teal-800 data-[active='1']:text-yellow-300","data-player-index":i[3],"data-action":"reveal",onClick:o,"data-active":e.playerResults[i[3]].isRevealed?"1":"0",disabled:e.playerResults[i[3]].isRiichi,children:"副露"})]})})}),u.jsxs("tr",{children:[u.jsx("td",{className:"w-full px-2",children:u.jsx("span",{children:"役"})}),u.jsx("td",{className:"w-0 text-right whitespace-nowrap px-4 pt-4",children:u.jsxs("div",{children:[u.jsxs("div",{className:"data-[active='1']:bg-yellow-200","data-active":e.playerResults[i[3]].detail.dora>0?"1":"0",children:[u.jsx("button",{className:"px-2 text-lg leading-0","data-player-index":i[3],"data-action":"dora-normal-minus",onClick:o,children:"-"}),"寶",e.playerResults[i[3]].detail.dora,u.jsx("button",{className:"px-2 text-lg leading-0","data-player-index":i[3],"data-action":"dora-normal-plus",onClick:o,children:"+"})]}),u.jsxs("div",{className:"data-[active='1']:bg-red-200","data-active":e.playerResults[i[3]].detail.redDora>0?"1":"0",children:[u.jsx("button",{className:"px-2 text-lg leading-0","data-player-index":i[3],"data-action":"dora-red-minus",onClick:o,children:"-"}),"赤",e.playerResults[i[3]].detail.redDora,u.jsx("button",{className:"px-2 text-lg leading-0","data-player-index":i[3],"data-action":"dora-red-plus",onClick:o,children:"+"})]})]})})]}),u.jsx("tr",{children:u.jsx("td",{className:"w-1/2 px-2 h-16",colSpan:2,children:u.jsxs("button",{className:"py-2 text-left block","data-player-index":i[3],"data-action":"waitingTile",onClick:o,children:[u.jsx("span",{className:"mr-2 text-xl",children:"待牌"}),u.jsx("div",{className:"inline-block space-x-1",children:(h=e.playerResults[i[3]].waitingTiles)==null?void 0:h.map(f=>u.jsx(Ur,{className:"inline-block align-middle w-8 animate-[fadeInFromLeft_1s_ease-in-out]",children:f},f))})]})})}),u.jsxs("tr",{children:[u.jsxs("td",{className:"p-1 space-x-1 text-white",style:{background:t[i[3]].color},children:[u.jsx("img",{className:"w-8 h-8 inline-block",src:t[i[3]].teamPicUrl,alt:t[i[3]].title}),u.jsx("img",{className:"w-[1.44rem] h-8 inline-block",src:t[i[3]].proPicUrl,alt:t[i[3]].name}),u.jsxs("div",{className:"inline-block align-middle",children:[u.jsx("p",{children:t[i[3]].title}),u.jsx("p",{children:t[i[3]].name})]})]}),u.jsx("td",{className:"p-1 space-x-1 text-white text-4xl text-right pr-2",style:{background:t[i[3]].color},children:e.playerResults[i[3]].afterScore})]})]})})]})]})},OY=({tabs:t,onChangeValue:e,defaultValue:n})=>{const[r,s]=x.useState(n),i=x.useCallback(o=>{const a=o.currentTarget.getAttribute("data-value");s(a),e==null||e(a)},[e]);return u.jsx("div",{className:"border-b border-neutral-400",children:t.map(o=>u.jsx("button",{className:"py-2 px-4 border-b-2 border-transparent hover:bg-neutral-200 rounded-t data-[active='1']:border-teal-600 data-[active='1']:text-teal-800 data-[active='1']:bg-teal-100","data-value":o.value,"data-active":r===o.value?"1":"0",onClick:i,children:o.label},o.value))})},y_=[{label:u.jsxs("span",{children:[u.jsx("i",{className:"bi bi-hdd-stack-fill"})," 列表(舊版)"]}),value:"listView-old"},{label:u.jsxs("span",{children:[u.jsx("i",{className:"bi bi-hdd-stack-fill"})," 列表(新版)"]}),value:"listView-new"},{label:u.jsxs("span",{children:[u.jsx("i",{className:"bi-grid-fill"})," 2x2"]}),value:"gridView"}];function OD({params:{matchId:t}}){const{data:e,set:n}=Mn("obs/1"),{data:r}=pE({queryKey:["matches",t],queryFn:({queryKey:b})=>sD(b[1])}),{match:s,matchRounds:i,matchCurrentRound:o,matchCurrentRoundDoras:a,updateCurrentMatchRound:l,pushMatchRound:c,setCurrentRoundDoras:d,setMatchName:h,setMatchPointDisplay:f,setMatchActiveResultDetail:p,setMatchRoundHasBroadcastedToTrue:y}=Is(t),v=x.useMemo(()=>Object.entries(i??{}).filter(([,b])=>!!b.resultDetail).map(([b,B])=>({id:b,...B})).reverse()??[],[i]),_=x.useMemo(()=>v.filter(({hasBroadcasted:b})=>!b),[v]),[g,m]=x.useState(void 0),[w,E]=x.useState(y_[0].value),[T,C]=vi(!1),[I,k]=x.useState({initialActivePlayerIndex:"0",initialTargetPlayerIndex:"-1"}),O=UK(),[L,j]=vi(!1),[P,D]=vi(!1),[te,G]=x.useState(null),Ge=x.useCallback(b=>{const B=b.currentTarget.getAttribute("data-player-index");if(!B)return;const ie=s==null?void 0:s.players[B];if(!ie)return;const at=!(o!=null&&o.playerResults[B].isRiichi);O.showConfirmDialog({title:at?"確定要立直嗎？":"取消立直？",content:at?`一旦點擊確定，就會播出立直動畫，請確定立直的是 ${ie.name}！`:`你是否想取消 ${ie.name} 的立直？`,onClickOk:async()=>{l({playerResults:{...o==null?void 0:o.playerResults,[B]:{...o==null?void 0:o.playerResults[B],isRiichi:!(o!=null&&o.playerResults[B].isRiichi)}}})}})},[O,s==null?void 0:s.players,o==null?void 0:o.playerResults,l]),ct=x.useCallback(b=>{var ie;const B=parseInt((ie=b.currentTarget)==null?void 0:ie.getAttribute("data-index"),10);typeof B<"u"&&!Number.isNaN(B)&&m(B)},[]),z=x.useCallback(b=>{if(typeof g<"u"){const B=b[0];if(!B)return;const ie=[...a];g===-1?ie.push(B):ie[g]=B,d(ie),m(void 0)}},[g,a,d]),Z=x.useCallback(()=>{if(typeof g<"u"){const b=[...a];g>-1&&(b.splice(g,1),d(b),m(void 0))}},[g,a,d]),K=x.useCallback(()=>{m(void 0)},[]),de=x.useCallback(b=>{const B=b==null?void 0:b.currentTarget.getAttribute("data-player-index");B&&(k({initialActivePlayerIndex:B}),C())},[C]),Qe=x.useCallback(()=>{j(!0)},[j]),ss=x.useCallback(()=>{D(!0)},[D]),Bn=x.useCallback((b,B)=>{if(console.log(b,B),!s||!o)return;const ie=s.players[b],at=o.playerResults[b];switch(B){case"reveal":return l({playerResults:{...o.playerResults,[b]:{...o.playerResults[b],isRevealed:!o.playerResults[b].isRevealed,detail:{...o.playerResults[b].detail,isRevealed:!o.playerResults[b].isRevealed}}}});case"riichi":return O.showConfirmDialog({title:at.isRiichi?"取消立直？":"確定要立直嗎？",content:at.isRiichi?`你是否想取消 ${ie.name} 的立直？`:`一旦點擊確定，就會播出立直動畫，請確定立直的是 ${ie.name}！`,onClickOk:async()=>{l({playerResults:{...o==null?void 0:o.playerResults,[b]:{...o==null?void 0:o.playerResults[b],isRiichi:!(o!=null&&o.playerResults[b].isRiichi),detail:{...o.playerResults[b].detail,isRiichied:!o.playerResults[b].isRiichi,raw:{...o.playerResults[b].detail.raw,riichi:!o.playerResults[b].isRiichi}}}}}),at.isRiichi||(G("立直動畫"),setTimeout(()=>{G(null)},2e3))}});case"ron-self":l({playerResults:{...o==null?void 0:o.playerResults,[b]:{...o==null?void 0:o.playerResults[b],detail:{...o.playerResults[b].detail,raw:{...o.playerResults[b].detail.raw,"menzenchin-tsumohou":!(o!=null&&o.playerResults[b].detail.isRevealed)}}}}}),k({initialActivePlayerIndex:b,initialTargetPlayerIndex:"-1"}),C();return;case"ron-before":l({playerResults:{...o==null?void 0:o.playerResults,[b]:{...o==null?void 0:o.playerResults[b],detail:{...o.playerResults[b].detail,raw:{...o.playerResults[b].detail.raw,"menzenchin-tsumohou":!1}}}}}),k({initialActivePlayerIndex:b,initialTargetPlayerIndex:dD(b)}),C();return;case"ron-after":l({playerResults:{...o==null?void 0:o.playerResults,[b]:{...o==null?void 0:o.playerResults[b],detail:{...o.playerResults[b].detail,raw:{...o.playerResults[b].detail.raw,"menzenchin-tsumohou":!1}}}}}),k({initialActivePlayerIndex:b,initialTargetPlayerIndex:hD(b)}),C();return;case"ron-opposite":l({playerResults:{...o==null?void 0:o.playerResults,[b]:{...o==null?void 0:o.playerResults[b],detail:{...o.playerResults[b].detail,raw:{...o.playerResults[b].detail.raw,"menzenchin-tsumohou":!1}}}}}),k({initialActivePlayerIndex:b,initialTargetPlayerIndex:fD(b)}),C();return;case"dora-normal-plus":return l({playerResults:{...o.playerResults,[b]:{...o.playerResults[b],detail:{...o.playerResults[b].detail,dora:o.playerResults[b].detail.dora+1}}}});case"dora-normal-minus":return l({playerResults:{...o.playerResults,[b]:{...o.playerResults[b],detail:{...o.playerResults[b].detail,dora:Math.max(o.playerResults[b].detail.dora-1,0)}}}});case"dora-red-plus":return l({playerResults:{...o.playerResults,[b]:{...o.playerResults[b],detail:{...o.playerResults[b].detail,redDora:o.playerResults[b].detail.redDora+1}}}});case"dora-red-minus":return l({playerResults:{...o.playerResults,[b]:{...o.playerResults[b],detail:{...o.playerResults[b].detail,redDora:Math.max(o.playerResults[b].detail.redDora-1,0)}}}});case"waitingTile":return Vi({index:b,tiles:(o==null?void 0:o.playerResults[b].waitingTiles)??[]});case"yaku":return Fh({index:b});case"yellow-card":return O.showConfirmDialog({title:at.isYellowCarded?"取消黃牌？":"確定要給予這名玩家黃牌嗎？",content:at.isYellowCarded?`你是否想取消 ${ie.name} 的黃牌？`:`一旦點擊確定，就會播出黃牌動畫，請確定要黃牌的是 ${ie.name}！`,onClickOk:async()=>{l({playerResults:{...o==null?void 0:o.playerResults,[b]:{...o==null?void 0:o.playerResults[b],isYellowCarded:!(o!=null&&o.playerResults[b].isYellowCarded)}}})}});case"red-card":return O.showConfirmDialog({title:at.isRedCarded?"取消紅牌？":"確定要給予這名玩家紅牌嗎？",content:at.isRedCarded?`你是否想取消 ${ie.name} 的紅牌？`:`一旦點擊確定，就會播出紅牌動畫，請確定要紅牌的是 ${ie.name}！`,onClickOk:async()=>{l({playerResults:{...o==null?void 0:o.playerResults,[b]:{...o==null?void 0:o.playerResults[b],isRedCarded:!(o!=null&&o.playerResults[b].isRedCarded)}}})}})}},[O,s,o,C,l]),Rs=x.useCallback(b=>{try{const B=zT(b.roundCount),ie=b.playerResults[B].type===ut.Win,at=!ie&&b.roundCount>=8;at&&alert("對局結束。"),l({...b,nextRoundType:at?Ue.End:ie?Ue.Extended:Ue.NextRound}),C(!1),G("分數變動中…"),setTimeout(()=>{G(null)},4e3)}catch(B){console.error(B)}},[C,l]),ar=x.useCallback(b=>{try{const B=zT(b.roundCount),ie=b.playerResults[B].type!==ut.Win,at=ie&&b.roundCount>=8;at&&alert("對局結束。"),l({...b,nextRoundType:at?Ue.End:ie?Ue.NextRoundAndExtended:Ue.Extended}),j(!1),G("分數變動中…"),setTimeout(()=>{G(null)},4e3)}catch(B){console.error(B)}},[j,l]),kr=x.useCallback(b=>{try{l({playerResults:b.playerResults,resultType:rt.Hotfix});const B={matchId:t,code:qy(t,b.roundCount,b.extendedRoundCount),roundCount:b.roundCount,extendedRoundCount:b.extendedRoundCount,cumulatedThousands:b.cumulatedThousands,nextRoundCumulatedThousands:0,resultType:rt.Unknown,nextRoundType:Ue.Unknown,playerResults:WT(b.playerResults),doras:(o==null?void 0:o.doras)??[]};c(B),G("分數變動中…"),setTimeout(()=>{G(null)},4e3),D(!1)}catch(B){console.error(B)}},[o==null?void 0:o.doras,t,c,D,l]),Iu=x.useCallback(()=>{if(!o)return;const b=o.nextRoundType===Ue.NextRound||o.nextRoundType===Ue.NextRoundAndExtended?o.roundCount+1:o.roundCount,B=o.nextRoundType===Ue.Extended||o.nextRoundType===Ue.NextRoundAndExtended?o.extendedRoundCount+1:0,ie={matchId:t,code:qy(t,b,B),roundCount:b,extendedRoundCount:B,cumulatedThousands:o.nextRoundCumulatedThousands,nextRoundCumulatedThousands:0,resultType:rt.Unknown,nextRoundType:Ue.Unknown,playerResults:WT(o.playerResults),doras:{}};c(ie)},[o,t,c]),ku=x.useCallback(()=>{n({matchId:t})},[t,n]),[cn,Vi]=x.useState(null),jh=x.useCallback(b=>{const B=b.currentTarget.getAttribute("data-player-index");typeof B>"u"||!(o!=null&&o.playerResults[B])||Vi({index:B,tiles:(o==null?void 0:o.playerResults[B].waitingTiles)??[]})},[o==null?void 0:o.playerResults]),Dg=x.useCallback(()=>{Vi(null)},[]),Oh=x.useCallback(b=>{cn&&(l({playerResults:{...o==null?void 0:o.playerResults,[cn.index]:{...o==null?void 0:o.playerResults[cn.index],waitingTiles:b}}}),Vi(null))},[cn,o==null?void 0:o.playerResults,l]),Dh=x.useCallback(()=>{cn&&(l({playerResults:{...o==null?void 0:o.playerResults,[cn.index]:{...o==null?void 0:o.playerResults[cn.index],waitingTiles:[]}}}),Vi(null))},[cn,o==null?void 0:o.playerResults,l]),[Rn,Fh]=x.useState(null),Ib=x.useCallback(()=>{Fh(null)},[]),S=x.useCallback(b=>{!o||!Rn||(l({playerResults:{...o.playerResults,[Rn.index]:{...o.playerResults[Rn.index],detail:{...o.playerResults[Rn.index].detail,...b}}}}),Fh(null))},[Rn,o,l]),R=x.useCallback(b=>{if(b.preventDefault(),!s)return;const B=prompt("對局名稱",s.name);B&&h(B)},[s,h]),N=x.useCallback(b=>{if(!i)return;const B=b.currentTarget.getAttribute("data-match-round-id");if(!B)return;const ie=i[B].resultDetail;ie&&(p(ie),y(B),G("播放和牌中…"),setTimeout(()=>{p(null),G(null)},2e4))},[i,p,y]),J=x.useCallback(()=>{p(null)},[p]),q=x.useCallback(()=>{f(!0)},[f]),U=x.useCallback(()=>{f(!1)},[f]);return x.useEffect(()=>{a.length===0&&m(-1)},[a.length]),(!s||!o)&&r?u.jsx(RY,{dbMatch:r}):!s||!o?u.jsx("div",{children:"對局讀取失敗。"}):u.jsxs("div",{children:[u.jsxs("div",{className:"container mx-auto my-8 px-8 space-y-24 pb-32",children:[u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex flex-row items-center gap-x-4 text-white",children:[u.jsxs("div",{className:"p-2 pl-4 pr-10 flex items-center gap-x-8 transition-[width] text-[4rem]",style:{background:"linear-gradient(280deg, transparent, transparent 22px, #00000080 23px, #00000080 100%)"},children:[u.jsxs("div",{className:"text-[0.5em]",children:[u.jsx("div",{className:"text-[0.5em]",children:u.jsxs("button",{type:"button",onClick:R,children:[s.name," ",u.jsx("i",{className:"bi bi-pencil"})]})}),u.jsxs("div",{className:"flex gap-x-8 items-center",children:[u.jsx("div",{children:u.jsx(_r,{roundCount:o.roundCount,max:8})}),u.jsxs("div",{className:"flex flex-col justify-around",children:[u.jsxs("div",{className:"flex-1 flex flex-row items-center gap-x-3",children:[u.jsx("div",{className:"flex-1",children:u.jsx("img",{src:"/images/score-hundred.png",alt:"hundred",className:"h-2"})}),u.jsx("div",{className:"text-[0.4em] pb-1.5 leading-none",children:o.extendedRoundCount??0})]}),u.jsxs("div",{className:"flex-1 flex flex-row items-center gap-x-3",children:[u.jsx("div",{className:"flex-1",children:u.jsx("img",{src:"/images/score-thousand.png",alt:"thousand",className:"h-2"})}),u.jsx("div",{className:"text-[0.4em] pb-1.5 leading-none",children:o.cumulatedThousands??0})]})]})]})]}),u.jsxs("div",{className:"flex items-center gap-x-2",children:[a.map((b,B)=>u.jsx("button",{"data-index":B,onClick:ct,className:"hover:opacity-80",children:u.jsx(Ur,{className:"w-12 animate-[fadeInFromLeft_0.5s_ease-in-out]",children:b},b)})),u.jsx(ke,{type:"button",color:a.length===0?"danger":"secondary",className:`${a.length===0&&"animate-bounce"}`,"data-index":"-1",onClick:ct,children:"+懸賞"})]})]}),u.jsx("div",{className:"flex-1"}),u.jsx("div",{className:"shrink-0",children:(e==null?void 0:e.matchId)!==t&&u.jsx(ke,{color:"success",type:"button",className:"animate-pulse",onClick:ku,children:"開始OBS"})})]}),u.jsxs("div",{className:"flex justify-between gap-x-8 ",children:[u.jsx("div",{className:"flex-1",children:u.jsx(OY,{tabs:y_,defaultValue:y_[0].value,onChangeValue:E})}),u.jsxs("div",{className:"text-right space-x-4",children:[s.activeResultDetail&&u.jsxs(ke,{color:"secondary",type:"button",onClick:J,children:["結束播放中的和牌詳情",u.jsx("br",{}),u.jsx("span",{className:"text-xs",children:"(或最多20秒後自動結束)"})]}),o.nextRoundType!==Ue.Unknown&&o.nextRoundType!==Ue.End&&u.jsxs(ke,{color:"success",type:"button",className:"animate-pulse",onClick:Iu,children:["進入",u.jsx(_r,{roundCount:o.nextRoundType===Ue.NextRound||o.nextRoundType===Ue.NextRoundAndExtended?o.roundCount+1:o.roundCount,extendedRoundCount:o.nextRoundType===Ue.Extended||o.nextRoundType===Ue.NextRoundAndExtended?o.extendedRoundCount+1:0})]}),u.jsx(ke,{color:"secondary",type:"button",onClick:Qe,children:"流局"})]})]}),w==="listView-old"&&u.jsx("div",{className:"space-y-4",children:["0","1","2","3"].map(b=>u.jsxs("div",{className:"flex gap-x-2 items-center",children:[u.jsx("div",{className:"flex-1 text-[2.5rem]",children:u.jsx(Ti,{player:s.players[b],playerIndex:b,score:o.playerResults[b].afterScore,scoreChanges:o.playerResults[b].scoreChanges,isEast:vr(b,o.roundCount),isRiichi:o.playerResults[b].isRiichi,waitingTiles:o.playerResults[b].waitingTiles,onClickWaitingTiles:jh,isYellowCarded:o.playerResults[b].isYellowCarded,isRedCarded:o.playerResults[b].isRedCarded})}),u.jsx("div",{children:u.jsx("button",{type:"button",className:`${o.playerResults[b].isRiichi?"bg-orange-600 text-white":"bg-white text-orange-600 opacity-30"} h-16 w-16 border-2 border-orange-600  rounded-full text-lg`,onClick:Ge,"data-player-index":b,children:o.playerResults[b].isRiichi?"已立直":"立直?"})}),u.jsx("div",{className:"pl-6",children:u.jsx(ke,{color:"danger",type:"button",onClick:de,"data-player-index":b,children:"和了"})})]}))}),w==="listView-new"&&u.jsx(PY,{players:s.players,currentRound:o,onAction:Bn}),w==="gridView"&&u.jsx(jY,{players:s.players,currentRound:o,onAction:Bn})]}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("h4",{className:"text-3xl",children:[u.jsx("i",{className:"bi bi-clock-history"})," 和牌記錄"]}),u.jsxs("table",{className:"data-table w-full",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"局數"}),u.jsx("th",{children:"玩家"}),u.jsx("th",{children:"分數＆細節"}),u.jsx("th",{className:"text-right px-2",children:"操作"})]})}),u.jsx("tbody",{children:v.map(b=>u.jsxs("tr",{className:"odd:bg-neutral-200",children:[u.jsx("td",{className:"text-center py-1",children:u.jsx(_r,{roundCount:b.roundCount,extendedRoundCount:b.extendedRoundCount})}),u.jsx("td",{className:"text-center py-1",style:{background:s.players[b.resultDetail.winnerPlayerIndex].color},children:s.players[b.resultDetail.winnerPlayerIndex].name}),u.jsxs("td",{className:"text-center py-1",children:[u.jsx("p",{children:b.resultDetail.yakus.map(({label:B})=>B).join(" ")}),u.jsx("p",{children:u.jsx(Hy,{han:b.resultDetail.han,fu:b.resultDetail.fu,yakumanCount:b.resultDetail.yakumanCount,isManganRoundUp:s.setting.isManganRoundUp==="1"})})]}),u.jsx("td",{className:"text-right py-1 px-2",children:u.jsxs(ke,{color:b.hasBroadcasted?"secondary":"danger",type:"button",className:b.hasBroadcasted?"opacity-50":"",onClick:N,"data-match-round-id":b.id,children:[u.jsx("i",{className:"bi bi-camera-reels"})," ",b.hasBroadcasted?"再次播放":"播放和牌詳情"]})})]},b.id))})]})]}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("h4",{className:"text-3xl",children:[u.jsx("i",{className:"bi bi-bar-chart-steps"})," 分數"," ",u.jsx("span",{className:"text-sm",children:"( 立=立直, 和=和牌, 統=出統, 摸=自摸, 聽=聽牌 )"})]}),u.jsx(wu,{players:s.players,matchRounds:i??{},className:"w-full table-auto"})]})]}),u.jsx(nr,{open:typeof g<"u",title:"選擇懸賞",onClose:K,children:u.jsx(ZT,{hideRedTiles:!0,onSubmit:z,onRemove:Z,canRemove:typeof g<"u"&&g>0,defaultValue:typeof g<"u"?[a[g]]:void 0})}),u.jsx(nr,{open:!!cn,title:"選擇待牌",onClose:Dg,children:u.jsx(ZT,{hideRedTiles:!0,onSubmit:Oh,onRemove:Dh,defaultValue:cn==null?void 0:cn.tiles,multiple:!0,canRemove:!0})}),u.jsx(aY,{round:o.roundCount,activePlayerIndex:(Rn==null?void 0:Rn.index)??"0",targetPlayerIndex:"-1",open:!!Rn,onClose:Ib,onSubmit:S,defaultValue:o.playerResults[(Rn==null?void 0:Rn.index)??"0"].detail}),u.jsx(nr,{hideCloseButton:!0,open:o.nextRoundType!==Ue.Unknown&&o.nextRoundType!==Ue.End,children:u.jsxs("div",{className:"space-y-6 text-center",children:[u.jsxs("p",{children:["當準備好時，點擊按鈕進入下一局。",u.jsx("br",{}),"如果發現分數有誤需要修改，請在下一局開始後，點擊頁面最下方的「手動調整分數」。"]}),u.jsx("div",{children:u.jsxs(ke,{color:"success",type:"button",className:"text-xl",onClick:Iu,children:["進入",u.jsx(_r,{roundCount:o.nextRoundType===Ue.NextRound||o.nextRoundType===Ue.NextRoundAndExtended?o.roundCount+1:o.roundCount,extendedRoundCount:o.nextRoundType===Ue.Extended||o.nextRoundType===Ue.NextRoundAndExtended?o.extendedRoundCount+1:0})]})})]})}),u.jsx(lY,{match:s,currentMatchRound:o,open:T,onSubmit:Rs,onClose:()=>C(!1),...I}),u.jsx(dY,{match:s,currentMatchRound:o,open:L,onSubmit:ar,onClose:()=>j(!1),...I}),u.jsx(kY,{match:s,currentMatchRound:o,open:P,onSubmit:kr,onClose:()=>D(!1),...I}),u.jsxs("div",{className:"fixed bottom-0 left-0 right-0 pl-6 pr-6 pb-6 z-50 flex justify-between items-end bg-gradient-to-b from-transparent to-[#00000080]",children:[u.jsx("div",{className:"text-left",children:u.jsxs("button",{onClick:ss,className:"relative rounded-full py-2 px-4 shadow shadow-neutral-700 text-center bg-neutral-200 border border-neutral-300 leading-6 text-neutral-600",children:[u.jsx("i",{className:"bi bi-pencil"})," 手動調整分數"]})}),u.jsxs("div",{className:"flex gap-x-6 items-end",children:[!s.showPoints&&u.jsxs("button",{onClick:q,className:"relative rounded-full py-2 px-4 shadow shadow-neutral-700 text-center bg-neutral-200 border border-neutral-300 leading-6 text-neutral-600",children:[u.jsx("i",{className:"bi bi-list-ol"})," 切換播放馬點＆名次"]}),s.showPoints&&u.jsxs("button",{onClick:U,className:"relative rounded-full py-2 px-4 shadow shadow-neutral-700 text-center bg-green-300 border border-green-300 leading-6 text-green-800",children:[u.jsx("i",{className:"bi bi-list-ol"})," 切換播放馬點＆名次"]}),u.jsxs("button",{className:"relative rounded-full p-5 shadow shadow-neutral-700 text-center bg-neutral-200 border border-neutral-300 text-4xl leading-6 text-neutral-600",children:[te?u.jsxs("span",{children:[u.jsx("i",{className:"bi bi-hourglass-split"})," ",te]}):u.jsx("i",{className:"bi bi-camera-reels"}),_.length>0&&u.jsx("div",{className:"absolute h-6 w-6 -top-1 -left-1 shadow shadow-neutral-700 bg-red-600 text-white text-sm rounded-full font-semibold",children:_.length})]})]})]})]})}function ne(){return ne=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ne.apply(this,arguments)}function ks(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var Px=t=>/^#?([A-Fa-f0-9]{3,4}){1,2}$/.test(t),Ga=255,si=100,lc=t=>{var{r:e,g:n,b:r,a:s}=t,i=Math.max(e,n,r),o=i-Math.min(e,n,r),a=o?i===e?(n-r)/o:i===n?2+(r-e)/o:4+(e-n)/o:0;return{h:60*(a<0?a+6:a),s:i?o/i*si:0,v:i/Ga*si,a:s}},DD=t=>{var{h:e,s:n,l:r,a:s}=FD(t);return"hsla("+e+", "+n+"%, "+r+"%, "+s+")"},FD=t=>{var{h:e,s:n,v:r,a:s}=t,i=(200-n)*r/si;return{h:e,s:i>0&&i<200?n*r/si/(i<=si?i:200-i)*si:0,l:i/2,a:s}},$D=t=>{var{r:e,g:n,b:r}=t,s=e<<16|n<<8|r;return"#"+(i=>new Array(7-i.length).join("0")+i)(s.toString(16))},DY=t=>{var{r:e,g:n,b:r,a:s}=t,i=typeof s=="number"&&(s*255|256).toString(16).slice(1);return""+$D({r:e,g:n,b:r,a:s})+(i||"")},gd=t=>lc(FY(t)),FY=t=>{var e=t.replace("#","");/^#?/.test(t)&&e.length===3&&(t="#"+e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2));var n=new RegExp("[A-Za-z0-9]{2}","g"),[r,s,i=0,o]=t.match(n).map(a=>parseInt(a,16));return{r,g:s,b:i,a:(o??255)/Ga}},ig=t=>{var{h:e,s:n,v:r,a:s}=t,i=e/60,o=n/si,a=r/si,l=Math.floor(i)%6,c=i-Math.floor(i),d=Ga*a*(1-o),h=Ga*a*(1-o*c),f=Ga*a*(1-o*(1-c));a*=Ga;var p={};switch(l){case 0:p.r=a,p.g=f,p.b=d;break;case 1:p.r=h,p.g=a,p.b=d;break;case 2:p.r=d,p.g=a,p.b=f;break;case 3:p.r=d,p.g=h,p.b=a;break;case 4:p.r=f,p.g=d,p.b=a;break;case 5:p.r=a,p.g=d,p.b=h;break}return p.r=Math.round(p.r),p.g=Math.round(p.g),p.b=Math.round(p.b),ne({},p,{a:s})},$Y=t=>{var{r:e,g:n,b:r,a:s}=ig(t);return"rgba("+e+", "+n+", "+r+", "+s+")"},MY=t=>{var{r:e,g:n,b:r}=t;return{r:e,g:n,b:r}},LY=t=>{var{h:e,s:n,l:r}=t;return{h:e,s:n,l:r}},Nx=t=>$D(ig(t)),VY=t=>{var{h:e,s:n,v:r}=t;return{h:e,s:n,v:r}},Qa=t=>{var e,n,r,s,i,o,a,l;return typeof t=="string"&&Px(t)?(o=gd(t),a=t):typeof t!="string"&&(o=t),o&&(r=VY(o),i=FD(o),s=ig(o),l=DY(s),a=Nx(o),n=LY(i),e=MY(s)),{rgb:e,hsl:n,hsv:r,rgba:s,hsla:i,hsva:o,hex:a,hexa:l}};function lI(t){var e=x.useRef(t);return x.useEffect(()=>{e.current=t}),x.useCallback((n,r)=>e.current&&e.current(n,r),[])}var Oc=t=>"touches"in t,uI=t=>{!Oc(t)&&t.preventDefault&&t.preventDefault()},cI=function(e,n,r){return n===void 0&&(n=0),r===void 0&&(r=1),e>r?r:e<n?n:e},dI=(t,e)=>{var n=t.getBoundingClientRect(),r=Oc(e)?e.touches[0]:e;return{left:cI((r.pageX-(n.left+window.pageXOffset))/n.width),top:cI((r.pageY-(n.top+window.pageYOffset))/n.height),width:n.width,height:n.height,x:r.pageX-(n.left+window.pageXOffset),y:r.pageY-(n.top+window.pageYOffset)}},UY=["prefixCls","className","onMove","onDown"],MD=me.forwardRef((t,e)=>{var{prefixCls:n="w-color-interactive",className:r,onMove:s,onDown:i}=t,o=ks(t,UY),a=x.useRef(null),l=x.useRef(!1),[c,d]=x.useState(!1),h=lI(s),f=lI(i),p=m=>l.current&&!Oc(m)?!1:(l.current=Oc(m),!0),y=x.useCallback(m=>{uI(m);var w=Oc(m)?m.touches.length>0:m.buttons>0;w&&a.current?h&&h(dI(a.current,m),m):d(!1)},[h]),v=x.useCallback(()=>d(!1),[]),_=x.useCallback(m=>{var w=m?window.addEventListener:window.removeEventListener;w(l.current?"touchmove":"mousemove",y),w(l.current?"touchend":"mouseup",v)},[]);x.useEffect(()=>(_(c),()=>{c&&_(!1)}),[c,_]);var g=x.useCallback(m=>{uI(m.nativeEvent),p(m.nativeEvent)&&(f&&f(dI(a.current,m.nativeEvent),m.nativeEvent),d(!0))},[f]);return u.jsx("div",ne({},o,{className:[n,r||""].filter(Boolean).join(" "),style:ne({},o.style,{touchAction:"none"}),ref:a,tabIndex:0,onMouseDown:g,onTouchStart:g}))});MD.displayName="Interactive";const LD=MD;var BY=t=>{var{className:e,color:n,left:r,top:s,prefixCls:i}=t,o={position:"absolute",top:s,left:r},a={"--saturation-pointer-box-shadow":"rgb(255 255 255) 0px 0px 0px 1.5px, rgb(0 0 0 / 30%) 0px 0px 1px 1px inset, rgb(0 0 0 / 40%) 0px 0px 1px 2px",width:6,height:6,transform:"translate(-3px, -3px)",boxShadow:"var(--saturation-pointer-box-shadow)",borderRadius:"50%",backgroundColor:n};return x.useMemo(()=>u.jsx("div",{className:i+"-pointer "+(e||""),style:o,children:u.jsx("div",{className:i+"-fill",style:a})}),[s,r,n,e,i])},zY=["prefixCls","radius","pointer","className","hue","style","hsva","onChange"],VD=me.forwardRef((t,e)=>{var n,{prefixCls:r="w-color-saturation",radius:s=0,pointer:i,className:o,hue:a=0,style:l,hsva:c,onChange:d}=t,h=ks(t,zY),f=ne({width:200,height:200,borderRadius:s},l,{position:"relative"}),p=(v,_)=>{d&&c&&d({h:c.h,s:v.left*100,v:(1-v.top)*100,a:c.a})},y=x.useMemo(()=>{if(!c)return null;var v={top:100-c.v+"%",left:c.s+"%",color:DD(c)};return i&&typeof i=="function"?i(ne({prefixCls:r},v)):u.jsx(BY,ne({prefixCls:r},v))},[c,i,r]);return u.jsx(LD,ne({className:[r,o||""].filter(Boolean).join(" ")},h,{style:ne({position:"absolute",inset:0,cursor:"crosshair",backgroundImage:"linear-gradient(0deg, #000, transparent), linear-gradient(90deg, #fff, hsl("+((n=c==null?void 0:c.h)!=null?n:a)+", 100%, 50%))"},f),ref:e,onMove:p,onDown:p,children:y}))});VD.displayName="Saturation";const WY=VD;var qY=["className","prefixCls","left","top","style","fillProps"],HY=t=>{var{className:e,prefixCls:n,left:r,top:s,style:i,fillProps:o}=t,a=ks(t,qY),l=ne({},i,{position:"absolute",left:r,top:s}),c=ne({width:18,height:18,boxShadow:"var(--alpha-pointer-box-shadow)",borderRadius:"50%",backgroundColor:"var(--alpha-pointer-background-color)"},o==null?void 0:o.style,{transform:r?"translate(-9px, -1px)":"translate(-1px, -9px)"});return u.jsx("div",ne({className:n+"-pointer "+(e||""),style:l},a,{children:u.jsx("div",ne({className:n+"-fill"},o,{style:c}))}))},GY=["prefixCls","className","hsva","background","bgProps","innerProps","pointerProps","radius","width","height","direction","style","onChange","pointer"],QY="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAMUlEQVQ4T2NkYGAQYcAP3uCTZhw1gGGYhAGBZIA/nYDCgBDAm9BGDWAAJyRCgLaBCAAgXwixzAS0pgAAAABJRU5ErkJggg==",UD=me.forwardRef((t,e)=>{var{prefixCls:n="w-color-alpha",className:r,hsva:s,background:i,bgProps:o={},innerProps:a={},pointerProps:l={},radius:c=0,width:d,height:h=16,direction:f="horizontal",style:p,onChange:y,pointer:v}=t,_=ks(t,GY),g=I=>{y&&y(ne({},s,{a:f==="horizontal"?I.left:I.top}),I)},m=DD(Object.assign({},s,{a:1})),w="linear-gradient(to "+(f==="horizontal"?"right":"bottom")+", rgba(244, 67, 54, 0) 0%, "+m+" 100%)",E={};f==="horizontal"?E.left=s.a*100+"%":E.top=s.a*100+"%";var T=ne({"--alpha-background-color":"#fff","--alpha-pointer-background-color":"rgb(248, 248, 248)","--alpha-pointer-box-shadow":"rgb(0 0 0 / 37%) 0px 1px 4px 0px",borderRadius:c,background:"url("+QY+") left center",backgroundColor:"var(--alpha-background-color)"},p,{position:"relative"},{width:d,height:h}),C=v&&typeof v=="function"?v(ne({prefixCls:n},l,E)):u.jsx(HY,ne({},l,{prefixCls:n},E));return u.jsxs("div",ne({},_,{className:[n,n+"-"+f,r||""].filter(Boolean).join(" "),style:T,ref:e,children:[u.jsx("div",ne({},o,{style:ne({inset:0,position:"absolute",background:i||w,borderRadius:c},o.style)})),u.jsx(LD,ne({},a,{style:ne({},a.style,{inset:0,zIndex:1,position:"absolute"}),onMove:g,onDown:g,children:C}))]}))});UD.displayName="Alpha";const jx=UD;var KY=["prefixCls","placement","label","value","className","style","labelStyle","inputStyle","onChange","onBlur"],YY=t=>/^#?([A-Fa-f0-9]{3,4}){1,2}$/.test(t),JY=t=>Number(String(t).replace(/%/g,"")),BD=me.forwardRef((t,e)=>{var{prefixCls:n="w-color-editable-input",placement:r="bottom",label:s,value:i,className:o,style:a,labelStyle:l,inputStyle:c,onChange:d,onBlur:h}=t,f=ks(t,KY),[p,y]=x.useState(i),v=x.useRef(!1);x.useEffect(()=>{t.value!==p&&(v.current||y(t.value))},[t.value]);function _(T,C){var I=(C||T.target.value).trim().replace(/^#/,"");YY(I)&&d&&d(T,I);var k=JY(I);isNaN(k)||d&&d(T,k),y(I)}function g(T){v.current=!1,y(t.value),h&&h(T)}var m={};r==="bottom"&&(m.flexDirection="column"),r==="top"&&(m.flexDirection="column-reverse"),r==="left"&&(m.flexDirection="row-reverse");var w=ne({"--editable-input-label-color":"rgb(153, 153, 153)","--editable-input-box-shadow":"rgb(204 204 204) 0px 0px 0px 1px inset","--editable-input-color":"#666",position:"relative",alignItems:"center",display:"flex",fontSize:11},m,a),E=ne({width:"100%",paddingTop:2,paddingBottom:2,paddingLeft:3,paddingRight:3,fontSize:11,background:"transparent",boxSizing:"border-box",border:"none",color:"var(--editable-input-color)",boxShadow:"var(--editable-input-box-shadow)"},c);return u.jsxs("div",{className:[n,o||""].filter(Boolean).join(" "),style:w,children:[u.jsx("input",ne({ref:e,value:p,onChange:_,onBlur:g,autoComplete:"off",onFocus:()=>v.current=!0},f,{style:E})),s&&u.jsx("span",{style:ne({color:"var(--editable-input-label-color)",textTransform:"capitalize"},l),children:s})]})});BD.displayName="EditableInput";const uc=BD;var XY=["prefixCls","hsva","placement","rProps","gProps","bProps","aProps","className","style","onChange"],zD=me.forwardRef((t,e)=>{var{prefixCls:n="w-color-editable-input-rgba",hsva:r,placement:s="bottom",rProps:i={},gProps:o={},bProps:a={},aProps:l={},className:c,style:d,onChange:h}=t,f=ks(t,XY),p=r?ig(r):{};function y(_){var g=Number(_.target.value);g&&g>255&&(_.target.value="255"),g&&g<0&&(_.target.value="0")}var v=(_,g,m)=>{typeof _=="number"&&(g==="a"&&(_<0&&(_=0),_>100&&(_=100),h&&h(Qa(lc(ne({},p,{a:_/100}))))),_>255&&(_=255,m.target.value="255"),_<0&&(_=0,m.target.value="0"),g==="r"&&h&&h(Qa(lc(ne({},p,{r:_})))),g==="g"&&h&&h(Qa(lc(ne({},p,{g:_})))),g==="b"&&h&&h(Qa(lc(ne({},p,{b:_})))))};return u.jsxs("div",ne({ref:e,className:[n,c||""].filter(Boolean).join(" ")},f,{style:ne({fontSize:11,display:"flex"},d),children:[u.jsx(uc,ne({label:"R",value:p.r||0,onBlur:y,placement:s,onChange:(_,g)=>v(g,"r",_)},i,{style:ne({},i.style)})),u.jsx(uc,ne({label:"G",value:p.g||0,onBlur:y,placement:s,onChange:(_,g)=>v(g,"g",_)},o,{style:ne({marginLeft:5},i.style)})),u.jsx(uc,ne({label:"B",value:p.b||0,onBlur:y,placement:s,onChange:(_,g)=>v(g,"b",_)},a,{style:ne({marginLeft:5},a.style)})),l&&u.jsx(uc,ne({label:"A",value:p.a?parseInt(String(p.a*100),10):0,onBlur:y,placement:s,onChange:(_,g)=>v(g,"a",_)},l,{style:ne({marginLeft:5},l.style)}))]}))});zD.displayName="EditableInputRGBA";const ZY=zD;var eJ=["prefixCls","className","hue","onChange","direction"],WD=me.forwardRef((t,e)=>{var{prefixCls:n="w-color-hue",className:r,hue:s=0,onChange:i,direction:o="horizontal"}=t,a=ks(t,eJ);return u.jsx(jx,ne({ref:e,className:n+" "+(r||"")},a,{direction:o,background:"linear-gradient(to "+(o==="horizontal"?"right":"bottom")+", rgb(255, 0, 0) 0%, rgb(255, 255, 0) 17%, rgb(0, 255, 0) 33%, rgb(0, 255, 255) 50%, rgb(0, 0, 255) 67%, rgb(255, 0, 255) 83%, rgb(255, 0, 0) 100%)",hsva:{h:s,s:100,v:100,a:s/360},onChange:(l,c)=>{i&&i({h:o==="horizontal"?360*c.left:360*c.top})}}))});WD.displayName="Hue";const tJ=WD;var nJ=["prefixCls","className","color","colors","style","rectProps","onChange","addonAfter","addonBefore","rectRender"],qD=me.forwardRef((t,e)=>{var{prefixCls:n="w-color-swatch",className:r,color:s,colors:i=[],style:o,rectProps:a={},onChange:l,addonAfter:c,addonBefore:d,rectRender:h}=t,f=ks(t,nJ),p=ne({"--swatch-background-color":"rgb(144, 19, 254)",background:"var(--swatch-background-color)",height:15,width:15,marginRight:5,marginBottom:5,cursor:"pointer",position:"relative",outline:"none",borderRadius:2},a.style),y=(v,_)=>{l&&l(gd(v),Qa(gd(v)),_)};return u.jsxs("div",ne({ref:e},f,{className:[n,r||""].filter(Boolean).join(" "),style:ne({display:"flex",flexWrap:"wrap",position:"relative"},o),children:[d&&me.isValidElement(d)&&d,i&&Array.isArray(i)&&i.map((v,_)=>{var g="",m="";typeof v=="string"&&(g=v,m=v),typeof v=="object"&&v.color&&(g=v.title||v.color,m=v.color);var w=s&&s.toLocaleLowerCase()===m.toLocaleLowerCase(),E=h&&h({key:_,title:g,color:m,checked:!!w,style:ne({},p,{background:m}),onClick:C=>y(m,C)});if(E)return E;var T=a.children&&me.isValidElement(a.children)?me.cloneElement(a.children,{color:m,checked:w}):null;return u.jsx("div",ne({tabIndex:0,title:g,onClick:C=>y(m,C)},a,{children:T,style:ne({},p,{background:m})}),_)}),c&&me.isValidElement(c)&&c]}))});qD.displayName="Swatch";const rJ=qD;var sJ=["prefixCls","className","onChange","width","presetColors","color","editableDisable","disableAlpha","style"],iJ=["#D0021B","#F5A623","#f8e61b","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF"],hI=t=>u.jsx("div",{style:{boxShadow:"rgb(0 0 0 / 60%) 0px 0px 2px",width:4,top:1,bottom:1,left:t.left,borderRadius:1,position:"absolute",backgroundColor:"#fff"}}),HD=me.forwardRef((t,e)=>{var{prefixCls:n="w-color-sketch",className:r,onChange:s,width:i=218,presetColors:o=iJ,color:a,editableDisable:l=!0,disableAlpha:c=!1,style:d}=t,h=ks(t,sJ),[f,p]=x.useState({h:209,s:36,v:90,a:1});x.useEffect(()=>{typeof a=="string"&&Px(a)&&p(gd(a)),typeof a=="object"&&p(a)},[a]);var y=C=>{p(C),s&&s(Qa(C))},v=(C,I)=>{typeof C=="string"&&Px(C)&&/(3|6)/.test(String(C.length))&&y(gd(C))},_=C=>y(ne({},f,{a:C.a})),g=C=>y(ne({},f,C,{a:f.a})),m=ne({"--sketch-background":"rgb(255, 255, 255)","--sketch-box-shadow":"rgb(0 0 0 / 15%) 0px 0px 0px 1px, rgb(0 0 0 / 15%) 0px 8px 16px","--sketch-swatch-box-shadow":"rgb(0 0 0 / 15%) 0px 0px 0px 1px inset","--sketch-alpha-box-shadow":"rgb(0 0 0 / 15%) 0px 0px 0px 1px inset, rgb(0 0 0 / 25%) 0px 0px 4px inset","--sketch-swatch-border-top":"1px solid rgb(238, 238, 238)",background:"var(--sketch-background)",borderRadius:4,boxShadow:"var(--sketch-box-shadow)",width:i},d),w={borderRadius:2,background:$Y(f),boxShadow:"var(--sketch-alpha-box-shadow)"},E={borderTop:"var(--sketch-swatch-border-top)",paddingTop:10,paddingLeft:10},T={marginRight:10,marginBottom:10,borderRadius:3,boxShadow:"var(--sketch-swatch-box-shadow)"};return u.jsxs("div",ne({},h,{className:n+" "+(r||""),ref:e,style:m,children:[u.jsxs("div",{style:{padding:"10px 10px 8px"},children:[u.jsx(WY,{hsva:f,style:{width:"auto",height:150},onChange:g}),u.jsxs("div",{style:{display:"flex",marginTop:4},children:[u.jsxs("div",{style:{flex:1},children:[u.jsx(tJ,{width:"auto",height:10,hue:f.h,pointer:hI,innerProps:{style:{marginLeft:1,marginRight:5}},onChange:C=>y(ne({},f,C))}),!c&&u.jsx(jx,{width:"auto",height:10,hsva:f,pointer:hI,style:{marginTop:4},innerProps:{style:{marginLeft:1,marginRight:5}},onChange:_})]}),!c&&u.jsx(jx,{width:24,height:24,hsva:f,radius:2,style:{marginLeft:4},bgProps:{style:{background:"transparent"}},innerProps:{style:w},pointer:()=>u.jsx(x.Fragment,{})})]})]}),l&&u.jsxs("div",{style:{display:"flex",margin:"0 10px 3px 10px"},children:[u.jsx(uc,{label:"Hex",value:Nx(f).replace(/^#/,"").toLocaleUpperCase(),onChange:(C,I)=>v(I),style:{minWidth:58}}),u.jsx(ZY,{hsva:f,style:{marginLeft:6},aProps:c?!1:{},onChange:C=>y(C.hsva)})]}),o&&o.length>0&&u.jsx(rJ,{style:E,colors:o,color:Nx(f),onChange:C=>y(C),rectProps:{style:T}})]}))});HD.displayName="Sketch";const oJ=HD;function GD({value:t,onChange:e,onBlur:n}){const r=x.useCallback(s=>{e==null||e(s.hex)},[e]);return u.jsx(oJ,{disableAlpha:!0,onChange:r,onBlur:n,color:t})}const aJ=async()=>new Promise(t=>{const e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","image/*"),e.addEventListener("change",n=>{var s;const r=(s=n.target.files)==null?void 0:s[0];r&&t(r)}),e.click()}),fI=({children:t,helperText:e,onChangeFile:n=async()=>{},...r})=>{const s=x.useMemo(()=>t||u.jsxs("div",{className:"space-y-2 text-center text-xs",children:[u.jsx("p",{children:u.jsx("i",{className:"bi bi-upload"})}),u.jsx("p",{children:"拖拉檔案上傳 ／ 點擊上傳"}),u.jsx("p",{children:e})]}),[t,e]),[{loading:i},o]=ng(n),a=x.useCallback(()=>{aJ().then(o)},[o]),l=x.useMemo(()=>({onFiles:d=>{const h=d.find(f=>!!f);h&&o(h)}}),[o]),[c]=YK(l);return u.jsxs("div",{className:"relative",children:[u.jsx("div",{...r,className:"bg-neutral-50 border border-neutral-200 border-dashed p-1 cursor-pointer hover:border-neutral-400 text-neutral-400",onClick:a,...c,children:s}),i&&u.jsx("div",{className:"absolute z-10 cursor-not-allowed inset-0 bg-neutral-300 text-white flex gap-x-1 items-center justify-center",children:u.jsx(EE,{})})]})};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QD="firebasestorage.googleapis.com",KD="storageBucket",lJ=2*60*1e3,uJ=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ot extends Jo{constructor(e,n,r=0){super(m_(e),`Firebase Storage: ${n} (${m_(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ot.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return m_(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var st;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(st||(st={}));function m_(t){return"storage/"+t}function kE(){const t="An unknown error occurred, please check the error payload for server response.";return new ot(st.UNKNOWN,t)}function cJ(t){return new ot(st.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function dJ(t){return new ot(st.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function hJ(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ot(st.UNAUTHENTICATED,t)}function fJ(){return new ot(st.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function pJ(t){return new ot(st.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function yJ(){return new ot(st.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function mJ(){return new ot(st.CANCELED,"User canceled the upload/download.")}function gJ(t){return new ot(st.INVALID_URL,"Invalid URL '"+t+"'.")}function vJ(t){return new ot(st.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function _J(){return new ot(st.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+KD+"' property when initializing the app?")}function xJ(){return new ot(st.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function wJ(){return new ot(st.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function EJ(t){return new ot(st.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Ox(t){return new ot(st.INVALID_ARGUMENT,t)}function YD(){return new ot(st.APP_DELETED,"The Firebase app was deleted.")}function bJ(t){return new ot(st.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Dc(t,e){return new ot(st.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Hu(t){throw new ot(st.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Dn.makeFromUrl(e,n)}catch{return new Dn(e,"")}if(r.path==="")return r;throw vJ(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(E){E.path.charAt(E.path.length-1)==="/"&&(E.path_=E.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),l={bucket:1,path:3};function c(E){E.path_=decodeURIComponent(E.path)}const d="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",p=new RegExp(`^https?://${h}/${d}/b/${s}/o${f}`,"i"),y={bucket:1,path:3},v=n===QD?"(?:storage.googleapis.com|storage.cloud.google.com)":n,_="([^?#]*)",g=new RegExp(`^https?://${v}/${s}/${_}`,"i"),w=[{regex:a,indices:l,postModify:i},{regex:p,indices:y,postModify:c},{regex:g,indices:{bucket:1,path:2},postModify:c}];for(let E=0;E<w.length;E++){const T=w[E],C=T.regex.exec(e);if(C){const I=C[T.indices.bucket];let k=C[T.indices.path];k||(k=""),r=new Dn(I,k),T.postModify(r);break}}if(r==null)throw gJ(e);return r}}class SJ{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CJ(t,e,n){let r=1,s=null,i=null,o=!1,a=0;function l(){return a===2}let c=!1;function d(..._){c||(c=!0,e.apply(null,_))}function h(_){s=setTimeout(()=>{s=null,t(p,l())},_)}function f(){i&&clearTimeout(i)}function p(_,...g){if(c){f();return}if(_){f(),d.call(null,_,...g);return}if(l()||o){f(),d.call(null,_,...g);return}r<64&&(r*=2);let w;a===1?(a=2,w=0):w=(r+Math.random())*1e3,h(w)}let y=!1;function v(_){y||(y=!0,f(),!c&&(s!==null?(_||(a=2),clearTimeout(s),h(0)):_||(a=1)))}return h(0),i=setTimeout(()=>{o=!0,v(!0)},n),v}function AJ(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TJ(t){return t!==void 0}function IJ(t){return typeof t=="object"&&!Array.isArray(t)}function RE(t){return typeof t=="string"||t instanceof String}function pI(t){return PE()&&t instanceof Blob}function PE(){return typeof Blob<"u"&&!nV()}function yI(t,e,n,r){if(r<e)throw Ox(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw Ox(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NE(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function JD(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var No;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(No||(No={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kJ(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RJ{constructor(e,n,r,s,i,o,a,l,c,d,h,f=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=d,this.connectionFactory_=h,this.retry=f,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,y)=>{this.resolve_=p,this.reject_=y,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new pf(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===No.NO_ERROR,l=i.getStatus();if(!a||kJ(l,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===No.ABORT;r(!1,new pf(!1,null,d));return}const c=this.successCodes_.indexOf(l)!==-1;r(!0,new pf(c,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());TJ(l)?i(l):i()}catch(l){o(l)}else if(a!==null){const l=kE();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(s.canceled){const l=this.appDelete_?YD():mJ();o(l)}else{const l=yJ();o(l)}};this.canceled_?n(!1,new pf(!1,null,!0)):this.backoffId_=CJ(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&AJ(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class pf{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function PJ(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function NJ(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function jJ(t,e){e&&(t["X-Firebase-GMPID"]=e)}function OJ(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function DJ(t,e,n,r,s,i,o=!0){const a=JD(t.urlParams),l=t.url+a,c=Object.assign({},t.headers);return jJ(c,e),PJ(c,n),NJ(c,i),OJ(c,r),new RJ(l,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FJ(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function $J(...t){const e=FJ();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(PE())return new Blob(t);throw new ot(st.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function MJ(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LJ(t){if(typeof atob>"u")throw EJ("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class g_{constructor(e,n){this.data=e,this.contentType=n||null}}function VJ(t,e){switch(t){case zr.RAW:return new g_(XD(e));case zr.BASE64:case zr.BASE64URL:return new g_(ZD(t,e));case zr.DATA_URL:return new g_(BJ(e),zJ(e))}throw kE()}function XD(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function UJ(t){let e;try{e=decodeURIComponent(t)}catch{throw Dc(zr.DATA_URL,"Malformed data URL.")}return XD(e)}function ZD(t,e){switch(t){case zr.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw Dc(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case zr.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw Dc(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=LJ(e)}catch(s){throw s.message.includes("polyfill")?s:Dc(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class eF{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Dc(zr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=WJ(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function BJ(t){const e=new eF(t);return e.base64?ZD(zr.BASE64,e.rest):UJ(e.rest)}function zJ(t){return new eF(t).contentType}function WJ(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(e,n){let r=0,s="";pI(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(pI(this.data_)){const r=this.data_,s=MJ(r,e,n);return s===null?null:new Bs(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Bs(r,!0)}}static getBlob(...e){if(PE()){const n=e.map(r=>r instanceof Bs?r.data_:r);return new Bs($J.apply(null,n))}else{const n=e.map(o=>RE(o)?VJ(zr.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)s[i++]=o[a]}),new Bs(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tF(t){let e;try{e=JSON.parse(t)}catch{return null}return IJ(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qJ(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function HJ(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function nF(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GJ(t,e){return e}class dn{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||GJ}}let yf=null;function QJ(t){return!RE(t)||t.length<2?t:nF(t)}function rF(){if(yf)return yf;const t=[];t.push(new dn("bucket")),t.push(new dn("generation")),t.push(new dn("metageneration")),t.push(new dn("name","fullPath",!0));function e(i,o){return QJ(o)}const n=new dn("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new dn("size");return s.xform=r,t.push(s),t.push(new dn("timeCreated")),t.push(new dn("updated")),t.push(new dn("md5Hash",null,!0)),t.push(new dn("cacheControl",null,!0)),t.push(new dn("contentDisposition",null,!0)),t.push(new dn("contentEncoding",null,!0)),t.push(new dn("contentLanguage",null,!0)),t.push(new dn("contentType",null,!0)),t.push(new dn("metadata","customMetadata",!0)),yf=t,yf}function KJ(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new Dn(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function YJ(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return KJ(r,t),r}function sF(t,e,n){const r=tF(e);return r===null?null:YJ(t,r,n)}function JJ(t,e,n,r){const s=tF(e);if(s===null||!RE(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(c=>{const d=t.bucket,h=t.fullPath,f="/b/"+o(d)+"/o/"+o(h),p=NE(f,n,r),y=JD({alt:"media",token:c});return p+y})[0]}function XJ(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class iF{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oF(t){if(!t)throw kE()}function ZJ(t,e){function n(r,s){const i=sF(t,s,e);return oF(i!==null),i}return n}function eX(t,e){function n(r,s){const i=sF(t,s,e);return oF(i!==null),JJ(i,s,t.host,t._protocol)}return n}function aF(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=fJ():s=hJ():n.getStatus()===402?s=dJ(t.bucket):n.getStatus()===403?s=pJ(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function tX(t){const e=aF(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=cJ(t.path)),i.serverResponse=s.serverResponse,i}return n}function nX(t,e,n){const r=e.fullServerUrl(),s=NE(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new iF(s,i,eX(t,n),o);return a.errorHandler=tX(e),a}function rX(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function sX(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=rX(null,e)),r}function iX(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let w="";for(let E=0;E<2;E++)w=w+Math.random().toString().slice(2);return w}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const c=sX(e,r,s),d=XJ(c,n),h="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,f=`\r
--`+l+"--",p=Bs.getBlob(h,r,f);if(p===null)throw xJ();const y={name:c.fullPath},v=NE(i,t.host,t._protocol),_="POST",g=t.maxUploadRetryTime,m=new iF(v,_,ZJ(t,n),g);return m.urlParams=y,m.headers=o,m.body=p.uploadData(),m.errorHandler=aF(e),m}class oX{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=No.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=No.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=No.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s){if(this.sent_)throw Hu("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(const i in s)s.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,s[i].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Hu("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Hu("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Hu("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Hu("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class aX extends oX{initXhr(){this.xhr_.responseType="text"}}function lF(){return new aX}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qo{constructor(e,n){this._service=e,n instanceof Dn?this._location=n:this._location=Dn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new qo(e,n)}get root(){const e=new Dn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return nF(this._location.path)}get storage(){return this._service}get parent(){const e=qJ(this._location.path);if(e===null)return null;const n=new Dn(this._location.bucket,e);return new qo(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw bJ(e)}}function lX(t,e,n){t._throwIfRoot("uploadBytes");const r=iX(t.storage,t._location,rF(),new Bs(e,!0),n);return t.storage.makeRequestWithTokens(r,lF).then(s=>({metadata:s,ref:t}))}function uX(t){t._throwIfRoot("getDownloadURL");const e=nX(t.storage,t._location,rF());return t.storage.makeRequestWithTokens(e,lF).then(n=>{if(n===null)throw wJ();return n})}function cX(t,e){const n=HJ(t._location.path,e),r=new Dn(t._location.bucket,n);return new qo(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dX(t){return/^[A-Za-z]+:\/\//.test(t)}function hX(t,e){return new qo(t,e)}function uF(t,e){if(t instanceof jE){const n=t;if(n._bucket==null)throw _J();const r=new qo(n,n._bucket);return e!=null?uF(r,e):r}else return e!==void 0?cX(t,e):t}function fX(t,e){if(e&&dX(e)){if(t instanceof jE)return hX(t,e);throw Ox("To use ref(service, url), the first argument must be a Storage instance.")}else return uF(t,e)}function mI(t,e){const n=e==null?void 0:e[KD];return n==null?null:Dn.makeFromBucketSpec(n,t)}function pX(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:o1(s,t.app.options.projectId))}class jE{constructor(e,n,r,s,i){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=QD,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=lJ,this._maxUploadRetryTime=uJ,this._requests=new Set,s!=null?this._bucket=Dn.makeFromBucketSpec(s,this._host):this._bucket=mI(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Dn.makeFromBucketSpec(this._url,e):this._bucket=mI(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){yI("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){yI("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new qo(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new SJ(YD());{const o=DJ(e,this._appId,r,s,n,this._firebaseVersion,i);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const gI="@firebase/storage",vI="0.11.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cF="storage";function yX(t,e,n){return t=Qt(t),lX(t,e,n)}function mX(t){return t=Qt(t),uX(t)}function gX(t,e){return t=Qt(t),fX(t,e)}function vX(t=d1(),e){t=Qt(t);const r=u1(t,cF).getImmediate({identifier:e}),s=i1("storage");return s&&_X(r,...s),r}function _X(t,e,n,r={}){pX(t,e,n,r)}function xX(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new jE(n,r,s,e,c1)}function wX(){Ul(new Lo(cF,xX,"PUBLIC").setMultipleInstances(!0)),Qr(gI,vI,""),Qr(gI,vI,"esm2017")}wX();const EX=vX(cE),_I=(t,e)=>{const n=e??`images/uploads/ungroup/image_${ps()}`,r=gX(EX,n);return yX(r,t).then(async s=>({url:await mX(s.ref)}))},xI={title:"",name:"新的玩家",color:"#FF0000",proPicUrl:""};function dF({defaultValue:t,onSubmit:e}){const{reset:n,setValue:r,control:s,handleSubmit:i}=sg({defaultValues:xI}),[{loading:o},a]=ng(e,[e]),l=x.useMemo(()=>i(y=>{a(y)}),[a,i]),c=rg({control:s}),d=x.useCallback(y=>_I(y).then(({url:v})=>{r("proPicUrl",v)}),[r]),h=x.useCallback(()=>{r("proPicUrl",null)},[r]),f=x.useCallback(y=>_I(y).then(({url:v})=>{r("teamPicUrl",v)}),[r]),p=x.useCallback(()=>{r("teamPicUrl",null)},[r]);return x.useEffect(()=>{n(t??xI)},[t,n]),u.jsxs("form",{onSubmit:l,className:"space-y-6",children:[u.jsxs("div",{className:"flex gap-x-6",children:[u.jsx("div",{className:"shrink-0",children:u.jsx(pn,{label:"顏色",children:u.jsx(Sn,{name:"color",control:s,render:({field:y})=>u.jsx(GD,{...y}),disabled:o})})}),u.jsxs("div",{className:"flex-1 space-y-6",children:[u.jsx(pn,{label:"稱號",children:u.jsx(Sn,{name:"title",control:s,render:({field:y})=>u.jsx(ri,{type:"text",...y,placeholder:"例：天鳳鳳位、雀魂x段",disabled:o})})}),u.jsx(pn,{className:"mb-6",label:"名字",children:u.jsx(Sn,{name:"name",control:s,rules:{required:!0},render:({field:y})=>u.jsx(ri,{...y}),disabled:o})}),u.jsxs("div",{className:"grid grid-cols-2 gap-x-6",children:[u.jsx(pn,{className:"mb-6",label:"玩家圖片",action:c.proPicUrl&&u.jsx("a",{href:"#",className:"text-xs underline text-teal-800",onClick:h,children:"移除"}),children:u.jsx(fI,{helperText:"建議大小 360px * 500px (18:25)",onChangeFile:d,children:c.proPicUrl&&u.jsx("img",{className:"aspect-[18/25]",src:c.proPicUrl})})}),u.jsx(pn,{className:"mb-6",label:"隊伍圖片",action:c.teamPicUrl&&u.jsx("a",{href:"#",className:"text-xs underline text-teal-800",onClick:p,children:"移除"}),children:u.jsx(fI,{helperText:"建議大小 500px * 500px (1:1)",onChangeFile:f,children:c.teamPicUrl&&u.jsx("img",{className:"aspect-square",src:c.teamPicUrl})})})]})]})]}),u.jsxs("div",{children:[u.jsx("div",{className:"mb-2",children:"預覽"}),u.jsx("div",{className:"text-[4rem] p-4 bg-gray-800 text-white",children:u.jsx(Ti,{player:c,score:25e3,waitingTiles:["5m","6m","7m"],isRiichi:!0,isEast:!0})})]}),u.jsx("div",{children:u.jsx(ke,{type:"submit",loading:o,children:"儲存"})})]})}var bX=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},W,OE=OE||{},le=bX||self;function og(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function vh(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function SX(t){return Object.prototype.hasOwnProperty.call(t,v_)&&t[v_]||(t[v_]=++CX)}var v_="closure_uid_"+(1e9*Math.random()>>>0),CX=0;function AX(t,e,n){return t.call.apply(t.bind,arguments)}function TX(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),t.apply(e,s)}}return function(){return t.apply(e,arguments)}}function sn(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?sn=AX:sn=TX,sn.apply(null,arguments)}function mf(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function Ft(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,s,i){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[s].apply(r,o)}}function Mi(){this.s=this.s,this.o=this.o}var IX=0;Mi.prototype.s=!1;Mi.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),IX!=0)&&SX(this)};Mi.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const hF=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function DE(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function wI(t,e){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(og(r)){const s=t.length||0,i=r.length||0;t.length=s+i;for(let o=0;o<i;o++)t[s+o]=r[o]}else t.push(r)}}function on(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}on.prototype.h=function(){this.defaultPrevented=!0};var kX=function(){if(!le.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{le.addEventListener("test",()=>{},e),le.removeEventListener("test",()=>{},e)}catch{}return t}();function vd(t){return/^[\s\xa0]*$/.test(t)}function ag(){var t=le.navigator;return t&&(t=t.userAgent)?t:""}function Lr(t){return ag().indexOf(t)!=-1}function FE(t){return FE[" "](t),t}FE[" "]=function(){};function RX(t,e){var n=EZ;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var PX=Lr("Opera"),ru=Lr("Trident")||Lr("MSIE"),fF=Lr("Edge"),Dx=fF||ru,pF=Lr("Gecko")&&!(ag().toLowerCase().indexOf("webkit")!=-1&&!Lr("Edge"))&&!(Lr("Trident")||Lr("MSIE"))&&!Lr("Edge"),NX=ag().toLowerCase().indexOf("webkit")!=-1&&!Lr("Edge");function yF(){var t=le.document;return t?t.documentMode:void 0}var Fx;e:{var __="",x_=function(){var t=ag();if(pF)return/rv:([^\);]+)(\)|;)/.exec(t);if(fF)return/Edge\/([\d\.]+)/.exec(t);if(ru)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(NX)return/WebKit\/(\S+)/.exec(t);if(PX)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(x_&&(__=x_?x_[1]:""),ru){var w_=yF();if(w_!=null&&w_>parseFloat(__)){Fx=String(w_);break e}}Fx=__}var $x;if(le.document&&ru){var EI=yF();$x=EI||parseInt(Fx,10)||void 0}else $x=void 0;var jX=$x;function _d(t,e){if(on.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(pF){e:{try{FE(e.nodeName);var s=!0;break e}catch{}s=!1}s||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:OX[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&_d.$.h.call(this)}}Ft(_d,on);var OX={2:"touch",3:"pen",4:"mouse"};_d.prototype.h=function(){_d.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var _h="closure_listenable_"+(1e6*Math.random()|0),DX=0;function FX(t,e,n,r,s){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=s,this.key=++DX,this.fa=this.ia=!1}function lg(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function $E(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function $X(t,e){for(const n in t)e.call(void 0,t[n],n,t)}function mF(t){const e={};for(const n in t)e[n]=t[n];return e}const bI="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function gF(t,e){let n,r;for(let s=1;s<arguments.length;s++){r=arguments[s];for(n in r)t[n]=r[n];for(let i=0;i<bI.length;i++)n=bI[i],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ug(t){this.src=t,this.g={},this.h=0}ug.prototype.add=function(t,e,n,r,s){var i=t.toString();t=this.g[i],t||(t=this.g[i]=[],this.h++);var o=Lx(t,e,r,s);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new FX(e,this.src,i,!!r,s),e.ia=n,t.push(e)),e};function Mx(t,e){var n=e.type;if(n in t.g){var r=t.g[n],s=hF(r,e),i;(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(lg(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function Lx(t,e,n,r){for(var s=0;s<t.length;++s){var i=t[s];if(!i.fa&&i.listener==e&&i.capture==!!n&&i.la==r)return s}return-1}var ME="closure_lm_"+(1e6*Math.random()|0),E_={};function vF(t,e,n,r,s){if(r&&r.once)return xF(t,e,n,r,s);if(Array.isArray(e)){for(var i=0;i<e.length;i++)vF(t,e[i],n,r,s);return null}return n=UE(n),t&&t[_h]?t.O(e,n,vh(r)?!!r.capture:!!r,s):_F(t,e,n,!1,r,s)}function _F(t,e,n,r,s,i){if(!e)throw Error("Invalid event type");var o=vh(s)?!!s.capture:!!s,a=VE(t);if(a||(t[ME]=a=new ug(t)),n=a.add(e,n,r,o,i),n.proxy)return n;if(r=MX(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)kX||(s=o),s===void 0&&(s=!1),t.addEventListener(e.toString(),r,s);else if(t.attachEvent)t.attachEvent(EF(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function MX(){function t(n){return e.call(t.src,t.listener,n)}const e=LX;return t}function xF(t,e,n,r,s){if(Array.isArray(e)){for(var i=0;i<e.length;i++)xF(t,e[i],n,r,s);return null}return n=UE(n),t&&t[_h]?t.P(e,n,vh(r)?!!r.capture:!!r,s):_F(t,e,n,!0,r,s)}function wF(t,e,n,r,s){if(Array.isArray(e))for(var i=0;i<e.length;i++)wF(t,e[i],n,r,s);else r=vh(r)?!!r.capture:!!r,n=UE(n),t&&t[_h]?(t=t.i,e=String(e).toString(),e in t.g&&(i=t.g[e],n=Lx(i,n,r,s),-1<n&&(lg(i[n]),Array.prototype.splice.call(i,n,1),i.length==0&&(delete t.g[e],t.h--)))):t&&(t=VE(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Lx(e,n,r,s)),(n=-1<t?e[t]:null)&&LE(n))}function LE(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[_h])Mx(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(EF(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=VE(e))?(Mx(n,t),n.h==0&&(n.src=null,e[ME]=null)):lg(t)}}}function EF(t){return t in E_?E_[t]:E_[t]="on"+t}function LX(t,e){if(t.fa)t=!0;else{e=new _d(e,this);var n=t.listener,r=t.la||t.src;t.ia&&LE(t),t=n.call(r,e)}return t}function VE(t){return t=t[ME],t instanceof ug?t:null}var b_="__closure_events_fn_"+(1e9*Math.random()>>>0);function UE(t){return typeof t=="function"?t:(t[b_]||(t[b_]=function(e){return t.handleEvent(e)}),t[b_])}function Dt(){Mi.call(this),this.i=new ug(this),this.S=this,this.J=null}Ft(Dt,Mi);Dt.prototype[_h]=!0;Dt.prototype.removeEventListener=function(t,e,n,r){wF(this,t,e,n,r)};function qt(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new on(e,t);else if(e instanceof on)e.target=e.target||t;else{var s=e;e=new on(r,t),gF(e,s)}if(s=!0,n)for(var i=n.length-1;0<=i;i--){var o=e.g=n[i];s=gf(o,r,!0,e)&&s}if(o=e.g=t,s=gf(o,r,!0,e)&&s,s=gf(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)o=e.g=n[i],s=gf(o,r,!1,e)&&s}Dt.prototype.N=function(){if(Dt.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)lg(n[r]);delete t.g[e],t.h--}}this.J=null};Dt.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};Dt.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function gf(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var s=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.fa&&o.capture==n){var a=o.listener,l=o.la||o.src;o.ia&&Mx(t.i,o),s=a.call(l,r)!==!1&&s}}return s&&!r.defaultPrevented}var BE=le.JSON.stringify;class VX{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function UX(){var t=zE;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class BX{constructor(){this.h=this.g=null}add(e,n){const r=bF.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var bF=new VX(()=>new zX,t=>t.reset());class zX{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function WX(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function qX(t){le.setTimeout(()=>{throw t},0)}let xd,wd=!1,zE=new BX,SF=()=>{const t=le.Promise.resolve(void 0);xd=()=>{t.then(HX)}};var HX=()=>{for(var t;t=UX();){try{t.h.call(t.g)}catch(n){qX(n)}var e=bF;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}wd=!1};function cg(t,e){Dt.call(this),this.h=t||1,this.g=e||le,this.j=sn(this.qb,this),this.l=Date.now()}Ft(cg,Dt);W=cg.prototype;W.ga=!1;W.T=null;W.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),qt(this,"tick"),this.ga&&(WE(this),this.start()))}};W.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function WE(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}W.N=function(){cg.$.N.call(this),WE(this),delete this.g};function qE(t,e,n){if(typeof t=="function")n&&(t=sn(t,n));else if(t&&typeof t.handleEvent=="function")t=sn(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:le.setTimeout(t,e||0)}function CF(t){t.g=qE(()=>{t.g=null,t.i&&(t.i=!1,CF(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class GX extends Mi{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:CF(this)}N(){super.N(),this.g&&(le.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ed(t){Mi.call(this),this.h=t,this.g={}}Ft(Ed,Mi);var SI=[];function AF(t,e,n,r){Array.isArray(n)||(n&&(SI[0]=n.toString()),n=SI);for(var s=0;s<n.length;s++){var i=vF(e,n[s],r||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}}function TF(t){$E(t.g,function(e,n){this.g.hasOwnProperty(n)&&LE(e)},t),t.g={}}Ed.prototype.N=function(){Ed.$.N.call(this),TF(this)};Ed.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function dg(){this.g=!0}dg.prototype.Ea=function(){this.g=!1};function QX(t,e,n,r,s,i){t.info(function(){if(t.g)if(i)for(var o="",a=i.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var d=c[0];c=c[1];var h=d.split("_");o=2<=h.length&&h[1]=="type"?o+(d+"="+c+"&"):o+(d+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+e+`
`+n+`
`+o})}function KX(t,e,n,r,s,i,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+e+`
`+n+`
`+i+" "+o})}function Ka(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+JX(t,n)+(r?" "+r:"")})}function YX(t,e){t.info(function(){return"TIMEOUT: "+e})}dg.prototype.info=function(){};function JX(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if(i!="noop"&&i!="stop"&&i!="close")for(var o=1;o<s.length;o++)s[o]=""}}}}return BE(n)}catch{return e}}var ta={},CI=null;function hg(){return CI=CI||new Dt}ta.Ta="serverreachability";function IF(t){on.call(this,ta.Ta,t)}Ft(IF,on);function bd(t){const e=hg();qt(e,new IF(e))}ta.STAT_EVENT="statevent";function kF(t,e){on.call(this,ta.STAT_EVENT,t),this.stat=e}Ft(kF,on);function mn(t){const e=hg();qt(e,new kF(e,t))}ta.Ua="timingevent";function RF(t,e){on.call(this,ta.Ua,t),this.size=e}Ft(RF,on);function xh(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return le.setTimeout(function(){t()},e)}var fg={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},PF={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function HE(){}HE.prototype.h=null;function AI(t){return t.h||(t.h=t.i())}function NF(){}var wh={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function GE(){on.call(this,"d")}Ft(GE,on);function QE(){on.call(this,"c")}Ft(QE,on);var Vx;function pg(){}Ft(pg,HE);pg.prototype.g=function(){return new XMLHttpRequest};pg.prototype.i=function(){return{}};Vx=new pg;function Eh(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new Ed(this),this.P=XX,t=Dx?125:void 0,this.V=new cg(t),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new jF}function jF(){this.i=null,this.g="",this.h=!1}var XX=45e3,Ux={},Xy={};W=Eh.prototype;W.setTimeout=function(t){this.P=t};function Bx(t,e,n){t.L=1,t.v=mg(bs(e)),t.s=n,t.S=!0,OF(t,null)}function OF(t,e){t.G=Date.now(),bh(t),t.A=bs(t.v);var n=t.A,r=t.W;Array.isArray(r)||(r=[String(r)]),BF(n.i,"t",r),t.C=0,n=t.l.J,t.h=new jF,t.g=u$(t.l,n?e:null,!t.s),0<t.O&&(t.M=new GX(sn(t.Pa,t,t.g),t.O)),AF(t.U,t.g,"readystatechange",t.nb),e=t.I?mF(t.I):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.A,t.u,t.s,e)):(t.u="GET",t.g.ha(t.A,t.u,null,e)),bd(),QX(t.j,t.u,t.A,t.m,t.W,t.s)}W.nb=function(t){t=t.target;const e=this.M;e&&Wr(t)==3?e.l():this.Pa(t)};W.Pa=function(t){try{if(t==this.g)e:{const d=Wr(this.g);var e=this.g.Ia();const h=this.g.da();if(!(3>d)&&(d!=3||Dx||this.g&&(this.h.h||this.g.ja()||RI(this.g)))){this.J||d!=4||e==7||(e==8||0>=h?bd(3):bd(2)),yg(this);var n=this.g.da();this.ca=n;t:if(DF(this)){var r=RI(this.g);t="";var s=r.length,i=Wr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){io(this),Fc(this);var o="";break t}this.h.i=new le.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:i&&e==s-1});r.splice(0,s),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,KX(this.j,this.u,this.A,this.m,this.W,d,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!vd(a)){var c=a;break t}}c=null}if(n=c)Ka(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,zx(this,n);else{this.i=!1,this.o=3,mn(12),io(this),Fc(this);break e}}this.S?(FF(this,d,o),Dx&&this.i&&d==3&&(AF(this.U,this.V,"tick",this.mb),this.V.start())):(Ka(this.j,this.m,o,null),zx(this,o)),d==4&&io(this),this.i&&!this.J&&(d==4?i$(this.l,this):(this.i=!1,bh(this)))}else _Z(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.o=3,mn(12)):(this.o=0,mn(13)),io(this),Fc(this)}}}catch{}finally{}};function DF(t){return t.g?t.u=="GET"&&t.L!=2&&t.l.Ha:!1}function FF(t,e,n){let r=!0,s;for(;!t.J&&t.C<n.length;)if(s=ZX(t,n),s==Xy){e==4&&(t.o=4,mn(14),r=!1),Ka(t.j,t.m,null,"[Incomplete Response]");break}else if(s==Ux){t.o=4,mn(15),Ka(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else Ka(t.j,t.m,s,null),zx(t,s);DF(t)&&s!=Xy&&s!=Ux&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,mn(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),eb(e),e.M=!0,mn(11))):(Ka(t.j,t.m,n,"[Invalid Chunked Response]"),io(t),Fc(t))}W.mb=function(){if(this.g){var t=Wr(this.g),e=this.g.ja();this.C<e.length&&(yg(this),FF(this,t,e),this.i&&t!=4&&bh(this))}};function ZX(t,e){var n=t.C,r=e.indexOf(`
`,n);return r==-1?Xy:(n=Number(e.substring(n,r)),isNaN(n)?Ux:(r+=1,r+n>e.length?Xy:(e=e.slice(r,r+n),t.C=r+n,e)))}W.cancel=function(){this.J=!0,io(this)};function bh(t){t.Y=Date.now()+t.P,$F(t,t.P)}function $F(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=xh(sn(t.lb,t),e)}function yg(t){t.B&&(le.clearTimeout(t.B),t.B=null)}W.lb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(YX(this.j,this.A),this.L!=2&&(bd(),mn(17)),io(this),this.o=2,Fc(this)):$F(this,this.Y-t)};function Fc(t){t.l.H==0||t.J||i$(t.l,t)}function io(t){yg(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,WE(t.V),TF(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function zx(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||Wx(n.i,t))){if(!t.K&&Wx(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var s=r;if(s[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)tm(n),_g(n);else break e;ZE(n),mn(18)}}else n.Fa=s[1],0<n.Fa-n.V&&37500>s[2]&&n.G&&n.A==0&&!n.v&&(n.v=xh(sn(n.ib,n),6e3));if(1>=qF(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else oo(n,11)}else if((t.K||n.g==t)&&tm(n),!vd(e))for(s=n.Ja.g.parse(e),e=0;e<s.length;e++){let c=s[e];if(n.V=c[0],c=c[1],n.H==2)if(c[0]=="c"){n.K=c[1],n.pa=c[2];const d=c[3];d!=null&&(n.ra=d,n.l.info("VER="+n.ra));const h=c[4];h!=null&&(n.Ga=h,n.l.info("SVER="+n.Ga));const f=c[5];f!=null&&typeof f=="number"&&0<f&&(r=1.5*f,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const p=t.g;if(p){const y=p.g?p.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(y){var i=r.i;i.g||y.indexOf("spdy")==-1&&y.indexOf("quic")==-1&&y.indexOf("h2")==-1||(i.j=i.l,i.g=new Set,i.h&&(KE(i,i.h),i.h=null))}if(r.F){const v=p.g?p.g.getResponseHeader("X-HTTP-Session-Id"):null;v&&(r.Da=v,Be(r.I,r.F,v))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=l$(r,r.J?r.pa:null,r.Y),o.K){HF(r.i,o);var a=o,l=r.L;l&&a.setTimeout(l),a.B&&(yg(a),bh(a)),r.g=o}else r$(r);0<n.j.length&&xg(n)}else c[0]!="stop"&&c[0]!="close"||oo(n,7);else n.H==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?oo(n,7):XE(n):c[0]!="noop"&&n.h&&n.h.Aa(c),n.A=0)}}bd(4)}catch{}}function eZ(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(og(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function tZ(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(og(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}function MF(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(og(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=tZ(t),r=eZ(t),s=r.length,i=0;i<s;i++)e.call(void 0,r[i],n&&n[i],t)}var LF=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function nZ(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),s=null;if(0<=r){var i=t[n].substring(0,r);s=t[n].substring(r+1)}else i=t[n];e(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}function jo(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof jo){this.h=t.h,Zy(this,t.j),this.s=t.s,this.g=t.g,em(this,t.m),this.l=t.l;var e=t.i,n=new Sd;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),TI(this,n),this.o=t.o}else t&&(e=String(t).match(LF))?(this.h=!1,Zy(this,e[1]||"",!0),this.s=cc(e[2]||""),this.g=cc(e[3]||"",!0),em(this,e[4]),this.l=cc(e[5]||"",!0),TI(this,e[6]||"",!0),this.o=cc(e[7]||"")):(this.h=!1,this.i=new Sd(null,this.h))}jo.prototype.toString=function(){var t=[],e=this.j;e&&t.push(dc(e,II,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(dc(e,II,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(dc(n,n.charAt(0)=="/"?iZ:sZ,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",dc(n,aZ)),t.join("")};function bs(t){return new jo(t)}function Zy(t,e,n){t.j=n?cc(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function em(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function TI(t,e,n){e instanceof Sd?(t.i=e,lZ(t.i,t.h)):(n||(e=dc(e,oZ)),t.i=new Sd(e,t.h))}function Be(t,e,n){t.i.set(e,n)}function mg(t){return Be(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function cc(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function dc(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,rZ),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function rZ(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var II=/[#\/\?@]/g,sZ=/[#\?:]/g,iZ=/[#\?]/g,oZ=/[#\?@]/g,aZ=/#/g;function Sd(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Li(t){t.g||(t.g=new Map,t.h=0,t.i&&nZ(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}W=Sd.prototype;W.add=function(t,e){Li(this),this.i=null,t=Eu(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function VF(t,e){Li(t),e=Eu(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function UF(t,e){return Li(t),e=Eu(t,e),t.g.has(e)}W.forEach=function(t,e){Li(this),this.g.forEach(function(n,r){n.forEach(function(s){t.call(e,s,r,this)},this)},this)};W.ta=function(){Li(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const s=t[r];for(let i=0;i<s.length;i++)n.push(e[r])}return n};W.Z=function(t){Li(this);let e=[];if(typeof t=="string")UF(this,t)&&(e=e.concat(this.g.get(Eu(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};W.set=function(t,e){return Li(this),this.i=null,t=Eu(this,t),UF(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};W.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function BF(t,e,n){VF(t,e),0<n.length&&(t.i=null,t.g.set(Eu(t,e),DE(n)),t.h+=n.length)}W.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const i=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var s=i;o[r]!==""&&(s+="="+encodeURIComponent(String(o[r]))),t.push(s)}}return this.i=t.join("&")};function Eu(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function lZ(t,e){e&&!t.j&&(Li(t),t.i=null,t.g.forEach(function(n,r){var s=r.toLowerCase();r!=s&&(VF(this,r),BF(this,s,n))},t)),t.j=e}var uZ=class{constructor(t,e){this.g=t,this.map=e}};function zF(t){this.l=t||cZ,le.PerformanceNavigationTiming?(t=le.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(le.g&&le.g.Ka&&le.g.Ka()&&le.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var cZ=10;function WF(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function qF(t){return t.h?1:t.g?t.g.size:0}function Wx(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function KE(t,e){t.g?t.g.add(e):t.h=e}function HF(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}zF.prototype.cancel=function(){if(this.i=GF(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function GF(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return DE(t.i)}var dZ=class{stringify(t){return le.JSON.stringify(t,void 0)}parse(t){return le.JSON.parse(t,void 0)}};function hZ(){this.g=new dZ}function fZ(t,e,n){const r=n||"";try{MF(t,function(s,i){let o=s;vh(s)&&(o=BE(s)),e.push(r+i+"="+encodeURIComponent(o))})}catch(s){throw e.push(r+"type="+encodeURIComponent("_badmap")),s}}function pZ(t,e){const n=new dg;if(le.Image){const r=new Image;r.onload=mf(vf,n,r,"TestLoadImage: loaded",!0,e),r.onerror=mf(vf,n,r,"TestLoadImage: error",!1,e),r.onabort=mf(vf,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=mf(vf,n,r,"TestLoadImage: timeout",!1,e),le.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function vf(t,e,n,r,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(r)}catch{}}function Sh(t){this.l=t.ec||null,this.j=t.ob||!1}Ft(Sh,HE);Sh.prototype.g=function(){return new gg(this.l,this.j)};Sh.prototype.i=function(t){return function(){return t}}({});function gg(t,e){Dt.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=YE,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ft(gg,Dt);var YE=0;W=gg.prototype;W.open=function(t,e){if(this.readyState!=YE)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Cd(this)};W.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||le).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};W.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ch(this)),this.readyState=YE};W.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Cd(this)),this.g&&(this.readyState=3,Cd(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof le.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;QF(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function QF(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}W.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Ch(this):Cd(this),this.readyState==3&&QF(this)}};W.Za=function(t){this.g&&(this.response=this.responseText=t,Ch(this))};W.Ya=function(t){this.g&&(this.response=t,Ch(this))};W.ka=function(){this.g&&Ch(this)};function Ch(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Cd(t)}W.setRequestHeader=function(t,e){this.v.append(t,e)};W.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};W.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Cd(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(gg.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var yZ=le.JSON.parse;function it(t){Dt.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=KF,this.L=this.M=!1}Ft(it,Dt);var KF="",mZ=/^https?$/i,gZ=["POST","PUT"];W=it.prototype;W.Oa=function(t){this.M=t};W.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Vx.g(),this.C=this.u?AI(this.u):AI(Vx),this.g.onreadystatechange=sn(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(i){kI(this,i);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const i of r.keys())n.set(i,r.get(i));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(i=>i.toLowerCase()=="content-type"),s=le.FormData&&t instanceof le.FormData,!(0<=hF(gZ,e))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of n)this.g.setRequestHeader(i,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{XF(this),0<this.B&&((this.L=vZ(this.g))?(this.g.timeout=this.B,this.g.ontimeout=sn(this.ua,this)):this.A=qE(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(i){kI(this,i)}};function vZ(t){return ru&&typeof t.timeout=="number"&&t.ontimeout!==void 0}W.ua=function(){typeof OE<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,qt(this,"timeout"),this.abort(8))};function kI(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,YF(t),vg(t)}function YF(t){t.F||(t.F=!0,qt(t,"complete"),qt(t,"error"))}W.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,qt(this,"complete"),qt(this,"abort"),vg(this))};W.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),vg(this,!0)),it.$.N.call(this)};W.La=function(){this.s||(this.G||this.v||this.l?JF(this):this.kb())};W.kb=function(){JF(this)};function JF(t){if(t.h&&typeof OE<"u"&&(!t.C[1]||Wr(t)!=4||t.da()!=2)){if(t.v&&Wr(t)==4)qE(t.La,0,t);else if(qt(t,"readystatechange"),Wr(t)==4){t.h=!1;try{const o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var s=String(t.I).match(LF)[1]||null;!s&&le.self&&le.self.location&&(s=le.self.location.protocol.slice(0,-1)),r=!mZ.test(s?s.toLowerCase():"")}n=r}if(n)qt(t,"complete"),qt(t,"success");else{t.m=6;try{var i=2<Wr(t)?t.g.statusText:""}catch{i=""}t.j=i+" ["+t.da()+"]",YF(t)}}finally{vg(t)}}}}function vg(t,e){if(t.g){XF(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||qt(t,"ready");try{n.onreadystatechange=r}catch{}}}function XF(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(le.clearTimeout(t.A),t.A=null)}W.isActive=function(){return!!this.g};function Wr(t){return t.g?t.g.readyState:0}W.da=function(){try{return 2<Wr(this)?this.g.status:-1}catch{return-1}};W.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};W.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),yZ(e)}};function RI(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case KF:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function _Z(t){const e={};t=(t.g&&2<=Wr(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(vd(t[r]))continue;var n=WX(t[r]);const s=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();const i=e[s]||[];e[s]=i,i.push(n)}$X(e,function(r){return r.join(", ")})}W.Ia=function(){return this.m};W.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function ZF(t){let e="";return $E(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function JE(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=ZF(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Be(t,e,n))}function Gu(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function e$(t){this.Ga=0,this.j=[],this.l=new dg,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Gu("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Gu("baseRetryDelayMs",5e3,t),this.hb=Gu("retryDelaySeedMs",1e4,t),this.eb=Gu("forwardChannelMaxRetries",2,t),this.xa=Gu("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new zF(t&&t.concurrentRequestLimit),this.Ja=new hZ,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}W=e$.prototype;W.ra=8;W.H=1;function XE(t){if(t$(t),t.H==3){var e=t.W++,n=bs(t.I);if(Be(n,"SID",t.K),Be(n,"RID",e),Be(n,"TYPE","terminate"),Ah(t,n),e=new Eh(t,t.l,e),e.L=2,e.v=mg(bs(n)),n=!1,le.navigator&&le.navigator.sendBeacon)try{n=le.navigator.sendBeacon(e.v.toString(),"")}catch{}!n&&le.Image&&(new Image().src=e.v,n=!0),n||(e.g=u$(e.l,null),e.g.ha(e.v)),e.G=Date.now(),bh(e)}a$(t)}function _g(t){t.g&&(eb(t),t.g.cancel(),t.g=null)}function t$(t){_g(t),t.u&&(le.clearTimeout(t.u),t.u=null),tm(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&le.clearTimeout(t.m),t.m=null)}function xg(t){if(!WF(t.i)&&!t.m){t.m=!0;var e=t.Na;xd||SF(),wd||(xd(),wd=!0),zE.add(e,t),t.C=0}}function xZ(t,e){return qF(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=xh(sn(t.Na,t,e),o$(t,t.C)),t.C++,!0)}W.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const s=new Eh(this,this.l,t);let i=this.s;if(this.U&&(i?(i=mF(i),gF(i,this.U)):i=this.U),this.o!==null||this.O||(s.I=i,i=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=n$(this,s,e),n=bs(this.I),Be(n,"RID",t),Be(n,"CVER",22),this.F&&Be(n,"X-HTTP-Session-Id",this.F),Ah(this,n),i&&(this.O?e="headers="+encodeURIComponent(String(ZF(i)))+"&"+e:this.o&&JE(n,this.o,i)),KE(this.i,s),this.bb&&Be(n,"TYPE","init"),this.P?(Be(n,"$req",e),Be(n,"SID","null"),s.aa=!0,Bx(s,n,null)):Bx(s,n,e),this.H=2}}else this.H==3&&(t?PI(this,t):this.j.length==0||WF(this.i)||PI(this))};function PI(t,e){var n;e?n=e.m:n=t.W++;const r=bs(t.I);Be(r,"SID",t.K),Be(r,"RID",n),Be(r,"AID",t.V),Ah(t,r),t.o&&t.s&&JE(r,t.o,t.s),n=new Eh(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=n$(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),KE(t.i,n),Bx(n,r,e)}function Ah(t,e){t.na&&$E(t.na,function(n,r){Be(e,r,n)}),t.h&&MF({},function(n,r){Be(e,r,n)})}function n$(t,e,n){n=Math.min(t.j.length,n);var r=t.h?sn(t.h.Va,t.h,t):null;e:{var s=t.j;let i=-1;for(;;){const o=["count="+n];i==-1?0<n?(i=s[0].g,o.push("ofs="+i)):i=0:o.push("ofs="+i);let a=!0;for(let l=0;l<n;l++){let c=s[l].g;const d=s[l].map;if(c-=i,0>c)i=Math.max(0,s[l].g-100),a=!1;else try{fZ(d,o,"req"+c+"_")}catch{r&&r(d)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function r$(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;xd||SF(),wd||(xd(),wd=!0),zE.add(e,t),t.A=0}}function ZE(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=xh(sn(t.Ma,t),o$(t,t.A)),t.A++,!0)}W.Ma=function(){if(this.u=null,s$(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=xh(sn(this.jb,this),t)}};W.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,mn(10),_g(this),s$(this))};function eb(t){t.B!=null&&(le.clearTimeout(t.B),t.B=null)}function s$(t){t.g=new Eh(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=bs(t.wa);Be(e,"RID","rpc"),Be(e,"SID",t.K),Be(e,"AID",t.V),Be(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Be(e,"TO",t.qa),Be(e,"TYPE","xmlhttp"),Ah(t,e),t.o&&t.s&&JE(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.v=mg(bs(e)),n.s=null,n.S=!0,OF(n,t)}W.ib=function(){this.v!=null&&(this.v=null,_g(this),ZE(this),mn(19))};function tm(t){t.v!=null&&(le.clearTimeout(t.v),t.v=null)}function i$(t,e){var n=null;if(t.g==e){tm(t),eb(t),t.g=null;var r=2}else if(Wx(t.i,e))n=e.F,HF(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.s?e.s.length:0,e=Date.now()-e.G;var s=t.C;r=hg(),qt(r,new RF(r,n)),xg(t)}else r$(t);else if(s=e.o,s==3||s==0&&0<e.ca||!(r==1&&xZ(t,e)||r==2&&ZE(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),s){case 1:oo(t,5);break;case 4:oo(t,10);break;case 3:oo(t,6);break;default:oo(t,2)}}}function o$(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function oo(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=sn(t.pb,t);n||(n=new jo("//www.google.com/images/cleardot.gif"),le.location&&le.location.protocol=="http"||Zy(n,"https"),mg(n)),pZ(n.toString(),r)}else mn(2);t.H=0,t.h&&t.h.za(e),a$(t),t$(t)}W.pb=function(t){t?(this.l.info("Successfully pinged google.com"),mn(2)):(this.l.info("Failed to ping google.com"),mn(1))};function a$(t){if(t.H=0,t.ma=[],t.h){const e=GF(t.i);(e.length!=0||t.j.length!=0)&&(wI(t.ma,e),wI(t.ma,t.j),t.i.i.length=0,DE(t.j),t.j.length=0),t.h.ya()}}function l$(t,e,n){var r=n instanceof jo?bs(n):new jo(n);if(r.g!="")e&&(r.g=e+"."+r.g),em(r,r.m);else{var s=le.location;r=s.protocol,e=e?e+"."+s.hostname:s.hostname,s=+s.port;var i=new jo(null);r&&Zy(i,r),e&&(i.g=e),s&&em(i,s),n&&(i.l=n),r=i}return n=t.F,e=t.Da,n&&e&&Be(r,n,e),Be(r,"VER",t.ra),Ah(t,r),r}function u$(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ha&&!t.va?new it(new Sh({ob:!0})):new it(t.va),e.Oa(t.J),e}W.isActive=function(){return!!this.h&&this.h.isActive(this)};function c$(){}W=c$.prototype;W.Ba=function(){};W.Aa=function(){};W.za=function(){};W.ya=function(){};W.isActive=function(){return!0};W.Va=function(){};function nm(){if(ru&&!(10<=Number(jX)))throw Error("Environmental error: no available transport.")}nm.prototype.g=function(t,e){return new Ln(t,e)};function Ln(t,e){Dt.call(this),this.g=new e$(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!vd(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!vd(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new bu(this)}Ft(Ln,Dt);Ln.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;mn(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=l$(t,null,t.Y),xg(t)};Ln.prototype.close=function(){XE(this.g)};Ln.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=BE(t),t=n);e.j.push(new uZ(e.fb++,t)),e.H==3&&xg(e)};Ln.prototype.N=function(){this.g.h=null,delete this.j,XE(this.g),delete this.g,Ln.$.N.call(this)};function d$(t){GE.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Ft(d$,GE);function h$(){QE.call(this),this.status=1}Ft(h$,QE);function bu(t){this.g=t}Ft(bu,c$);bu.prototype.Ba=function(){qt(this.g,"a")};bu.prototype.Aa=function(t){qt(this.g,new d$(t))};bu.prototype.za=function(t){qt(this.g,new h$)};bu.prototype.ya=function(){qt(this.g,"b")};function wZ(){this.blockSize=-1}function Tr(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}Ft(Tr,wZ);Tr.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function S_(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var s=0;16>s;++s)r[s]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(s=0;16>s;++s)r[s]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],s=t.g[2];var i=t.g[3],o=e+(i^n&(s^i))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=i+(s^e&(n^s))+r[1]+3905402710&4294967295,i=e+(o<<12&4294967295|o>>>20),o=s+(n^i&(e^n))+r[2]+606105819&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(e^s&(i^e))+r[3]+3250441966&4294967295,n=s+(o<<22&4294967295|o>>>10),o=e+(i^n&(s^i))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=i+(s^e&(n^s))+r[5]+1200080426&4294967295,i=e+(o<<12&4294967295|o>>>20),o=s+(n^i&(e^n))+r[6]+2821735955&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(e^s&(i^e))+r[7]+4249261313&4294967295,n=s+(o<<22&4294967295|o>>>10),o=e+(i^n&(s^i))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=i+(s^e&(n^s))+r[9]+2336552879&4294967295,i=e+(o<<12&4294967295|o>>>20),o=s+(n^i&(e^n))+r[10]+4294925233&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(e^s&(i^e))+r[11]+2304563134&4294967295,n=s+(o<<22&4294967295|o>>>10),o=e+(i^n&(s^i))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=i+(s^e&(n^s))+r[13]+4254626195&4294967295,i=e+(o<<12&4294967295|o>>>20),o=s+(n^i&(e^n))+r[14]+2792965006&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(e^s&(i^e))+r[15]+1236535329&4294967295,n=s+(o<<22&4294967295|o>>>10),o=e+(s^i&(n^s))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(e^n))+r[6]+3225465664&4294967295,i=e+(o<<9&4294967295|o>>>23),o=s+(e^n&(i^e))+r[11]+643717713&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^e&(s^i))+r[0]+3921069994&4294967295,n=s+(o<<20&4294967295|o>>>12),o=e+(s^i&(n^s))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(e^n))+r[10]+38016083&4294967295,i=e+(o<<9&4294967295|o>>>23),o=s+(e^n&(i^e))+r[15]+3634488961&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^e&(s^i))+r[4]+3889429448&4294967295,n=s+(o<<20&4294967295|o>>>12),o=e+(s^i&(n^s))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(e^n))+r[14]+3275163606&4294967295,i=e+(o<<9&4294967295|o>>>23),o=s+(e^n&(i^e))+r[3]+4107603335&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^e&(s^i))+r[8]+1163531501&4294967295,n=s+(o<<20&4294967295|o>>>12),o=e+(s^i&(n^s))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(e^n))+r[2]+4243563512&4294967295,i=e+(o<<9&4294967295|o>>>23),o=s+(e^n&(i^e))+r[7]+1735328473&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^e&(s^i))+r[12]+2368359562&4294967295,n=s+(o<<20&4294967295|o>>>12),o=e+(n^s^i)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=i+(e^n^s)+r[8]+2272392833&4294967295,i=e+(o<<11&4294967295|o>>>21),o=s+(i^e^n)+r[11]+1839030562&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^e)+r[14]+4259657740&4294967295,n=s+(o<<23&4294967295|o>>>9),o=e+(n^s^i)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=i+(e^n^s)+r[4]+1272893353&4294967295,i=e+(o<<11&4294967295|o>>>21),o=s+(i^e^n)+r[7]+4139469664&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^e)+r[10]+3200236656&4294967295,n=s+(o<<23&4294967295|o>>>9),o=e+(n^s^i)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=i+(e^n^s)+r[0]+3936430074&4294967295,i=e+(o<<11&4294967295|o>>>21),o=s+(i^e^n)+r[3]+3572445317&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^e)+r[6]+76029189&4294967295,n=s+(o<<23&4294967295|o>>>9),o=e+(n^s^i)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=i+(e^n^s)+r[12]+3873151461&4294967295,i=e+(o<<11&4294967295|o>>>21),o=s+(i^e^n)+r[15]+530742520&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^e)+r[2]+3299628645&4294967295,n=s+(o<<23&4294967295|o>>>9),o=e+(s^(n|~i))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=i+(n^(e|~s))+r[7]+1126891415&4294967295,i=e+(o<<10&4294967295|o>>>22),o=s+(e^(i|~n))+r[14]+2878612391&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~e))+r[5]+4237533241&4294967295,n=s+(o<<21&4294967295|o>>>11),o=e+(s^(n|~i))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=i+(n^(e|~s))+r[3]+2399980690&4294967295,i=e+(o<<10&4294967295|o>>>22),o=s+(e^(i|~n))+r[10]+4293915773&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~e))+r[1]+2240044497&4294967295,n=s+(o<<21&4294967295|o>>>11),o=e+(s^(n|~i))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=i+(n^(e|~s))+r[15]+4264355552&4294967295,i=e+(o<<10&4294967295|o>>>22),o=s+(e^(i|~n))+r[6]+2734768916&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~e))+r[13]+1309151649&4294967295,n=s+(o<<21&4294967295|o>>>11),o=e+(s^(n|~i))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=i+(n^(e|~s))+r[11]+3174756917&4294967295,i=e+(o<<10&4294967295|o>>>22),o=s+(e^(i|~n))+r[2]+718787259&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(s+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+s&4294967295,t.g[3]=t.g[3]+i&4294967295}Tr.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,s=this.h,i=0;i<e;){if(s==0)for(;i<=n;)S_(this,t,i),i+=this.blockSize;if(typeof t=="string"){for(;i<e;)if(r[s++]=t.charCodeAt(i++),s==this.blockSize){S_(this,r),s=0;break}}else for(;i<e;)if(r[s++]=t[i++],s==this.blockSize){S_(this,r),s=0;break}}this.h=s,this.i+=e};Tr.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function Oe(t,e){this.h=e;for(var n=[],r=!0,s=t.length-1;0<=s;s--){var i=t[s]|0;r&&i==e||(n[s]=i,r=!1)}this.g=n}var EZ={};function tb(t){return-128<=t&&128>t?RX(t,function(e){return new Oe([e|0],0>e?-1:0)}):new Oe([t|0],0>t?-1:0)}function qr(t){if(isNaN(t)||!isFinite(t))return pl;if(0>t)return Bt(qr(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=qx;return new Oe(e,0)}function f$(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return Bt(f$(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=qr(Math.pow(e,8)),r=pl,s=0;s<t.length;s+=8){var i=Math.min(8,t.length-s),o=parseInt(t.substring(s,s+i),e);8>i?(i=qr(Math.pow(e,i)),r=r.R(i).add(qr(o))):(r=r.R(n),r=r.add(qr(o)))}return r}var qx=4294967296,pl=tb(0),Hx=tb(1),NI=tb(16777216);W=Oe.prototype;W.ea=function(){if(Jn(this))return-Bt(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:qx+r)*e,e*=qx}return t};W.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(ys(this))return"0";if(Jn(this))return"-"+Bt(this).toString(t);for(var e=qr(Math.pow(t,6)),n=this,r="";;){var s=sm(n,e).g;n=rm(n,s.R(e));var i=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=s,ys(n))return i+r;for(;6>i.length;)i="0"+i;r=i+r}};W.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function ys(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function Jn(t){return t.h==-1}W.X=function(t){return t=rm(this,t),Jn(t)?-1:ys(t)?0:1};function Bt(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new Oe(n,~t.h).add(Hx)}W.abs=function(){return Jn(this)?Bt(this):this};W.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,s=0;s<=e;s++){var i=r+(this.D(s)&65535)+(t.D(s)&65535),o=(i>>>16)+(this.D(s)>>>16)+(t.D(s)>>>16);r=o>>>16,i&=65535,o&=65535,n[s]=o<<16|i}return new Oe(n,n[n.length-1]&-2147483648?-1:0)};function rm(t,e){return t.add(Bt(e))}W.R=function(t){if(ys(this)||ys(t))return pl;if(Jn(this))return Jn(t)?Bt(this).R(Bt(t)):Bt(Bt(this).R(t));if(Jn(t))return Bt(this.R(Bt(t)));if(0>this.X(NI)&&0>t.X(NI))return qr(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var s=0;s<t.g.length;s++){var i=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(s)>>>16,l=t.D(s)&65535;n[2*r+2*s]+=o*l,_f(n,2*r+2*s),n[2*r+2*s+1]+=i*l,_f(n,2*r+2*s+1),n[2*r+2*s+1]+=o*a,_f(n,2*r+2*s+1),n[2*r+2*s+2]+=i*a,_f(n,2*r+2*s+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new Oe(n,0)};function _f(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Qu(t,e){this.g=t,this.h=e}function sm(t,e){if(ys(e))throw Error("division by zero");if(ys(t))return new Qu(pl,pl);if(Jn(t))return e=sm(Bt(t),e),new Qu(Bt(e.g),Bt(e.h));if(Jn(e))return e=sm(t,Bt(e)),new Qu(Bt(e.g),e.h);if(30<t.g.length){if(Jn(t)||Jn(e))throw Error("slowDivide_ only works with positive integers.");for(var n=Hx,r=e;0>=r.X(t);)n=jI(n),r=jI(r);var s=ma(n,1),i=ma(r,1);for(r=ma(r,2),n=ma(n,2);!ys(r);){var o=i.add(r);0>=o.X(t)&&(s=s.add(n),i=o),r=ma(r,1),n=ma(n,1)}return e=rm(t,s.R(e)),new Qu(s,e)}for(s=pl;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),i=qr(n),o=i.R(e);Jn(o)||0<o.X(t);)n-=r,i=qr(n),o=i.R(e);ys(i)&&(i=Hx),s=s.add(i),t=rm(t,o)}return new Qu(s,t)}W.gb=function(t){return sm(this,t).h};W.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new Oe(n,this.h&t.h)};W.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new Oe(n,this.h|t.h)};W.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new Oe(n,this.h^t.h)};function jI(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new Oe(n,t.h)}function ma(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,s=[],i=0;i<r;i++)s[i]=0<e?t.D(i+n)>>>e|t.D(i+n+1)<<32-e:t.D(i+n);return new Oe(s,t.h)}nm.prototype.createWebChannel=nm.prototype.g;Ln.prototype.send=Ln.prototype.u;Ln.prototype.open=Ln.prototype.m;Ln.prototype.close=Ln.prototype.close;fg.NO_ERROR=0;fg.TIMEOUT=8;fg.HTTP_ERROR=6;PF.COMPLETE="complete";NF.EventType=wh;wh.OPEN="a";wh.CLOSE="b";wh.ERROR="c";wh.MESSAGE="d";Dt.prototype.listen=Dt.prototype.O;it.prototype.listenOnce=it.prototype.P;it.prototype.getLastError=it.prototype.Sa;it.prototype.getLastErrorCode=it.prototype.Ia;it.prototype.getStatus=it.prototype.da;it.prototype.getResponseJson=it.prototype.Wa;it.prototype.getResponseText=it.prototype.ja;it.prototype.send=it.prototype.ha;it.prototype.setWithCredentials=it.prototype.Oa;Tr.prototype.digest=Tr.prototype.l;Tr.prototype.reset=Tr.prototype.reset;Tr.prototype.update=Tr.prototype.j;Oe.prototype.add=Oe.prototype.add;Oe.prototype.multiply=Oe.prototype.R;Oe.prototype.modulo=Oe.prototype.gb;Oe.prototype.compare=Oe.prototype.X;Oe.prototype.toNumber=Oe.prototype.ea;Oe.prototype.toString=Oe.prototype.toString;Oe.prototype.getBits=Oe.prototype.D;Oe.fromNumber=qr;Oe.fromString=f$;var bZ=function(){return new nm},SZ=function(){return hg()},C_=fg,CZ=PF,AZ=ta,OI={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},TZ=Sh,xf=NF,IZ=it,kZ=Tr,yl=Oe;const DI="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}tn.UNAUTHENTICATED=new tn(null),tn.GOOGLE_CREDENTIALS=new tn("google-credentials-uid"),tn.FIRST_PARTY=new tn("first-party-uid"),tn.MOCK_USER=new tn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Su="10.5.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ho=new a1("@firebase/firestore");function Ku(){return Ho.logLevel}function X(t,...e){if(Ho.logLevel<=Te.DEBUG){const n=e.map(nb);Ho.debug(`Firestore (${Su}): ${t}`,...n)}}function Ss(t,...e){if(Ho.logLevel<=Te.ERROR){const n=e.map(nb);Ho.error(`Firestore (${Su}): ${t}`,...n)}}function su(t,...e){if(Ho.logLevel<=Te.WARN){const n=e.map(nb);Ho.warn(`Firestore (${Su}): ${t}`,...n)}}function nb(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ae(t="Unexpected state"){const e=`FIRESTORE (${Su}) INTERNAL ASSERTION FAILED: `+t;throw Ss(e),new Error(e)}function We(t,e){t||ae()}function ce(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class re extends Jo{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p${constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class RZ{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(tn.UNAUTHENTICATED))}shutdown(){}}class PZ{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class NZ{constructor(e){this.t=e,this.currentUser=tn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const s=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let i=new _i;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new _i,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{X("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(X("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new _i)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(X("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(We(typeof r.accessToken=="string"),new p$(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return We(e===null||typeof e=="string"),new tn(e)}}class jZ{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=tn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class OZ{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new jZ(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(tn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class DZ{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class FZ{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){const r=i=>{i.error!=null&&X("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,X("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{X("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):X("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(We(typeof n.token=="string"),this.R=n.token,new DZ(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $Z(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y${static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=$Z(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function Pe(t,e){return t<e?-1:t>e?1:0}function iu(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new re($.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new re($.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new re($.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new re($.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Et.fromMillis(Date.now())}static fromDate(e){return Et.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Et(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Pe(this.nanoseconds,e.nanoseconds):Pe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ue{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ue(e)}static min(){return new ue(new Et(0,0))}static max(){return new ue(new Et(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ad{constructor(e,n,r){n===void 0?n=0:n>e.length&&ae(),r===void 0?r=e.length-n:r>e.length-n&&ae(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Ad.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Ad?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class He extends Ad{construct(e,n,r){return new He(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new re($.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new He(n)}static emptyPath(){return new He([])}}const MZ=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class zt extends Ad{construct(e,n,r){return new zt(e,n,r)}static isValidIdentifier(e){return MZ.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),zt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new zt(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new re($.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new re($.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new re($.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new re($.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new zt(n)}static emptyPath(){return new zt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class se{constructor(e){this.path=e}static fromPath(e){return new se(He.fromString(e))}static fromName(e){return new se(He.fromString(e).popFirst(5))}static empty(){return new se(He.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&He.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return He.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new se(new He(e.slice()))}}function LZ(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=ue.fromTimestamp(r===1e9?new Et(n+1,0):new Et(n,r));return new Ii(s,se.empty(),e)}function VZ(t){return new Ii(t.readTime,t.key,-1)}class Ii{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Ii(ue.min(),se.empty(),-1)}static max(){return new Ii(ue.max(),se.empty(),-1)}}function UZ(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=se.comparator(t.documentKey,e.documentKey),n!==0?n:Pe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BZ="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class zZ{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Th(t){if(t.code!==$.FAILED_PRECONDITION||t.message!==BZ)throw t;X("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ae(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new F((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof F?n:F.resolve(n)}catch(n){return F.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):F.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):F.reject(n)}static resolve(e){return new F((n,r)=>{n(e)})}static reject(e){return new F((n,r)=>{r(e)})}static waitFor(e){return new F((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},l=>r(l))}),o=!0,i===s&&n()})}static or(e){let n=F.resolve(!1);for(const r of e)n=n.next(s=>s?F.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new F((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const c=l;n(e[c]).next(d=>{o[c]=d,++a,a===i&&r(o)},d=>s(d))}})}static doWhile(e,n){return new F((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function Ih(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rb{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.se(r),this.oe=r=>n.writeSequenceNumber(r))}se(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.oe&&this.oe(e),e}}rb._e=-1;function wg(t){return t==null}function im(t){return t===0&&1/t==-1/0}function WZ(t){return typeof t=="number"&&Number.isInteger(t)&&!im(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FI(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Cu(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function m$(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(e,n){this.comparator=e,this.root=n||Lt.EMPTY}insert(e,n){return new Ze(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Lt.BLACK,null,null))}remove(e){return new Ze(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Lt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new wf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new wf(this.root,e,this.comparator,!1)}getReverseIterator(){return new wf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new wf(this.root,e,this.comparator,!0)}}class wf{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Lt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Lt.RED,this.left=s??Lt.EMPTY,this.right=i??Lt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Lt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Lt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Lt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Lt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Lt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ae();const e=this.left.check();if(e!==this.right.check())throw ae();return e+(this.isRed()?0:1)}}Lt.EMPTY=null,Lt.RED=!0,Lt.BLACK=!1;Lt.EMPTY=new class{constructor(){this.size=0}get key(){throw ae()}get value(){throw ae()}get color(){throw ae()}get left(){throw ae()}get right(){throw ae()}copy(e,n,r,s,i){return this}insert(e,n,r){return new Lt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e){this.comparator=e,this.data=new Ze(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new $I(this.data.getIterator())}getIteratorFrom(e){return new $I(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ht)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ht(this.comparator);return n.data=e,n}}class $I{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr{constructor(e){this.fields=e,e.sort(zt.comparator)}static empty(){return new xr([])}unionWith(e){let n=new Ht(zt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new xr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return iu(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g$ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new g$("Invalid base64 string: "+i):i}}(e);return new un(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new un(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Pe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}un.EMPTY_BYTE_STRING=new un("");const qZ=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ki(t){if(We(!!t),typeof t=="string"){let e=0;const n=qZ.exec(t);if(We(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ft(t.seconds),nanos:ft(t.nanos)}}function ft(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Go(t){return typeof t=="string"?un.fromBase64String(t):un.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sb(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function ib(t){const e=t.mapValue.fields.__previous_value__;return sb(e)?ib(e):e}function Td(t){const e=ki(t.mapValue.fields.__local_write_time__.timestampValue);return new Et(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HZ{constructor(e,n,r,s,i,o,a,l,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}class Id{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Id("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Id&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ef={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Qo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?sb(t)?4:GZ(t)?9007199254740991:10:ae()}function Zr(t,e){if(t===e)return!0;const n=Qo(t);if(n!==Qo(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Td(t).isEqual(Td(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=ki(s.timestampValue),a=ki(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Go(s.bytesValue).isEqual(Go(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return ft(s.geoPointValue.latitude)===ft(i.geoPointValue.latitude)&&ft(s.geoPointValue.longitude)===ft(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return ft(s.integerValue)===ft(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=ft(s.doubleValue),a=ft(i.doubleValue);return o===a?im(o)===im(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return iu(t.arrayValue.values||[],e.arrayValue.values||[],Zr);case 10:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(FI(o)!==FI(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Zr(o[l],a[l])))return!1;return!0}(t,e);default:return ae()}}function kd(t,e){return(t.values||[]).find(n=>Zr(n,e))!==void 0}function ou(t,e){if(t===e)return 0;const n=Qo(t),r=Qo(e);if(n!==r)return Pe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Pe(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=ft(i.integerValue||i.doubleValue),l=ft(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return MI(t.timestampValue,e.timestampValue);case 4:return MI(Td(t),Td(e));case 5:return Pe(t.stringValue,e.stringValue);case 6:return function(i,o){const a=Go(i),l=Go(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const d=Pe(a[c],l[c]);if(d!==0)return d}return Pe(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=Pe(ft(i.latitude),ft(o.latitude));return a!==0?a:Pe(ft(i.longitude),ft(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(i,o){const a=i.values||[],l=o.values||[];for(let c=0;c<a.length&&c<l.length;++c){const d=ou(a[c],l[c]);if(d)return d}return Pe(a.length,l.length)}(t.arrayValue,e.arrayValue);case 10:return function(i,o){if(i===Ef.mapValue&&o===Ef.mapValue)return 0;if(i===Ef.mapValue)return 1;if(o===Ef.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),c=o.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let h=0;h<l.length&&h<d.length;++h){const f=Pe(l[h],d[h]);if(f!==0)return f;const p=ou(a[l[h]],c[d[h]]);if(p!==0)return p}return Pe(l.length,d.length)}(t.mapValue,e.mapValue);default:throw ae()}}function MI(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Pe(t,e);const n=ki(t),r=ki(e),s=Pe(n.seconds,r.seconds);return s!==0?s:Pe(n.nanos,r.nanos)}function au(t){return Gx(t)}function Gx(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=ki(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Go(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return se.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Gx(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Gx(n.fields[o])}`;return s+"}"}(t.mapValue):ae()}function Qx(t){return!!t&&"integerValue"in t}function ob(t){return!!t&&"arrayValue"in t}function LI(t){return!!t&&"nullValue"in t}function VI(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function hp(t){return!!t&&"mapValue"in t}function $c(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Cu(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=$c(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=$c(t.arrayValue.values[n]);return e}return Object.assign({},t)}function GZ(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{constructor(e){this.value=e}static empty(){return new Xn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!hp(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=$c(n)}setAll(e){let n=zt.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=$c(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());hp(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Zr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];hp(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Cu(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Xn($c(this.value))}}function v$(t){const e=[];return Cu(t.fields,(n,r)=>{const s=new zt([n]);if(hp(r)){const i=v$(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new xr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new rn(e,0,ue.min(),ue.min(),ue.min(),Xn.empty(),0)}static newFoundDocument(e,n,r,s){return new rn(e,1,n,ue.min(),r,s,0)}static newNoDocument(e,n){return new rn(e,2,n,ue.min(),ue.min(),Xn.empty(),0)}static newUnknownDocument(e,n){return new rn(e,3,n,ue.min(),ue.min(),Xn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ue.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Xn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Xn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ue.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof rn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new rn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class om{constructor(e,n){this.position=e,this.inclusive=n}}function UI(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=se.comparator(se.fromName(o.referenceValue),n.key):r=ou(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function BI(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Zr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class am{constructor(e,n="asc"){this.field=e,this.dir=n}}function QZ(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _${}class xt extends _${constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new YZ(e,n,r):n==="array-contains"?new ZZ(e,r):n==="in"?new eee(e,r):n==="not-in"?new tee(e,r):n==="array-contains-any"?new nee(e,r):new xt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new JZ(e,r):new XZ(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(ou(n,this.value)):n!==null&&Qo(this.value)===Qo(n)&&this.matchesComparison(ou(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ae()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class es extends _${constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new es(e,n)}matches(e){return x$(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function x$(t){return t.op==="and"}function w$(t){return KZ(t)&&x$(t)}function KZ(t){for(const e of t.filters)if(e instanceof es)return!1;return!0}function Kx(t){if(t instanceof xt)return t.field.canonicalString()+t.op.toString()+au(t.value);if(w$(t))return t.filters.map(e=>Kx(e)).join(",");{const e=t.filters.map(n=>Kx(n)).join(",");return`${t.op}(${e})`}}function E$(t,e){return t instanceof xt?function(r,s){return s instanceof xt&&r.op===s.op&&r.field.isEqual(s.field)&&Zr(r.value,s.value)}(t,e):t instanceof es?function(r,s){return s instanceof es&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&E$(o,s.filters[a]),!0):!1}(t,e):void ae()}function b$(t){return t instanceof xt?function(n){return`${n.field.canonicalString()} ${n.op} ${au(n.value)}`}(t):t instanceof es?function(n){return n.op.toString()+" {"+n.getFilters().map(b$).join(" ,")+"}"}(t):"Filter"}class YZ extends xt{constructor(e,n,r){super(e,n,r),this.key=se.fromName(r.referenceValue)}matches(e){const n=se.comparator(e.key,this.key);return this.matchesComparison(n)}}class JZ extends xt{constructor(e,n){super(e,"in",n),this.keys=S$("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class XZ extends xt{constructor(e,n){super(e,"not-in",n),this.keys=S$("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function S$(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>se.fromName(r.referenceValue))}class ZZ extends xt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return ob(n)&&kd(n.arrayValue,this.value)}}class eee extends xt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&kd(this.value.arrayValue,n)}}class tee extends xt{constructor(e,n){super(e,"not-in",n)}matches(e){if(kd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!kd(this.value.arrayValue,n)}}class nee extends xt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!ob(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>kd(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ree{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ce=null}}function zI(t,e=null,n=[],r=[],s=null,i=null,o=null){return new ree(t,e,n,r,s,i,o)}function ab(t){const e=ce(t);if(e.ce===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Kx(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),wg(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>au(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>au(r)).join(",")),e.ce=n}return e.ce}function lb(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!QZ(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!E$(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!BI(t.startAt,e.startAt)&&BI(t.endAt,e.endAt)}function Yx(t){return se.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eg{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function see(t,e,n,r,s,i,o,a){return new Eg(t,e,n,r,s,i,o,a)}function C$(t){return new Eg(t)}function WI(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function iee(t){return t.collectionGroup!==null}function Mc(t){const e=ce(t);if(e.le===null){e.le=[];const n=new Set;for(const i of e.explicitOrderBy)e.le.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ht(zt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.le.push(new am(i,r))}),n.has(zt.keyField().canonicalString())||e.le.push(new am(zt.keyField(),r))}return e.le}function Yr(t){const e=ce(t);return e.he||(e.he=oee(e,Mc(t))),e.he}function oee(t,e){if(t.limitType==="F")return zI(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new am(s.field,i)});const n=t.endAt?new om(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new om(t.startAt.position,t.startAt.inclusive):null;return zI(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Jx(t,e,n){return new Eg(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function bg(t,e){return lb(Yr(t),Yr(e))&&t.limitType===e.limitType}function A$(t){return`${ab(Yr(t))}|lt:${t.limitType}`}function Ta(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>b$(s)).join(", ")}]`),wg(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>au(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>au(s)).join(",")),`Target(${r})`}(Yr(t))}; limitType=${t.limitType})`}function Sg(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):se.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Mc(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const c=UI(o,a,l);return o.inclusive?c<=0:c<0}(r.startAt,Mc(r),s)||r.endAt&&!function(o,a,l){const c=UI(o,a,l);return o.inclusive?c>=0:c>0}(r.endAt,Mc(r),s))}(t,e)}function aee(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function T$(t){return(e,n)=>{let r=!1;for(const s of Mc(t)){const i=lee(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function lee(t,e,n){const r=t.field.isKeyField()?se.comparator(e.key,n.key):function(i,o,a){const l=o.data.field(i),c=a.data.field(i);return l!==null&&c!==null?ou(l,c):ae()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ae()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Au{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Cu(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return m$(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uee=new Ze(se.comparator);function Cs(){return uee}const I$=new Ze(se.comparator);function hc(...t){let e=I$;for(const n of t)e=e.insert(n.key,n);return e}function k$(t){let e=I$;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ao(){return Lc()}function R$(){return Lc()}function Lc(){return new Au(t=>t.toString(),(t,e)=>t.isEqual(e))}const cee=new Ze(se.comparator),dee=new Ht(se.comparator);function Ee(...t){let e=dee;for(const n of t)e=e.add(n);return e}const hee=new Ht(Pe);function fee(){return hee}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P$(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:im(e)?"-0":e}}function N$(t){return{integerValue:""+t}}function pee(t,e){return WZ(e)?N$(e):P$(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cg{constructor(){this._=void 0}}function yee(t,e,n){return t instanceof lm?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&sb(i)&&(i=ib(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof Rd?O$(t,e):t instanceof Pd?D$(t,e):function(s,i){const o=j$(s,i),a=qI(o)+qI(s.Ie);return Qx(o)&&Qx(s.Ie)?N$(a):P$(s.serializer,a)}(t,e)}function mee(t,e,n){return t instanceof Rd?O$(t,e):t instanceof Pd?D$(t,e):n}function j$(t,e){return t instanceof um?function(r){return Qx(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class lm extends Cg{}class Rd extends Cg{constructor(e){super(),this.elements=e}}function O$(t,e){const n=F$(e);for(const r of t.elements)n.some(s=>Zr(s,r))||n.push(r);return{arrayValue:{values:n}}}class Pd extends Cg{constructor(e){super(),this.elements=e}}function D$(t,e){let n=F$(e);for(const r of t.elements)n=n.filter(s=>!Zr(s,r));return{arrayValue:{values:n}}}class um extends Cg{constructor(e,n){super(),this.serializer=e,this.Ie=n}}function qI(t){return ft(t.integerValue||t.doubleValue)}function F$(t){return ob(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function gee(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Rd&&s instanceof Rd||r instanceof Pd&&s instanceof Pd?iu(r.elements,s.elements,Zr):r instanceof um&&s instanceof um?Zr(r.Ie,s.Ie):r instanceof lm&&s instanceof lm}(t.transform,e.transform)}class vee{constructor(e,n){this.version=e,this.transformResults=n}}class Jr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Jr}static exists(e){return new Jr(void 0,e)}static updateTime(e){return new Jr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function fp(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Ag{}function $$(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new ub(t.key,Jr.none()):new kh(t.key,t.data,Jr.none());{const n=t.data,r=Xn.empty();let s=new Ht(zt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new na(t.key,r,new xr(s.toArray()),Jr.none())}}function _ee(t,e,n){t instanceof kh?function(s,i,o){const a=s.value.clone(),l=GI(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof na?function(s,i,o){if(!fp(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=GI(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(M$(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Vc(t,e,n,r){return t instanceof kh?function(i,o,a,l){if(!fp(i.precondition,o))return a;const c=i.value.clone(),d=QI(i.fieldTransforms,l,o);return c.setAll(d),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof na?function(i,o,a,l){if(!fp(i.precondition,o))return a;const c=QI(i.fieldTransforms,l,o),d=o.data;return d.setAll(M$(i)),d.setAll(c),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(i,o,a){return fp(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function xee(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=j$(r.transform,s||null);i!=null&&(n===null&&(n=Xn.empty()),n.set(r.field,i))}return n||null}function HI(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&iu(r,s,(i,o)=>gee(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class kh extends Ag{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class na extends Ag{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function M$(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function GI(t,e,n){const r=new Map;We(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,mee(o,a,n[s]))}return r}function QI(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,yee(i,o,e))}return r}class ub extends Ag{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class wee extends Ag{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eee{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&_ee(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Vc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Vc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=R$();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const l=$$(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(ue.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ee())}isEqual(e){return this.batchId===e.batchId&&iu(this.mutations,e.mutations,(n,r)=>HI(n,r))&&iu(this.baseMutations,e.baseMutations,(n,r)=>HI(n,r))}}class cb{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){We(e.mutations.length===r.length);let s=function(){return cee}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new cb(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bee{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class See{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ht,Se;function Cee(t){switch(t){default:return ae();case $.CANCELLED:case $.UNKNOWN:case $.DEADLINE_EXCEEDED:case $.RESOURCE_EXHAUSTED:case $.INTERNAL:case $.UNAVAILABLE:case $.UNAUTHENTICATED:return!1;case $.INVALID_ARGUMENT:case $.NOT_FOUND:case $.ALREADY_EXISTS:case $.PERMISSION_DENIED:case $.FAILED_PRECONDITION:case $.ABORTED:case $.OUT_OF_RANGE:case $.UNIMPLEMENTED:case $.DATA_LOSS:return!0}}function L$(t){if(t===void 0)return Ss("GRPC error has no .code"),$.UNKNOWN;switch(t){case ht.OK:return $.OK;case ht.CANCELLED:return $.CANCELLED;case ht.UNKNOWN:return $.UNKNOWN;case ht.DEADLINE_EXCEEDED:return $.DEADLINE_EXCEEDED;case ht.RESOURCE_EXHAUSTED:return $.RESOURCE_EXHAUSTED;case ht.INTERNAL:return $.INTERNAL;case ht.UNAVAILABLE:return $.UNAVAILABLE;case ht.UNAUTHENTICATED:return $.UNAUTHENTICATED;case ht.INVALID_ARGUMENT:return $.INVALID_ARGUMENT;case ht.NOT_FOUND:return $.NOT_FOUND;case ht.ALREADY_EXISTS:return $.ALREADY_EXISTS;case ht.PERMISSION_DENIED:return $.PERMISSION_DENIED;case ht.FAILED_PRECONDITION:return $.FAILED_PRECONDITION;case ht.ABORTED:return $.ABORTED;case ht.OUT_OF_RANGE:return $.OUT_OF_RANGE;case ht.UNIMPLEMENTED:return $.UNIMPLEMENTED;case ht.DATA_LOSS:return $.DATA_LOSS;default:return ae()}}(Se=ht||(ht={}))[Se.OK=0]="OK",Se[Se.CANCELLED=1]="CANCELLED",Se[Se.UNKNOWN=2]="UNKNOWN",Se[Se.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Se[Se.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Se[Se.NOT_FOUND=5]="NOT_FOUND",Se[Se.ALREADY_EXISTS=6]="ALREADY_EXISTS",Se[Se.PERMISSION_DENIED=7]="PERMISSION_DENIED",Se[Se.UNAUTHENTICATED=16]="UNAUTHENTICATED",Se[Se.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Se[Se.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Se[Se.ABORTED=10]="ABORTED",Se[Se.OUT_OF_RANGE=11]="OUT_OF_RANGE",Se[Se.UNIMPLEMENTED=12]="UNIMPLEMENTED",Se[Se.INTERNAL=13]="INTERNAL",Se[Se.UNAVAILABLE=14]="UNAVAILABLE",Se[Se.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Aee(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tee=new yl([4294967295,4294967295],0);function KI(t){const e=Aee().encode(t),n=new kZ;return n.update(e),new Uint8Array(n.digest())}function YI(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new yl([n,r],0),new yl([s,i],0)]}class db{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new fc(`Invalid padding: ${n}`);if(r<0)throw new fc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new fc(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new fc(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=yl.fromNumber(this.Te)}de(e,n,r){let s=e.add(n.multiply(yl.fromNumber(r)));return s.compare(Tee)===1&&(s=new yl([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;const n=KI(e),[r,s]=YI(n);for(let i=0;i<this.hashCount;i++){const o=this.de(r,s,i);if(!this.Ae(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new db(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Te===0)return;const n=KI(e),[r,s]=YI(n);for(let i=0;i<this.hashCount;i++){const o=this.de(r,s,i);this.Re(o)}}Re(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class fc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tg{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Rh.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Tg(ue.min(),s,new Ze(Pe),Cs(),Ee())}}class Rh{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Rh(r,n,Ee(),Ee(),Ee())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp{constructor(e,n,r,s){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=s}}class V${constructor(e,n){this.targetId=e,this.fe=n}}class U${constructor(e,n,r=un.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class JI{constructor(){this.ge=0,this.pe=ZI(),this.ye=un.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=Ee(),n=Ee(),r=Ee();return this.pe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:ae()}}),new Rh(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=ZI()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1}Be(){this.Se=!0,this.we=!0}}class Iee{constructor(e){this.Le=e,this.ke=new Map,this.qe=Cs(),this.Qe=XI(),this.Ke=new Ze(Pe)}$e(e){for(const n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(const n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{const r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:ae()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,s)=>{this.je(s)&&n(s)})}Je(e){const n=e.targetId,r=e.fe.count,s=this.Ye(n);if(s){const i=s.target;if(Yx(i))if(r===0){const o=new se(i.path);this.We(n,o,rn.newNoDocument(o,ue.min()))}else We(r===1);else{const o=this.Ze(n);if(o!==r){const a=this.Xe(e),l=a?this.et(a,e,o):1;if(l!==0){this.He(n);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,c)}}}}}Xe(e){const n=e.fe.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=Go(r).toUint8Array()}catch(l){if(l instanceof g$)return su("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new db(o,s,i)}catch(l){return su(l instanceof fc?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Te===0?null:a}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.We(n,i,null),s++)}),s}it(e){const n=new Map;this.ke.forEach((i,o)=>{const a=this.Ye(o);if(a){if(i.current&&Yx(a.target)){const l=new se(a.target.path);this.qe.get(l)!==null||this.st(o,l)||this.We(o,l,rn.newNoDocument(l,e))}i.De&&(n.set(o,i.ve()),i.Fe())}});let r=Ee();this.Qe.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Ye(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.qe.forEach((i,o)=>o.setReadTime(e));const s=new Tg(e,n,this.Ke,this.qe,r);return this.qe=Cs(),this.Qe=XI(),this.Ke=new Ze(Pe),s}Ue(e,n){if(!this.je(e))return;const r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;const s=this.ze(e);this.st(e,n)?s.Me(n,1):s.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){const n=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new JI,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new Ht(Pe),this.Qe=this.Qe.insert(e,n)),n}je(e){const n=this.Ye(e)!==null;return n||X("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){const n=this.ke.get(e);return n&&n.be?null:this.Le._t(e)}He(e){this.ke.set(e,new JI),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function XI(){return new Ze(se.comparator)}function ZI(){return new Ze(se.comparator)}const kee=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),Ree=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),Pee=(()=>({and:"AND",or:"OR"}))();class Nee{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Xx(t,e){return t.useProto3Json||wg(e)?e:{value:e}}function cm(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function B$(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function jee(t,e){return cm(t,e.toTimestamp())}function Xr(t){return We(!!t),ue.fromTimestamp(function(n){const r=ki(n);return new Et(r.seconds,r.nanos)}(t))}function hb(t,e){return function(r){return new He(["projects",r.projectId,"databases",r.database])}(t).child("documents").child(e).canonicalString()}function z$(t){const e=He.fromString(t);return We(G$(e)),e}function Zx(t,e){return hb(t.databaseId,e.path)}function A_(t,e){const n=z$(e);if(n.get(1)!==t.databaseId.projectId)throw new re($.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new re($.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new se(W$(n))}function ew(t,e){return hb(t.databaseId,e)}function Oee(t){const e=z$(t);return e.length===4?He.emptyPath():W$(e)}function tw(t){return new He(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function W$(t){return We(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function ek(t,e,n){return{name:Zx(t,e),fields:n.value.mapValue.fields}}function Dee(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:ae()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,d){return c.useProto3Json?(We(d===void 0||typeof d=="string"),un.fromBase64String(d||"")):(We(d===void 0||d instanceof Uint8Array),un.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const d=c.code===void 0?$.UNKNOWN:L$(c.code);return new re(d,c.message||"")}(o);n=new U$(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=A_(t,r.document.name),i=Xr(r.document.updateTime),o=r.document.createTime?Xr(r.document.createTime):ue.min(),a=new Xn({mapValue:{fields:r.document.fields}}),l=rn.newFoundDocument(s,i,o,a),c=r.targetIds||[],d=r.removedTargetIds||[];n=new pp(c,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=A_(t,r.document),i=r.readTime?Xr(r.readTime):ue.min(),o=rn.newNoDocument(s,i),a=r.removedTargetIds||[];n=new pp([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=A_(t,r.document),i=r.removedTargetIds||[];n=new pp([],i,s,null)}else{if(!("filter"in e))return ae();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new See(s,i),a=r.targetId;n=new V$(a,o)}}return n}function Fee(t,e){let n;if(e instanceof kh)n={update:ek(t,e.key,e.value)};else if(e instanceof ub)n={delete:Zx(t,e.key)};else if(e instanceof na)n={update:ek(t,e.key,e.data),updateMask:qee(e.fieldMask)};else{if(!(e instanceof wee))return ae();n={verify:Zx(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof lm)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Rd)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Pd)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof um)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw ae()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:jee(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ae()}(t,e.precondition)),n}function $ee(t,e){return t&&t.length>0?(We(e!==void 0),t.map(n=>function(s,i){let o=s.updateTime?Xr(s.updateTime):Xr(i);return o.isEqual(ue.min())&&(o=Xr(i)),new vee(o,s.transformResults||[])}(n,e))):[]}function Mee(t,e){return{documents:[ew(t,e.path)]}}function Lee(t,e){const n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=ew(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ew(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const s=function(l){if(l.length!==0)return H$(es.create(l,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const i=function(l){if(l.length!==0)return l.map(c=>function(h){return{field:Ia(h.field),direction:Bee(h.dir)}}(c))}(e.orderBy);i&&(n.structuredQuery.orderBy=i);const o=Xx(t,e.limit);return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),n}function Vee(t){let e=Oee(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){We(r===1);const d=n.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];n.where&&(i=function(h){const f=q$(h);return f instanceof es&&w$(f)?f.getFilters():[f]}(n.where));let o=[];n.orderBy&&(o=function(h){return h.map(f=>function(y){return new am(ka(y.field),function(_){switch(_){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(f))}(n.orderBy));let a=null;n.limit&&(a=function(h){let f;return f=typeof h=="object"?h.value:h,wg(f)?null:f}(n.limit));let l=null;n.startAt&&(l=function(h){const f=!!h.before,p=h.values||[];return new om(p,f)}(n.startAt));let c=null;return n.endAt&&(c=function(h){const f=!h.before,p=h.values||[];return new om(p,f)}(n.endAt)),see(e,s,o,i,a,"F",l,c)}function Uee(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ae()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function q$(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=ka(n.unaryFilter.field);return xt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=ka(n.unaryFilter.field);return xt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=ka(n.unaryFilter.field);return xt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=ka(n.unaryFilter.field);return xt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ae()}}(t):t.fieldFilter!==void 0?function(n){return xt.create(ka(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ae()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return es.create(n.compositeFilter.filters.map(r=>q$(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ae()}}(n.compositeFilter.op))}(t):ae()}function Bee(t){return kee[t]}function zee(t){return Ree[t]}function Wee(t){return Pee[t]}function Ia(t){return{fieldPath:t.canonicalString()}}function ka(t){return zt.fromServerFormat(t.fieldPath)}function H$(t){return t instanceof xt?function(n){if(n.op==="=="){if(VI(n.value))return{unaryFilter:{field:Ia(n.field),op:"IS_NAN"}};if(LI(n.value))return{unaryFilter:{field:Ia(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(VI(n.value))return{unaryFilter:{field:Ia(n.field),op:"IS_NOT_NAN"}};if(LI(n.value))return{unaryFilter:{field:Ia(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ia(n.field),op:zee(n.op),value:n.value}}}(t):t instanceof es?function(n){const r=n.getFilters().map(s=>H$(s));return r.length===1?r[0]:{compositeFilter:{op:Wee(n.op),filters:r}}}(t):ae()}function qee(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function G$(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(e,n,r,s,i=ue.min(),o=ue.min(),a=un.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new ii(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new ii(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ii(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ii(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hee{constructor(e){this.ut=e}}function Gee(t){const e=Vee({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Jx(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qee{constructor(){this.on=new Kee}addToCollectionParentIndex(e,n){return this.on.add(n),F.resolve()}getCollectionParents(e,n){return F.resolve(this.on.getEntries(n))}addFieldIndex(e,n){return F.resolve()}deleteFieldIndex(e,n){return F.resolve()}deleteAllFieldIndexes(e){return F.resolve()}createTargetIndexes(e,n){return F.resolve()}getDocumentsMatchingTarget(e,n){return F.resolve(null)}getIndexType(e,n){return F.resolve(0)}getFieldIndexes(e,n){return F.resolve([])}getNextCollectionGroupToUpdate(e){return F.resolve(null)}getMinOffset(e,n){return F.resolve(Ii.min())}getMinOffsetFromCollectionGroup(e,n){return F.resolve(Ii.min())}updateCollectionGroup(e,n,r){return F.resolve()}updateIndexEntries(e,n){return F.resolve()}}class Kee{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Ht(He.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Ht(He.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new lu(0)}static Nn(){return new lu(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yee{constructor(){this.changes=new Au(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,rn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?F.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jee{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xee{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Vc(r.mutation,s,xr.empty(),Et.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ee()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ee()){const s=ao();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=hc();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=ao();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ee()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=Cs();const o=Lc(),a=function(){return Lc()}();return n.forEach((l,c)=>{const d=r.get(c.key);s.has(c.key)&&(d===void 0||d.mutation instanceof na)?i=i.insert(c.key,c):d!==void 0?(o.set(c.key,d.mutation.getFieldMask()),Vc(d.mutation,c,d.mutation.getFieldMask(),Et.now())):o.set(c.key,xr.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,d)=>o.set(c,d)),n.forEach((c,d)=>{var h;return a.set(c,new Jee(d,(h=o.get(c))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){const r=Lc();let s=new Ze((o,a)=>o-a),i=Ee();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let d=r.get(l)||xr.empty();d=a.applyToLocalView(c,d),r.set(l,d);const h=(s.get(a.batchId)||Ee()).add(l);s=s.insert(a.batchId,h)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,d=l.value,h=R$();d.forEach(f=>{if(!i.has(f)){const p=$$(n.get(f),r.get(f));p!==null&&h.set(f,p),i=i.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,h))}return F.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return se.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):iee(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):F.resolve(ao());let a=-1,l=i;return o.next(c=>F.forEach(c,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),i.get(d)?F.resolve():this.remoteDocumentCache.getEntry(e,d).next(f=>{l=l.insert(d,f)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,Ee())).next(d=>({batchId:a,changes:k$(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new se(n)).next(r=>{let s=hc();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=hc();return this.indexManager.getCollectionParents(e,i).next(a=>F.forEach(a,l=>{const c=function(h,f){return new Eg(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r,s).next(d=>{d.forEach((h,f)=>{o=o.insert(h,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((l,c)=>{const d=c.getKey();o.get(d)===null&&(o=o.insert(d,rn.newInvalidDocument(d)))});let a=hc();return o.forEach((l,c)=>{const d=i.get(l);d!==void 0&&Vc(d.mutation,c,xr.empty(),Et.now()),Sg(n,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zee{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,n){return F.resolve(this.ur.get(n))}saveBundleMetadata(e,n){return this.ur.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Xr(s.createTime)}}(n)),F.resolve()}getNamedQuery(e,n){return F.resolve(this.cr.get(n))}saveNamedQuery(e,n){return this.cr.set(n.name,function(s){return{name:s.name,query:Gee(s.bundledQuery),readTime:Xr(s.readTime)}}(n)),F.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ete{constructor(){this.overlays=new Ze(se.comparator),this.lr=new Map}getOverlay(e,n){return F.resolve(this.overlays.get(n))}getOverlays(e,n){const r=ao();return F.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.lt(e,n,i)}),F.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.lr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.lr.delete(r)),F.resolve()}getOverlaysForCollection(e,n,r){const s=ao(),i=n.length+1,o=new se(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return F.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Ze((c,d)=>c-d);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let d=i.get(c.largestBatchId);d===null&&(d=ao(),i=i.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const a=ao(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>a.set(c,d)),!(a.size()>=s)););return F.resolve(a)}lt(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.lr.get(s.largestBatchId).delete(r.key);this.lr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new bee(n,r));let i=this.lr.get(n);i===void 0&&(i=Ee(),this.lr.set(n,i)),this.lr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fb{constructor(){this.hr=new Ht(Nt.Pr),this.Ir=new Ht(Nt.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,n){const r=new Nt(e,n);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.dr(new Nt(e,n))}Ar(e,n){e.forEach(r=>this.removeReference(r,n))}Rr(e){const n=new se(new He([])),r=new Nt(n,e),s=new Nt(n,e+1),i=[];return this.Ir.forEachInRange([r,s],o=>{this.dr(o),i.push(o.key)}),i}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const n=new se(new He([])),r=new Nt(n,e),s=new Nt(n,e+1);let i=Ee();return this.Ir.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Nt(e,0),r=this.hr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Nt{constructor(e,n){this.key=e,this.gr=n}static Pr(e,n){return se.comparator(e.key,n.key)||Pe(e.gr,n.gr)}static Tr(e,n){return Pe(e.gr,n.gr)||se.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tte{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.pr=1,this.yr=new Ht(Nt.Pr)}checkEmpty(e){return F.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Eee(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.yr=this.yr.add(new Nt(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return F.resolve(o)}lookupMutationBatch(e,n){return F.resolve(this.wr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.Sr(r),i=s<0?0:s;return F.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return F.resolve(this.mutationQueue.length===0?-1:this.pr-1)}getAllMutationBatches(e){return F.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Nt(n,0),s=new Nt(n,Number.POSITIVE_INFINITY),i=[];return this.yr.forEachInRange([r,s],o=>{const a=this.wr(o.gr);i.push(a)}),F.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ht(Pe);return n.forEach(s=>{const i=new Nt(s,0),o=new Nt(s,Number.POSITIVE_INFINITY);this.yr.forEachInRange([i,o],a=>{r=r.add(a.gr)})}),F.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;se.isDocumentKey(i)||(i=i.child(""));const o=new Nt(new se(i),0);let a=new Ht(Pe);return this.yr.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.gr)),!0)},o),F.resolve(this.br(a))}br(e){const n=[];return e.forEach(r=>{const s=this.wr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){We(this.Dr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.yr;return F.forEach(n.mutations,s=>{const i=new Nt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,n){const r=new Nt(n,0),s=this.yr.firstAfterOrEqual(r);return F.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,F.resolve()}Dr(e,n){return this.Sr(e)}Sr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}wr(e){const n=this.Sr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nte{constructor(e){this.Cr=e,this.docs=function(){return new Ze(se.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Cr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return F.resolve(r?r.document.mutableCopy():rn.newInvalidDocument(n))}getEntries(e,n){let r=Cs();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():rn.newInvalidDocument(s))}),F.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Cs();const o=n.path,a=new se(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:d}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||UZ(VZ(d),r)<=0||(s.has(d.key)||Sg(n,d))&&(i=i.insert(d.key,d.mutableCopy()))}return F.resolve(i)}getAllFromCollectionGroup(e,n,r,s){ae()}vr(e,n){return F.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new rte(this)}getSize(e){return F.resolve(this.size)}}class rte extends Yee{constructor(e){super(),this._r=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this._r.addEntry(e,s)):this._r.removeEntry(r)}),F.waitFor(n)}getFromCache(e,n){return this._r.getEntry(e,n)}getAllFromCache(e,n){return this._r.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ste{constructor(e){this.persistence=e,this.Fr=new Au(n=>ab(n),lb),this.lastRemoteSnapshotVersion=ue.min(),this.highestTargetId=0,this.Mr=0,this.Or=new fb,this.targetCount=0,this.Nr=lu.On()}forEachTarget(e,n){return this.Fr.forEach((r,s)=>n(s)),F.resolve()}getLastRemoteSnapshotVersion(e){return F.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return F.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),F.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Mr&&(this.Mr=n),F.resolve()}kn(e){this.Fr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Nr=new lu(n),this.highestTargetId=n),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,n){return this.kn(n),this.targetCount+=1,F.resolve()}updateTargetData(e,n){return this.kn(n),F.resolve()}removeTargetData(e,n){return this.Fr.delete(n.target),this.Or.Rr(n.targetId),this.targetCount-=1,F.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Fr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Fr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),F.waitFor(i).next(()=>s)}getTargetCount(e){return F.resolve(this.targetCount)}getTargetData(e,n){const r=this.Fr.get(n)||null;return F.resolve(r)}addMatchingKeys(e,n,r){return this.Or.Er(n,r),F.resolve()}removeMatchingKeys(e,n,r){this.Or.Ar(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),F.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Or.Rr(n),F.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Or.mr(n);return F.resolve(r)}containsKey(e,n){return F.resolve(this.Or.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ite{constructor(e,n){this.Br={},this.overlays={},this.Lr=new rb(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new ste(this),this.indexManager=new Qee,this.remoteDocumentCache=function(s){return new nte(s)}(r=>this.referenceDelegate.Qr(r)),this.serializer=new Hee(n),this.Kr=new Zee(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new ete,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Br[e.toKey()];return r||(r=new tte(n,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,n,r){X("MemoryPersistence","Starting transaction:",e);const s=new ote(this.Lr.next());return this.referenceDelegate.$r(),r(s).next(i=>this.referenceDelegate.Ur(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Wr(e,n){return F.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,n)))}}class ote extends zZ{constructor(e){super(),this.currentSequenceNumber=e}}class pb{constructor(e){this.persistence=e,this.Gr=new fb,this.zr=null}static jr(e){return new pb(e)}get Hr(){if(this.zr)return this.zr;throw ae()}addReference(e,n,r){return this.Gr.addReference(r,n),this.Hr.delete(r.toString()),F.resolve()}removeReference(e,n,r){return this.Gr.removeReference(r,n),this.Hr.add(r.toString()),F.resolve()}markPotentiallyOrphaned(e,n){return this.Hr.add(n.toString()),F.resolve()}removeTarget(e,n){this.Gr.Rr(n.targetId).forEach(s=>this.Hr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Hr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}$r(){this.zr=new Set}Ur(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return F.forEach(this.Hr,r=>{const s=se.fromPath(r);return this.Jr(e,s).next(i=>{i||n.removeEntry(s,ue.min())})}).next(()=>(this.zr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Jr(e,n).next(r=>{r?this.Hr.delete(n.toString()):this.Hr.add(n.toString())})}Qr(e){return 0}Jr(e,n){return F.or([()=>F.resolve(this.Gr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Wr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yb{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.ki=r,this.qi=s}static Qi(e,n){let r=Ee(),s=Ee();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new yb(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ate{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lte{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(e,n){this.Gi=e,this.indexManager=n,this.Ki=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.zi(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ji(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new ate;return this.Hi(e,n,o).next(a=>{if(i.result=a,this.$i)return this.Ji(e,n,o,a.size)})}).next(()=>i.result)}Ji(e,n,r,s){return r.documentReadCount<this.Ui?(Ku()<=Te.DEBUG&&X("QueryEngine","SDK will not create cache indexes for query:",Ta(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),F.resolve()):(Ku()<=Te.DEBUG&&X("QueryEngine","Query:",Ta(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Wi*s?(Ku()<=Te.DEBUG&&X("QueryEngine","The SDK decides to create cache indexes for query:",Ta(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Yr(n))):F.resolve())}zi(e,n){if(WI(n))return F.resolve(null);let r=Yr(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Jx(n,null,"F"),r=Yr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Ee(...i);return this.Gi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const c=this.Yi(n,a);return this.Zi(n,c,o,l.readTime)?this.zi(e,Jx(n,null,"F")):this.Xi(e,c,n,l)}))})))}ji(e,n,r,s){return WI(n)||s.isEqual(ue.min())?F.resolve(null):this.Gi.getDocuments(e,r).next(i=>{const o=this.Yi(n,i);return this.Zi(n,o,r,s)?F.resolve(null):(Ku()<=Te.DEBUG&&X("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ta(n)),this.Xi(e,o,n,LZ(s,-1)).next(a=>a))})}Yi(e,n){let r=new Ht(T$(e));return n.forEach((s,i)=>{Sg(e,i)&&(r=r.add(i))}),r}Zi(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Hi(e,n,r){return Ku()<=Te.DEBUG&&X("QueryEngine","Using full collection scan to execute query:",Ta(n)),this.Gi.getDocumentsMatchingQuery(e,n,Ii.min(),r)}Xi(e,n,r,s){return this.Gi.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ute{constructor(e,n,r,s){this.persistence=e,this.es=n,this.serializer=s,this.ts=new Ze(Pe),this.ns=new Au(i=>ab(i),lb),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Xee(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ts))}}function cte(t,e,n,r){return new ute(t,e,n,r)}async function Q$(t,e){const n=ce(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.os(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=Ee();for(const c of s){o.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}for(const c of i){a.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}return n.localDocuments.getDocuments(r,l).next(c=>({_s:c,removedBatchIds:o,addedBatchIds:a}))})})}function dte(t,e){const n=ce(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.ss.newChangeBuffer({trackRemovals:!0});return function(a,l,c,d){const h=c.batch,f=h.keys();let p=F.resolve();return f.forEach(y=>{p=p.next(()=>d.getEntry(l,y)).next(v=>{const _=c.docVersions.get(y);We(_!==null),v.version.compareTo(_)<0&&(h.applyToRemoteDocument(v,c),v.isValidDocument()&&(v.setReadTime(c.commitVersion),d.addEntry(v)))})}),p.next(()=>a.mutationQueue.removeMutationBatch(l,h))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Ee();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function K$(t){const e=ce(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.qr.getLastRemoteSnapshotVersion(n))}function hte(t,e){const n=ce(t),r=e.snapshotVersion;let s=n.ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.ss.newChangeBuffer({trackRemovals:!0});s=n.ts;const a=[];e.targetChanges.forEach((d,h)=>{const f=s.get(h);if(!f)return;a.push(n.qr.removeMatchingKeys(i,d.removedDocuments,h).next(()=>n.qr.addMatchingKeys(i,d.addedDocuments,h)));let p=f.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?p=p.withResumeToken(un.EMPTY_BYTE_STRING,ue.min()).withLastLimboFreeSnapshotVersion(ue.min()):d.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(d.resumeToken,r)),s=s.insert(h,p),function(v,_,g){return v.resumeToken.approximateByteSize()===0||_.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=3e8?!0:g.addedDocuments.size+g.modifiedDocuments.size+g.removedDocuments.size>0}(f,p,d)&&a.push(n.qr.updateTargetData(i,p))});let l=Cs(),c=Ee();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,d))}),a.push(fte(i,o,e.documentUpdates).next(d=>{l=d.us,c=d.cs})),!r.isEqual(ue.min())){const d=n.qr.getLastRemoteSnapshotVersion(i).next(h=>n.qr.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(d)}return F.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(n.ts=s,i))}function fte(t,e,n){let r=Ee(),s=Ee();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Cs();return n.forEach((a,l)=>{const c=i.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(ue.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):X("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{us:o,cs:s}})}function pte(t,e){const n=ce(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function yte(t,e){const n=ce(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.qr.getTargetData(r,e).next(i=>i?(s=i,F.resolve(s)):n.qr.allocateTargetId(r).next(o=>(s=new ii(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.qr.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.ts.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.ts=n.ts.insert(r.targetId,r),n.ns.set(e,r.targetId)),r})}async function nw(t,e,n){const r=ce(t),s=r.ts.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Ih(o))throw o;X("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ts=r.ts.remove(e),r.ns.delete(s.target)}function tk(t,e,n){const r=ce(t);let s=ue.min(),i=Ee();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,d){const h=ce(l),f=h.ns.get(d);return f!==void 0?F.resolve(h.ts.get(f)):h.qr.getTargetData(c,d)}(r,o,Yr(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.es.getDocumentsMatchingQuery(o,e,n?s:ue.min(),n?i:Ee())).next(a=>(mte(r,aee(e),a),{documents:a,ls:i})))}function mte(t,e,n){let r=t.rs.get(e)||ue.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.rs.set(e,r)}class nk{constructor(){this.activeTargetIds=fee()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class gte{constructor(){this.eo=new nk,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,n,r){this.no[e]=n}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new nk,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vte{ro(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){X("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){X("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bf=null;function T_(){return bf===null?bf=function(){return 268435456+Math.round(2147483648*Math.random())}():bf++,"0x"+bf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _te={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xte{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}onMessage(e){this.Eo=e}close(){this.lo()}send(e){this.co(e)}Ao(){this.Po()}Ro(e){this.To(e)}Vo(e){this.Eo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xt="WebChannelConnection";class wte extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.mo=r+"://"+n.host,this.fo=`projects/${s}/databases/${i}`,this.po=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get yo(){return!1}wo(n,r,s,i,o){const a=T_(),l=this.So(n,r);X("RestConnection",`Sending RPC '${n}' ${a}:`,l,s);const c={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(c,i,o),this.Do(n,l,c,s).then(d=>(X("RestConnection",`Received RPC '${n}' ${a}: `,d),d),d=>{throw su("RestConnection",`RPC '${n}' ${a} failed with error: `,d,"url: ",l,"request:",s),d})}Co(n,r,s,i,o,a){return this.wo(n,r,s,i,o)}bo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Su}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),s&&s.headers.forEach((i,o)=>n[o]=i)}So(n,r){const s=_te[n];return`${this.mo}/v1/${r}:${s}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Do(e,n,r,s){const i=T_();return new Promise((o,a)=>{const l=new IZ;l.setWithCredentials(!0),l.listenOnce(CZ.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case C_.NO_ERROR:const d=l.getResponseJson();X(Xt,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(d)),o(d);break;case C_.TIMEOUT:X(Xt,`RPC '${e}' ${i} timed out`),a(new re($.DEADLINE_EXCEEDED,"Request time out"));break;case C_.HTTP_ERROR:const h=l.getStatus();if(X(Xt,`RPC '${e}' ${i} failed with status:`,h,"response text:",l.getResponseText()),h>0){let f=l.getResponseJson();Array.isArray(f)&&(f=f[0]);const p=f==null?void 0:f.error;if(p&&p.status&&p.message){const y=function(_){const g=_.toLowerCase().replace(/_/g,"-");return Object.values($).indexOf(g)>=0?g:$.UNKNOWN}(p.status);a(new re(y,p.message))}else a(new re($.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new re($.UNAVAILABLE,"Connection failed."));break;default:ae()}}finally{X(Xt,`RPC '${e}' ${i} completed.`)}});const c=JSON.stringify(s);X(Xt,`RPC '${e}' ${i} sending request:`,s),l.send(n,"POST",c,r,15)})}vo(e,n,r){const s=T_(),i=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=bZ(),a=SZ(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.xmlHttpFactory=new TZ({})),this.bo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const d=i.join("");X(Xt,`Creating RPC '${e}' stream ${s}: ${d}`,l);const h=o.createWebChannel(d,l);let f=!1,p=!1;const y=new xte({co:_=>{p?X(Xt,`Not sending because RPC '${e}' stream ${s} is closed:`,_):(f||(X(Xt,`Opening RPC '${e}' stream ${s} transport.`),h.open(),f=!0),X(Xt,`RPC '${e}' stream ${s} sending:`,_),h.send(_))},lo:()=>h.close()}),v=(_,g,m)=>{_.listen(g,w=>{try{m(w)}catch(E){setTimeout(()=>{throw E},0)}})};return v(h,xf.EventType.OPEN,()=>{p||X(Xt,`RPC '${e}' stream ${s} transport opened.`)}),v(h,xf.EventType.CLOSE,()=>{p||(p=!0,X(Xt,`RPC '${e}' stream ${s} transport closed`),y.Ro())}),v(h,xf.EventType.ERROR,_=>{p||(p=!0,su(Xt,`RPC '${e}' stream ${s} transport errored:`,_),y.Ro(new re($.UNAVAILABLE,"The operation could not be completed")))}),v(h,xf.EventType.MESSAGE,_=>{var g;if(!p){const m=_.data[0];We(!!m);const w=m,E=w.error||((g=w[0])===null||g===void 0?void 0:g.error);if(E){X(Xt,`RPC '${e}' stream ${s} received error:`,E);const T=E.status;let C=function(O){const L=ht[O];if(L!==void 0)return L$(L)}(T),I=E.message;C===void 0&&(C=$.INTERNAL,I="Unknown error status: "+T+" with message "+E.message),p=!0,y.Ro(new re(C,I)),h.close()}else X(Xt,`RPC '${e}' stream ${s} received:`,m),y.Vo(m)}}),v(a,AZ.STAT_EVENT,_=>{_.stat===OI.PROXY?X(Xt,`RPC '${e}' stream ${s} detected buffering proxy`):_.stat===OI.NOPROXY&&X(Xt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{y.Ao()},0),y}}function I_(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ig(t){return new Nee(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y${constructor(e,n,r=1e3,s=1.5,i=6e4){this.si=e,this.timerId=n,this.Fo=r,this.Mo=s,this.xo=i,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(e){this.cancel();const n=Math.floor(this.Oo+this.qo()),r=Math.max(0,Date.now()-this.Bo),s=Math.max(0,n-r);s>0&&X("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Oo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,s,()=>(this.Bo=Date.now(),e())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){this.No!==null&&(this.No.skipDelay(),this.No=null)}cancel(){this.No!==null&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J${constructor(e,n,r,s,i,o,a,l){this.si=e,this.Ko=r,this.$o=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new Y$(e,n)}jo(){return this.state===1||this.state===5||this.Ho()}Ho(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Jo()}async stop(){this.jo()&&await this.close(0)}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&this.Wo===null&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(e){this.t_(),this.stream.send(e)}async Xo(){if(this.Ho())return this.close(0)}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}async close(e,n){this.t_(),this.n_(),this.zo.cancel(),this.Uo++,e!==4?this.zo.reset():n&&n.code===$.RESOURCE_EXHAUSTED?(Ss(n.toString()),Ss("Using maximum backoff delay to prevent overloading the backend."),this.zo.Lo()):n&&n.code===$.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.r_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Io(n)}r_(){}auth(){this.state=1;const e=this.i_(this.Uo),n=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Uo===n&&this.s_(r,s)},r=>{e(()=>{const s=new re($.UNKNOWN,"Fetching auth token failed: "+r.message);return this.o_(s)})})}s_(e,n){const r=this.i_(this.Uo);this.stream=this.__(e,n),this.stream.ho(()=>{r(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(s=>{r(()=>this.o_(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}Jo(){this.state=5,this.zo.ko(async()=>{this.state=0,this.start()})}o_(e){return X("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}i_(e){return n=>{this.si.enqueueAndForget(()=>this.Uo===e?n():(X("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Ete extends J${constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}__(e,n){return this.connection.vo("Listen",e,n)}onMessage(e){this.zo.reset();const n=Dee(this.serializer,e),r=function(i){if(!("targetChange"in i))return ue.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ue.min():o.readTime?Xr(o.readTime):ue.min()}(e);return this.listener.a_(n,r)}u_(e){const n={};n.database=tw(this.serializer),n.addTarget=function(i,o){let a;const l=o.target;if(a=Yx(l)?{documents:Mee(i,l)}:{query:Lee(i,l)},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=B$(i,o.resumeToken);const c=Xx(i,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(ue.min())>0){a.readTime=cm(i,o.snapshotVersion.toTimestamp());const c=Xx(i,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=Uee(this.serializer,e);r&&(n.labels=r),this.e_(n)}c_(e){const n={};n.database=tw(this.serializer),n.removeTarget=e,this.e_(n)}}class bte extends J${constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(e,n){return this.connection.vo("Write",e,n)}onMessage(e){if(We(!!e.streamToken),this.lastStreamToken=e.streamToken,this.l_){this.zo.reset();const n=$ee(e.writeResults,e.commitTime),r=Xr(e.commitTime);return this.listener.I_(r,n)}return We(!e.writeResults||e.writeResults.length===0),this.l_=!0,this.listener.T_()}E_(){const e={};e.database=tw(this.serializer),this.e_(e)}P_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Fee(this.serializer,r))};this.e_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ste extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.d_=!1}A_(){if(this.d_)throw new re($.FAILED_PRECONDITION,"The client has already been terminated.")}wo(e,n,r){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.connection.wo(e,n,r,s,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===$.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new re($.UNKNOWN,s.toString())})}Co(e,n,r,s){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Co(e,n,r,i,o,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===$.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new re($.UNKNOWN,i.toString())})}terminate(){this.d_=!0}}class Cte{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){this.V_===0&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(e){this.state==="Online"?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.p_("Offline")))}set(e){this.S_(),this.V_=0,e==="Online"&&(this.f_=!1),this.p_(e)}p_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}y_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(Ss(n),this.f_=!1):X("OnlineStateTracker",n)}S_(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ate{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=i,this.F_.ro(o=>{r.enqueueAndForget(async()=>{ra(this)&&(X("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=ce(l);c.C_.add(4),await Ph(c),c.M_.set("Unknown"),c.C_.delete(4),await kg(c)}(this))})}),this.M_=new Cte(r,s)}}async function kg(t){if(ra(t))for(const e of t.v_)await e(!0)}async function Ph(t){for(const e of t.v_)await e(!1)}function X$(t,e){const n=ce(t);n.D_.has(e.targetId)||(n.D_.set(e.targetId,e),vb(n)?gb(n):Tu(n).Ho()&&mb(n,e))}function Z$(t,e){const n=ce(t),r=Tu(n);n.D_.delete(e),r.Ho()&&eM(n,e),n.D_.size===0&&(r.Ho()?r.Zo():ra(n)&&n.M_.set("Unknown"))}function mb(t,e){if(t.x_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ue.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Tu(t).u_(e)}function eM(t,e){t.x_.Oe(e),Tu(t).c_(e)}function gb(t){t.x_=new Iee({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.D_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),Tu(t).start(),t.M_.g_()}function vb(t){return ra(t)&&!Tu(t).jo()&&t.D_.size>0}function ra(t){return ce(t).C_.size===0}function tM(t){t.x_=void 0}async function Tte(t){t.D_.forEach((e,n)=>{mb(t,e)})}async function Ite(t,e){tM(t),vb(t)?(t.M_.w_(e),gb(t)):t.M_.set("Unknown")}async function kte(t,e,n){if(t.M_.set("Online"),e instanceof U$&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.D_.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.D_.delete(a),s.x_.removeTarget(a))}(t,e)}catch(r){X("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await dm(t,r)}else if(e instanceof pp?t.x_.$e(e):e instanceof V$?t.x_.Je(e):t.x_.Ge(e),!n.isEqual(ue.min()))try{const r=await K$(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.x_.it(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const d=i.D_.get(c);d&&i.D_.set(c,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const d=i.D_.get(l);if(!d)return;i.D_.set(l,d.withResumeToken(un.EMPTY_BYTE_STRING,d.snapshotVersion)),eM(i,l);const h=new ii(d.target,l,c,d.sequenceNumber);mb(i,h)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){X("RemoteStore","Failed to raise snapshot:",r),await dm(t,r)}}async function dm(t,e,n){if(!Ih(e))throw e;t.C_.add(1),await Ph(t),t.M_.set("Offline"),n||(n=()=>K$(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{X("RemoteStore","Retrying IndexedDB access"),await n(),t.C_.delete(1),await kg(t)})}function nM(t,e){return e().catch(n=>dm(t,n,e))}async function Rg(t){const e=ce(t),n=Ri(e);let r=e.b_.length>0?e.b_[e.b_.length-1].batchId:-1;for(;Rte(e);)try{const s=await pte(e.localStore,r);if(s===null){e.b_.length===0&&n.Zo();break}r=s.batchId,Pte(e,s)}catch(s){await dm(e,s)}rM(e)&&sM(e)}function Rte(t){return ra(t)&&t.b_.length<10}function Pte(t,e){t.b_.push(e);const n=Ri(t);n.Ho()&&n.h_&&n.P_(e.mutations)}function rM(t){return ra(t)&&!Ri(t).jo()&&t.b_.length>0}function sM(t){Ri(t).start()}async function Nte(t){Ri(t).E_()}async function jte(t){const e=Ri(t);for(const n of t.b_)e.P_(n.mutations)}async function Ote(t,e,n){const r=t.b_.shift(),s=cb.from(r,e,n);await nM(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Rg(t)}async function Dte(t,e){e&&Ri(t).h_&&await async function(r,s){if(function(o){return Cee(o)&&o!==$.ABORTED}(s.code)){const i=r.b_.shift();Ri(r).Yo(),await nM(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Rg(r)}}(t,e),rM(t)&&sM(t)}async function sk(t,e){const n=ce(t);n.asyncQueue.verifyOperationInProgress(),X("RemoteStore","RemoteStore received new credentials");const r=ra(n);n.C_.add(3),await Ph(n),r&&n.M_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.C_.delete(3),await kg(n)}async function Fte(t,e){const n=ce(t);e?(n.C_.delete(2),await kg(n)):e||(n.C_.add(2),await Ph(n),n.M_.set("Unknown"))}function Tu(t){return t.O_||(t.O_=function(n,r,s){const i=ce(n);return i.A_(),new Ete(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{ho:Tte.bind(null,t),Io:Ite.bind(null,t),a_:kte.bind(null,t)}),t.v_.push(async e=>{e?(t.O_.Yo(),vb(t)?gb(t):t.M_.set("Unknown")):(await t.O_.stop(),tM(t))})),t.O_}function Ri(t){return t.N_||(t.N_=function(n,r,s){const i=ce(n);return i.A_(),new bte(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{ho:Nte.bind(null,t),Io:Dte.bind(null,t),T_:jte.bind(null,t),I_:Ote.bind(null,t)}),t.v_.push(async e=>{e?(t.N_.Yo(),await Rg(t)):(await t.N_.stop(),t.b_.length>0&&(X("RemoteStore",`Stopping write stream with ${t.b_.length} pending writes`),t.b_=[]))})),t.N_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _b{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new _i,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new _b(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new re($.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function xb(t,e){if(Ss("AsyncQueue",`${e}: ${t}`),Ih(t))return new re($.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml{constructor(e){this.comparator=e?(n,r)=>e(n,r)||se.comparator(n.key,r.key):(n,r)=>se.comparator(n.key,r.key),this.keyedMap=hc(),this.sortedSet=new Ze(this.comparator)}static emptySet(e){return new ml(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ml)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ml;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ik{constructor(){this.B_=new Ze(se.comparator)}track(e){const n=e.doc.key,r=this.B_.get(n);r?e.type!==0&&r.type===3?this.B_=this.B_.insert(n,e):e.type===3&&r.type!==1?this.B_=this.B_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.B_=this.B_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.B_=this.B_.remove(n):e.type===1&&r.type===2?this.B_=this.B_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):ae():this.B_=this.B_.insert(n,e)}L_(){const e=[];return this.B_.inorderTraversal((n,r)=>{e.push(r)}),e}}class uu{constructor(e,n,r,s,i,o,a,l,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new uu(e,n,ml.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&bg(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $te{constructor(){this.k_=void 0,this.listeners=[]}}class Mte{constructor(){this.queries=new Au(e=>A$(e),bg),this.onlineState="Unknown",this.q_=new Set}}async function Lte(t,e){const n=ce(t),r=e.query;let s=!1,i=n.queries.get(r);if(i||(s=!0,i=new $te),s)try{i.k_=await n.onListen(r)}catch(o){const a=xb(o,`Initialization of query '${Ta(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,i),i.listeners.push(e),e.Q_(n.onlineState),i.k_&&e.K_(i.k_)&&wb(n)}async function Vte(t,e){const n=ce(t),r=e.query;let s=!1;const i=n.queries.get(r);if(i){const o=i.listeners.indexOf(e);o>=0&&(i.listeners.splice(o,1),s=i.listeners.length===0)}if(s)return n.queries.delete(r),n.onUnlisten(r)}function Ute(t,e){const n=ce(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.listeners)a.K_(s)&&(r=!0);o.k_=s}}r&&wb(n)}function Bte(t,e,n){const r=ce(t),s=r.queries.get(e);if(s)for(const i of s.listeners)i.onError(n);r.queries.delete(e)}function wb(t){t.q_.forEach(e=>{e.next()})}class zte{constructor(e,n,r){this.query=e,this.U_=n,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=r||{}}K_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new uu(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.W_?this.z_(e)&&(this.U_.next(e),n=!0):this.j_(e,this.onlineState)&&(this.H_(e),n=!0),this.G_=e,n}onError(e){this.U_.error(e)}Q_(e){this.onlineState=e;let n=!1;return this.G_&&!this.W_&&this.j_(this.G_,e)&&(this.H_(this.G_),n=!0),n}j_(e,n){if(!e.fromCache)return!0;const r=n!=="Offline";return(!this.options.J_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}z_(e){if(e.docChanges.length>0)return!0;const n=this.G_&&this.G_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}H_(e){e=uu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.W_=!0,this.U_.next(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iM{constructor(e){this.key=e}}class oM{constructor(e){this.key=e}}class Wte{constructor(e,n){this.query=e,this.ia=n,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=Ee(),this.mutatedKeys=Ee(),this._a=T$(e),this.aa=new ml(this._a)}get ua(){return this.ia}ca(e,n){const r=n?n.la:new ik,s=n?n.aa:this.aa;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,h)=>{const f=s.get(d),p=Sg(this.query,h)?h:null,y=!!f&&this.mutatedKeys.has(f.key),v=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let _=!1;f&&p?f.data.isEqual(p.data)?y!==v&&(r.track({type:3,doc:p}),_=!0):this.ha(f,p)||(r.track({type:2,doc:p}),_=!0,(l&&this._a(p,l)>0||c&&this._a(p,c)<0)&&(a=!0)):!f&&p?(r.track({type:0,doc:p}),_=!0):f&&!p&&(r.track({type:1,doc:f}),_=!0,(l||c)&&(a=!0)),_&&(p?(o=o.add(p),i=v?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{aa:o,la:r,Zi:a,mutatedKeys:i}}ha(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r){const s=this.aa;this.aa=e.aa,this.mutatedKeys=e.mutatedKeys;const i=e.la.L_();i.sort((c,d)=>function(f,p){const y=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ae()}};return y(f)-y(p)}(c.type,d.type)||this._a(c.doc,d.doc)),this.Pa(r);const o=n?this.Ia():[],a=this.oa.size===0&&this.current?1:0,l=a!==this.sa;return this.sa=a,i.length!==0||l?{snapshot:new uu(this.query,e.aa,s,i,e.mutatedKeys,a===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ta:o}:{Ta:o}}Q_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({aa:this.aa,la:new ik,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(e){return!this.ia.has(e)&&!!this.aa.has(e)&&!this.aa.get(e).hasLocalMutations}Pa(e){e&&(e.addedDocuments.forEach(n=>this.ia=this.ia.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.ia=this.ia.delete(n)),this.current=e.current)}Ia(){if(!this.current)return[];const e=this.oa;this.oa=Ee(),this.aa.forEach(r=>{this.Ea(r.key)&&(this.oa=this.oa.add(r.key))});const n=[];return e.forEach(r=>{this.oa.has(r)||n.push(new oM(r))}),this.oa.forEach(r=>{e.has(r)||n.push(new iM(r))}),n}da(e){this.ia=e.ls,this.oa=Ee();const n=this.ca(e.documents);return this.applyChanges(n,!0)}Aa(){return uu.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,this.sa===0,this.hasCachedResults)}}class qte{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class Hte{constructor(e){this.key=e,this.Ra=!1}}class Gte{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Va={},this.ma=new Au(a=>A$(a),bg),this.fa=new Map,this.ga=new Set,this.pa=new Ze(se.comparator),this.ya=new Map,this.wa=new fb,this.Sa={},this.ba=new Map,this.Da=lu.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return this.Ca===!0}}async function Qte(t,e){const n=sne(t);let r,s;const i=n.ma.get(e);if(i)r=i.targetId,n.sharedClientState.addLocalQueryTarget(r),s=i.view.Aa();else{const o=await yte(n.localStore,Yr(e)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,s=await Kte(n,e,r,a==="current",o.resumeToken),n.isPrimaryClient&&X$(n.remoteStore,o)}return s}async function Kte(t,e,n,r,s){t.va=(h,f,p)=>async function(v,_,g,m){let w=_.view.ca(g);w.Zi&&(w=await tk(v.localStore,_.query,!1).then(({documents:C})=>_.view.ca(C,w)));const E=m&&m.targetChanges.get(_.targetId),T=_.view.applyChanges(w,v.isPrimaryClient,E);return ak(v,_.targetId,T.Ta),T.snapshot}(t,h,f,p);const i=await tk(t.localStore,e,!0),o=new Wte(e,i.ls),a=o.ca(i.documents),l=Rh.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),c=o.applyChanges(a,t.isPrimaryClient,l);ak(t,n,c.Ta);const d=new qte(e,n,o);return t.ma.set(e,d),t.fa.has(n)?t.fa.get(n).push(e):t.fa.set(n,[e]),c.snapshot}async function Yte(t,e){const n=ce(t),r=n.ma.get(e),s=n.fa.get(r.targetId);if(s.length>1)return n.fa.set(r.targetId,s.filter(i=>!bg(i,e))),void n.ma.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await nw(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),Z$(n.remoteStore,r.targetId),rw(n,r.targetId)}).catch(Th)):(rw(n,r.targetId),await nw(n.localStore,r.targetId,!0))}async function Jte(t,e,n){const r=ine(t);try{const s=await function(o,a){const l=ce(o),c=Et.now(),d=a.reduce((p,y)=>p.add(y.key),Ee());let h,f;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let y=Cs(),v=Ee();return l.ss.getEntries(p,d).next(_=>{y=_,y.forEach((g,m)=>{m.isValidDocument()||(v=v.add(g))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,y)).next(_=>{h=_;const g=[];for(const m of a){const w=xee(m,h.get(m.key).overlayedDocument);w!=null&&g.push(new na(m.key,w,v$(w.value.mapValue),Jr.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,g,a)}).next(_=>{f=_;const g=_.applyToLocalDocumentSet(h,v);return l.documentOverlayCache.saveOverlays(p,_.batchId,g)})}).then(()=>({batchId:f.batchId,changes:k$(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let c=o.Sa[o.currentUser.toKey()];c||(c=new Ze(Pe)),c=c.insert(a,l),o.Sa[o.currentUser.toKey()]=c}(r,s.batchId,n),await Nh(r,s.changes),await Rg(r.remoteStore)}catch(s){const i=xb(s,"Failed to persist write");n.reject(i)}}async function aM(t,e){const n=ce(t);try{const r=await hte(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.ya.get(i);o&&(We(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.Ra=!0:s.modifiedDocuments.size>0?We(o.Ra):s.removedDocuments.size>0&&(We(o.Ra),o.Ra=!1))}),await Nh(n,r,e)}catch(r){await Th(r)}}function ok(t,e,n){const r=ce(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.ma.forEach((i,o)=>{const a=o.view.Q_(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=ce(o);l.onlineState=a;let c=!1;l.queries.forEach((d,h)=>{for(const f of h.listeners)f.Q_(a)&&(c=!0)}),c&&wb(l)}(r.eventManager,e),s.length&&r.Va.a_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Xte(t,e,n){const r=ce(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.ya.get(e),i=s&&s.key;if(i){let o=new Ze(se.comparator);o=o.insert(i,rn.newNoDocument(i,ue.min()));const a=Ee().add(i),l=new Tg(ue.min(),new Map,new Ze(Pe),o,a);await aM(r,l),r.pa=r.pa.remove(i),r.ya.delete(e),Eb(r)}else await nw(r.localStore,e,!1).then(()=>rw(r,e,n)).catch(Th)}async function Zte(t,e){const n=ce(t),r=e.batch.batchId;try{const s=await dte(n.localStore,e);uM(n,r,null),lM(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Nh(n,s)}catch(s){await Th(s)}}async function ene(t,e,n){const r=ce(t);try{const s=await function(o,a){const l=ce(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return l.mutationQueue.lookupMutationBatch(c,a).next(h=>(We(h!==null),d=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>l.localDocuments.getDocuments(c,d))})}(r.localStore,e);uM(r,e,n),lM(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Nh(r,s)}catch(s){await Th(s)}}function lM(t,e){(t.ba.get(e)||[]).forEach(n=>{n.resolve()}),t.ba.delete(e)}function uM(t,e,n){const r=ce(t);let s=r.Sa[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Sa[r.currentUser.toKey()]=s}}function rw(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.fa.get(e))t.ma.delete(r),n&&t.Va.Fa(r,n);t.fa.delete(e),t.isPrimaryClient&&t.wa.Rr(e).forEach(r=>{t.wa.containsKey(r)||cM(t,r)})}function cM(t,e){t.ga.delete(e.path.canonicalString());const n=t.pa.get(e);n!==null&&(Z$(t.remoteStore,n),t.pa=t.pa.remove(e),t.ya.delete(n),Eb(t))}function ak(t,e,n){for(const r of n)r instanceof iM?(t.wa.addReference(r.key,e),tne(t,r)):r instanceof oM?(X("SyncEngine","Document no longer in limbo: "+r.key),t.wa.removeReference(r.key,e),t.wa.containsKey(r.key)||cM(t,r.key)):ae()}function tne(t,e){const n=e.key,r=n.path.canonicalString();t.pa.get(n)||t.ga.has(r)||(X("SyncEngine","New document in limbo: "+n),t.ga.add(r),Eb(t))}function Eb(t){for(;t.ga.size>0&&t.pa.size<t.maxConcurrentLimboResolutions;){const e=t.ga.values().next().value;t.ga.delete(e);const n=new se(He.fromString(e)),r=t.Da.next();t.ya.set(r,new Hte(n)),t.pa=t.pa.insert(n,r),X$(t.remoteStore,new ii(Yr(C$(n.path)),r,"TargetPurposeLimboResolution",rb._e))}}async function Nh(t,e,n){const r=ce(t),s=[],i=[],o=[];r.ma.isEmpty()||(r.ma.forEach((a,l)=>{o.push(r.va(l,e,n).then(c=>{if((c||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(l.targetId,c!=null&&c.fromCache?"not-current":"current"),c){s.push(c);const d=yb.Qi(l.targetId,c);i.push(d)}}))}),await Promise.all(o),r.Va.a_(s),await async function(l,c){const d=ce(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>F.forEach(c,f=>F.forEach(f.ki,p=>d.persistence.referenceDelegate.addReference(h,f.targetId,p)).next(()=>F.forEach(f.qi,p=>d.persistence.referenceDelegate.removeReference(h,f.targetId,p)))))}catch(h){if(!Ih(h))throw h;X("LocalStore","Failed to update sequence numbers: "+h)}for(const h of c){const f=h.targetId;if(!h.fromCache){const p=d.ts.get(f),y=p.snapshotVersion,v=p.withLastLimboFreeSnapshotVersion(y);d.ts=d.ts.insert(f,v)}}}(r.localStore,i))}async function nne(t,e){const n=ce(t);if(!n.currentUser.isEqual(e)){X("SyncEngine","User change. New user:",e.toKey());const r=await Q$(n.localStore,e);n.currentUser=e,function(i,o){i.ba.forEach(a=>{a.forEach(l=>{l.reject(new re($.CANCELLED,o))})}),i.ba.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Nh(n,r._s)}}function rne(t,e){const n=ce(t),r=n.ya.get(e);if(r&&r.Ra)return Ee().add(r.key);{let s=Ee();const i=n.fa.get(e);if(!i)return s;for(const o of i){const a=n.ma.get(o);s=s.unionWith(a.view.ua)}return s}}function sne(t){const e=ce(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=aM.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=rne.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Xte.bind(null,e),e.Va.a_=Ute.bind(null,e.eventManager),e.Va.Fa=Bte.bind(null,e.eventManager),e}function ine(t){const e=ce(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Zte.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ene.bind(null,e),e}class lk{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=Ig(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return cte(this.persistence,new lte,e.initialUser,this.serializer)}createPersistence(e){return new ite(pb.jr,this.serializer)}createSharedClientState(e){return new gte}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class one{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>ok(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=nne.bind(null,this.syncEngine),await Fte(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Mte}()}createDatastore(e){const n=Ig(e.databaseInfo.databaseId),r=function(i){return new wte(i)}(e.databaseInfo);return function(i,o,a,l){return new Ste(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new Ate(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>ok(this.syncEngine,n,0),function(){return rk.D()?new rk:new vte}())}createSyncEngine(e,n){return function(s,i,o,a,l,c,d){const h=new Gte(s,i,o,a,l,c);return d&&(h.Ca=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(n){const r=ce(n);X("RemoteStore","RemoteStore shutting down."),r.C_.add(5),await Ph(r),r.F_.shutdown(),r.M_.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ane{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Oa(this.observer.next,e)}error(e){this.observer.error?this.Oa(this.observer.error,e):Ss("Uncaught Error in snapshot listener:",e.toString())}Na(){this.muted=!0}Oa(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lne{constructor(e,n,r,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=tn.UNAUTHENTICATED,this.clientId=y$.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async i=>{X("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(r,i=>(X("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new re($.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new _i;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=xb(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function k_(t,e){t.asyncQueue.verifyOperationInProgress(),X("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await Q$(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function uk(t,e){t.asyncQueue.verifyOperationInProgress();const n=await cne(t);X("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener(s=>sk(e.remoteStore,s)),t.setAppCheckTokenChangeListener((s,i)=>sk(e.remoteStore,i)),t._onlineComponents=e}function une(t){return t.name==="FirebaseError"?t.code===$.FAILED_PRECONDITION||t.code===$.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}async function cne(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){X("FirestoreClient","Using user provided OfflineComponentProvider");try{await k_(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!une(n))throw n;su("Error using user provided cache. Falling back to memory cache: "+n),await k_(t,new lk)}}else X("FirestoreClient","Using default OfflineComponentProvider"),await k_(t,new lk);return t._offlineComponents}async function dM(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(X("FirestoreClient","Using user provided OnlineComponentProvider"),await uk(t,t._uninitializedComponentsProvider._online)):(X("FirestoreClient","Using default OnlineComponentProvider"),await uk(t,new one))),t._onlineComponents}function dne(t){return dM(t).then(e=>e.syncEngine)}async function hne(t){const e=await dM(t),n=e.eventManager;return n.onListen=Qte.bind(null,e.syncEngine),n.onUnlisten=Yte.bind(null,e.syncEngine),n}function fne(t,e,n={}){const r=new _i;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const d=new ane({next:f=>{o.enqueueAndForget(()=>Vte(i,h)),f.fromCache&&l.source==="server"?c.reject(new re($.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new zte(a,d,{includeMetadataChanges:!0,J_:!0});return Lte(i,h)}(await hne(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hM(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ck=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fM(t,e,n){if(!n)throw new re($.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function pne(t,e,n,r){if(e===!0&&r===!0)throw new re($.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function dk(t){if(!se.isDocumentKey(t))throw new re($.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function hk(t){if(se.isDocumentKey(t))throw new re($.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function bb(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ae()}function cu(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new re($.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=bb(t);throw new re($.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fk{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new re($.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new re($.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}pne("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=hM((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new re($.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new re($.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new re($.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Pg{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new fk({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new re($.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new re($.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new fk(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new RZ;switch(r.type){case"firstParty":return new OZ(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new re($.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=ck.get(n);r&&(X("ComponentProvider","Removing Datastore"),ck.delete(n),r.terminate())}(this),Promise.resolve()}}function yne(t,e,n,r={}){var s;const i=(t=cu(t,Pg))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&su("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=tn.MOCK_USER;else{a=o1(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new re($.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new tn(c)}t._authCredentials=new PZ(new p$(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ng{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ng(this.firestore,e,this._query)}}class rr{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new xi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new rr(this.firestore,e,this._key)}}class xi extends Ng{constructor(e,n,r){super(e,n,C$(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new rr(this.firestore,null,new se(e))}withConverter(e){return new xi(this.firestore,e,this._path)}}function mne(t,e,...n){if(t=Qt(t),fM("collection","path",e),t instanceof Pg){const r=He.fromString(e,...n);return hk(r),new xi(t,null,r)}{if(!(t instanceof rr||t instanceof xi))throw new re($.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(He.fromString(e,...n));return hk(r),new xi(t.firestore,null,r)}}function Sb(t,e,...n){if(t=Qt(t),arguments.length===1&&(e=y$.newId()),fM("doc","path",e),t instanceof Pg){const r=He.fromString(e,...n);return dk(r),new rr(t,null,new se(r))}{if(!(t instanceof rr||t instanceof xi))throw new re($.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(He.fromString(e,...n));return dk(r),new rr(t.firestore,t instanceof xi?t.converter:null,new se(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gne{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new Y$(this,"async_queue_retry"),this.iu=()=>{const n=I_();n&&X("AsyncQueue","Visibility state changed to "+n.visibilityState),this.zo.Qo()};const e=I_();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.su(),this.ou(e)}enterRestrictedMode(e){if(!this.Za){this.Za=!0,this.nu=e||!1;const n=I_();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.iu)}}enqueue(e){if(this.su(),this.Za)return new Promise(()=>{});const n=new _i;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ya.push(e),this._u()))}async _u(){if(this.Ya.length!==0){try{await this.Ya[0](),this.Ya.shift(),this.zo.reset()}catch(e){if(!Ih(e))throw e;X("AsyncQueue","Operation failed with retryable error: "+e)}this.Ya.length>0&&this.zo.ko(()=>this._u())}}ou(e){const n=this.Ja.then(()=>(this.tu=!0,e().catch(r=>{this.eu=r,this.tu=!1;const s=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Ss("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.tu=!1,r))));return this.Ja=n,n}enqueueAfterDelay(e,n,r){this.su(),this.ru.indexOf(e)>-1&&(n=0);const s=_b.createAndSchedule(this,e,n,r,i=>this.au(i));return this.Xa.push(s),s}su(){this.eu&&ae()}verifyOperationInProgress(){}async uu(){let e;do e=this.Ja,await e;while(e!==this.Ja)}cu(e){for(const n of this.Xa)if(n.timerId===e)return!0;return!1}lu(e){return this.uu().then(()=>{this.Xa.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Xa)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.uu()})}hu(e){this.ru.push(e)}au(e){const n=this.Xa.indexOf(e);this.Xa.splice(n,1)}}class jg extends Pg{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=function(){return new gne}(),this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||yM(this),this._firestoreClient.terminate()}}function vne(t,e){const n=typeof t=="object"?t:d1(),r=typeof t=="string"?t:e||"(default)",s=u1(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=i1("firestore");i&&yne(s,...i)}return s}function pM(t){return t._firestoreClient||yM(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function yM(t){var e,n,r;const s=t._freezeSettings(),i=function(a,l,c,d){return new HZ(a,l,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,hM(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._firestoreClient=new lne(t._authCredentials,t._appCheckCredentials,t._queue,i),!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:s.localCache.kind,_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(e){this._byteString=e}static fromBase64String(e){try{return new du(un.fromBase64String(e))}catch(n){throw new re($.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new du(un.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cb{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new re($.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mM{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ab{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new re($.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new re($.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Pe(this._lat,e._lat)||Pe(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _ne=/^__.*__$/;class xne{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new na(e,this.data,this.fieldMask,n,this.fieldTransforms):new kh(e,this.data,n,this.fieldTransforms)}}function gM(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ae()}}class Tb{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Pu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(e){return new Tb(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Tu({path:r,du:!1});return s.Au(e),s}Ru(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Tu({path:r,du:!1});return s.Pu(),s}Vu(e){return this.Tu({path:void 0,du:!0})}mu(e){return hm(e,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Au(this.path.get(e))}Au(e){if(e.length===0)throw this.mu("Document fields must not be empty");if(gM(this.Iu)&&_ne.test(e))throw this.mu('Document fields cannot begin and end with "__"')}}class wne{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Ig(e)}pu(e,n,r,s=!1){return new Tb({Iu:e,methodName:n,gu:r,path:zt.emptyPath(),du:!1,fu:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ene(t){const e=t._freezeSettings(),n=Ig(t._databaseId);return new wne(t._databaseId,!!e.ignoreUndefinedProperties,n)}function bne(t,e,n,r,s,i={}){const o=t.pu(i.merge||i.mergeFields?2:0,e,n,s);wM("Data must be an object, but it was:",o,r);const a=_M(r,o);let l,c;if(i.merge)l=new xr(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const h of i.mergeFields){const f=Sne(e,h,n);if(!o.contains(f))throw new re($.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);Ane(d,f)||d.push(f)}l=new xr(d),c=o.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=o.fieldTransforms;return new xne(new Xn(a),l,c)}function vM(t,e){if(xM(t=Qt(t)))return wM("Unsupported field value:",e,t),_M(t,e);if(t instanceof mM)return function(r,s){if(!gM(s.Iu))throw s.mu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.mu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.du&&e.Iu!==4)throw e.mu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=vM(a,s.Vu(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Qt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return pee(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Et.fromDate(r);return{timestampValue:cm(s.serializer,i)}}if(r instanceof Et){const i=new Et(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:cm(s.serializer,i)}}if(r instanceof Ab)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof du)return{bytesValue:B$(s.serializer,r._byteString)};if(r instanceof rr){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.mu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:hb(r.firestore._databaseId||s.databaseId,r._key.path)}}throw s.mu(`Unsupported field value: ${bb(r)}`)}(t,e)}function _M(t,e){const n={};return m$(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Cu(t,(r,s)=>{const i=vM(s,e.Eu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function xM(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Et||t instanceof Ab||t instanceof du||t instanceof rr||t instanceof mM)}function wM(t,e,n){if(!xM(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=bb(n);throw r==="an object"?e.mu(t+" a custom object"):e.mu(t+" "+r)}}function Sne(t,e,n){if((e=Qt(e))instanceof Cb)return e._internalPath;if(typeof e=="string")return EM(t,e);throw hm("Field path arguments must be of type string or ",t,!1,void 0,n)}const Cne=new RegExp("[~\\*/\\[\\]]");function EM(t,e,n){if(e.search(Cne)>=0)throw hm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Cb(...e.split("."))._internalPath}catch{throw hm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function hm(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new re($.INVALID_ARGUMENT,a+t+l)}function Ane(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bM{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new rr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Tne(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(SM("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class Tne extends bM{data(){return super.data()}}function SM(t,e){return typeof e=="string"?EM(t,e):e instanceof Cb?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ine(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new re($.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class kne{convertValue(e,n="none"){switch(Qo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ft(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Go(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw ae()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Cu(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertGeoPoint(e){return new Ab(ft(e.latitude),ft(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=ib(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Td(e));default:return null}}convertTimestamp(e){const n=ki(e);return new Et(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=He.fromString(e);We(G$(r));const s=new Id(r.get(1),r.get(3)),i=new se(r.popFirst(5));return s.isEqual(n)||Ss(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rne(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Pne extends bM{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new yp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(SM("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class yp extends Pne{data(e={}){return super.data(e)}}class Nne{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Sf(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new yp(this._firestore,this._userDataWriter,r.key,r,new Sf(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new re($.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new yp(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Sf(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new yp(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Sf(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,d=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:jne(a.type),doc:l,oldIndex:c,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function jne(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ae()}}class One extends kne{constructor(e){super(),this.firestore=e}convertBytes(e){return new du(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new rr(this.firestore,null,n)}}function Dne(t){t=cu(t,Ng);const e=cu(t.firestore,jg),n=pM(e),r=new One(e);return Ine(t._query),fne(n,t._query).then(s=>new Nne(e,r,t,s))}function CM(t,e,n){t=cu(t,rr);const r=cu(t.firestore,jg),s=Rne(t.converter,e,n);return AM(r,[bne(Ene(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Jr.none())])}function Fne(t){return AM(cu(t.firestore,jg),[new ub(t._key,Jr.none())])}function AM(t,e){return function(r,s){const i=new _i;return r.asyncQueue.enqueueAndForget(async()=>Jte(await dne(r),s,i)),i.promise}(pM(t),e)}(function(e,n=!0){(function(s){Su=s})(c1),Ul(new Lo("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new jg(new NZ(r.getProvider("auth-internal")),new FZ(r.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new re($.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Id(c.options.projectId,d)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),Qr(DI,"4.3.2",e),Qr(DI,"4.3.2","esm2017")})();const Og=vne(cE),$ne=async()=>await Dne(mne(Og,"players")).then(e=>e.docs.map(n=>n.data())).catch(console.log),sw=async t=>{const e={...t,id:ps(),createdAt:new Date().getTime(),updatedAt:new Date().getTime()};return await CM(Sb(Og,"players",e.id),e),e},Mne=async(t,e)=>{const n={...e,updatedAt:new Date().getTime()};return await CM(Sb(Og,"players",n.id),n),n},Lne=async t=>(await Fne(Sb(Og,"players",t)),!0);function Vne({onSelect:t,...e}){const[n,r]=x.useState(""),s=x.useCallback(()=>{r(ps())},[]);return u.jsxs(nr,{title:"選擇玩家",...e,children:[u.jsx(ke,{onClick:s,color:"secondary",children:"刷新列表"}),u.jsx("div",{className:"mt-4",children:u.jsx(TM,{onClickPlayer:t},n)})]})}const TM=({onClickPlayer:t,onClickClone:e,onClickDelete:n})=>{const{value:r,loading:s}=zK($ne),i=x.useCallback(l=>{if(!t||!r)return;const c=l.currentTarget.getAttribute("data-id");if(!c)return;const d=r.find(h=>h.id===c);d&&t(c,d)},[t,r]),o=x.useCallback(l=>{if(!e||!r)return;const c=l.currentTarget.getAttribute("data-id");if(!c)return;const d=r.find(p=>p.id===c);if(!d)return;const{id:h,...f}=d;e(f)},[e,r]),a=x.useCallback(l=>{if(!n)return;const c=l.currentTarget.getAttribute("data-id");c&&n(c)},[n]);return u.jsxs(u.Fragment,{children:[s&&u.jsx("div",{className:"w-32 text-center mx-auto my-8",children:u.jsx(EE,{})}),!s&&(r==null?void 0:r.length)===0&&u.jsx("div",{className:"text-gray-500 text-center py-4",children:u.jsx("span",{children:"沒有已儲存的玩家"})}),u.jsx("div",{className:`grid grid-cols-1 gap-2 ${e||n?"":"md:grid-cols-2"}`,children:!s&&(r==null?void 0:r.map(l=>u.jsxs("div",{className:"text-left flex items-center gap-x-2",children:[u.jsx("div",{className:"flex-1 cursor-pointer",onClick:i,"data-id":l.id,children:u.jsx(jD,{player:l})}),e&&u.jsx("div",{className:"shrink-0",children:u.jsx(ke,{color:"primary",variant:"text",onClick:o,"data-id":l.id,children:"複製"})}),n&&u.jsx("div",{className:"shrink-0",children:u.jsx(ke,{color:"danger",variant:"text",onClick:a,"data-id":l.id,children:"刪除"})})]},l.id)))})]})};function Une(){const[t,e]=x.useState(),[n,r]=x.useState("1"),[s,i]=vi(!1),o=x.useCallback(()=>i(!1),[i]),a=x.useCallback(()=>{e(void 0),i(!0)},[i]),l=x.useCallback((f,p)=>{e(p),i(!0)},[i]),c=x.useCallback(f=>{sw({...f,name:f.name+"(複製)"}).then(()=>{r(ps())})},[]),d=x.useCallback(f=>{confirm("確定要刪除玩家嗎？")&&Lne(f).then(()=>{r(ps())})},[]),h=x.useCallback(f=>f.id?Mne(f.id,f).then(()=>{r(ps()),i(!1)}):sw(f).then(()=>{r(ps()),i(!1)}),[i]);return u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"container mx-auto max-w-screen-sm space-y-4 py-16",children:[u.jsx("div",{className:"shrink-0",children:u.jsx("a",{href:"/",className:"underline",children:"< 回上一頁"})}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("div",{children:u.jsx("h1",{className:"text-4xl",children:"玩家"})}),u.jsx("div",{children:u.jsx(ke,{onClick:a,children:"新增"})})]}),u.jsx(TM,{onClickPlayer:l,onClickClone:c,onClickDelete:d},n)]}),u.jsx(nr,{title:"新增／修改玩家",open:s,onClose:o,children:u.jsx("div",{className:"container space-y-6",children:u.jsx(dF,{onSubmit:h,defaultValue:t})})})]})}const Bne={0:"東",1:"南",2:"西",3:"北"};function zne({playerIndex:t,...e}){return u.jsx("span",{...e,children:Bne[t]})}const Wne={0:{title:"",name:"玩家A",color:"#6700cf"},1:{title:"",name:"玩家B",color:"#00b5de"},2:{title:"",name:"玩家C",color:"#e3277b"},3:{title:"",name:"玩家D",color:"#03ada5"}},qne=`${new Date().toISOString().substring(0,10)} 對局`;function Hne(){const t=Kj(),[,e]=LL(),{getValues:n,control:r}=sg({defaultValues:{name:qne,startingScore:"25000",isManganRoundUp:"1",yakuMax:"12",yakumanMax:"13"}}),s=rg({name:"startingScore",control:r}),[i,o]=x.useState(Wne),[a,l]=x.useState(),[c,d]=vi(!1),h=x.useCallback(C=>{const I=C.currentTarget.getAttribute("data-player-index");if(!I)return;const k=i[I];l({index:I,player:k}),d(!0)},[i,d]),f=x.useCallback(async C=>{a&&(o(I=>({...I,[a.index]:{...I[a.index],...C}})),d(!1))},[a,d]),p=x.useCallback(()=>{d(!1)},[d]),[y,v]=x.useState(),_=x.useCallback(C=>{C.preventDefault(),v("choose")},[]),g=x.useCallback(()=>{v(null)},[]),m=x.useCallback((C,I)=>{y==="choose"&&(l(k=>k?{...k,player:I}:void 0),v(null))},[y]),w=x.useCallback(C=>{const I=C.currentTarget;if(!I)return;const k=I.getAttribute("data-player-index");if(!k)return;const O=k==="0"?"1":k==="1"?"2":"3";o(L=>({...L,[k]:L[O],[O]:L[k]}))},[]),[{loading:E},T]=ng(async()=>{const{name:C,...I}=n(),k=await Promise.all(Object.values(i).map(D=>D.id||D.name==="玩家A"||D.name==="玩家B"||D.name==="玩家C"||D.name==="玩家D"?Promise.resolve(D):sw(D))),O={code:NK(),name:C,remark:"",createdAt:new Date().toISOString(),createdBy:"Dicky",updatedAt:new Date().toISOString(),updatedBy:"Dicky",setting:I,players:{0:k[0],1:k[1],2:k[2],3:k[3]},activeResultDetail:null},L=await t.push("matches",O),j=parseInt(I.startingScore),P={matchId:L.key,code:qy(O.code,1,0),roundCount:1,extendedRoundCount:0,cumulatedThousands:0,nextRoundCumulatedThousands:0,resultType:0,nextRoundType:0,playerResults:{0:{beforeScore:j,afterScore:j,type:0,scoreChanges:[],prevScoreChanges:[],detail:{han:1,fu:30,yakumanCount:0,dora:0,redDora:0,innerDora:0,yakus:[],raw:{},isRevealed:!1,isRiichied:!1}},1:{beforeScore:j,afterScore:j,type:0,scoreChanges:[],prevScoreChanges:[],detail:{han:1,fu:30,yakumanCount:0,dora:0,redDora:0,innerDora:0,yakus:[],raw:{},isRevealed:!1,isRiichied:!1}},2:{beforeScore:j,afterScore:j,type:0,scoreChanges:[],prevScoreChanges:[],detail:{han:1,fu:30,yakumanCount:0,dora:0,redDora:0,innerDora:0,yakus:[],raw:{},isRevealed:!1,isRiichied:!1}},3:{beforeScore:j,afterScore:j,type:0,scoreChanges:[],prevScoreChanges:[],detail:{han:1,fu:30,yakumanCount:0,dora:0,redDora:0,innerDora:0,yakus:[],raw:{},isRevealed:!1,isRiichied:!1}}},doras:[]};await t.push("matchRounds",P),e(`/match/${P.matchId}/obs`)},[t,n,i,e]);return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"container mx-auto max-w-screen-sm",children:u.jsxs("div",{className:"min-h-screen flex flex-col py-16 gap-y-4",children:[u.jsx("div",{className:"shrink-0",children:u.jsx("a",{href:"/",className:"underline",children:"< 回上一頁"})}),u.jsx("div",{className:"flex-1",children:u.jsxs("div",{className:"space-y-12",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsx("h1",{className:"text-4xl",children:"對局"}),u.jsx(pn,{label:"對局名稱",children:u.jsx(Sn,{name:"name",control:r,rules:{required:!0},render:({field:C})=>u.jsx("div",{className:"text-xl",children:u.jsx(ri,{...C})})})}),u.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[u.jsx(pn,{label:"起始點數",children:u.jsx(Sn,{name:"startingScore",control:r,rules:{required:!0},render:({field:C})=>u.jsxs(cs,{...C,children:[u.jsx("option",{value:"25000",children:"25000"}),u.jsx("option",{value:"30000",children:"30000"}),u.jsx("option",{value:"35000",children:"35000"}),u.jsx("option",{value:"50000",children:"50000"}),u.jsx("option",{value:"100000",children:"100000"})]})})}),u.jsx(pn,{label:"滿貫切上",children:u.jsx(Sn,{name:"isManganRoundUp",control:r,rules:{required:!0},render:({field:C})=>u.jsxs(cs,{...C,children:[u.jsx("option",{value:"0",children:"不切上"}),u.jsx("option",{value:"1",children:"切上 (3翻70符 & 4翻40符 = 滿貫)"})]})})}),u.jsx(pn,{label:"累積翻數上限",children:u.jsx(Sn,{name:"yakuMax",control:r,rules:{required:!0},render:({field:C})=>u.jsxs(cs,{...C,children:[u.jsx("option",{value:"12",children:"三倍滿 (12翻)"}),u.jsx("option",{value:"13",children:"累計役滿 (13翻)"})]})})}),u.jsx(pn,{label:"役滿上限",children:u.jsx(Sn,{name:"yakumanMax",control:r,rules:{required:!0},render:({field:C})=>u.jsxs(cs,{...C,children:[u.jsx("option",{value:"13",children:"單役滿"}),u.jsx("option",{value:"26",children:"兩倍役滿"}),u.jsx("option",{value:"39",children:"三倍役滿"}),u.jsx("option",{value:"130",children:"無上限"})]})})})]})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsx("h1",{className:"text-4xl",children:"玩家"}),u.jsx("div",{children:["0","1","2","3"].map(C=>u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"flex items-center gap-x-4",children:[u.jsx("div",{className:"shrink-0",children:u.jsx("div",{className:"h-14 w-14 border-4 rounded border-black text-[40px] flex items-center justify-center pb-1",children:u.jsx(zne,{playerIndex:C})})}),u.jsx("div",{className:"flex-1 text-[48px] cursor-pointer hover:scale-105","data-player-index":C,onClick:h,children:u.jsx(Ti,{player:i[C],score:s})})]},C),C!=="3"&&u.jsx("div",{className:"text-center",children:u.jsx(ke,{variant:"icon",color:"secondary",type:"button","data-player-index":C,onClick:w,children:u.jsx("i",{className:"bi bi-arrow-down-up"})})})]}))})]})]})}),u.jsx("div",{className:"shrink-0 space-y-4",children:u.jsx(ke,{size:"xlarge",className:"w-full",onClick:T,loading:E,type:"submit",children:"開始對局"})})]})}),u.jsx(nr,{title:u.jsxs("div",{className:"space-x-4",children:[u.jsx("span",{children:"修改玩家"}),u.jsxs("a",{href:"#",className:"text-xs underline font-normal text-teal-600 hover:text-teal-500 align-middle",onClick:_,children:[u.jsx("i",{className:"bi bi-search"}),"搜尋玩家"]})]}),open:c,onClose:p,children:u.jsxs("div",{className:"container space-y-6",children:[!!(a!=null&&a.player.id)&&u.jsxs("div",{className:"py-2 px-3 bg-yellow-200 text-yellow-800 rounded",children:["注意：在這裡的修改不會儲存到玩家列表的資料庫。假如你想保留這些修改，請在"," ",u.jsxs("a",{href:"/players",target:"_blank",className:"text-teal-600 underline",children:["玩家列表 ",u.jsx("i",{className:"bi bi-box-arrow-up-right"})]})," ","中修改。"]}),u.jsx(dF,{onSubmit:f,defaultValue:a==null?void 0:a.player})]})}),u.jsx(Vne,{open:y==="choose",onSelect:m,onClose:g})]})}function Gne({team:t,onClickEdit:e,children:n,...r}){const s=x.useCallback(()=>{e==null||e(t)},[e,t]);return u.jsxs("div",{className:"flex-1 flex items-center gap-x-2 rounded p-2 text-white",style:{background:t.color??"#115e59"},...r,children:[u.jsx("div",{className:"flex-1",children:u.jsx("div",{className:"text-2xl",children:t.name??"(無名稱)"})}),e&&u.jsx("div",{className:"shrink-0",children:u.jsx(ke,{variant:"icon",color:"inverted",type:"button",onClick:s,children:u.jsx("i",{className:"bi bi-pencil"})})})]})}function Qne(){const{data:t,update:e,push:n}=Mn("teams"),r=x.useMemo(()=>Object.entries(t??{}).reverse().map(([g,m])=>({...m,_id:g})),[t]),[s,i]=vi(!1),{register:o,reset:a,handleSubmit:l,control:c}=sg({defaultValues:{_id:void 0,name:"新的隊伍",color:"#000000"}}),d=rg({control:c}),h=x.useMemo(()=>({name:"隊員名字",title:d.name??"",color:d.color??"#000000"}),[d.color,d.name]),f=x.useRef(null),p=x.useCallback(()=>i(!1),[i]),y=x.useCallback(()=>{a({_id:"",name:"新的隊伍",color:"#000000"}),i(!0)},[a,i]),v=x.useCallback(g=>{a({...g}),i(!0)},[a,i]),_=x.useMemo(()=>l(g=>{g._id?e({[g._id]:g}):n(g),i(!1)}),[l,n,i,e]);return u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"container mx-auto max-w-screen-sm space-y-4 py-16",children:[u.jsx("div",{className:"shrink-0",children:u.jsx("a",{href:"/",className:"underline",children:"< 回上一頁"})}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("div",{children:u.jsx("h1",{className:"text-4xl",children:"隊伍"})}),u.jsx("div",{children:u.jsx(ke,{onClick:y,children:"新增"})})]}),u.jsx("div",{className:"space-y-2",children:r.map(g=>u.jsx(Gne,{team:g,onClickEdit:v},g._id))})]}),u.jsx(nr,{title:"新增／修改隊伍",open:s,onClose:p,children:u.jsx("div",{className:"container",children:u.jsxs("form",{ref:f,onSubmit:_,children:[u.jsx("input",{type:"hidden",...o("_id")}),u.jsxs("div",{children:[u.jsx(pn,{className:"mb-6",label:"名字",children:u.jsx(Sn,{name:"name",control:c,rules:{required:!0},render:({field:g})=>u.jsx(ri,{...g})})}),u.jsx(pn,{className:"mb-6",label:"顏色（務必選能看清楚白字的深色）",children:u.jsx(Sn,{name:"color",control:c,rules:{required:!0},render:({field:g})=>u.jsx(GD,{...g})})})]}),u.jsxs("div",{className:"mb-6",children:[u.jsx("div",{className:"mb-2",children:"預覽"}),u.jsx("div",{className:"text-[4rem] px-4 pt-6 pb-1 bg-gray-800 text-white relative",children:u.jsx(Ti,{player:h,score:25e3})})]}),u.jsxs("div",{className:"flex gap-x-2",children:[u.jsx("div",{className:"flex-1",children:u.jsx(ke,{className:"w-full",color:"secondary",type:"button",onClick:p,children:"取消"})}),u.jsx("div",{className:"flex-1",children:u.jsx(ke,{className:"w-full",type:"submit",children:"儲存"})})]})]})})})]})}function Kne({params:{obsRoomId:t}}){const{data:e}=Mn(`obs/${t}`),n=x.useMemo(()=>({matchId:e==null?void 0:e.matchId}),[e==null?void 0:e.matchId]);return!n||!n.matchId?u.jsx(u.Fragment,{children:"讀取中…"}):u.jsx(pD,{params:n})}function Yne({params:{obsRoomId:t}}){const{data:e}=Mn(`obs/${t}`),{match:n,matchRounds:r,matchCurrentRound:s}=Is((e==null?void 0:e.matchId)??"");return!n||!s?u.jsx("div",{children:"對局讀取失敗。"}):u.jsx("div",{children:u.jsx("div",{className:"container mx-auto my-8 px-8 space-y-6",children:u.jsx(wu,{players:n.players,matchRounds:r,className:"w-full table-auto"})})})}function Jne(){const{data:t}=Mn("matches"),e=x.useMemo(()=>Object.entries(t??{}).reverse().map(([n,r])=>({...r,_id:n})),[t]);return console.log(e),u.jsxs("div",{className:"container mx-auto max-w-screen-sm space-y-4 py-16",children:[u.jsx("div",{className:"shrink-0",children:u.jsx("a",{href:"/",className:"underline",children:"< 回上一頁"})}),u.jsx("div",{className:"flex justify-between items-center",children:u.jsx("div",{children:u.jsx("h1",{className:"text-4xl",children:"對局"})})}),u.jsxs("table",{className:"data-table w-full",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"對局"}),u.jsx("th",{children:"東家"}),u.jsx("th",{children:"南家"}),u.jsx("th",{children:"西家"}),u.jsx("th",{children:"北家"})]})}),u.jsx("tbody",{children:e.map(n=>u.jsxs("tr",{children:[u.jsx("td",{children:u.jsx("a",{href:`/match/${n._id}`,target:"_blank",children:n.name})}),u.jsx("td",{children:n.players[0].name}),u.jsx("td",{children:n.players[1].name}),u.jsx("td",{children:n.players[2].name}),u.jsx("td",{children:n.players[3].name})]},n._id))})]})]})}function IM({players:t,matchRounds:e}){return x.useMemo(()=>{const n=Object.values(e??{}),r=n[n.length-1];return[...n.map(s=>({name:s.resultType===rt.Hotfix?"分數調整":cD(s.roundCount,s.extendedRoundCount,8),p0:s.playerResults[0].beforeScore,p1:s.playerResults[1].beforeScore,p2:s.playerResults[2].beforeScore,p3:s.playerResults[3].beforeScore})),{name:"完結",p0:r.playerResults[0].afterScore,p1:r.playerResults[1].afterScore,p2:r.playerResults[2].afterScore,p3:r.playerResults[3].afterScore}]},[e]),u.jsx("div",{className:"bg-white"})}function Xne({params:{obsRoomId:t}}){const{data:e}=Mn(`obs/${t}`),{match:n,matchRounds:r,matchCurrentRound:s}=Is((e==null?void 0:e.matchId)??"");return!n||!s?u.jsx("div",{children:"對局讀取失敗。"}):u.jsx("div",{children:u.jsx("div",{className:"container mx-auto my-8 px-8 space-y-6",children:u.jsx(IM,{players:n.players,matchRounds:r})})})}function Zne({params:{obsRoomId:t}}){const{data:e}=Mn(`obs/${t}`),{match:n,matchRounds:r,matchCurrentRound:s}=Is((e==null?void 0:e.matchId)??""),[i,o]=x.useState(0);return x.useEffect(()=>{const l=setInterval(()=>{o(c=>1-c)},8e3);return()=>{clearInterval(l)}},[]),!n||!s?u.jsx("div",{children:"對局讀取失敗。"}):u.jsxs("div",{children:[u.jsx("div",{className:i===0?"block":"hidden",children:u.jsx(wu,{players:n.players,matchRounds:r,className:"w-full table-auto"})}),u.jsx("div",{className:i===1?"block":"hidden",children:u.jsx(IM,{players:n.players,matchRounds:r})})]})}function ere({params:{obsRoomId:t}}){const{data:e}=Mn(`obs/${t}`),n=x.useMemo(()=>({matchId:e==null?void 0:e.matchId}),[e==null?void 0:e.matchId]);return!n||!n.matchId?u.jsx(u.Fragment,{children:"讀取中…"}):u.jsx(OD,{params:n})}const Cf=({teamPlayer:t})=>{const e=x.useMemo(()=>Wa(t),[t]),n=x.useMemo(()=>iD(e.color??"#000000"),[e.color]);return u.jsxs("div",{className:"relative overflow-hidden",children:[u.jsx("table",{className:"w-full",children:u.jsxs("tbody",{children:[u.jsxs("tr",{style:{background:e.color},children:[u.jsx("td",{className:"w-[8mm] h-[8mm]"}),u.jsx("td",{className:"w-[2mm] border-r border-white"}),u.jsx("td",{}),u.jsx("td",{className:"w-[2mm] border-l border-white"}),u.jsx("td",{className:"w-[8mm] h-[8mm]"})]}),u.jsxs("tr",{style:{background:e.color},children:[u.jsx("td",{className:"h-[2mm] border-b border-white"}),u.jsx("td",{}),u.jsx("td",{}),u.jsx("td",{}),u.jsx("td",{className:"h-[2mm] border-b border-white"})]}),u.jsxs("tr",{style:{background:`linear-gradient(180deg, ${e.color}, ${n})`},children:[u.jsx("td",{}),u.jsx("td",{}),u.jsx("td",{className:"w-[150mm] h-[40mm]"}),u.jsx("td",{}),u.jsx("td",{})]}),u.jsxs("tr",{style:{background:n},children:[u.jsx("td",{className:"h-[2mm] border-t border-white"}),u.jsx("td",{}),u.jsx("td",{}),u.jsx("td",{}),u.jsx("td",{className:"h-[2mm] border-t border-white"})]}),u.jsxs("tr",{style:{background:n},children:[u.jsx("td",{className:"w-[8mm] h-[8mm]"}),u.jsx("td",{className:"w-[2mm] border-r border-white"}),u.jsx("td",{}),u.jsx("td",{className:"w-[2mm] border-l border-white"}),u.jsx("td",{className:"w-[8mm] h-[8mm]"})]})]})}),u.jsx("div",{className:"absolute left-[0] top-[2.5mm] w-[55mm] h-[55mm] bg-contain opacity-50",style:{backgroundImage:`url(${e.largeTeamPicUrl})`}}),u.jsxs("div",{className:"absolute top-[10mm] bottom-[10mm] left-[25mm] right-[12mm] flex flex-col items-center justify-center",children:[u.jsx("p",{className:"text-[13mm] text-white leading-none font-semibold mb-[3mm]",style:{textShadow:"0px 0px 3px #333333B0, 0px 0px 6px #333333B0"},children:e.name}),u.jsx("p",{className:"text-[13mm] text-white leading-none font-semibold",style:{textShadow:"0px 0px 3px #333333B0, 0px 0px 6px #333333B0"},children:e.nickname})]})]})},tre=()=>{const{matchId:t}=UL();console.log(t);const{data:e}=pE({queryKey:["matches",t],queryFn:({queryKey:n})=>sD(n[1]),enabled:!!t});return e?u.jsxs("div",{className:"pt-16",children:[u.jsxs("div",{className:"w-[170mm] mx-auto mb-8 print:hidden",children:[u.jsx("p",{children:"右鍵「列印」，設定如下："}),u.jsxs("ul",{children:[u.jsxs("li",{children:["紙張大小：",u.jsx("strong",{children:"A4"})]}),u.jsxs("li",{children:["邊界：",u.jsx("strong",{children:"無邊界"})]}),u.jsxs("li",{children:["選項：",u.jsx("strong",{children:"打勾「背景圖片」"})]})]})]}),u.jsx("div",{className:"w-[170mm] h-[60mm] mx-auto",children:u.jsx(Cf,{teamPlayer:e==null?void 0:e.playerEast})}),u.jsx("div",{className:"w-[170mm] h-[60mm] mx-auto",children:u.jsx(Cf,{teamPlayer:e==null?void 0:e.playerSouth})}),u.jsx("div",{className:"w-[170mm] h-[60mm] mx-auto",children:u.jsx(Cf,{teamPlayer:e==null?void 0:e.playerWest})}),u.jsx("div",{className:"w-[170mm] h-[60mm] mx-auto",children:u.jsx(Cf,{teamPlayer:e==null?void 0:e.playerNorth})})]}):u.jsx(u.Fragment,{})},kM=({params:{matchId:t}})=>{const{match:e,matchRounds:n}=Is(t),r=x.useMemo(()=>Object.entries(n??{}).filter(([,s])=>!!s.resultDetail).map(([s,i])=>({id:s,...i}))??[],[n]);return!e||!n?u.jsx(u.Fragment,{}):u.jsxs("div",{className:"container mx-auto my-8 px-8 space-y-8",children:[u.jsx("h1",{className:"text-4xl text-center",children:e.name}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("h4",{className:"text-3xl",children:[u.jsx("i",{className:"bi bi-bar-chart-steps"})," 分數"," ",u.jsx("span",{className:"text-sm",children:"( 立=立直, 和=和牌, 統=出統, 摸=自摸, 聽=聽牌 )"})]}),u.jsx(wu,{players:e.players,matchRounds:n??{},className:"w-full table-auto"})]}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("h4",{className:"text-3xl",children:[u.jsx("i",{className:"bi bi-clock-history"})," 和牌記錄"]}),u.jsxs("table",{className:"data-table w-full",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"局數"}),u.jsx("th",{children:"玩家"}),u.jsx("th",{children:"分數"}),u.jsx("th",{children:"役種"})]})}),u.jsx("tbody",{children:r.map(s=>u.jsxs("tr",{className:"odd:bg-neutral-200",children:[u.jsx("td",{className:"text-center py-1",children:u.jsx(_r,{roundCount:s.roundCount,extendedRoundCount:s.extendedRoundCount})}),u.jsx("td",{className:"text-center py-1",style:{background:e.players[s.resultDetail.winnerPlayerIndex].color},children:e.players[s.resultDetail.winnerPlayerIndex].name}),u.jsx("td",{className:"text-center py-1 text-xl",children:u.jsx(En,{value:s.playerResults[s.resultDetail.winnerPlayerIndex].afterScore-s.playerResults[s.resultDetail.winnerPlayerIndex].beforeScore,positiveClassName:"text-green-600",negativeClassName:"text-red-600",signed:!0,hideZero:!0})}),u.jsxs("td",{className:"text-center py-1",children:[u.jsx("p",{children:s.resultDetail.yakus.map(({label:i})=>i).join(" ")}),u.jsx("p",{children:u.jsx(Hy,{han:s.resultDetail.han,fu:s.resultDetail.fu,yakumanCount:s.resultDetail.yakumanCount,isManganRoundUp:e.setting.isManganRoundUp==="1"})})]})]},s.id))})]})]})]})};function nre({params:{obsRoomId:t}}){const{data:e}=Mn(`obs/${t}`),n=x.useMemo(()=>({matchId:e==null?void 0:e.matchId}),[e==null?void 0:e.matchId]);return!n||!n.matchId?u.jsx(u.Fragment,{children:"讀取中…"}):u.jsx(kM,{params:n})}const rre={[rt.Ron]:"ron",[rt.SelfDrawn]:"tsumo",[rt.Exhausted]:"exhausted",[rt.Hotfix]:"hotfix",[rt.Unknown]:"unknown"},sre={[An.East]:"east",[An.South]:"south",[An.West]:"west",[An.North]:"north"},ire={[ut.None]:"none",[ut.Win]:"win",[ut.Lose]:"lose"},Af=(t,e)=>{var n,r,s,i,o,a,l,c,d;return{position:sre[$i(e,t.roundCount)],type:ire[t.playerResults[e].type],status:t.playerResults[e].isRiichi||(n=t.playerResults[e].detail)!=null&&n.isRiichied?"isRiichied":t.playerResults[e].isRevealed||(r=t.playerResults[e].detail)!=null&&r.isRevealed?"isRevealed":"none",isWaited:!!t.playerResults[e].waitingTiles&&t.playerResults[e].waitingTiles.length>0,beforeScore:t.playerResults[e].beforeScore,afterScore:t.playerResults[e].afterScore,dora:(s=t.playerResults[e].detail)==null?void 0:s.dora,redDora:(i=t.playerResults[e].detail)==null?void 0:i.redDora,innerDora:(o=t.playerResults[e].detail)==null?void 0:o.innerDora,han:(a=t.playerResults[e].detail)==null?void 0:a.han,fu:(l=t.playerResults[e].detail)==null?void 0:l.fu,yaku:(d=(c=t.playerResults[e].detail)==null?void 0:c.yakus)==null?void 0:d.map(({label:h})=>h).join(" "),pureScore:0}};function ore({params:{matchId:t}}){const{match:e,matchRounds:n,matchCurrentRound:r}=Is(t),s=x.useCallback(()=>{if(!e||!n)return;const i=Object.values(n),o=i[i.length-1],a=[{index:"0",score:o.playerResults[0].afterScore},{index:"1",score:o.playerResults[1].afterScore},{index:"2",score:o.playerResults[2].afterScore},{index:"3",score:o.playerResults[3].afterScore}].sort((h,f)=>h.score===f.score?h.index<f.index?-1:1:f.score-h.score),l={0:(a.findIndex(h=>h.index==="0")+1).toString(),1:(a.findIndex(h=>h.index==="1")+1).toString(),2:(a.findIndex(h=>h.index==="2")+1).toString(),3:(a.findIndex(h=>h.index==="3")+1).toString()},c={1:15,2:5,3:-5,4:-15},d={_id:t,result:{playerEast:{score:o.playerResults[0].afterScore,ranking:l[0],point:(o.playerResults[0].afterScore-25e3)/1e3+c[l[0]]},playerSouth:{score:o.playerResults[1].afterScore,ranking:l[1],point:(o.playerResults[1].afterScore-25e3)/1e3+c[l[1]]},playerWest:{score:o.playerResults[2].afterScore,ranking:l[2],point:(o.playerResults[2].afterScore-25e3)/1e3+c[l[2]]},playerNorth:{score:o.playerResults[3].afterScore,ranking:l[3],point:(o.playerResults[3].afterScore-25e3)/1e3+c[l[3]]}},rounds:i.map(h=>({_key:ps(),type:rre[h.resultType],code:`${h.roundCount}.${h.extendedRoundCount}`,playerEast:Af(h,"0"),playerSouth:Af(h,"1"),playerWest:Af(h,"2"),playerNorth:Af(h,"3")}))};fetch(`http://localhost:3000/api/match/${d._id}/result`,{method:"PATCH",body:JSON.stringify(d),headers:{Accept:"application/json"}}).then(()=>{alert("done")})},[e,t,n]);return!e||!r?u.jsx("div",{children:"對局讀取失敗。"}):u.jsx("div",{children:u.jsxs("div",{className:"container mx-auto my-8 px-8 space-y-6",children:[u.jsxs("div",{children:[u.jsx("h6",{className:"text-center text-sm",children:t}),u.jsx("h3",{className:"text-2xl text-center",children:e.name})]}),u.jsx(wu,{players:e.players,matchRounds:n,className:"w-full table-auto"}),u.jsx("div",{className:"text-center",children:u.jsx(ke,{onClick:s,children:"匯出"})})]})})}const are=({initialMinutes:t})=>{const[e,n]=x.useState(0),[r,s]=x.useMemo(()=>[Math.floor(e/60).toString().padStart(2,"0"),(e%60).toString().padStart(2,"0")],[e]);return x.useEffect(()=>{n(t*60)},[t]),XK(()=>{n(i=>i-1)},e>0?1e3:null),u.jsxs("span",{children:[r,":",s]})},RM=({params:{matchId:t}})=>{const{match:e}=Is(t),n=x.useMemo(()=>e?["0","1","2","3"].map(i=>e.players[i]):[],[e]),r=tY("m"),s=x.useMemo(()=>{const i=parseInt(r);return isNaN(i)?15:i},[r]);return u.jsxs("div",{className:"fixed inset-0 text-white flex flex-col justify-center items-center",style:{background:"linear-gradient(to bottom, rgb(30, 34, 59), rgb(16, 18, 33))"},children:[u.jsxs("div",{className:"w-[80vw]",children:[u.jsxs("div",{className:"flex justify-between",children:[u.jsx("img",{src:"/images/tournament-long-logo.png",className:"w-[50%]",alt:""}),u.jsx("div",{children:u.jsx("img",{src:"/images/logo-hkma.webp",className:"w-[12vw]",alt:""})})]}),u.jsxs("div",{className:"flex justify-between items-center mb-[10vh]",children:[u.jsxs("div",{style:{paddingBottom:"25vh"},children:[u.jsx("p",{className:"text-left text-[80px] leading-3",children:"下一場賽事"}),u.jsx("p",{className:"text-left text-[120px] scale-[200%] origin-top-left font-numeric",children:u.jsx(are,{initialMinutes:s})})]}),u.jsx("div",{className:"grid grid-cols-2 gap-[2vw]",children:n.map(i=>u.jsx("img",{className:"w-[16vw] aspect-square",src:i.largeTeamPicUrl}))})]})]}),u.jsxs("div",{className:"fixed bottom-[5vh] left-[10vw]",children:[u.jsx("div",{children:u.jsx("img",{src:"/images/homepage-qr.png",className:"w-[8vw]",alt:""})}),u.jsxs("p",{className:"text-[32px]",children:["聯賽官網: ",u.jsx("u",{children:"https://hkleague2024.hkmahjong.org/"})]})]})]})};function lre({params:{obsRoomId:t}}){const{data:e}=Mn(`obs/${t}`),n=x.useMemo(()=>({matchId:e==null?void 0:e.matchId}),[e==null?void 0:e.matchId]);return!n||!n.matchId?u.jsx(u.Fragment,{children:"讀取中…"}):u.jsx(RM,{params:n})}function ure(){return u.jsx("div",{className:"fixed inset-0 text-white flex flex-col justify-center items-center",style:{background:"linear-gradient(to bottom, rgb(30, 34, 59), rgb(16, 18, 33))"},children:u.jsxs("div",{className:"w-[80vw]",children:[u.jsxs("div",{className:"flex justify-between",children:[u.jsx("img",{src:"/images/tournament-long-logo.png",className:"w-[50%]",alt:""}),u.jsx("div",{children:u.jsx("img",{src:"/images/logo-hkma.webp",className:"w-[12vw]",alt:""})})]}),u.jsxs("div",{className:"flex flex-col justify-center items-center h-[70vh]",children:[u.jsx("p",{className:"text-[100px] text-center",children:"今天賽事已結束，感謝各位收看！"}),u.jsx("div",{className:"text-center mt-[5vh]",children:u.jsx("img",{src:"/images/homepage-qr.png",className:"w-[12vw] mx-auto",alt:""})}),u.jsx("p",{className:"text-[48px] text-center",children:u.jsx("u",{children:"https://hkleague2024.hkmahjong.org/"})}),u.jsx("p",{className:"text-[48px] text-center",children:"賽程、賽事重溫、隊伍介紹、新手教程"})]})]})})}const cre=new tG({defaultOptions:{queries:{retry:2,refetchOnReconnect:!1,refetchOnWindowFocus:!1,refetchIntervalInBackground:!1,staleTime:1/0}}});R_.createRoot(document.getElementById("root")).render(u.jsx(me.StrictMode,{children:u.jsx(oG,{client:cre,children:u.jsx(L7,{children:u.jsx(VK,{children:u.jsxs(BL,{children:[u.jsx(dt,{path:"/",component:EK}),u.jsx(dt,{path:"/create-match",component:Hne}),u.jsx(dt,{path:"/match/:matchId",component:OK}),u.jsx(dt,{path:"/match/:matchId/obs",component:pD}),u.jsx(dt,{path:"/match/:matchId/control",component:OD}),u.jsx(dt,{path:"/match/:matchId/export",component:ore}),u.jsx(dt,{path:"/match/:matchId/forecast",component:RM}),u.jsx(dt,{path:"/match/:matchId/nameplates",component:tre}),u.jsx(dt,{path:"/match/:matchId/stat",component:kM}),u.jsx(dt,{path:"/obs/:obsRoomId",component:Kne}),u.jsx(dt,{path:"/obs/:obsRoomId/control",component:ere}),u.jsx(dt,{path:"/obs/:obsRoomId/forecast",component:lre}),u.jsx(dt,{path:"/obs/:obsRoomId/end",component:ure}),u.jsx(dt,{path:"/obs/:obsRoomId/score",component:Yne}),u.jsx(dt,{path:"/obs/:obsRoomId/chart",component:Xne}),u.jsx(dt,{path:"/obs/:obsRoomId/carousel",component:Zne}),u.jsx(dt,{path:"/obs/:obsRoomId/stat",component:nre}),u.jsx(dt,{path:"/players",component:Une}),u.jsx(dt,{path:"/teams",component:Qne}),u.jsx(dt,{path:"/matches",component:Jne})]})})})})}));qL();export{iw as c,ow as g};
