import{i as b,n as f,r as l,u as v,k as p,a as N,j as e,L as h}from"./index-0LaFy2cp.js";import{a as w,C as y}from"./useCurrentTournament-Dp40AeN5.js";import{u as S}from"./useObsRoom-DdQRc1vQ.js";var I=function(s,r,t){if(!b)return[r,f,f];var c=JSON.parse,n=l.useRef(function(i){try{var u=t?t.raw?String:t.serializer:JSON.stringify,o=localStorage.getItem(i);return o!==null?c(o):(r&&localStorage.setItem(i,u(r)),r)}catch{return r}}),m=l.useState(function(){return n.current(s)}),x=m[0],a=m[1];l.useLayoutEffect(function(){return a(n.current(s))},[s]);var d=l.useCallback(function(i){try{var u=typeof i=="function"?i(x):i;if(typeof u>"u")return;var o=void 0;t||(o=JSON.stringify(u)),localStorage.setItem(s,o),a(c(o))}catch{}},[s,a]),j=l.useCallback(function(){try{localStorage.removeItem(s),a(void 0)}catch{}},[s,a]);return[x,d,j]};function C(){return v({queryKey:["v2-tournaments"],queryFn:w,placeholderData:p})}function E(s){var r;return(r=document.getElementById(s))==null?void 0:r.showModal()}function L(s){var r;return(r=document.getElementById(s))==null?void 0:r.close()}function M(){var t;const{data:s}=S(),{rtMatch:r}=N(((t=s==null?void 0:s.activeMatch)==null?void 0:t.id)??(s==null?void 0:s.matchId));return r?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"border-2 border-error rounded text-center space-y-1 p-1",children:[e.jsx("div",{className:"text-error text-xs font-bold",children:"直播中"}),e.jsx("div",{children:r.name})]})}):e.jsx(e.Fragment,{})}function T({children:s}){var x;const{data:r=[]}=C(),[t,c]=I("v2-current-tournament-id",""),n=l.useMemo(()=>r==null?void 0:r.find(({id:a})=>a===t),[r,t]);l.useEffect(()=>{!t&&r[0]&&c(r[0].id)},[r,t,c]);const m=l.useCallback(a=>{const d=a.currentTarget.getAttribute("data-tournament-id");c(d),L("tournament-selector-dialog")},[c]);return e.jsxs(y.Provider,{value:t,children:[e.jsxs("div",{className:"drawer drawer-open",children:[e.jsx("input",{id:"my-drawer-2",type:"checkbox",className:"drawer-toggle"}),e.jsxs("div",{className:"drawer-content",children:[e.jsx("div",{className:"navbar bg-base-100 w-full border-b-1 border-base-300",children:e.jsxs("div",{className:"mx-2 flex-1 px-2 flex gap-x-2 items-center",children:[e.jsxs("div",{className:"flex gap-x-2 items-center",children:[e.jsx("img",{src:(x=n==null?void 0:n.image.logo)==null?void 0:x.default.url,className:"w-8 h-8"}),e.jsx("span",{children:n==null?void 0:n.name})]}),e.jsx("div",{children:r.length>1&&e.jsx("button",{onClick:()=>E("tournament-selector-dialog"),className:"btn btn-xs btn-ghost text-primary",children:"切換"})})]})}),e.jsx("main",{children:s})]}),e.jsx("div",{className:"drawer-side border-r-1 border-base-300",children:e.jsxs("div",{className:"w-60",children:[e.jsx("div",{className:"p-4 w-full text-lg text-center",children:"日麻直播系統"}),e.jsx("h5",{className:"text-sm font-bold px-4",children:"聯賽控制"}),e.jsxs("ul",{className:"menu bg-base-100 text-base-content min-h-full p-4 w-full",children:[e.jsx("li",{children:e.jsx(h,{href:"/",children:"賽事"})}),e.jsx("li",{children:e.jsx("a",{children:"隊伍／選手"})}),e.jsx("li",{children:e.jsx("a",{children:"風格"})})]}),e.jsx("div",{className:"divider"}),e.jsx("h5",{className:"text-sm font-bold px-4",children:"OBS 控制"}),e.jsx("div",{className:"px-4 py-2",children:e.jsx(M,{})}),e.jsxs("ul",{className:"menu bg-base-100 text-base-content min-h-full p-4 w-full",children:[e.jsx("li",{children:e.jsx("a",{children:"如何設置 OBS"})}),e.jsx("li",{children:e.jsx(h,{href:"/obs/match-control",children:"分數控制台"})}),e.jsx("li",{children:e.jsx(h,{href:"/obs/scene-control",children:"多合一場景控制台"})})]})]})})]}),e.jsxs("dialog",{id:"tournament-selector-dialog",className:"modal",children:[e.jsxs("div",{className:"modal-box",children:[e.jsx("h3",{className:"font-bold text-lg",children:"切換聯賽"}),e.jsx("ul",{className:"menu w-full",children:r.map(a=>{var d;return e.jsx("li",{children:e.jsxs("a",{className:"flex gap-x-2",onClick:m,"data-tournament-id":a.id,children:[e.jsx("img",{src:(d=a.image.logo)==null?void 0:d.default.url,className:"w-8 h-8",alt:""}),e.jsx("span",{className:"flex-1",children:a.name})]})},a.id)})})]}),e.jsx("form",{method:"dialog",className:"modal-backdrop",children:e.jsx("button",{children:"close"})})]})]})}export{T as default};
